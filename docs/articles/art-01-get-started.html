<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started â€¢ midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">midfieldr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9012</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/art-01-get-started.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/art-02-midfield-data.html">MIDFIELD practice data</a>
    </li>
    <li>
      <a href="../articles/art-03-multiway.html">Multiway graphs and tables</a>
    </li>
    <li>
      <a href="../articles/art-04-case-selection.html">Case selection</a>
    </li>
    <li>
      <a href="../articles/art-05-timely-completion.html">Timely completion</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/pages/get_session.html">Session info</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/pages/about_midfield.html">About</a>
</li>
<li>
  <a href="https://github.com/MIDFIELDR/midfieldr">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="art-01-get-started_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/master/vignettes/art-01-get-started.Rmd"><code>vignettes/art-01-get-started.Rmd</code></a></small>
      <div class="hidden name"><code>art-01-get-started.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>In the MIDFIELD practice data, the programs with the greatest numbers of students are Business and Engineering. In this vignette, we compare the number of students ever enrolled in these programs, grouped by sex and race/ethnicity.</p>
<p>We use midfieldr functions to access midfielddata student records. We condition, group and summarize the data, and graph a result. For data carpentry, we use base R and selected syntax from the data.table package.</p>
<div id="this-vignette-uses" class="section level3">
<h3 class="hasAnchor">
<a href="#this-vignette-uses" class="anchor"></a>This vignette uses</h3>
<p>midfieldr functions</p>
<ul>
<li><code><a href="../reference/add_race_sex.html">add_race_sex()</a></code></li>
<li><code><a href="../reference/filter_text.html">filter_text()</a></code></li>
<li><code><a href="../reference/prepare_multiway.html">prepare_multiway()</a></code></li>
<li><code><a href="../reference/subset_matriculant.html">subset_matriculant()</a></code></li>
</ul>
<p>midfieldr built-in data sets</p>
<ul>
<li><code>cip</code></li>
</ul>
<p>packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages used</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfieldr">midfieldr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfielddata">midfielddata</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># optional code to control data.table printing</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>datatable.print.nrows <span class="op">=</span> <span class="fl">10</span>, datatable.print.topn <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="gather-programs" class="section level2">
<h2 class="hasAnchor">
<a href="#gather-programs" class="anchor"></a>Gather programs</h2>
<p>Instructional programs are encoded by 6-digit CIP codes, included in midfieldr in the <code>cip</code> data set. You may view its help page by running</p>
<pre><code><a href="../reference/cip.html">? cip</a></code></pre>
<p>We search <code>cip</code> for our program codes using <code><a href="../reference/filter_text.html">filter_text()</a></code>. You may view its help page by running</p>
<pre><code><a href="../reference/filter_text.html">? filter_text</a></code></pre>
<p>In this example, we assume we have already searched <code>cip</code> and found that the codes we want start with 14 (engineering) and 52 (business). Our next step is to pull all 6-digit codes associated with these two programs.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># business</span>
<span class="va">business</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="st">"^52"</span>, keep_col <span class="op">=</span> <span class="st">"cip6"</span><span class="op">)</span>

<span class="co"># add program label</span>
<span class="va">business</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Business"</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">business</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;       cip6  program</span>
<span class="co">#&gt;  1: 520101 Business</span>
<span class="co">#&gt;  2: 520201 Business</span>
<span class="co">#&gt;  3: 520202 Business</span>
<span class="co">#&gt;  4: 520203 Business</span>
<span class="co">#&gt;  5: 520204 Business</span>
<span class="co">#&gt; ---                </span>
<span class="co">#&gt; 90: 521910 Business</span>
<span class="co">#&gt; 91: 521999 Business</span>
<span class="co">#&gt; 92: 522001 Business</span>
<span class="co">#&gt; 93: 522101 Business</span>
<span class="co">#&gt; 94: 529999 Business</span></code></pre></div>
<p>Repeat for engineering</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># engineering</span>
<span class="va">engineering</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="st">"^14"</span>, keep_col <span class="op">=</span> <span class="st">"cip6"</span><span class="op">)</span>

<span class="co"># add program label</span>
<span class="va">engineering</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Engineering"</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">engineering</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;       cip6     program</span>
<span class="co">#&gt;  1: 140101 Engineering</span>
<span class="co">#&gt;  2: 140102 Engineering</span>
<span class="co">#&gt;  3: 140201 Engineering</span>
<span class="co">#&gt;  4: 140301 Engineering</span>
<span class="co">#&gt;  5: 140401 Engineering</span>
<span class="co">#&gt; ---                   </span>
<span class="co">#&gt; 52: 144401 Engineering</span>
<span class="co">#&gt; 53: 144501 Engineering</span>
<span class="co">#&gt; 54: 149999 Engineering</span>
<span class="co">#&gt; 55: 14XXXX Engineering</span>
<span class="co">#&gt; 56: 14YYYY Engineering</span></code></pre></div>
<p>Bind the two data frames.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># bind the two data frames</span>
<span class="va">program_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">business</span>, <span class="va">engineering</span><span class="op">)</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">program_group</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">program</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;        cip6     program</span>
<span class="co">#&gt;   1: 520101    Business</span>
<span class="co">#&gt;   2: 520201    Business</span>
<span class="co">#&gt;   3: 520202    Business</span>
<span class="co">#&gt;   4: 520203    Business</span>
<span class="co">#&gt;   5: 520204    Business</span>
<span class="co">#&gt;  ---                   </span>
<span class="co">#&gt; 146: 144401 Engineering</span>
<span class="co">#&gt; 147: 144501 Engineering</span>
<span class="co">#&gt; 148: 149999 Engineering</span>
<span class="co">#&gt; 149: 14XXXX Engineering</span>
<span class="co">#&gt; 150: 14YYYY Engineering</span></code></pre></div>
<p>We extract the <code>cip6</code> column as a character vector to use later to extract student data by their CIP codes.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract a vector of 6-digit CIP codes</span>
<span class="va">group_cip</span> <span class="op">&lt;-</span> <span class="va">program_group</span><span class="op">$</span><span class="va">cip6</span>

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">group_cip</span><span class="op">)</span>
<span class="co">#&gt;  chr [1:150] "520101" "520201" "520202" "520203" "520204" "520205" "520206" ...</span></code></pre></div>
</div>
<div id="gather-students" class="section level2">
<h2 class="hasAnchor">
<a href="#gather-students" class="anchor"></a>Gather students</h2>
<p>We access the term data to obtain the IDs of all students ever enrolled in these programs. The result, <code>DT</code>, is a data table to which we will add information as we proceed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract unique students ever enrolled from term data</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"cip6"</span>, <span class="st">"institution"</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">$</span><span class="va">cip6</span> <span class="op">%chin%</span> <span class="va">group_cip</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">DT</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                 id   cip6   institution</span>
<span class="co">#&gt;     1: MID25783135 520101 Institution M</span>
<span class="co">#&gt;     2: MID25783162 14XXXX Institution M</span>
<span class="co">#&gt;     3: MID25783162 520301 Institution M</span>
<span class="co">#&gt;     4: MID25783162 521401 Institution M</span>
<span class="co">#&gt;     5: MID25783166 14XXXX Institution M</span>
<span class="co">#&gt;    ---                                 </span>
<span class="co">#&gt; 50961: MID26697484 521401 Institution L</span>
<span class="co">#&gt; 50962: MID26697576 520301 Institution L</span>
<span class="co">#&gt; 50963: MID26697576 521401 Institution L</span>
<span class="co">#&gt; 50964: MID26697599 521201 Institution L</span>
<span class="co">#&gt; 50965: MID26697685 521201 Institution L</span></code></pre></div>
<p>We update the IDs a number of times, so we extract them from the data table as a character vector.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># initialize an ID vector</span>
<span class="va">latest_id</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>Examining the result shows a vector with 36,685 unique IDs.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">latest_id</span><span class="op">)</span>
<span class="co">#&gt;  chr [1:36685] "MID25783135" "MID25783162" "MID25783166" "MID25783167" ...</span></code></pre></div>
<p>We use <code><a href="../reference/subset_matriculant.html">subset_matriculant()</a></code> to limit our research to students for whom we have matriculation information. The default matriculation record is <code>midfieldstudents</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># limit study to students with matriculation data</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_matriculant.html">subset_matriculant</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;                 id   cip6   institution</span>
<span class="co">#&gt;     1: MID25783135 520101 Institution M</span>
<span class="co">#&gt;     2: MID25783162 14XXXX Institution M</span>
<span class="co">#&gt;     3: MID25783162 520301 Institution M</span>
<span class="co">#&gt;     4: MID25783162 521401 Institution M</span>
<span class="co">#&gt;     5: MID25783166 14XXXX Institution M</span>
<span class="co">#&gt;    ---                                 </span>
<span class="co">#&gt; 50961: MID26697484 521401 Institution L</span>
<span class="co">#&gt; 50962: MID26697576 520301 Institution L</span>
<span class="co">#&gt; 50963: MID26697576 521401 Institution L</span>
<span class="co">#&gt; 50964: MID26697599 521201 Institution L</span>
<span class="co">#&gt; 50965: MID26697685 521201 Institution L</span></code></pre></div>
<p>Update the ID vector.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># update the ID vector</span>
<span class="va">latest_id</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
                    
<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">latest_id</span><span class="op">)</span>
<span class="co">#&gt; [1] 36685</span></code></pre></div>
<p>In this case, all our enrollees are recorded in the student data set, so the number of students remains the same.</p>
</div>
<div id="group-and-summarize" class="section level2">
<h2 class="hasAnchor">
<a href="#group-and-summarize" class="anchor"></a>Group and summarize</h2>
<p>Our results are going to be grouped by program, race/ethnicity, and sex. Here, we join these variables to the working data frame. We use <code><a href="../reference/add_race_sex.html">add_race_sex()</a></code> to access the student data to obtain race/ethnicity and sex as self-reported at matriculation.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># join demographics</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_race_sex.html">add_race_sex</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;                 id   cip6   institution  race    sex</span>
<span class="co">#&gt;     1: MID25783135 520101 Institution M White   Male</span>
<span class="co">#&gt;     2: MID25783162 14XXXX Institution M White   Male</span>
<span class="co">#&gt;     3: MID25783162 520301 Institution M White   Male</span>
<span class="co">#&gt;     4: MID25783162 521401 Institution M White   Male</span>
<span class="co">#&gt;     5: MID25783166 14XXXX Institution M White   Male</span>
<span class="co">#&gt;    ---                                              </span>
<span class="co">#&gt; 50961: MID26697484 521401 Institution L White Female</span>
<span class="co">#&gt; 50962: MID26697576 520301 Institution L Asian   Male</span>
<span class="co">#&gt; 50963: MID26697576 521401 Institution L Asian   Male</span>
<span class="co">#&gt; 50964: MID26697599 521201 Institution L White   Male</span>
<span class="co">#&gt; 50965: MID26697685 521201 Institution L White   Male</span></code></pre></div>
<p>Next we join the program names from <code>program_group</code> to our working data frame by <code>cip6</code>. Set <code>all.x = TRUE</code> for a left-outer join, that is, keeping all the rows of <code>DT</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add program name </span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">program_group</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;          cip6          id   institution          race    sex     program</span>
<span class="co">#&gt;     1: 140101 MID25853474 Institution B         Other   Male Engineering</span>
<span class="co">#&gt;     2: 140101 MID25864225 Institution B         White Female Engineering</span>
<span class="co">#&gt;     3: 140101 MID25864273 Institution B         Asian   Male Engineering</span>
<span class="co">#&gt;     4: 140101 MID25864554 Institution B         White   Male Engineering</span>
<span class="co">#&gt;     5: 140101 MID25864996 Institution B         Asian   Male Engineering</span>
<span class="co">#&gt;    ---                                                                  </span>
<span class="co">#&gt; 50961: 529999 MID26356699 Institution E International   Male    Business</span>
<span class="co">#&gt; 50962: 529999 MID26356852 Institution E         White Female    Business</span>
<span class="co">#&gt; 50963: 529999 MID26357196 Institution E         White Female    Business</span>
<span class="co">#&gt; 50964: 529999 MID26357287 Institution E         White   Male    Business</span>
<span class="co">#&gt; 50965: 529999 MID26357906 Institution E         White   Male    Business</span></code></pre></div>
<p>Next we group by our grouping variables variables and count the number of students in each grouping. The count is assigned to the new <code>ever</code> column.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># assign</span>
<span class="va">grouping_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"sex"</span>, <span class="st">"race"</span><span class="op">)</span>

<span class="co"># aggregate</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>ever <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, keyby <span class="op">=</span> <span class="va">grouping_variables</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">DT</span>, nrows <span class="op">=</span> <span class="fl">32</span><span class="op">)</span>
<span class="co">#&gt;         program    sex            race  ever</span>
<span class="co">#&gt;  1:    Business Female           Asian   505</span>
<span class="co">#&gt;  2:    Business Female           Black  1637</span>
<span class="co">#&gt;  3:    Business Female        Hispanic   520</span>
<span class="co">#&gt;  4:    Business Female   International    92</span>
<span class="co">#&gt;  5:    Business Female Native American    56</span>
<span class="co">#&gt;  6:    Business Female           Other   163</span>
<span class="co">#&gt;  7:    Business Female         Unknown    67</span>
<span class="co">#&gt;  8:    Business Female           White  7842</span>
<span class="co">#&gt;  9:    Business   Male           Asian   561</span>
<span class="co">#&gt; 10:    Business   Male           Black  1329</span>
<span class="co">#&gt; 11:    Business   Male        Hispanic   681</span>
<span class="co">#&gt; 12:    Business   Male   International   143</span>
<span class="co">#&gt; 13:    Business   Male Native American    73</span>
<span class="co">#&gt; 14:    Business   Male           Other   243</span>
<span class="co">#&gt; 15:    Business   Male         Unknown    83</span>
<span class="co">#&gt; 16:    Business   Male           White 10928</span>
<span class="co">#&gt; 17: Engineering Female           Asian   414</span>
<span class="co">#&gt; 18: Engineering Female           Black   919</span>
<span class="co">#&gt; 19: Engineering Female        Hispanic   218</span>
<span class="co">#&gt; 20: Engineering Female   International    75</span>
<span class="co">#&gt; 21: Engineering Female Native American    32</span>
<span class="co">#&gt; 22: Engineering Female           Other   108</span>
<span class="co">#&gt; 23: Engineering Female         Unknown    25</span>
<span class="co">#&gt; 24: Engineering Female           White  3934</span>
<span class="co">#&gt; 25: Engineering   Male           Asian  1398</span>
<span class="co">#&gt; 26: Engineering   Male           Black  1588</span>
<span class="co">#&gt; 27: Engineering   Male        Hispanic   756</span>
<span class="co">#&gt; 28: Engineering   Male   International   444</span>
<span class="co">#&gt; 29: Engineering   Male Native American   100</span>
<span class="co">#&gt; 30: Engineering   Male           Other   385</span>
<span class="co">#&gt; 31: Engineering   Male         Unknown    71</span>
<span class="co">#&gt; 32: Engineering   Male           White 15575</span>
<span class="co">#&gt;         program    sex            race  ever</span></code></pre></div>
</div>
<div id="graph-the-results" class="section level2">
<h2 class="hasAnchor">
<a href="#graph-the-results" class="anchor"></a>Graph the results</h2>
<p>To begin conditioning the data for graphing, we remove ambiguous levels of race/ethnicity.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># remove ambiguous levels of race/ethnicity</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">DT</span><span class="op">$</span><span class="va">race</span> <span class="op">%chin%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Unknown"</span>, <span class="st">"International"</span>, <span class="st">"Other"</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">race</span><span class="op">)</span>
<span class="co">#&gt; [1] "Asian"           "Black"           "Hispanic"        "Native American"</span>
<span class="co">#&gt; [5] "White"</span></code></pre></div>
<p>To protect confidentiality, we omit observations with 10 or fewer students ever enrolled.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># protect confidentiality of small populations</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">ever</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">DT</span>, nrows <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="co">#&gt;         program    sex            race  ever</span>
<span class="co">#&gt;  1:    Business Female           Asian   505</span>
<span class="co">#&gt;  2:    Business Female           Black  1637</span>
<span class="co">#&gt;  3:    Business Female        Hispanic   520</span>
<span class="co">#&gt;  4:    Business Female Native American    56</span>
<span class="co">#&gt;  5:    Business Female           White  7842</span>
<span class="co">#&gt;  6:    Business   Male           Asian   561</span>
<span class="co">#&gt;  7:    Business   Male           Black  1329</span>
<span class="co">#&gt;  8:    Business   Male        Hispanic   681</span>
<span class="co">#&gt;  9:    Business   Male Native American    73</span>
<span class="co">#&gt; 10:    Business   Male           White 10928</span>
<span class="co">#&gt; 11: Engineering Female           Asian   414</span>
<span class="co">#&gt; 12: Engineering Female           Black   919</span>
<span class="co">#&gt; 13: Engineering Female        Hispanic   218</span>
<span class="co">#&gt; 14: Engineering Female Native American    32</span>
<span class="co">#&gt; 15: Engineering Female           White  3934</span>
<span class="co">#&gt; 16: Engineering   Male           Asian  1398</span>
<span class="co">#&gt; 17: Engineering   Male           Black  1588</span>
<span class="co">#&gt; 18: Engineering   Male        Hispanic   756</span>
<span class="co">#&gt; 19: Engineering   Male Native American   100</span>
<span class="co">#&gt; 20: Engineering   Male           White 15575</span></code></pre></div>
<p>We combine race/ethnicity and sex to form the <code>race_sex</code> categorical variable.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a new category</span>
<span class="va">DT</span><span class="op">[</span>, <span class="va">race_sex</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">race</span>, <span class="va">sex</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;         program    sex            race  ever               race_sex</span>
<span class="co">#&gt;  1:    Business Female           Asian   505           Asian Female</span>
<span class="co">#&gt;  2:    Business Female           Black  1637           Black Female</span>
<span class="co">#&gt;  3:    Business Female        Hispanic   520        Hispanic Female</span>
<span class="co">#&gt;  4:    Business Female Native American    56 Native American Female</span>
<span class="co">#&gt;  5:    Business Female           White  7842           White Female</span>
<span class="co">#&gt; ---                                                                </span>
<span class="co">#&gt; 16: Engineering   Male           Asian  1398             Asian Male</span>
<span class="co">#&gt; 17: Engineering   Male           Black  1588             Black Male</span>
<span class="co">#&gt; 18: Engineering   Male        Hispanic   756          Hispanic Male</span>
<span class="co">#&gt; 19: Engineering   Male Native American   100   Native American Male</span>
<span class="co">#&gt; 20: Engineering   Male           White 15575             White Male</span></code></pre></div>
<p><em>Multiway data</em> are characterized by two categorical variables and one quantitative variable <span class="citation">(<a href="#ref-Cleveland:1993" role="doc-biblioref">Cleveland, 1993</a>)</span>. In this example, the two categories are program and race/ethnicity/sex and the quantitative variable is the number of students ever enrolled.</p>
<p>To structure the data in multiway form, we select the three multiway variables.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># select the three multiway variables</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"race_sex"</span>, <span class="st">"ever"</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="va">..cols_we_want</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;         program               race_sex  ever</span>
<span class="co">#&gt;  1:    Business           Asian Female   505</span>
<span class="co">#&gt;  2:    Business           Black Female  1637</span>
<span class="co">#&gt;  3:    Business        Hispanic Female   520</span>
<span class="co">#&gt;  4:    Business Native American Female    56</span>
<span class="co">#&gt;  5:    Business           White Female  7842</span>
<span class="co">#&gt; ---                                         </span>
<span class="co">#&gt; 16: Engineering             Asian Male  1398</span>
<span class="co">#&gt; 17: Engineering             Black Male  1588</span>
<span class="co">#&gt; 18: Engineering          Hispanic Male   756</span>
<span class="co">#&gt; 19: Engineering   Native American Male   100</span>
<span class="co">#&gt; 20: Engineering             White Male 15575</span></code></pre></div>
<p>The second attribute of multiway data is that the levels of the categories are ordered by the median value of the quantitative variable. <code><a href="../reference/prepare_multiway.html">prepare_multiway()</a></code> converts the categorical variables to factors and orders the category levels.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># order the category levels</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_multiway.html">prepare_multiway</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></code></pre></div>
<p>The median values are attributes of the data frame. We can view them as follows. Note that <code>program</code> and <code>race_sex</code> are now factors ordered by the median enrolled numbers (recorded under the <code>scores</code> attribute).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">DT</span>, FUN <span class="op">=</span> <span class="va">attributes</span><span class="op">)</span>
<span class="co">#&gt; $program</span>
<span class="co">#&gt; $program$levels</span>
<span class="co">#&gt; [1] "Business"    "Engineering"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $program$class</span>
<span class="co">#&gt; [1] "factor"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $program$scores</span>
<span class="co">#&gt;    Business Engineering </span>
<span class="co">#&gt;       621.0       837.5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $race_sex</span>
<span class="co">#&gt; $race_sex$levels</span>
<span class="co">#&gt;  [1] "Native American Female" "Native American Male"   "Hispanic Female"       </span>
<span class="co">#&gt;  [4] "Asian Female"           "Hispanic Male"          "Asian Male"            </span>
<span class="co">#&gt;  [7] "Black Female"           "Black Male"             "White Female"          </span>
<span class="co">#&gt; [10] "White Male"            </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $race_sex$class</span>
<span class="co">#&gt; [1] "factor"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $race_sex$scores</span>
<span class="co">#&gt;           Asian Female             Asian Male           Black Female </span>
<span class="co">#&gt;                  459.5                  979.5                 1278.0 </span>
<span class="co">#&gt;             Black Male        Hispanic Female          Hispanic Male </span>
<span class="co">#&gt;                 1458.5                  369.0                  718.5 </span>
<span class="co">#&gt; Native American Female   Native American Male           White Female </span>
<span class="co">#&gt;                   44.0                   86.5                 5888.0 </span>
<span class="co">#&gt;             White Male </span>
<span class="co">#&gt;                13251.5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ever</span>
<span class="co">#&gt; NULL</span></code></pre></div>
<p>We use ggplot2 to graph the multiway data. Rows and panels, from top to bottom, are ordered by decreasing medians. We use a logarithmic scale because the numbers differ by orders of magnitude. In a log base-2 scale, every grid line represents a doubling of the previous grid line.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DT</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ever</span>, y <span class="op">=</span> <span class="va">race_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, as.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>
    trans <span class="op">=</span> <span class="st">"log2"</span>,
    breaks <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">14</span><span class="op">)</span>,
    limits <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">14</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Number of students (log-2 scale)"</span>,
    y <span class="op">=</span> <span class="st">""</span>,
    title <span class="op">=</span> <span class="st">"Ever enrolled in the program"</span>,
    caption <span class="op">=</span> <span class="st">"Source: midfielddata"</span>
  <span class="op">)</span></code></pre></div>
<p><img src="../man/figures/art-01-get-started-fig1-1.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Cleveland:1993" class="csl-entry">
Cleveland, William S. (1993) <em><span>Visualizing Data</span></em>. Summit, NJ: <span>Hobart Press</span>.
</div>
<div id="ref-Dowle+Srinivasan:2020:data-table" class="csl-entry">
Dowle, Matt and Srinivasan, Arun (2020) <em><span class="nocase">data.table: Extension of data.frame</span></em>. RÂ package versionÂ 1.13.0. Available at: <a href="https://CRAN.R-project.org/package=data.table">https://CRAN.R-project.org/package=data.table</a>.
</div>
</div>
</div>
<div id="appendix" class="section level2">
<h2 class="hasAnchor">
<a href="#appendix" class="anchor"></a>Appendix</h2>
<div id="complete-script" class="section level3">
<h3 class="hasAnchor">
<a href="#complete-script" class="anchor"></a>Complete script</h3>
<p>The vignette code chunks are collected below in a single, condensed script.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages used</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfieldr">midfieldr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfielddata">midfielddata</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="co"># gather programs</span>
<span class="va">business</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="st">"^52"</span>, keep_col <span class="op">=</span> <span class="st">"cip6"</span><span class="op">)</span>
<span class="va">business</span> <span class="op">&lt;-</span> <span class="va">business</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Business"</span><span class="op">]</span>
<span class="va">engineering</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="st">"^14"</span>, keep_col <span class="op">=</span> <span class="st">"cip6"</span><span class="op">)</span>
<span class="va">engineering</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Engineering"</span><span class="op">]</span>
<span class="va">program_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">engineering</span>, <span class="va">business</span><span class="op">)</span><span class="op">)</span>
<span class="va">group_cip</span> <span class="op">&lt;-</span> <span class="va">program_group</span><span class="op">$</span><span class="va">cip6</span>

<span class="co"># gather students</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"cip6"</span>, <span class="st">"institution"</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">$</span><span class="va">cip6</span> <span class="op">%chin%</span> <span class="va">group_cip</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">latest_id</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_matriculant.html">subset_matriculant</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">latest_id</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>

<span class="co"># join grouping variables</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_race_sex.html">add_race_sex</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">program_group</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># group and summarize</span>
<span class="va">grouping_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>ever <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">grouping_variables</span><span class="op">]</span>

<span class="co"># condition the data for display</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">DT</span><span class="op">$</span><span class="va">race</span> <span class="op">%chin%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Unknown"</span>, <span class="st">"International"</span>, <span class="st">"Other"</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">ever</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span>, <span class="va">race_sex</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">race</span>, <span class="va">sex</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">]</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"race_sex"</span>, <span class="st">"ever"</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_multiway.html">prepare_multiway</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>

<span class="co"># graph results</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DT</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ever</span>, y <span class="op">=</span> <span class="va">race_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, as.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>
    trans <span class="op">=</span> <span class="st">"log2"</span>,
    breaks <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">14</span><span class="op">)</span>,
    limits <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">14</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Number of students (log-2 scale)"</span>,
    y <span class="op">=</span> <span class="st">""</span>,
    title <span class="op">=</span> <span class="st">"Ever enrolled in the program"</span>,
    caption <span class="op">=</span> <span class="st">"Source: midfielddata"</span>
  <span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Richard Layton, Russell Long, Matthew Ohland, US National Science Foundation.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
