<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using midfieldr • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using midfieldr">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">midfieldr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/using_midfieldr.html">Using midfieldr</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/explore_cip.html">Explore program CIP codes</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Papers/Talks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pages/talks.html">Talks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/pages/get_session.html">Session info</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/pages/about_midfield.html">About</a>
</li>
<li>
  <a href="https://github.com/MIDFIELDR/midfieldr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="using_midfieldr_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using midfieldr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/master/vignettes/using_midfieldr.Rmd"><code>vignettes/using_midfieldr.Rmd</code></a></small>
      <div class="hidden name"><code>using_midfieldr.Rmd</code></div>

    </div>

    
    
<p>This exercise illustrates a typical workflow for computing a persistence metric, starting with student record data from MIDFIELD <span class="citation">(Ohland and Long <a href="#ref-aee2016" role="doc-biblioref">2016</a>)</span> and ending with a multiway graph.</p>
<p>Our metric in this case is “stickiness”, the ratio of the number of students graduating from a program to the number ever enrolled in the program <span class="citation">(Ohland et al. <a href="#ref-stickiness2012" role="doc-biblioref">2012</a>)</span>. We compare the stickiness of three engineering programs with students grouped by program, race/ethnicity, and sex.</p>
<p>In this introductory example, conveying <em>what</em> is more important than <em>how</em>. We focus on what the steps are and how they fit together. How the code works is explained in greater detail in the vignettes <a href="index.html">(link)</a>.</p>
<div id="gather-program-data" class="section level2">
<h2 class="hasAnchor">
<a href="#gather-program-data" class="anchor"></a>Gather program data</h2>
<p>In this example, we compare the stickiness of three programs—Chemical Engineering, Electrical Engineering, and Industrial Engineering—grouping students by program, race/ethnicity, and sex.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># load packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">midfieldr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">midfielddata</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<p>We start by searching the <code>cip</code> data set for the 6-digit codes of our programs. Our first search using <code><a href="../reference/get_cip.html">get_cip()</a></code> is for engineering generally. The search is refined by searching on specific program key words.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># first pass</span>
<span class="no">sub_cip</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_cip.html">get_cip</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">cip</span>, <span class="kw">keep_any</span> <span class="kw">=</span> <span class="st">"engineering"</span>)

<span class="co"># examine the full result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">sub_cip</span>)
<span class="co">#&gt; 'data.frame':    121 obs. of  6 variables:</span>
<span class="co">#&gt;  $ cip2    : chr  "14" "14" "14" "14" ...</span>
<span class="co">#&gt;  $ cip2name: chr  "Engineering" "Engineering" "Engineering" "Engineering" ...</span>
<span class="co">#&gt;  $ cip4    : chr  "1401" "1401" "1402" "1403" ...</span>
<span class="co">#&gt;  $ cip4name: chr  "Engineering, General" "Engineering, General" "Aerospace, Aeronautical and Astronautical Engineering" "Agricultural, Biological Engineering and Bioengineering" ...</span>
<span class="co">#&gt;  $ cip6    : chr  "140101" "140102" "140201" "140301" ...</span>
<span class="co">#&gt;  $ cip6name: chr  "Engineering, General" "Pre-Engineering" "Aerospace, Aeronautical and Astronautical, Space Engineering" "Agricultural, Biological Engineering and Bioengineering" ...</span>

<span class="co"># examine the result at the 2-digit level</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">sub_cip</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"cip2"</span>, <span class="st">"cip2name"</span>)])
<span class="co">#&gt;     cip2                                         cip2name</span>
<span class="co">#&gt; 1     14                                      Engineering</span>
<span class="co">#&gt; 57    15                           Engineering Technology</span>
<span class="co">#&gt; 119   29                            Military Technologies</span>
<span class="co">#&gt; 121   51 Health Professions and Related Clinical Sciences</span></pre></body></html></div>
<p>We refine the result by operating on the <code>sub_cip</code> data frame we just created.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># second pass</span>
<span class="no">sub_cip2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_cip.html">get_cip</a></span>(
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">sub_cip</span>,
  <span class="kw">keep_any</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"chemical"</span>, <span class="st">"electrical"</span>, <span class="st">"industrial"</span>),
  <span class="kw">drop_any</span> <span class="kw">=</span> <span class="st">"technolog"</span>
)

<span class="co"># examine the result at the 4-digit level</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">sub_cip2</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"cip4"</span>, <span class="st">"cip4name"</span>)])
<span class="co">#&gt;   cip4                                               cip4name</span>
<span class="co">#&gt; 1 1407                                   Chemical Engineering</span>
<span class="co">#&gt; 4 1410 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 8 1435                                 Industrial Engineering</span>
<span class="co">#&gt; 9 1443                                Biochemical Engineering</span></pre></body></html></div>
<p>The results show that the 4-digit codes we want are 1407, 1410, and 1435. We use <code><a href="../reference/get_cip.html">get_cip()</a></code> again to extract the 6-digit codes for these specific programs. With <code><a href="../reference/label_programs.html">label_programs()</a></code> we extract the 6-digit columns only and add a program label.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># get chemical engineering</span>
<span class="no">che_cip</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_cip.html">get_cip</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">sub_cip2</span>, <span class="kw">keep_any</span> <span class="kw">=</span> <span class="st">"^1407"</span>)
<span class="no">che</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/label_programs.html">label_programs</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">che_cip</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Chemical Engineering"</span>)

<span class="co"># view the result</span>
<span class="no">che</span>
<span class="co">#&gt;     cip6                              cip6name              program</span>
<span class="co">#&gt; 1 140701                  Chemical Engineering Chemical Engineering</span>
<span class="co">#&gt; 2 140702 Chemical and Biomolecular Engineering Chemical Engineering</span>
<span class="co">#&gt; 3 140799           Chemical Engineering, Other Chemical Engineering</span></pre></body></html></div>
<p>Repeat for electrical and industrial engineering.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># get electrical engineering</span>
<span class="no">ece_cip</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_cip.html">get_cip</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">sub_cip2</span>, <span class="kw">keep_any</span> <span class="kw">=</span> <span class="st">"^1410"</span>)
<span class="no">ece</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/label_programs.html">label_programs</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">ece_cip</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Electrical Engineering"</span>)

<span class="co"># get industrial engineering</span>
<span class="no">ise_cip</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_cip.html">get_cip</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">sub_cip2</span>, <span class="kw">keep_any</span> <span class="kw">=</span> <span class="st">"^1435"</span>)
<span class="no">ise</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/label_programs.html">label_programs</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">ise_cip</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Industrial Engineering"</span>)</pre></body></html></div>
<p>We combine the three programs into one data frame.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># gather the programs in the study</span>
<span class="no">program_group</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">che</span>, <span class="no">ece</span>, <span class="no">ise</span>)

<span class="co"># examine the result</span>
<span class="no">program_group</span>
<span class="co">#&gt;     cip6                                                      cip6name</span>
<span class="co">#&gt; 1 140701                                          Chemical Engineering</span>
<span class="co">#&gt; 2 140702                         Chemical and Biomolecular Engineering</span>
<span class="co">#&gt; 3 140799                                   Chemical Engineering, Other</span>
<span class="co">#&gt; 4 141001        Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 5 141003                                 Laser and Optical Engineering</span>
<span class="co">#&gt; 6 141004                                Telecommunications Engineering</span>
<span class="co">#&gt; 7 141099 Electrical, Electronics and Communications Engineering, Other</span>
<span class="co">#&gt; 8 143501                                        Industrial Engineering</span>
<span class="co">#&gt;                  program</span>
<span class="co">#&gt; 1   Chemical Engineering</span>
<span class="co">#&gt; 2   Chemical Engineering</span>
<span class="co">#&gt; 3   Chemical Engineering</span>
<span class="co">#&gt; 4 Electrical Engineering</span>
<span class="co">#&gt; 5 Electrical Engineering</span>
<span class="co">#&gt; 6 Electrical Engineering</span>
<span class="co">#&gt; 7 Electrical Engineering</span>
<span class="co">#&gt; 8 Industrial Engineering</span></pre></body></html></div>
<p>We can see that our custom program names are consistent with the default 6-digit CIP names, so we can dispense with the <code>cip6names</code> column. The <code>program</code> column is used later for grouping, summarizing, and joining.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># verbose column can be deleted</span>
<span class="no">program_group</span>$<span class="no">cip6name</span> <span class="kw">&lt;-</span> <span class="kw">NULL</span>

<span class="co"># examine the result</span>
<span class="no">program_group</span>
<span class="co">#&gt;     cip6                program</span>
<span class="co">#&gt; 1 140701   Chemical Engineering</span>
<span class="co">#&gt; 2 140702   Chemical Engineering</span>
<span class="co">#&gt; 3 140799   Chemical Engineering</span>
<span class="co">#&gt; 4 141001 Electrical Engineering</span>
<span class="co">#&gt; 5 141003 Electrical Engineering</span>
<span class="co">#&gt; 6 141004 Electrical Engineering</span>
<span class="co">#&gt; 7 141099 Electrical Engineering</span>
<span class="co">#&gt; 8 143501 Industrial Engineering</span></pre></body></html></div>
<p>We extract the <code>cip6</code> column as a character vector to gather student data.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># extract a vector of 6-digit CIP codes</span>
<span class="no">group_codes</span> <span class="kw">&lt;-</span> <span class="no">program_group</span>$<span class="no">cip6</span>

<span class="co"># examine the result</span>
<span class="no">group_codes</span>
<span class="co">#&gt; [1] "140701" "140702" "140799" "141001" "141003" "141004" "141099" "143501"</span></pre></body></html></div>
<p><br><a href="#top">▲ top of page</a></p>
</div>
<div id="gather-student-data" class="section level2">
<h2 class="hasAnchor">
<a href="#gather-student-data" class="anchor"></a>Gather student data</h2>
<p>We use <code><a href="../reference/get_enrollees.html">get_enrollees()</a></code> to extract the IDs of all students who ever enrolled in the programs listed in <code>group_codes</code>. The default data argument is <code>midfieldterms</code>.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># extract students ever enrolled</span>
<span class="no">enrollees</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_enrollees.html">get_enrollees</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">midfieldterms</span>, <span class="kw">codes</span> <span class="kw">=</span> <span class="no">group_codes</span>)

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">enrollees</span>)
<span class="co">#&gt; 'data.frame':    6402 obs. of  2 variables:</span>
<span class="co">#&gt;  $ id  : chr  "MID25783178" "MID25783178" "MID25783197" "MID25783257" ...</span>
<span class="co">#&gt;  $ cip6: chr  "140701" "143501" "140701" "140701" ...</span></pre></body></html></div>
<p><br></p>
<p><strong>feasible completion here</strong></p>
<p><br><br></p>
<p>We use <code><a href="../reference/get_race_sex.html">get_race_sex()</a></code> to obtain the race/ethnicity of each enrollee. The default data argument is <code>midfieldstudents</code>.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># get student race/ethnicity and sex</span>
<span class="no">ids_we_seek</span> <span class="kw">&lt;-</span> <span class="no">enrollees</span>$<span class="no">id</span>
<span class="no">demographics</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_race_sex.html">get_race_sex</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">midfieldstudents</span>, <span class="kw">keep_id</span> <span class="kw">=</span> <span class="no">ids_we_seek</span>)

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">demographics</span>)
<span class="co">#&gt; 'data.frame':    6190 obs. of  3 variables:</span>
<span class="co">#&gt;  $ id  : chr  "MID25783178" "MID25783197" "MID25783257" "MID25783491" ...</span>
<span class="co">#&gt;  $ race: chr  "Black" "White" "White" "White" ...</span>
<span class="co">#&gt;  $ sex : chr  "Male" "Male" "Male" "Male" ...</span></pre></body></html></div>
<p>Now we can join the race/ethnicity and sex data frame to the enrollees data frame.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># join the two data frames</span>
<span class="no">enrollees</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">enrollees</span>, <span class="no">demographics</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">enrollees</span>)
<span class="co">#&gt; 'data.frame':    6402 obs. of  4 variables:</span>
<span class="co">#&gt;  $ id  : chr  "MID25783178" "MID25783178" "MID25783197" "MID25783257" ...</span>
<span class="co">#&gt;  $ cip6: chr  "140701" "143501" "140701" "140701" ...</span>
<span class="co">#&gt;  $ race: chr  "Black" "Black" "White" "White" ...</span>
<span class="co">#&gt;  $ sex : chr  "Male" "Male" "Male" "Male" ...</span></pre></body></html></div>
<p>We join the program names from <code>program_group</code> to our working data frame so we can count by groups in the next step.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># join the program names</span>
<span class="no">enrollees</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">enrollees</span>, <span class="no">program_group</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">enrollees</span>)
<span class="co">#&gt; 'data.frame':    6402 obs. of  5 variables:</span>
<span class="co">#&gt;  $ cip6   : chr  "140701" "140701" "140701" "140701" ...</span>
<span class="co">#&gt;  $ id     : chr  "MID25783178" "MID26457912" "MID25783197" "MID25783257" ...</span>
<span class="co">#&gt;  $ race   : chr  "Black" "White" "White" "White" ...</span>
<span class="co">#&gt;  $ sex    : chr  "Male" "Male" "Male" "Male" ...</span>
<span class="co">#&gt;  $ program: chr  "Chemical Engineering" "Chemical Engineering" "Chemical Engineering" "Chemical Engineering" ...</span></pre></body></html></div>
<p>To frame our results in terms of program, race/ethnicity, and sex, we group by these variables and count the number of students in each grouping. The count is assigned to the new <code>ever</code> column.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># initialize the variable `ever` to hold the count</span>
<span class="no">enrollees</span>$<span class="no">ever</span> <span class="kw">&lt;-</span> <span class="fl">0</span>

<span class="co"># group by the framing variables and count</span>
<span class="no">grouped_enrollees</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(<span class="no">ever</span> ~ <span class="no">race</span> + <span class="no">sex</span> + <span class="no">program</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">enrollees</span>,
  <span class="kw">function</span>(<span class="no">x</span>) <span class="no">ever</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>)
)

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">grouped_enrollees</span>)
<span class="co">#&gt; 'data.frame':    48 obs. of  4 variables:</span>
<span class="co">#&gt;  $ race   : chr  "Asian" "Black" "Hispanic" "International" ...</span>
<span class="co">#&gt;  $ sex    : chr  "Female" "Female" "Female" "Female" ...</span>
<span class="co">#&gt;  $ program: chr  "Chemical Engineering" "Chemical Engineering" "Chemical Engineering" "Chemical Engineering" ...</span>
<span class="co">#&gt;  $ ever   : int  56 147 37 8 7 11 6 462 98 98 ...</span></pre></body></html></div>
<p>Note the change in the size of the data frame, from 6402 in <code>enrollees</code> where every row is a student to 48 in the <code>grouped_enrollees</code> below where every row is a group.</p>
<p>A similar process is used to group and summarize our graduates. We start with <code><a href="../reference/get_graduates.html">get_graduates()</a></code> with a default data argument of <code>midfielddegrees</code>. For graduates, the question of completion feasibility is moot—graduation itself establishes feasibility. Thus we omit the the feasible completion filter in this step.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># gather individual graduating students</span>
<span class="no">graduates</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_graduates.html">get_graduates</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">midfielddegrees</span>, <span class="kw">codes</span> <span class="kw">=</span> <span class="no">group_codes</span>)
<span class="no">ids_we_seek</span> <span class="kw">&lt;-</span> <span class="no">graduates</span>$<span class="no">id</span>
<span class="no">demographics</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_race_sex.html">get_race_sex</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">midfieldstudents</span>, <span class="kw">keep_id</span> <span class="kw">=</span> <span class="no">ids_we_seek</span>)
<span class="no">graduates</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">graduates</span>, <span class="no">demographics</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">graduates</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">graduates</span>, <span class="no">program_group</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># initialize the grad count column</span>
<span class="no">graduates</span>$<span class="no">grad</span> <span class="kw">&lt;-</span> <span class="fl">0</span>

<span class="co"># group by the framing variables</span>
<span class="no">grouped_graduates</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(<span class="no">grad</span> ~ <span class="no">race</span> + <span class="no">sex</span> + <span class="no">program</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">graduates</span>,
  <span class="kw">function</span>(<span class="no">x</span>) <span class="no">grad</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>)
)

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">grouped_graduates</span>)
<span class="co">#&gt; 'data.frame':    45 obs. of  4 variables:</span>
<span class="co">#&gt;  $ race   : chr  "Asian" "Black" "Hispanic" "International" ...</span>
<span class="co">#&gt;  $ sex    : chr  "Female" "Female" "Female" "Female" ...</span>
<span class="co">#&gt;  $ program: chr  "Chemical Engineering" "Chemical Engineering" "Chemical Engineering" "Chemical Engineering" ...</span>
<span class="co">#&gt;  $ grad   : int  26 52 11 4 1 1 3 170 35 26 ...</span></pre></body></html></div>
<p>Note that we have 48 groupings of enrollees but only 45 groupings of graduates. Some enrollee groups have no graduates.</p>
<p><br><a href="#top">▲ top of page</a></p>
</div>
<div id="compute-the-metric" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-the-metric" class="anchor"></a>Compute the metric</h2>
<p>We join the two data frames by our framing variables (program, race/ethnicity, and sex), producing a data frame with <code>ever</code> and <code>grad</code> for each group.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="co"># join graduates to ever enrolled</span>
<span class="no">metric</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">grouped_enrollees</span>, <span class="no">grouped_graduates</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># examine the result, ordered by program</span>
<span class="no">metric</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">metric</span>$<span class="no">program</span>), , <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]
<span class="co">#&gt;               race    sex                program ever grad</span>
<span class="co">#&gt; 1            Asian Female   Chemical Engineering   56   26</span>
<span class="co">#&gt; 4            Asian   Male   Chemical Engineering   98   35</span>
<span class="co">#&gt; 7            Black Female   Chemical Engineering  147   52</span>
<span class="co">#&gt; 10           Black   Male   Chemical Engineering   98   26</span>
<span class="co">#&gt; 13        Hispanic Female   Chemical Engineering   37   11</span>
<span class="co">#&gt; 16        Hispanic   Male   Chemical Engineering   57   18</span>
<span class="co">#&gt; 19   International Female   Chemical Engineering    8    4</span>
<span class="co">#&gt; 22   International   Male   Chemical Engineering   23    7</span>
<span class="co">#&gt; 25 Native American Female   Chemical Engineering    7    1</span>
<span class="co">#&gt; 28 Native American   Male   Chemical Engineering    8    3</span>
<span class="co">#&gt; 31           Other Female   Chemical Engineering   11    1</span>
<span class="co">#&gt; 34           Other   Male   Chemical Engineering   28    3</span>
<span class="co">#&gt; 37         Unknown Female   Chemical Engineering    6    3</span>
<span class="co">#&gt; 40         Unknown   Male   Chemical Engineering    4    2</span>
<span class="co">#&gt; 43           White Female   Chemical Engineering  462  170</span>
<span class="co">#&gt; 46           White   Male   Chemical Engineering  896  354</span>
<span class="co">#&gt; 2            Asian Female Electrical Engineering   50   22</span>
<span class="co">#&gt; 5            Asian   Male Electrical Engineering  253  120</span>
<span class="co">#&gt; 8            Black Female Electrical Engineering  180   72</span>
<span class="co">#&gt; 11           Black   Male Electrical Engineering  379  130</span>
<span class="co">#&gt; 14        Hispanic Female Electrical Engineering   24    6</span>
<span class="co">#&gt; 17        Hispanic   Male Electrical Engineering   89   32</span>
<span class="co">#&gt; 20   International Female Electrical Engineering   11    4</span>
<span class="co">#&gt; 23   International   Male Electrical Engineering   83   46</span>
<span class="co">#&gt; 26 Native American Female Electrical Engineering    3    1</span>
<span class="co">#&gt; 29 Native American   Male Electrical Engineering   12    1</span>
<span class="co">#&gt; 32           Other Female Electrical Engineering   11    3</span>
<span class="co">#&gt; 35           Other   Male Electrical Engineering   23    7</span>
<span class="co">#&gt; 38         Unknown Female Electrical Engineering    3    1</span>
<span class="co">#&gt; 41         Unknown   Male Electrical Engineering   11    4</span>
<span class="co">#&gt; 44           White Female Electrical Engineering  244   74</span>
<span class="co">#&gt; 47           White   Male Electrical Engineering 1636  698</span>
<span class="co">#&gt; 3            Asian Female Industrial Engineering   49   22</span>
<span class="co">#&gt; 6            Asian   Male Industrial Engineering   88   47</span>
<span class="co">#&gt; 9            Black Female Industrial Engineering  121   56</span>
<span class="co">#&gt; 12           Black   Male Industrial Engineering  151   50</span>
<span class="co">#&gt; 15        Hispanic Female Industrial Engineering   12    5</span>
<span class="co">#&gt; 18        Hispanic   Male Industrial Engineering   34   19</span>
<span class="co">#&gt; 21   International Female Industrial Engineering    7    4</span>
<span class="co">#&gt; 24   International   Male Industrial Engineering   30   18</span>
<span class="co">#&gt; 27 Native American Female Industrial Engineering    1   NA</span>
<span class="co">#&gt; 30 Native American   Male Industrial Engineering    1   NA</span>
<span class="co">#&gt; 33           Other Female Industrial Engineering    8    4</span>
<span class="co">#&gt; 36           Other   Male Industrial Engineering   10    4</span>
<span class="co">#&gt; 39         Unknown Female Industrial Engineering    2   NA</span>
<span class="co">#&gt; 42         Unknown   Male Industrial Engineering    1    1</span>
<span class="co">#&gt; 45           White Female Industrial Engineering  312  172</span>
<span class="co">#&gt; 48           White   Male Industrial Engineering  617  354</span></pre></body></html></div>
<p>There are 3 NA entries in the <code>grad</code> column where we have enrollees but no graduates. To see them more directly:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">rows_with_degree_NA</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">metric</span>$<span class="no">grad</span>)
<span class="no">metric</span>[<span class="no">rows_with_degree_NA</span>, , <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]
<span class="co">#&gt;               race    sex                program ever grad</span>
<span class="co">#&gt; 27 Native American Female Industrial Engineering    1   NA</span>
<span class="co">#&gt; 30 Native American   Male Industrial Engineering    1   NA</span>
<span class="co">#&gt; 39         Unknown Female Industrial Engineering    2   NA</span></pre></body></html></div>
<p>We convert the NA values in the <code>grad</code> column to zero.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co"># convert grad NA to zero</span>
<span class="no">metric</span>$<span class="no">grad</span>[<span class="no">rows_with_degree_NA</span>] <span class="kw">&lt;-</span> <span class="fl">0</span>

<span class="co"># examine the result</span>
<span class="no">metric</span>[<span class="no">rows_with_degree_NA</span>, , <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]
<span class="co">#&gt;               race    sex                program ever grad</span>
<span class="co">#&gt; 27 Native American Female Industrial Engineering    1    0</span>
<span class="co">#&gt; 30 Native American   Male Industrial Engineering    1    0</span>
<span class="co">#&gt; 39         Unknown Female Industrial Engineering    2    0</span></pre></body></html></div>
<p>We omit rows with zero students ever enrolled, if any, to avoid dividing by zero, then divide <code>grad</code> by <code>ever</code> to compute stickiness.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co"># prevent division by zero</span>
<span class="no">rows_we_keep</span> <span class="kw">&lt;-</span> <span class="no">metric</span>$<span class="no">ever</span> <span class="kw">&gt;</span> <span class="fl">0</span>
<span class="no">metric</span> <span class="kw">&lt;-</span> <span class="no">metric</span>[<span class="no">rows_we_keep</span>, , <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]

<span class="co"># compute stickiness</span>
<span class="no">metric</span>$<span class="no">stick</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">metric</span>$<span class="no">grad</span> / <span class="no">metric</span>$<span class="no">ever</span>, <span class="fl">3</span>)

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">metric</span>)
<span class="co">#&gt; 'data.frame':    48 obs. of  6 variables:</span>
<span class="co">#&gt;  $ race   : chr  "Asian" "Asian" "Asian" "Asian" ...</span>
<span class="co">#&gt;  $ sex    : chr  "Female" "Female" "Female" "Male" ...</span>
<span class="co">#&gt;  $ program: chr  "Chemical Engineering" "Electrical Engineering" "Industrial Engineering" "Chemical Engineering" ...</span>
<span class="co">#&gt;  $ ever   : int  56 50 49 98 253 88 147 180 121 98 ...</span>
<span class="co">#&gt;  $ grad   : num  26 22 22 35 120 47 52 72 56 26 ...</span>
<span class="co">#&gt;  $ stick  : num  0.464 0.44 0.449 0.357 0.474 0.534 0.354 0.4 0.463 0.265 ...</span></pre></body></html></div>
<p>This completes the data manipulation for obtaining the persistence metric.</p>
<p><br><a href="#top">▲ top of page</a></p>
</div>
<div id="prepare-the-results-for-display" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-the-results-for-display" class="anchor"></a>Prepare the results for display</h2>
<p>To prepare the results for graphing, we construct a “pre-multiway” version of the data frame. We begin by removing ambiguous levels of race/ethnicity and sex.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># initialize the pre-multiway data frame</span>
<span class="no">pre_mw</span> <span class="kw">&lt;-</span> <span class="no">metric</span>

<span class="co"># remove an ambiguous level of sex</span>
<span class="no">rows_we_keep</span> <span class="kw">&lt;-</span> !<span class="no">pre_mw</span>$<span class="no">sex</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Unknown"</span>)
<span class="no">pre_mw</span> <span class="kw">&lt;-</span> <span class="no">pre_mw</span>[<span class="no">rows_we_keep</span>, , <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">pre_mw</span>$<span class="no">sex</span>)
<span class="co">#&gt; [1] "Female" "Male"</span>

<span class="co"># remove ambiguous levels of race/ethnicity</span>
<span class="no">rows_we_keep</span> <span class="kw">&lt;-</span> !<span class="no">pre_mw</span>$<span class="no">race</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Unknown"</span>, <span class="st">"International"</span>, <span class="st">"Other"</span>)
<span class="no">pre_mw</span> <span class="kw">&lt;-</span> <span class="no">pre_mw</span>[<span class="no">rows_we_keep</span>, , <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">pre_mw</span>$<span class="no">race</span>)
<span class="co">#&gt; [1] "Asian"           "Black"           "Hispanic"        "Native American"</span>
<span class="co">#&gt; [5] "White"</span></pre></body></html></div>
<p>To protect confidentiality, we omit observations with 5 or fewer students ever enrolled.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="co"># protect confidentiality of small populations</span>
<span class="no">rows_we_keep</span> <span class="kw">&lt;-</span> <span class="no">pre_mw</span>$<span class="no">ever</span> <span class="kw">&gt;</span> <span class="fl">5</span>
<span class="no">pre_mw</span> <span class="kw">&lt;-</span> <span class="no">pre_mw</span>[<span class="no">rows_we_keep</span>, , <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">pre_mw</span>)
<span class="co">#&gt; 'data.frame':    27 obs. of  6 variables:</span>
<span class="co">#&gt;  $ race   : chr  "Asian" "Asian" "Asian" "Asian" ...</span>
<span class="co">#&gt;  $ sex    : chr  "Female" "Female" "Female" "Male" ...</span>
<span class="co">#&gt;  $ program: chr  "Chemical Engineering" "Electrical Engineering" "Industrial Engineering" "Chemical Engineering" ...</span>
<span class="co">#&gt;  $ ever   : int  56 50 49 98 253 88 147 180 121 98 ...</span>
<span class="co">#&gt;  $ grad   : num  26 22 22 35 120 47 52 72 56 26 ...</span>
<span class="co">#&gt;  $ stick  : num  0.464 0.44 0.449 0.357 0.474 0.534 0.354 0.4 0.463 0.265 ...</span></pre></body></html></div>
<p>We plan to display these data in a multiway graph, characterized by a single quantitative response variable (stickiness) for each combination of levels of the two categorical variables (program and race/ethnicity/sex).</p>
<p>The race/ethnicity/sex category is created by uniting <code>race</code> and <code>sex</code>.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="co"># create a new combined framing variables</span>
<span class="no">pre_mw</span>$<span class="no">race_sex</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">pre_mw</span>$<span class="no">race</span>, <span class="no">pre_mw</span>$<span class="no">sex</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">" "</span>)

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">pre_mw</span>)
<span class="co">#&gt; 'data.frame':    27 obs. of  7 variables:</span>
<span class="co">#&gt;  $ race    : chr  "Asian" "Asian" "Asian" "Asian" ...</span>
<span class="co">#&gt;  $ sex     : chr  "Female" "Female" "Female" "Male" ...</span>
<span class="co">#&gt;  $ program : chr  "Chemical Engineering" "Electrical Engineering" "Industrial Engineering" "Chemical Engineering" ...</span>
<span class="co">#&gt;  $ ever    : int  56 50 49 98 253 88 147 180 121 98 ...</span>
<span class="co">#&gt;  $ grad    : num  26 22 22 35 120 47 52 72 56 26 ...</span>
<span class="co">#&gt;  $ stick   : num  0.464 0.44 0.449 0.357 0.474 0.534 0.354 0.4 0.463 0.265 ...</span>
<span class="co">#&gt;  $ race_sex: chr  "Asian Female" "Asian Female" "Asian Female" "Asian Male" ...</span></pre></body></html></div>
<p>To structure the data in multiway form, we select the three multiway variables and use <code><a href="../reference/order_multiway.html">order_multiway()</a></code> to convert the categorical variables to factors and order the levels of the categories by the median stickiness.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="co"># initialize the multiway data frame</span>
<span class="no">data_mw</span> <span class="kw">&lt;-</span> <span class="no">pre_mw</span>

<span class="co"># complete the transformation to multiway form</span>
<span class="no">columns_we_keep</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"program"</span>, <span class="st">"race_sex"</span>, <span class="st">"stick"</span>)
<span class="no">data_mw</span> <span class="kw">&lt;-</span> <span class="no">data_mw</span>[, <span class="no">columns_we_keep</span>, <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]
<span class="no">data_mw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/order_multiway.html">order_multiway</a></span>(<span class="no">data_mw</span>)

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">data_mw</span>)
<span class="co">#&gt; 'data.frame':    27 obs. of  3 variables:</span>
<span class="co">#&gt;  $ program : Factor w/ 3 levels "Chemical Engineering",..: 1 2 3 1 2 3 1 2 3 1 ...</span>
<span class="co">#&gt;  $ race_sex: Factor w/ 10 levels "Native American Female",..: 9 9 9 10 10 10 7 7 7 4 ...</span>
<span class="co">#&gt;  $ stick   : num  0.464 0.44 0.449 0.357 0.474 0.534 0.354 0.4 0.463 0.265 ...</span></pre></body></html></div>
<p>Notice the categorical variables that were character variables are now factors. The levels of the factors are ordered by the stickiness median. For example, the programs are ordered from 1 (least sticky) to 3 (most sticky).</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="co"># ordered levels of program by median stickiness</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">data_mw</span>$<span class="no">program</span>)
<span class="co">#&gt; [1] "Chemical Engineering"   "Electrical Engineering" "Industrial Engineering"</span></pre></body></html></div>
<p>While the student groupings levels are ordered from 1 (least sticky) to 10 (most sticky).</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="co"># ordered levels of student group by median stickiness</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">data_mw</span>$<span class="no">race_sex</span>)
<span class="co">#&gt;  [1] "Native American Female" "Native American Male"   "Hispanic Female"       </span>
<span class="co">#&gt;  [4] "Black Male"             "Hispanic Male"          "White Female"          </span>
<span class="co">#&gt;  [7] "Black Female"           "White Male"             "Asian Female"          </span>
<span class="co">#&gt; [10] "Asian Male"</span></pre></body></html></div>
<p><br><a href="#top">▲ top of page</a></p>
</div>
<div id="graph-the-results" class="section level2">
<h2 class="hasAnchor">
<a href="#graph-the-results" class="anchor"></a>Graph the results</h2>
<p>We use conventional ggplot2 functions to graph stickiness in a multiway dot plot. Rows and panels, from top to bottom, are ordered by decreasing median stickiness <span class="citation">(Cleveland <a href="#ref-cleveland1993" role="doc-biblioref">1993</a>)</span>.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co"># graph results</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">data_mw</span>, <span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">stick</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">race_sex</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="kw">facets</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span>(<span class="no">program</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">as.table</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Stickiness"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">""</span>)</pre></body></html></div>
<p><img src="../man/figures/vign-using-midfieldr-fig1-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>A multiway design reveals patterns and anomalies in the results. For example, among these programs for this sample population:</p>
<p>Visual anomalies, circled in red</p>
<ul>
<li>Hispanic men have a higher stickiness in Industrial engineering than would be expected from their overall stickiness</li>
<li>White women have a lower stickiness in Electrical engineering than expected</li>
<li>Asian men have a lower stickiness in Chemical engineering than expected</li>
</ul>
<p>Patterns, for these students and these programs</p>
<ul>
<li>Industrial engineering has the highest stickiness, Chemical engineering the lowest</li>
<li>Asian men and women have the highest stickiness</li>
<li>Native American men and women have the lowest stickiness, though their small numbers may make the finding meaningless</li>
</ul>
<p>Such visual anomalies and patterns raise questions that lead to further research, for example, in institutional polices, the cultures of professional disciplines, and student experiences in the undergraduate ecosystem.</p>
<p><br><a href="#top">▲ top of page</a></p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs">
<div id="ref-cleveland1993">
<p>Cleveland, William S. 1993. <em>Visualizing Data</em>. Summit, NJ: Hobart Press.</p>
</div>
<div id="ref-stickiness2012">
<p>Ohland, Matthew, Marisa Orr, Richard Layton, Susan Lord, and Russell Long. 2012. “Introducing Stickiness as a Versatile Metric of Engineering Persistence.” In <em>Proceedings of the Frontiers in Education Conference</em>, 1–5.</p>
</div>
<div id="ref-aee2016">
<p>Ohland, Matthew W., and Russell A. Long. 2016. “The Multiple-Institution Database for Investigating Engineering Longitudinal Development: An Experiential Case Study of Data Sharing and Reuse.” <em>Advances in Engineering Education</em> 5 (2).</p>
</div>
</div>
</div>
<div id="appendix" class="section level2">
<h2 class="hasAnchor">
<a href="#appendix" class="anchor"></a>Appendix</h2>
<div id="complete-script" class="section level3">
<h3 class="hasAnchor">
<a href="#complete-script" class="anchor"></a>Complete script</h3>
<p>In response to requests from some of our workshop attendees, we collect the vignette code chunks in one script. We condense the script by omitting exploratory steps so we can focus on the steps that produce the results.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="co"># load packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">midfieldr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="co"># gather the three programs</span>
<span class="no">che_cip</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_cip.html">get_cip</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">cip</span>, <span class="kw">keep_any</span> <span class="kw">=</span> <span class="st">"^1407"</span>)
<span class="no">che</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/label_programs.html">label_programs</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">che_cip</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Chemical Engineering"</span>)
<span class="no">ece_cip</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_cip.html">get_cip</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">cip</span>, <span class="kw">keep_any</span> <span class="kw">=</span> <span class="st">"^1410"</span>)
<span class="no">ece</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/label_programs.html">label_programs</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">ece_cip</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Electrical Engineering"</span>)
<span class="no">ise_cip</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_cip.html">get_cip</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">cip</span>, <span class="kw">keep_any</span> <span class="kw">=</span> <span class="st">"^1435"</span>)
<span class="no">ise</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/label_programs.html">label_programs</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">ise_cip</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Industrial Engineering"</span>)
<span class="no">program_group</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">che</span>, <span class="no">ece</span>, <span class="no">ise</span>)
<span class="no">program_group</span>$<span class="no">cip6name</span> <span class="kw">&lt;-</span> <span class="kw">NULL</span>

<span class="co"># extract a vector of 6-digit CIP codes</span>
<span class="no">group_codes</span> <span class="kw">&lt;-</span> <span class="no">program_group</span>$<span class="no">cip6</span>

<span class="co"># gather individual students ever enrolled</span>
<span class="no">enrollees</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_enrollees.html">get_enrollees</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">midfieldterms</span>, <span class="kw">codes</span> <span class="kw">=</span> <span class="no">group_codes</span>)
<span class="no">ids_we_seek</span> <span class="kw">&lt;-</span> <span class="no">enrollees</span>$<span class="no">id</span>
<span class="no">demographics</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_race_sex.html">get_race_sex</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">midfieldstudents</span>, <span class="kw">keep_id</span> <span class="kw">=</span> <span class="no">ids_we_seek</span>)
<span class="no">enrollees</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">enrollees</span>, <span class="no">demographics</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">enrollees</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">enrollees</span>, <span class="no">program_group</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># group by the framing variables</span>
<span class="no">enrollees</span>$<span class="no">ever</span> <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">grouped_enrollees</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(<span class="no">ever</span> ~ <span class="no">race</span> + <span class="no">sex</span> + <span class="no">program</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">enrollees</span>,
  <span class="kw">function</span>(<span class="no">x</span>) <span class="no">ever</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>)
)

<span class="co"># gather individual graduating students</span>
<span class="no">graduates</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_graduates.html">get_graduates</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">midfielddegrees</span>, <span class="kw">codes</span> <span class="kw">=</span> <span class="no">group_codes</span>)
<span class="no">ids_we_seek</span> <span class="kw">&lt;-</span> <span class="no">graduates</span>$<span class="no">id</span>
<span class="no">demographics</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_race_sex.html">get_race_sex</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">midfieldstudents</span>, <span class="kw">keep_id</span> <span class="kw">=</span> <span class="no">ids_we_seek</span>)
<span class="no">graduates</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">graduates</span>, <span class="no">demographics</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">graduates</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">graduates</span>, <span class="no">program_group</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># group by the framing variables</span>
<span class="no">graduates</span>$<span class="no">grad</span> <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">grouped_graduates</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(<span class="no">grad</span> ~ <span class="no">race</span> + <span class="no">sex</span> + <span class="no">program</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">graduates</span>,
  <span class="kw">function</span>(<span class="no">x</span>) <span class="no">grad</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>)
)

<span class="co"># compute the metric</span>
<span class="no">metric</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">grouped_enrollees</span>, <span class="no">grouped_graduates</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">degree_NA</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">metric</span>$<span class="no">grad</span>)
<span class="no">metric</span>$<span class="no">grad</span>[<span class="no">degree_NA</span>] <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">rows_we_keep</span> <span class="kw">&lt;-</span> <span class="no">metric</span>$<span class="no">ever</span> <span class="kw">&gt;</span> <span class="fl">0</span>
<span class="no">metric</span> <span class="kw">&lt;-</span> <span class="no">metric</span>[<span class="no">rows_we_keep</span>, , <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]
<span class="no">metric</span>$<span class="no">stick</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">metric</span>$<span class="no">grad</span> / <span class="no">metric</span>$<span class="no">ever</span>, <span class="fl">3</span>)

<span class="co"># prepare data for multiway graph</span>
<span class="no">rows_we_keep</span> <span class="kw">&lt;-</span> !<span class="no">metric</span>$<span class="no">race</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Unknown"</span>, <span class="st">"International"</span>, <span class="st">"Other"</span>) <span class="kw">&amp;</span>
  !<span class="no">metric</span>$<span class="no">sex</span> <span class="kw">%in%</span> <span class="st">"Unknown"</span>
<span class="no">pre_mw</span> <span class="kw">&lt;-</span> <span class="no">metric</span>[<span class="no">rows_we_keep</span>, , <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]
<span class="no">rows_we_keep</span> <span class="kw">&lt;-</span> <span class="no">pre_mw</span>$<span class="no">ever</span> <span class="kw">&gt;</span> <span class="fl">5</span>
<span class="no">pre_mw</span> <span class="kw">&lt;-</span> <span class="no">pre_mw</span>[<span class="no">rows_we_keep</span>, , <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]
<span class="no">pre_mw</span>$<span class="no">race_sex</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">pre_mw</span>$<span class="no">race</span>, <span class="no">pre_mw</span>$<span class="no">sex</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">" "</span>)

<span class="co"># complete the transformation to multiway form</span>
<span class="no">columns_we_keep</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"program"</span>, <span class="st">"race_sex"</span>, <span class="st">"stick"</span>)
<span class="no">pre_mw</span> <span class="kw">&lt;-</span> <span class="no">pre_mw</span>[, <span class="no">columns_we_keep</span>, <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">FALSE</span>]
<span class="no">data_mw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/order_multiway.html">order_multiway</a></span>(<span class="no">pre_mw</span>)

<span class="co"># graph results</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">data_mw</span>, <span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">stick</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">race_sex</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="kw">facets</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span>(<span class="no">program</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">as.table</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Stickiness"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">""</span>)</pre></body></html></div>
<p><br><a href="#top">▲ top of page </a><br><a href="../index.html">◁ main page </a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Richard Layton, Russell Long, Matthew Ohland, US National Science Foundation.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
