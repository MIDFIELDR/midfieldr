<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stickiness metric • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Stickiness metric">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">midfieldr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9007</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_basics.html">Data basics</a>
    </li>
    <li>
      <a href="../articles/multiway_graphs.html">Multiway graphs and tables</a>
    </li>
    <li>
      <a href="../articles/identify_programs.html">Identify programs</a>
    </li>
    <li>
      <a href="../articles/handle_fye.html">Handle FYE programs</a>
    </li>
    <li>
      <a href="../articles/feasible_completion.html">Feasible completion</a>
    </li>
    <li>
      <a href="../articles/graduation_rate.html">Graduation rate</a>
    </li>
    <li>
      <a href="../articles/stickiness_metric.html">Stickiness metric</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/pages/get_session.html">Session info</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/pages/about_midfield.html">About</a>
</li>
<li>
  <a href="https://github.com/MIDFIELDR/midfieldr">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="stickiness_metric_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Stickiness metric</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/master/vignettes/stickiness_metric.Rmd"><code>vignettes/stickiness_metric.Rmd</code></a></small>
      <div class="hidden name"><code>stickiness_metric.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Longitudinal “stickiness” is the ratio of the number of students graduating in a program to the number of students ever enrolled in that program <span class="citation">(<a href="#ref-Ohland+Orr+others:2012" role="doc-biblioref">Ohland et al., 2012</a>)</span>.</p>
<p>The stickiness metric accounts for all students in a program. Unlike the graduation rate metric, stickiness includes students who begin college part-time, who enroll mid-year, and who switch majors or transfer between institutions.</p>
<p>Every student counted in a program’s stickiness metric was enrolled in that program for at least one term. The program succeeded in attracting these students—stickiness tells us how well the program succeeded in retaining them.</p>
<div id="this-vignette-uses" class="section level3">
<h3 class="hasAnchor">
<a href="#this-vignette-uses" class="anchor"></a>This vignette uses</h3>
<p>midfieldr functions</p>
<ul>
<li><code><a href="../reference/subset_feasible.html">subset_feasible()</a></code></li>
</ul>
<p>packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages used</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfieldr">midfieldr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfielddata">midfielddata</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://Rdatatable.gitlab.io/data.table">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="co"># print max 20 rows, otherwise 10 rows each head/tail</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>datatable.print.nrows <span class="op">=</span> <span class="fl">20</span>, datatable.print.topn <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="choose-the-programs-to-study" class="section level2">
<h2 class="hasAnchor">
<a href="#choose-the-programs-to-study" class="anchor"></a>Choose the programs to study</h2>
<p>In the <em>Identify programs</em> vignette <a href="identify_programs.html">(link)</a>, we create the program group of 6-digit codes and user-defined program names for the engineering case study. These data are included with midfieldr as the built-in data set <code>rep_group</code>. View its help page by running</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span> <span class="va">rep_group</span> </code></pre></div>
<p>The data are loaded with midfieldr.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># obtain programs (built-in data set)</span>
<span class="va">program_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span><span class="op">(</span><span class="va">rep_group</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">program_group</span>
<span class="co">#&gt;       cip6                program</span>
<span class="co">#&gt;  1: 140801      Civil Engineering</span>
<span class="co">#&gt;  2: 140802      Civil Engineering</span>
<span class="co">#&gt;  3: 140803      Civil Engineering</span>
<span class="co">#&gt;  4: 140804      Civil Engineering</span>
<span class="co">#&gt;  5: 140805      Civil Engineering</span>
<span class="co">#&gt;  6: 140899      Civil Engineering</span>
<span class="co">#&gt;  7: 141001 Electrical Engineering</span>
<span class="co">#&gt;  8: 141003 Electrical Engineering</span>
<span class="co">#&gt;  9: 141004 Electrical Engineering</span>
<span class="co">#&gt; 10: 141099 Electrical Engineering</span>
<span class="co">#&gt; 11: 141901 Mechanical Engineering</span>
<span class="co">#&gt; 12: 143501 Industrial Engineering</span></code></pre></div>
<p>We extract the <code>cip6</code> column as a character vector to gather student data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract a vector of 6-digit CIP codes</span>
<span class="va">group_cip</span> <span class="op">&lt;-</span> <span class="va">program_group</span><span class="op">$</span><span class="va">cip6</span>

<span class="co"># examine the result</span>
<span class="va">group_cip</span>
<span class="co">#&gt;  [1] "140801" "140802" "140803" "140804" "140805" "140899" "141001" "141003"</span>
<span class="co">#&gt;  [9] "141004" "141099" "141901" "143501"</span></code></pre></div>
</div>
<div id="gather-the-students-ever-enrolled" class="section level2">
<h2 class="hasAnchor">
<a href="#gather-the-students-ever-enrolled" class="anchor"></a>Gather the students ever enrolled</h2>
<p>We access <code>midfieldterms</code> to obtain the IDs of all students ever enrolled in these programs.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract students ever enrolled</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"cip6"</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">$</span><span class="va">cip6</span> <span class="op">%in%</span> <span class="va">group_cip</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">enrollees</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                 id   cip6</span>
<span class="co">#&gt;     1: MID25783178 143501</span>
<span class="co">#&gt;     2: MID25783197 140801</span>
<span class="co">#&gt;     3: MID25783388 141901</span>
<span class="co">#&gt;     4: MID25783441 140801</span>
<span class="co">#&gt;     5: MID25783491 141001</span>
<span class="co">#&gt;     6: MID25783553 140801</span>
<span class="co">#&gt;     7: MID25783606 141001</span>
<span class="co">#&gt;     8: MID25783648 140801</span>
<span class="co">#&gt;     9: MID25783912 143501</span>
<span class="co">#&gt;    10: MID25784022 141901</span>
<span class="co">#&gt;    ---                   </span>
<span class="co">#&gt; 10755: MID26696484 141901</span>
<span class="co">#&gt; 10756: MID26696642 141001</span>
<span class="co">#&gt; 10757: MID26696738 141901</span>
<span class="co">#&gt; 10758: MID26696771 141001</span>
<span class="co">#&gt; 10759: MID26696958 141901</span>
<span class="co">#&gt; 10760: MID26696967 141901</span>
<span class="co">#&gt; 10761: MID26696979 141901</span>
<span class="co">#&gt; 10762: MID26697163 141901</span>
<span class="co">#&gt; 10763: MID26697444 141901</span>
<span class="co">#&gt; 10764: MID26697447 141001</span></code></pre></div>
<p>There may be FYE students who are imputed to have started in one of these programs as well. In the <em>Handle FYE programs</em> vignette <a href="handle_fye.html">(link)</a>, we derive the starting programs for all FYE students in midfielddata. This <code>fye_start</code> data is included in midfieldr. Again, we filter by the program group CIP codes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># gather FYE students predicted to start in these programs</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">fye_start</span><span class="op">$</span><span class="va">start</span> <span class="op">%in%</span> <span class="va">group_cip</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"start"</span><span class="op">)</span>
<span class="va">fye_starters</span> <span class="op">&lt;-</span> <span class="va">fye_start</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">fye_starters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">fye_starters</span><span class="op">)</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">fye_starters</span>, old <span class="op">=</span> <span class="st">"start"</span>, new <span class="op">=</span> <span class="st">"cip6"</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">fye_starters</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                id   cip6</span>
<span class="co">#&gt;    1: MID25783166 141901</span>
<span class="co">#&gt;    2: MID25783227 141001</span>
<span class="co">#&gt;    3: MID25783388 141901</span>
<span class="co">#&gt;    4: MID25783428 140801</span>
<span class="co">#&gt;    5: MID25783441 140801</span>
<span class="co">#&gt;    6: MID25783491 141001</span>
<span class="co">#&gt;    7: MID25783553 140801</span>
<span class="co">#&gt;    8: MID25783606 141001</span>
<span class="co">#&gt;    9: MID25783648 140801</span>
<span class="co">#&gt;   10: MID25783753 141901</span>
<span class="co">#&gt;   ---                   </span>
<span class="co">#&gt; 3819: MID26648222 141901</span>
<span class="co">#&gt; 3820: MID26648282 143501</span>
<span class="co">#&gt; 3821: MID26648283 141001</span>
<span class="co">#&gt; 3822: MID26648334 140801</span>
<span class="co">#&gt; 3823: MID26648392 141901</span>
<span class="co">#&gt; 3824: MID26648422 141901</span>
<span class="co">#&gt; 3825: MID26648435 141901</span>
<span class="co">#&gt; 3826: MID26648484 140801</span>
<span class="co">#&gt; 3827: MID26648517 140801</span>
<span class="co">#&gt; 3828: MID26648544 141901</span></code></pre></div>
<p>Bind the two data frames</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">fye_starters</span><span class="op">)</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">enrollees</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                 id   cip6</span>
<span class="co">#&gt;     1: MID25783166 141901</span>
<span class="co">#&gt;     2: MID25783178 143501</span>
<span class="co">#&gt;     3: MID25783197 140801</span>
<span class="co">#&gt;     4: MID25783227 141001</span>
<span class="co">#&gt;     5: MID25783388 141901</span>
<span class="co">#&gt;     6: MID25783428 140801</span>
<span class="co">#&gt;     7: MID25783441 140801</span>
<span class="co">#&gt;     8: MID25783491 141001</span>
<span class="co">#&gt;     9: MID25783553 140801</span>
<span class="co">#&gt;    10: MID25783606 141001</span>
<span class="co">#&gt;    ---                   </span>
<span class="co">#&gt; 12400: MID26696484 141901</span>
<span class="co">#&gt; 12401: MID26696642 141001</span>
<span class="co">#&gt; 12402: MID26696738 141901</span>
<span class="co">#&gt; 12403: MID26696771 141001</span>
<span class="co">#&gt; 12404: MID26696958 141901</span>
<span class="co">#&gt; 12405: MID26696967 141901</span>
<span class="co">#&gt; 12406: MID26696979 141901</span>
<span class="co">#&gt; 12407: MID26697163 141901</span>
<span class="co">#&gt; 12408: MID26697444 141901</span>
<span class="co">#&gt; 12409: MID26697447 141001</span></code></pre></div>
<p>The enrollee data derived above is the data set <code>rep_ever</code> in midfieldr. View its help page by running</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span> <span class="va">rep_ever</span></code></pre></div>
<p>For some of these students, completing their program may not be feasible given the range of data available. <code><a href="../reference/subset_feasible.html">subset_feasible()</a></code> subsets the student IDs, retaining those who matriculate at least six years before the last term in the data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># apply the feasible completion filter</span>
<span class="va">feasible_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_feasible.html">subset_feasible</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">enrollees</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">feasible_ids</span><span class="op">)</span>
<span class="co">#&gt;  chr [1:9166] "MID25783178" "MID25783197" "MID25783441" "MID25783491" ...</span></code></pre></div>
<p>See the <em>Feasible completion</em> vignette <a href="feasible_completion.html">(link)</a> for a detailed explanation of how completion feasibility is determined.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subset the enrollees</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="va">feasible_ids</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">enrollees</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                id   cip6</span>
<span class="co">#&gt;    1: MID25783178 143501</span>
<span class="co">#&gt;    2: MID25783197 140801</span>
<span class="co">#&gt;    3: MID25783227 141001</span>
<span class="co">#&gt;    4: MID25783388 141901</span>
<span class="co">#&gt;    5: MID25783441 140801</span>
<span class="co">#&gt;    6: MID25783491 141001</span>
<span class="co">#&gt;    7: MID25783553 140801</span>
<span class="co">#&gt;    8: MID25783606 141001</span>
<span class="co">#&gt;    9: MID25783753 141901</span>
<span class="co">#&gt;   10: MID25783830 141901</span>
<span class="co">#&gt;   ---                   </span>
<span class="co">#&gt; 9764: MID26696439 141901</span>
<span class="co">#&gt; 9765: MID26696484 141901</span>
<span class="co">#&gt; 9766: MID26696642 141001</span>
<span class="co">#&gt; 9767: MID26696738 141901</span>
<span class="co">#&gt; 9768: MID26696771 141001</span>
<span class="co">#&gt; 9769: MID26696958 141901</span>
<span class="co">#&gt; 9770: MID26696967 141901</span>
<span class="co">#&gt; 9771: MID26697163 141901</span>
<span class="co">#&gt; 9772: MID26697444 141901</span>
<span class="co">#&gt; 9773: MID26697447 141001</span></code></pre></div>
<p>We access <code>midfieldstudents</code> to obtain the race/ethnicity and sex of the enrollees.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># obtain race/ethnicity and sex at matriculation</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="va">feasible_ids</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">race_sex</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">race_sex</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                id     race    sex</span>
<span class="co">#&gt;    1: MID25783178    Black   Male</span>
<span class="co">#&gt;    2: MID25783197    White   Male</span>
<span class="co">#&gt;    3: MID25783227    White   Male</span>
<span class="co">#&gt;    4: MID25783388    White   Male</span>
<span class="co">#&gt;    5: MID25783441    White   Male</span>
<span class="co">#&gt;    6: MID25783491    White   Male</span>
<span class="co">#&gt;    7: MID25783553    White   Male</span>
<span class="co">#&gt;    8: MID25783606    White   Male</span>
<span class="co">#&gt;    9: MID25783753    White   Male</span>
<span class="co">#&gt;   10: MID25783830    Black   Male</span>
<span class="co">#&gt;   ---                            </span>
<span class="co">#&gt; 9157: MID26696439    White   Male</span>
<span class="co">#&gt; 9158: MID26696484    White   Male</span>
<span class="co">#&gt; 9159: MID26696642    White   Male</span>
<span class="co">#&gt; 9160: MID26696738    White   Male</span>
<span class="co">#&gt; 9161: MID26696771    White Female</span>
<span class="co">#&gt; 9162: MID26696958    White   Male</span>
<span class="co">#&gt; 9163: MID26696967    White   Male</span>
<span class="co">#&gt; 9164: MID26697163 Hispanic   Male</span>
<span class="co">#&gt; 9165: MID26697444    White   Male</span>
<span class="co">#&gt; 9166: MID26697447    Asian   Male</span></code></pre></div>
<p>Now we can join the race/ethnicity and sex data frame to the enrollees data frame.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># left-join demographics to enrollees</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">race_sex</span>, by <span class="op">=</span> <span class="st">"id"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">enrollees</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                id   cip6     race    sex</span>
<span class="co">#&gt;    1: MID25783178 143501    Black   Male</span>
<span class="co">#&gt;    2: MID25783197 140801    White   Male</span>
<span class="co">#&gt;    3: MID25783227 141001    White   Male</span>
<span class="co">#&gt;    4: MID25783388 141901    White   Male</span>
<span class="co">#&gt;    5: MID25783441 140801    White   Male</span>
<span class="co">#&gt;    6: MID25783491 141001    White   Male</span>
<span class="co">#&gt;    7: MID25783553 140801    White   Male</span>
<span class="co">#&gt;    8: MID25783606 141001    White   Male</span>
<span class="co">#&gt;    9: MID25783753 141901    White   Male</span>
<span class="co">#&gt;   10: MID25783830 141901    Black   Male</span>
<span class="co">#&gt;   ---                                   </span>
<span class="co">#&gt; 9764: MID26696439 141901    White   Male</span>
<span class="co">#&gt; 9765: MID26696484 141901    White   Male</span>
<span class="co">#&gt; 9766: MID26696642 141001    White   Male</span>
<span class="co">#&gt; 9767: MID26696738 141901    White   Male</span>
<span class="co">#&gt; 9768: MID26696771 141001    White Female</span>
<span class="co">#&gt; 9769: MID26696958 141901    White   Male</span>
<span class="co">#&gt; 9770: MID26696967 141901    White   Male</span>
<span class="co">#&gt; 9771: MID26697163 141901 Hispanic   Male</span>
<span class="co">#&gt; 9772: MID26697444 141901    White   Male</span>
<span class="co">#&gt; 9773: MID26697447 141001    Asian   Male</span></code></pre></div>
<p>We join the program names from <code>program_group</code> to our working data frame so we can aggregate by groups in a future step.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># left-join program_group to enrollees</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">program_group</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">enrollees</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;         cip6          id     race    sex                program</span>
<span class="co">#&gt;    1: 143501 MID25783178    Black   Male Industrial Engineering</span>
<span class="co">#&gt;    2: 140801 MID25783197    White   Male      Civil Engineering</span>
<span class="co">#&gt;    3: 141001 MID25783227    White   Male Electrical Engineering</span>
<span class="co">#&gt;    4: 141901 MID25783388    White   Male Mechanical Engineering</span>
<span class="co">#&gt;    5: 140801 MID25783441    White   Male      Civil Engineering</span>
<span class="co">#&gt;    6: 141001 MID25783491    White   Male Electrical Engineering</span>
<span class="co">#&gt;    7: 140801 MID25783553    White   Male      Civil Engineering</span>
<span class="co">#&gt;    8: 141001 MID25783606    White   Male Electrical Engineering</span>
<span class="co">#&gt;    9: 141901 MID25783753    White   Male Mechanical Engineering</span>
<span class="co">#&gt;   10: 141901 MID25783830    Black   Male Mechanical Engineering</span>
<span class="co">#&gt;   ---                                                          </span>
<span class="co">#&gt; 9764: 141901 MID26696439    White   Male Mechanical Engineering</span>
<span class="co">#&gt; 9765: 141901 MID26696484    White   Male Mechanical Engineering</span>
<span class="co">#&gt; 9766: 141001 MID26696642    White   Male Electrical Engineering</span>
<span class="co">#&gt; 9767: 141901 MID26696738    White   Male Mechanical Engineering</span>
<span class="co">#&gt; 9768: 141001 MID26696771    White Female Electrical Engineering</span>
<span class="co">#&gt; 9769: 141901 MID26696958    White   Male Mechanical Engineering</span>
<span class="co">#&gt; 9770: 141901 MID26696967    White   Male Mechanical Engineering</span>
<span class="co">#&gt; 9771: 141901 MID26697163 Hispanic   Male Mechanical Engineering</span>
<span class="co">#&gt; 9772: 141901 MID26697444    White   Male Mechanical Engineering</span>
<span class="co">#&gt; 9773: 141001 MID26697447    Asian   Male Electrical Engineering</span></code></pre></div>
</div>
<div id="gather-the-students-graduating" class="section level2">
<h2 class="hasAnchor">
<a href="#gather-the-students-graduating" class="anchor"></a>Gather the students graduating</h2>
<p>We access <code>midfielddegrees</code> to obtain the IDs of all students graduating from these programs. We skip the feasible completion step because for graduates, the question of completion feasibility is moot—graduation itself establishes feasibility.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract graduates</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"cip6"</span>, <span class="st">"term_degree"</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfielddegrees</span><span class="op">$</span><span class="va">cip6</span> <span class="op">%in%</span> <span class="va">group_cip</span>
<span class="va">graduates</span> <span class="op">&lt;-</span> <span class="va">midfielddegrees</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">graduates</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                id   cip6 term_degree</span>
<span class="co">#&gt;    1: MID25783178 143501       20001</span>
<span class="co">#&gt;    2: MID25783197 140801       19911</span>
<span class="co">#&gt;    3: MID25783441 140801       19963</span>
<span class="co">#&gt;    4: MID25783491 141001       20001</span>
<span class="co">#&gt;    5: MID25783912 143501       20001</span>
<span class="co">#&gt;    6: MID25784334 140801       19963</span>
<span class="co">#&gt;    7: MID25784418 140801       19981</span>
<span class="co">#&gt;    8: MID25784489 140801       19931</span>
<span class="co">#&gt;    9: MID25784709 140801       19971</span>
<span class="co">#&gt;   10: MID25784742 140801       19943</span>
<span class="co">#&gt;   ---                               </span>
<span class="co">#&gt; 4667: MID26696234 141901       20143</span>
<span class="co">#&gt; 4668: MID26696337 140801       20133</span>
<span class="co">#&gt; 4669: MID26696429 143501       20133</span>
<span class="co">#&gt; 4670: MID26696484 141901       20154</span>
<span class="co">#&gt; 4671: MID26696642 141001       20153</span>
<span class="co">#&gt; 4672: MID26696738 141901       20133</span>
<span class="co">#&gt; 4673: MID26696771 141001       20143</span>
<span class="co">#&gt; 4674: MID26696967 141901       20141</span>
<span class="co">#&gt; 4675: MID26697163 141901       20133</span>
<span class="co">#&gt; 4676: MID26697447 141001       20154</span></code></pre></div>
<p>Some students might have earned a second degree in a term after their first degree. To ensure we count only the first degree, we the minimum value of <code>term_degree</code> grouped by <code>id</code>, using the data.table <code>.SD</code> syntax.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># keep the first degree term if more than one</span>
<span class="va">graduates</span> <span class="op">&lt;-</span> <span class="va">graduates</span><span class="op">[</span>, <span class="va">.SD</span><span class="op">[</span><span class="va">term_degree</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">term_degree</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="va">id</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">graduates</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                id   cip6 term_degree</span>
<span class="co">#&gt;    1: MID25783178 143501       20001</span>
<span class="co">#&gt;    2: MID25783197 140801       19911</span>
<span class="co">#&gt;    3: MID25783441 140801       19963</span>
<span class="co">#&gt;    4: MID25783491 141001       20001</span>
<span class="co">#&gt;    5: MID25783912 143501       20001</span>
<span class="co">#&gt;    6: MID25784334 140801       19963</span>
<span class="co">#&gt;    7: MID25784418 140801       19981</span>
<span class="co">#&gt;    8: MID25784489 140801       19931</span>
<span class="co">#&gt;    9: MID25784709 140801       19971</span>
<span class="co">#&gt;   10: MID25784742 140801       19943</span>
<span class="co">#&gt;   ---                               </span>
<span class="co">#&gt; 4667: MID26696234 141901       20143</span>
<span class="co">#&gt; 4668: MID26696337 140801       20133</span>
<span class="co">#&gt; 4669: MID26696429 143501       20133</span>
<span class="co">#&gt; 4670: MID26696484 141901       20154</span>
<span class="co">#&gt; 4671: MID26696642 141001       20153</span>
<span class="co">#&gt; 4672: MID26696738 141901       20133</span>
<span class="co">#&gt; 4673: MID26696771 141001       20143</span>
<span class="co">#&gt; 4674: MID26696967 141901       20141</span>
<span class="co">#&gt; 4675: MID26697163 141901       20133</span>
<span class="co">#&gt; 4676: MID26697447 141001       20154</span></code></pre></div>
<p>We can remove the <code>term_degree</code> column and then we access <code>midfieldstudents</code> for student race/ethnicity and sex.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># finished with term_degree column</span>
<span class="va">graduates</span><span class="op">[</span>, <span class="va">term_degree</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span>

<span class="co"># join race sex</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="va">graduates</span><span class="op">$</span><span class="va">id</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">race_sex</span><span class="op">)</span>
<span class="va">graduates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">graduates</span>, <span class="va">race_sex</span>, by <span class="op">=</span> <span class="st">"id"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># join program labels</span>
<span class="va">graduates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">graduates</span>, <span class="va">program_group</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">graduates</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;         cip6          id     race    sex                program</span>
<span class="co">#&gt;    1: 143501 MID25783178    Black   Male Industrial Engineering</span>
<span class="co">#&gt;    2: 140801 MID25783197    White   Male      Civil Engineering</span>
<span class="co">#&gt;    3: 140801 MID25783441    White   Male      Civil Engineering</span>
<span class="co">#&gt;    4: 141001 MID25783491    White   Male Electrical Engineering</span>
<span class="co">#&gt;    5: 143501 MID25783912    White   Male Industrial Engineering</span>
<span class="co">#&gt;    6: 140801 MID25784334    White Female      Civil Engineering</span>
<span class="co">#&gt;    7: 140801 MID25784418    White   Male      Civil Engineering</span>
<span class="co">#&gt;    8: 140801 MID25784489    Asian Female      Civil Engineering</span>
<span class="co">#&gt;    9: 140801 MID25784709    White   Male      Civil Engineering</span>
<span class="co">#&gt;   10: 140801 MID25784742    White Female      Civil Engineering</span>
<span class="co">#&gt;   ---                                                          </span>
<span class="co">#&gt; 4667: 141901 MID26696234 Hispanic   Male Mechanical Engineering</span>
<span class="co">#&gt; 4668: 140801 MID26696337 Hispanic   Male      Civil Engineering</span>
<span class="co">#&gt; 4669: 143501 MID26696429    White Female Industrial Engineering</span>
<span class="co">#&gt; 4670: 141901 MID26696484    White   Male Mechanical Engineering</span>
<span class="co">#&gt; 4671: 141001 MID26696642    White   Male Electrical Engineering</span>
<span class="co">#&gt; 4672: 141901 MID26696738    White   Male Mechanical Engineering</span>
<span class="co">#&gt; 4673: 141001 MID26696771    White Female Electrical Engineering</span>
<span class="co">#&gt; 4674: 141901 MID26696967    White   Male Mechanical Engineering</span>
<span class="co">#&gt; 4675: 141901 MID26697163 Hispanic   Male Mechanical Engineering</span>
<span class="co">#&gt; 4676: 141001 MID26697447    Asian   Male Electrical Engineering</span></code></pre></div>
</div>
<div id="group-summarize-and-join" class="section level2">
<h2 class="hasAnchor">
<a href="#group-summarize-and-join" class="anchor"></a>Group, summarize, and join</h2>
<p>To frame our results in terms of program, race/ethnicity, and sex, we assign these variables as our grouping variables.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># assign variables to aggregate by</span>
<span class="va">grouping_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span></code></pre></div>
<p>We count the number of students in each grouping. The count is assigned to the new <code>ever</code> column.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># group and summarize</span>
<span class="va">grouped_enrollees</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>ever <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">grouping_variables</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">grouped_enrollees</span>
<span class="co">#&gt;                    program            race    sex ever</span>
<span class="co">#&gt;  1:      Civil Engineering           White   Male 1376</span>
<span class="co">#&gt;  2:      Civil Engineering   International   Male   14</span>
<span class="co">#&gt;  3:      Civil Engineering           Asian Female   22</span>
<span class="co">#&gt;  4:      Civil Engineering           White Female  407</span>
<span class="co">#&gt;  5:      Civil Engineering           Black   Male  106</span>
<span class="co">#&gt;  6:      Civil Engineering           Black Female   56</span>
<span class="co">#&gt;  7:      Civil Engineering           Other   Male   15</span>
<span class="co">#&gt;  8:      Civil Engineering           Asian   Male   51</span>
<span class="co">#&gt;  9:      Civil Engineering        Hispanic   Male   66</span>
<span class="co">#&gt; 10:      Civil Engineering           Other Female    6</span>
<span class="co">#&gt; ---                                                   </span>
<span class="co">#&gt; 54: Industrial Engineering        Hispanic   Male   26</span>
<span class="co">#&gt; 55: Industrial Engineering        Hispanic Female    7</span>
<span class="co">#&gt; 56: Industrial Engineering           Asian Female   41</span>
<span class="co">#&gt; 57: Industrial Engineering           Other   Male    7</span>
<span class="co">#&gt; 58: Industrial Engineering   International Female    6</span>
<span class="co">#&gt; 59: Industrial Engineering Native American   Male    1</span>
<span class="co">#&gt; 60: Industrial Engineering           Other Female    4</span>
<span class="co">#&gt; 61: Industrial Engineering         Unknown   Male    1</span>
<span class="co">#&gt; 62: Industrial Engineering         Unknown Female    2</span>
<span class="co">#&gt; 63: Industrial Engineering Native American Female    1</span></code></pre></div>
<p>Repeat for the graduates, creating the new <code>grad</code> column.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># group and summarize</span>
<span class="va">grouped_graduates</span> <span class="op">&lt;-</span> <span class="va">graduates</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>grad <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">grouping_variables</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">grouped_graduates</span>
<span class="co">#&gt;                    program            race    sex grad</span>
<span class="co">#&gt;  1:      Civil Engineering           White   Male  708</span>
<span class="co">#&gt;  2:      Civil Engineering           White Female  192</span>
<span class="co">#&gt;  3:      Civil Engineering           Asian Female   11</span>
<span class="co">#&gt;  4:      Civil Engineering           Black   Male   39</span>
<span class="co">#&gt;  5:      Civil Engineering           Asian   Male   24</span>
<span class="co">#&gt;  6:      Civil Engineering           Black Female   21</span>
<span class="co">#&gt;  7:      Civil Engineering   International   Male    5</span>
<span class="co">#&gt;  8:      Civil Engineering           Other Female    1</span>
<span class="co">#&gt;  9:      Civil Engineering           Other   Male    8</span>
<span class="co">#&gt; 10:      Civil Engineering Native American   Male    3</span>
<span class="co">#&gt; ---                                                   </span>
<span class="co">#&gt; 51: Industrial Engineering           Asian   Male   47</span>
<span class="co">#&gt; 52: Industrial Engineering           Black Female   56</span>
<span class="co">#&gt; 53: Industrial Engineering   International   Male   18</span>
<span class="co">#&gt; 54: Industrial Engineering        Hispanic   Male   19</span>
<span class="co">#&gt; 55: Industrial Engineering        Hispanic Female    5</span>
<span class="co">#&gt; 56: Industrial Engineering           Asian Female   22</span>
<span class="co">#&gt; 57: Industrial Engineering           Other   Male    4</span>
<span class="co">#&gt; 58: Industrial Engineering   International Female    4</span>
<span class="co">#&gt; 59: Industrial Engineering           Other Female    4</span>
<span class="co">#&gt; 60: Industrial Engineering         Unknown   Male    1</span></code></pre></div>
<p>We join the two data frames by our grouping variables, producing a data frame with <code>ever</code> and <code>grad</code> for each group. Note that we have 63 groupings of enrollees but only 60 groupings of graduates. Some enrollee groups have no graduates.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># left-join graduates to enrollees</span>
<span class="va">grouped_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">grouped_enrollees</span>,
  <span class="va">grouped_graduates</span>,
  by <span class="op">=</span> <span class="va">grouping_variables</span>,
  all.x <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="co"># examine the result, ordered by program</span>
<span class="va">grouped_data</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                    program            race    sex ever grad</span>
<span class="co">#&gt;  1:      Civil Engineering           Asian Female   22   11</span>
<span class="co">#&gt;  2:      Civil Engineering           Asian   Male   51   24</span>
<span class="co">#&gt;  3:      Civil Engineering           Black Female   56   21</span>
<span class="co">#&gt;  4:      Civil Engineering           Black   Male  106   39</span>
<span class="co">#&gt;  5:      Civil Engineering        Hispanic Female   11    5</span>
<span class="co">#&gt;  6:      Civil Engineering        Hispanic   Male   66   30</span>
<span class="co">#&gt;  7:      Civil Engineering   International Female    1    1</span>
<span class="co">#&gt;  8:      Civil Engineering   International   Male   14    5</span>
<span class="co">#&gt;  9:      Civil Engineering Native American   Male    7    3</span>
<span class="co">#&gt; 10:      Civil Engineering           Other Female    6    1</span>
<span class="co">#&gt; ---                                                        </span>
<span class="co">#&gt; 54: Mechanical Engineering   International Female    3    2</span>
<span class="co">#&gt; 55: Mechanical Engineering   International   Male   43   26</span>
<span class="co">#&gt; 56: Mechanical Engineering Native American Female    5    2</span>
<span class="co">#&gt; 57: Mechanical Engineering Native American   Male   14    5</span>
<span class="co">#&gt; 58: Mechanical Engineering           Other Female    4    2</span>
<span class="co">#&gt; 59: Mechanical Engineering           Other   Male   49   28</span>
<span class="co">#&gt; 60: Mechanical Engineering         Unknown Female    5    3</span>
<span class="co">#&gt; 61: Mechanical Engineering         Unknown   Male   15    9</span>
<span class="co">#&gt; 62: Mechanical Engineering           White Female  345  141</span>
<span class="co">#&gt; 63: Mechanical Engineering           White   Male 2444 1166</span></code></pre></div>
</div>
<div id="compute-stickiness" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-stickiness" class="anchor"></a>Compute stickiness</h2>
<p>There are 3 NA entries in the <code>grad</code> column where we have enrollees but no graduates. To see them more directly:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># begin work on computing the metric</span>
<span class="va">stickiness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span><span class="op">(</span><span class="va">grouped_data</span><span class="op">)</span>

<span class="co"># identify NA values</span>
<span class="va">rows_with_degree_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">stickiness</span><span class="op">$</span><span class="va">grad</span><span class="op">)</span>
<span class="va">stickiness</span><span class="op">[</span><span class="va">rows_with_degree_NA</span><span class="op">]</span>
<span class="co">#&gt;                   program            race    sex ever grad</span>
<span class="co">#&gt; 1: Industrial Engineering Native American Female    1   NA</span>
<span class="co">#&gt; 2: Industrial Engineering Native American   Male    1   NA</span>
<span class="co">#&gt; 3: Industrial Engineering         Unknown Female    2   NA</span></code></pre></div>
<p>We convert the NA values in the <code>grad</code> column to zero.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># convert grad NA to zero</span>
<span class="va">stickiness</span><span class="op">[</span><span class="va">rows_with_degree_NA</span>, <span class="va">grad</span> <span class="op">:=</span> <span class="fl">0</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">stickiness</span><span class="op">[</span><span class="va">rows_with_degree_NA</span><span class="op">]</span>
<span class="co">#&gt;                   program            race    sex ever grad</span>
<span class="co">#&gt; 1: Industrial Engineering Native American Female    1    0</span>
<span class="co">#&gt; 2: Industrial Engineering Native American   Male    1    0</span>
<span class="co">#&gt; 3: Industrial Engineering         Unknown Female    2    0</span></code></pre></div>
<p>We omit rows with zero students ever enrolled, if any, to avoid dividing by zero.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># prevent division by zero</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">stickiness</span><span class="op">$</span><span class="va">ever</span> <span class="op">&gt;</span> <span class="fl">0</span>
<span class="va">stickiness</span> <span class="op">&lt;-</span> <span class="va">stickiness</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span></code></pre></div>
<p>Stickiness is the ratio of <code>grad</code> to <code>ever</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># compute stickiness</span>
<span class="va">stickiness</span><span class="op">[</span>, <span class="va">stick</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">grad</span> <span class="op">/</span> <span class="va">ever</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">stickiness</span>
<span class="co">#&gt;                    program            race    sex ever grad stick</span>
<span class="co">#&gt;  1:      Civil Engineering           Asian Female   22   11  0.50</span>
<span class="co">#&gt;  2:      Civil Engineering           Asian   Male   51   24  0.47</span>
<span class="co">#&gt;  3:      Civil Engineering           Black Female   56   21  0.38</span>
<span class="co">#&gt;  4:      Civil Engineering           Black   Male  106   39  0.37</span>
<span class="co">#&gt;  5:      Civil Engineering        Hispanic Female   11    5  0.45</span>
<span class="co">#&gt;  6:      Civil Engineering        Hispanic   Male   66   30  0.45</span>
<span class="co">#&gt;  7:      Civil Engineering   International Female    1    1  1.00</span>
<span class="co">#&gt;  8:      Civil Engineering   International   Male   14    5  0.36</span>
<span class="co">#&gt;  9:      Civil Engineering Native American   Male    7    3  0.43</span>
<span class="co">#&gt; 10:      Civil Engineering           Other Female    6    1  0.17</span>
<span class="co">#&gt; ---                                                              </span>
<span class="co">#&gt; 54: Mechanical Engineering   International Female    3    2  0.67</span>
<span class="co">#&gt; 55: Mechanical Engineering   International   Male   43   26  0.60</span>
<span class="co">#&gt; 56: Mechanical Engineering Native American Female    5    2  0.40</span>
<span class="co">#&gt; 57: Mechanical Engineering Native American   Male   14    5  0.36</span>
<span class="co">#&gt; 58: Mechanical Engineering           Other Female    4    2  0.50</span>
<span class="co">#&gt; 59: Mechanical Engineering           Other   Male   49   28  0.57</span>
<span class="co">#&gt; 60: Mechanical Engineering         Unknown Female    5    3  0.60</span>
<span class="co">#&gt; 61: Mechanical Engineering         Unknown   Male   15    9  0.60</span>
<span class="co">#&gt; 62: Mechanical Engineering           White Female  345  141  0.41</span>
<span class="co">#&gt; 63: Mechanical Engineering           White   Male 2444 1166  0.48</span></code></pre></div>
<p>To see the class of each column:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># name and class of variables (columns)</span>
<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">stickiness</span>, FUN <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;     program        race         sex        ever        grad       stick </span>
<span class="co">#&gt; "character" "character" "character"   "integer"   "integer"   "numeric"</span></code></pre></div>
<p>The stickiness data derived above is the data set <code>rep_stickiness</code> in midfieldr. View its help page by running</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span> <span class="va">rep_stickiness</span></code></pre></div>
</div>
<div id="condition-the-data-for-display" class="section level2">
<h2 class="hasAnchor">
<a href="#condition-the-data-for-display" class="anchor"></a>Condition the data for display</h2>
<p>Before graphing, we isolate the three multiway variables (program, combined race and sex, and stickiness) and transform the categorical variables into factors with levels that are ordered by median stickiness.</p>
<p>The <em>Multiway graphs and tables</em> vignette <a href="multiway_graphs.html">(link)</a> describes this process for the stickiness data in detail. The result is included as a data set <code>rep_stickiness_mw</code> in midfieldr. View its help page by running</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span> <span class="va">rep_stickiness_mw</span></code></pre></div>
<p>This data set is loaded with midfieldr.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># condition the data in multiway form (built-in data set)</span>
<span class="va">data_mw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span><span class="op">(</span><span class="va">rep_stickiness_mw</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">data_mw</span>
<span class="co">#&gt;                    program        race_sex stick</span>
<span class="co">#&gt;  1:      Civil Engineering    Asian Female  0.50</span>
<span class="co">#&gt;  2:      Civil Engineering      Asian Male  0.47</span>
<span class="co">#&gt;  3:      Civil Engineering    Black Female  0.38</span>
<span class="co">#&gt;  4:      Civil Engineering      Black Male  0.37</span>
<span class="co">#&gt;  5:      Civil Engineering Hispanic Female  0.45</span>
<span class="co">#&gt;  6:      Civil Engineering   Hispanic Male  0.45</span>
<span class="co">#&gt;  7:      Civil Engineering    White Female  0.47</span>
<span class="co">#&gt;  8:      Civil Engineering      White Male  0.51</span>
<span class="co">#&gt;  9: Electrical Engineering    Asian Female  0.49</span>
<span class="co">#&gt; 10: Electrical Engineering      Asian Male  0.54</span>
<span class="co">#&gt; ---                                             </span>
<span class="co">#&gt; 23: Industrial Engineering    White Female  0.60</span>
<span class="co">#&gt; 24: Industrial Engineering      White Male  0.58</span>
<span class="co">#&gt; 25: Mechanical Engineering    Asian Female  0.62</span>
<span class="co">#&gt; 26: Mechanical Engineering      Asian Male  0.60</span>
<span class="co">#&gt; 27: Mechanical Engineering    Black Female  0.36</span>
<span class="co">#&gt; 28: Mechanical Engineering      Black Male  0.37</span>
<span class="co">#&gt; 29: Mechanical Engineering Hispanic Female  0.38</span>
<span class="co">#&gt; 30: Mechanical Engineering   Hispanic Male  0.45</span>
<span class="co">#&gt; 31: Mechanical Engineering    White Female  0.41</span>
<span class="co">#&gt; 32: Mechanical Engineering      White Male  0.48</span></code></pre></div>
<p>The attributes of the data frame confirm that the categorical variables are factors and not characters. The median values by which the factor levels are ordered are shown in the <code>scores</code> attributes.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># name and class of variables (columns)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">data_mw</span>, FUN <span class="op">=</span> <span class="va">attributes</span><span class="op">)</span>
<span class="co">#&gt; $program</span>
<span class="co">#&gt; $program$levels</span>
<span class="co">#&gt; [1] "Mechanical Engineering" "Electrical Engineering" "Civil Engineering"     </span>
<span class="co">#&gt; [4] "Industrial Engineering"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $program$class</span>
<span class="co">#&gt; [1] "factor"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $program$scores</span>
<span class="co">#&gt;      Civil Engineering Electrical Engineering Industrial Engineering </span>
<span class="co">#&gt;                   0.46                   0.44                   0.59 </span>
<span class="co">#&gt; Mechanical Engineering </span>
<span class="co">#&gt;                   0.43 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $race_sex</span>
<span class="co">#&gt; $race_sex$levels</span>
<span class="co">#&gt; [1] "Black Male"      "Black Female"    "Hispanic Female" "White Female"   </span>
<span class="co">#&gt; [5] "Hispanic Male"   "White Male"      "Asian Female"    "Asian Male"     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $race_sex$class</span>
<span class="co">#&gt; [1] "factor"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $race_sex$scores</span>
<span class="co">#&gt;    Asian Female      Asian Male    Black Female      Black Male Hispanic Female </span>
<span class="co">#&gt;           0.520           0.570           0.410           0.380           0.425 </span>
<span class="co">#&gt;   Hispanic Male    White Female      White Male </span>
<span class="co">#&gt;           0.455           0.440           0.495 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stick</span>
<span class="co">#&gt; NULL</span></code></pre></div>
</div>
<div id="graph-the-metric" class="section level2">
<h2 class="hasAnchor">
<a href="#graph-the-metric" class="anchor"></a>Graph the metric</h2>
<p>We use conventional ggplot2 functions to graph the <code>data_mw</code> data set in a multiway graph.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># graph results</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_mw</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stick</span>, y <span class="op">=</span> <span class="va">race_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, as.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Stickiness"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p><img src="../man/figures/vignette-stickiness-metric-fig1-1.png" width="70%" style="display: block; margin: auto;"><br></p>
<p>For more information on multiway data and interpreting multiway graphs, see the <em>Multiway graphs and tables</em> vignette <a href="multiway_graphs.html">(link)</a>.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Ohland+Orr+others:2012" class="csl-entry">
Ohland, Matthew, Orr, Marisa, Layton, Richard, et al. (2012) <span class="nocase">Introducing stickiness as a versatile metric of engineering persistence</span>. In: <em><span class="nocase">Proceedings of the Frontiers in Education Conference</span></em>, 2012, pp. 1–5.
</div>
</div>
</div>
<div id="appendix" class="section level2">
<h2 class="hasAnchor">
<a href="#appendix" class="anchor"></a>Appendix</h2>
<div id="complete-script" class="section level3">
<h3 class="hasAnchor">
<a href="#complete-script" class="anchor"></a>Complete script</h3>
<p>The vignette code chunks are collected below in a single, condensed script.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages used</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfieldr">midfieldr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfielddata">midfielddata</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://Rdatatable.gitlab.io/data.table">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="co"># obtain programs (built-in data set)</span>
<span class="va">program_group</span> <span class="op">&lt;-</span> <span class="va">rep_group</span>
<span class="va">group_cip</span> <span class="op">&lt;-</span> <span class="va">program_group</span><span class="op">$</span><span class="va">cip6</span>

<span class="co"># gather students ever enrolled in programs</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"cip6"</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">$</span><span class="va">cip6</span> <span class="op">%in%</span> <span class="va">group_cip</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">)</span>

<span class="co"># gather FYE students predicted to start in these programs</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">fye_start</span><span class="op">$</span><span class="va">start</span> <span class="op">%in%</span> <span class="va">group_cip</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"start"</span><span class="op">)</span>
<span class="va">fye_starters</span> <span class="op">&lt;-</span> <span class="va">fye_start</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">fye_starters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">fye_starters</span><span class="op">)</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">fye_starters</span>, old <span class="op">=</span> <span class="st">"start"</span>, new <span class="op">=</span> <span class="st">"cip6"</span><span class="op">)</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">fye_starters</span><span class="op">)</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">)</span>

<span class="co"># apply the feasible completion filter</span>
<span class="va">feasible_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_feasible.html">subset_feasible</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">enrollees</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="va">feasible_ids</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>

<span class="co"># obtain race/ethnicity and sex at matriculation</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="va">feasible_ids</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">race_sex</span><span class="op">)</span>

<span class="co"># join data frames</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">race_sex</span>, by <span class="op">=</span> <span class="st">"id"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">program_group</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># gather students graduating from programs</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"cip6"</span>, <span class="st">"term_degree"</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfielddegrees</span><span class="op">$</span><span class="va">cip6</span> <span class="op">%in%</span> <span class="va">group_cip</span>
<span class="va">graduates</span> <span class="op">&lt;-</span> <span class="va">midfielddegrees</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">graduates</span> <span class="op">&lt;-</span> <span class="va">graduates</span><span class="op">[</span>, <span class="va">.SD</span><span class="op">[</span><span class="va">term_degree</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">term_degree</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="va">id</span><span class="op">]</span>

<span class="co"># join race/ethnicity, sex, and program labels</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="va">graduates</span><span class="op">$</span><span class="va">id</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">race_sex</span><span class="op">)</span>
<span class="va">graduates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">graduates</span>, <span class="va">race_sex</span>, by <span class="op">=</span> <span class="st">"id"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">graduates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">graduates</span>, <span class="va">program_group</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># group, summarize, and join</span>
<span class="va">grouping_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="va">grouped_enrollees</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>ever <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">grouping_variables</span><span class="op">]</span>
<span class="va">grouped_graduates</span> <span class="op">&lt;-</span> <span class="va">graduates</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>grad <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">grouping_variables</span><span class="op">]</span>
<span class="va">grouped_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">grouped_enrollees</span>,
  <span class="va">grouped_graduates</span>,
  by <span class="op">=</span> <span class="va">grouping_variables</span>,
  all.x <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="co"># compute the metric</span>
<span class="va">stickiness</span> <span class="op">&lt;-</span> <span class="va">grouped_data</span>
<span class="va">rows_with_degree_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">stickiness</span><span class="op">$</span><span class="va">grad</span><span class="op">)</span>
<span class="va">stickiness</span><span class="op">[</span><span class="va">rows_with_degree_NA</span>, <span class="va">grad</span> <span class="op">:=</span> <span class="fl">0</span><span class="op">]</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">stickiness</span><span class="op">$</span><span class="va">ever</span> <span class="op">&gt;</span> <span class="fl">0</span>
<span class="va">stickiness</span> <span class="op">&lt;-</span> <span class="va">stickiness</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>
<span class="va">stickiness</span><span class="op">[</span>, <span class="va">stick</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">grad</span> <span class="op">/</span> <span class="va">ever</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span>

<span class="co"># condition the data in multiway form (built-in data set)</span>
<span class="va">data_mw</span> <span class="op">&lt;-</span> <span class="va">rep_stickiness_mw</span>

<span class="co"># graph results</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_mw</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stick</span>, y <span class="op">=</span> <span class="va">race_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, as.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Stickiness"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Richard Layton, Russell Long, Matthew Ohland, US National Science Foundation.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
