<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="midfieldr">
<title>Case study students • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.5.1/tabs.js"></script><script src="../deps/bs3compat-0.2.5.1/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Case study students">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="https://midfieldr.github.io/midfieldr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom>
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">midfieldr</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.0.0.9018</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/art-000-getting-started.html">Getting started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-study">Case study</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-study">
    <a class="dropdown-item" href="../articles/art-002-case-study-programs.html">Programs</a>
    <a class="dropdown-item" href="../articles/art-004-case-study-students.html">Students</a>
    <a class="dropdown-item" href="../articles/art-006-case-study-stickiness.html">Stickiness</a>
    <a class="dropdown-item" href="../articles/art-008-case-study-grad-rate.html">Graduation rate</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/art-010-program-codes.html">Program codes and names</a>
    <a class="dropdown-item" href="../articles/art-015-subsetting-midfield-data.html">Subsetting MIDFIELD data</a>
    <a class="dropdown-item" href="../articles/art-020-data-sufficiency.html">Data sufficiency</a>
    <a class="dropdown-item" href="../articles/art-030-timely-completion.html">Timely completion</a>
    <a class="dropdown-item" href="../articles/art-040-fye-programs.html">FYE programs</a>
    <a class="dropdown-item" href="../articles/art-050-multiway-graphs.html">Multiway graphs</a>
    <a class="dropdown-item" href="../articles/art-060-tabulating-data.html">Tabulating data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control mr-sm-2" aria-label="Search" name="search-input" data-search-index="/search.json" id="search-input" placeholder="Search..." autocomplete="off">
</form>

      <ul class="navbar-nav ml-1">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MIDFIELDR/midfieldr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
  </div>
</nav><div class="container template-article">
<script src="art-004-case-study-students_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <img src="../package-logo.png" class="pkg-logo" alt=""><div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
      <h1 class="display-4" data-toc-skip>Case study students</h1>
                        <h4 data-toc-skip class="author">Richard Layton</h4>
            
            <h4 data-toc-skip class="date">2021-07-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/master/vignettes/art-004-case-study-students.Rmd" class="external-link"><code>vignettes/art-004-case-study-students.Rmd</code></a></small>
      <div class="d-none name"><code>art-004-case-study-students.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>Introduction</h2>
<p>We continue the case study by using the CIP codes in <code>study_program</code> to gather all degree-seeking students ever enrolled in the case study programs. After joining columns for program names and student race/ethnicity and sex, we filter for data sufficiency. The resulting data frame is the common basis for computing persistence metrics.</p>
<p>The case study is a quick tour of a typical workflow using student unit record data. This is a “big picture” development—functions are used without detailed explanations or development so that we can focus on the logic of the analysis. For exploring related midfieldr functions and methods in greater detail, see</p>
<ul>
<li><a href="art-015-subsetting-midfield-data.html" target="_blank">Subsetting MIDFIELD data</a></li>
<li><a href="art-020-data-sufficiency.html" target="_blank">Data sufficiency</a></li>
</ul>
<div id="outline" class="section level3">
<h3 class="hasAnchor">
<a href="#outline" class="anchor" aria-hidden="true"></a>Outline</h3>
<ul>
<li>Gather students</li>
<li>Join grouping variables</li>
<li>Filter for data sufficiency</li>
<li>Save results</li>
</ul>
</div>
<div id="in-this-vignette" class="section level3">
<h3 class="hasAnchor">
<a href="#in-this-vignette" class="anchor" aria-hidden="true"></a>In this vignette</h3>
<p>midfieldr functions</p>
<ul>
<li><a href="../reference/filter_match.html"><code>filter_match()</code></a></li>
<li><a href="../reference/add_race_sex.html"><code>add_race_sex()</code></a></li>
<li><a href="../reference/add_timely_term.html"><code>add_timely_term()</code></a></li>
<li><a href="../reference/add_data_sufficiency.html"><code>add_data_sufficiency()</code></a></li>
</ul>
<p>packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages used</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span>

<span class="co"># optional code to control data.table printing</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>
  datatable.print.nrows <span class="op">=</span> <span class="fl">6</span>,
  datatable.print.topn <span class="op">=</span> <span class="fl">3</span>,
  datatable.print.class <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<p>data</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load data tables from midfielddata</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="gather-students" class="section level2">
<h2 class="hasAnchor">
<a href="#gather-students" class="anchor" aria-hidden="true"></a>Gather students</h2>
<p>If you saved your results from the previous vignette in the file <code>results/case_program.csv</code>, you can read them back in to your workspace using the following where we specify that the CIP column is a string variable to prevent it being read as an integer.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Optional </span>
<span class="va">case_program</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="st">"results/case_program.csv"</span>, 
                      colClasses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>cip6 <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>If not, the data are included with midfieldr as the <code>study_program</code> data set. View its help page by running</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span> <span class="va">study_program</span></code></pre></div>
<p>In the remainder of the vignette, we assume we’re using the <code>study_program</code> data frame. A reminder of its contents:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Loaded with midfieldr</span>
<span class="va">study_program</span>
<span class="co">#&gt;       cip6    program</span>
<span class="co">#&gt;     &lt;char&gt;     &lt;char&gt;</span>
<span class="co">#&gt;  1: 140801      Civil</span>
<span class="co">#&gt;  2: 140802      Civil</span>
<span class="co">#&gt;  3: 140803      Civil</span>
<span class="co">#&gt; ---                  </span>
<span class="co">#&gt; 10: 141099 Electrical</span>
<span class="co">#&gt; 11: 141901 Mechanical</span>
<span class="co">#&gt; 12: 143501 Industrial</span></code></pre></div>
<p>We start with <code><a href="../reference/filter_match.html">filter_match()</a></code> to subset rows of <code>term</code> with <code>cip6</code> values that match the <code>cip6</code> values in <code>study_program</code> and returning three columns for student ID, institution, and CIP code.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># All terms for all students in the study programs </span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_match.html">filter_match</a></span><span class="op">(</span><span class="va">term</span>,
                   match_to <span class="op">=</span> <span class="va">study_program</span>,
                   by_col <span class="op">=</span> <span class="st">"cip6"</span>,
                   select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"institution"</span>, <span class="st">"cip6"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;               mcid   institution   cip6</span>
<span class="co">#&gt;             &lt;char&gt;        &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;     1: MID25783197 Institution M 140801</span>
<span class="co">#&gt;     2: MID25783197 Institution M 140801</span>
<span class="co">#&gt;     3: MID25783197 Institution M 140801</span>
<span class="co">#&gt;    ---                                 </span>
<span class="co">#&gt; 67091: MID26696429 Institution L 143501</span>
<span class="co">#&gt; 67092: MID26696429 Institution L 143501</span>
<span class="co">#&gt; 67093: MID26696429 Institution L 143501</span></code></pre></div>
<p>This result has duplicate rows because the data include all terms for each student. We remove duplicates with <code><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>

<span class="co"># Examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;               mcid   institution   cip6</span>
<span class="co">#&gt;             &lt;char&gt;        &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;     1: MID25783197 Institution M 140801</span>
<span class="co">#&gt;     2: MID25783441 Institution M 140801</span>
<span class="co">#&gt;     3: MID25783553 Institution M 140801</span>
<span class="co">#&gt;    ---                                 </span>
<span class="co">#&gt; 10762: MID26695626 Institution L 143501</span>
<span class="co">#&gt; 10763: MID26696116 Institution L 143501</span>
<span class="co">#&gt; 10764: MID26696429 Institution L 143501</span></code></pre></div>
<p>In general, the <code>term</code> data can include non-degree-seeking students. To limit the study to degree-seeking students only, we subset rows of <code>DT</code> with <code>mcid</code> values that match the <code>mcid</code> values in the <code>student</code> table (all students in th <code>student</code> data table are degree-seeking). As it happens, in this example all students are degree-seeking, so the results don’t change.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Limit the study to degree-seeking students</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_match.html">filter_match</a></span><span class="op">(</span><span class="va">DT</span>,
                   match_to <span class="op">=</span> <span class="va">student</span>,
                   by_col <span class="op">=</span> <span class="st">"mcid"</span><span class="op">)</span>

<span class="co"># Examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;               mcid   institution   cip6</span>
<span class="co">#&gt;             &lt;char&gt;        &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;     1: MID25783178 Institution M 143501</span>
<span class="co">#&gt;     2: MID25783197 Institution M 140801</span>
<span class="co">#&gt;     3: MID25783388 Institution M 141901</span>
<span class="co">#&gt;    ---                                 </span>
<span class="co">#&gt; 10762: MID26697163 Institution L 141901</span>
<span class="co">#&gt; 10763: MID26697444 Institution L 141901</span>
<span class="co">#&gt; 10764: MID26697447 Institution L 141001</span></code></pre></div>
</div>
<div id="join-grouping-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#join-grouping-variables" class="anchor" aria-hidden="true"></a>Join grouping variables</h2>
<p>In support of examining student characteristics (race/ethnicity and sex) and curricular pathways (program), we join these characteristics to the student data. These are the “group by” variables used in our persistence metrics.</p>
<p>Program names are joined by merging <code>study_program</code> to our working data frame.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Program name is a commonly used grouping variable</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">study_program</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;          cip6        mcid   institution    program</span>
<span class="co">#&gt;        &lt;char&gt;      &lt;char&gt;        &lt;char&gt;     &lt;char&gt;</span>
<span class="co">#&gt;     1: 140801 MID25783197 Institution M      Civil</span>
<span class="co">#&gt;     2: 140801 MID25783441 Institution M      Civil</span>
<span class="co">#&gt;     3: 140801 MID25783553 Institution M      Civil</span>
<span class="co">#&gt;    ---                                            </span>
<span class="co">#&gt; 10762: 143501 MID26695626 Institution L Industrial</span>
<span class="co">#&gt; 10763: 143501 MID26696116 Institution L Industrial</span>
<span class="co">#&gt; 10764: 143501 MID26696429 Institution L Industrial</span></code></pre></div>
<p>Student race/ethnicity and sex are joined using the midfieldr <code><a href="../reference/add_race_sex.html">add_race_sex()</a></code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Race/ethnicity and sex are commonly used grouping variables</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_race_sex.html">add_race_sex</a></span><span class="op">(</span><span class="va">DT</span>, midfield_student <span class="op">=</span> <span class="va">student</span><span class="op">)</span>

<span class="co"># Examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;          cip6        mcid   institution    program   race    sex</span>
<span class="co">#&gt;        &lt;char&gt;      &lt;char&gt;        &lt;char&gt;     &lt;char&gt; &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;     1: 140801 MID25783197 Institution M      Civil  White   Male</span>
<span class="co">#&gt;     2: 140801 MID25783441 Institution M      Civil  White   Male</span>
<span class="co">#&gt;     3: 140801 MID25783553 Institution M      Civil  White   Male</span>
<span class="co">#&gt;    ---                                                          </span>
<span class="co">#&gt; 10762: 143501 MID26695626 Institution L Industrial  White   Male</span>
<span class="co">#&gt; 10763: 143501 MID26696116 Institution L Industrial  White Female</span>
<span class="co">#&gt; 10764: 143501 MID26696429 Institution L Industrial  White Female</span></code></pre></div>
</div>
<div id="filter-for-data-sufficiency" class="section level2">
<h2 class="hasAnchor">
<a href="#filter-for-data-sufficiency" class="anchor" aria-hidden="true"></a>Filter for data sufficiency</h2>
<p>For students admitted too near the upper limit of their institution’s data range, the available data cover an insufficient number of years to fairly assess student performance. Only students for whom the data range is sufficient should be included in any analysis.</p>
<p>Data sufficiency is defined in terms of a timely completion term: the last term in which program completion would be considered timely for a given student. The timely completion term for many students is their admission term plus 6 years.</p>
<p>The midfieldr function <code><a href="../reference/add_timely_term.html">add_timely_term()</a></code> estimates a timely completion term for each student.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Timely completion term is required for determining data sufficiency </span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span>

<span class="co"># Examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;          cip6        mcid   institution    program   race    sex timely_term</span>
<span class="co">#&gt;        &lt;char&gt;      &lt;char&gt;        &lt;char&gt;     &lt;char&gt; &lt;char&gt; &lt;char&gt;      &lt;char&gt;</span>
<span class="co">#&gt;     1: 140801 MID25783197 Institution M      Civil  White   Male       19923</span>
<span class="co">#&gt;     2: 140801 MID25783441 Institution M      Civil  White   Male       19973</span>
<span class="co">#&gt;     3: 140801 MID25783553 Institution M      Civil  White   Male       20073</span>
<span class="co">#&gt;    ---                                                                      </span>
<span class="co">#&gt; 10762: 143501 MID26695626 Institution L Industrial  White   Male       20143</span>
<span class="co">#&gt; 10763: 143501 MID26696116 Institution L Industrial  White Female       20153</span>
<span class="co">#&gt; 10764: 143501 MID26696429 Institution L Industrial  White Female       20153</span></code></pre></div>
<p>The data sufficiency criterion is that a study must be limited to students whose timely completion term is within the range of data provided by their institution.</p>
<p>The midfieldr function <code>add_data_sufficiency</code> accesses finds the upper limit of their institution’s data range, compares it to the timely completion term, and reports in a TRUE/FALSE column whether the data are sufficient.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Establish the criterion</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span>

<span class="co"># Examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;          cip6        mcid   institution    program   race    sex timely_term</span>
<span class="co">#&gt;        &lt;char&gt;      &lt;char&gt;        &lt;char&gt;     &lt;char&gt; &lt;char&gt; &lt;char&gt;      &lt;char&gt;</span>
<span class="co">#&gt;     1: 140801 MID25783197 Institution M      Civil  White   Male       19923</span>
<span class="co">#&gt;     2: 140801 MID25783441 Institution M      Civil  White   Male       19973</span>
<span class="co">#&gt;     3: 140801 MID25783553 Institution M      Civil  White   Male       20073</span>
<span class="co">#&gt;    ---                                                                      </span>
<span class="co">#&gt; 10762: 143501 MID26695626 Institution L Industrial  White   Male       20143</span>
<span class="co">#&gt; 10763: 143501 MID26696116 Institution L Industrial  White Female       20153</span>
<span class="co">#&gt; 10764: 143501 MID26696429 Institution L Industrial  White Female       20153</span>
<span class="co">#&gt;        data_sufficiency</span>
<span class="co">#&gt;                  &lt;lgcl&gt;</span>
<span class="co">#&gt;     1:             TRUE</span>
<span class="co">#&gt;     2:             TRUE</span>
<span class="co">#&gt;     3:             TRUE</span>
<span class="co">#&gt;    ---                 </span>
<span class="co">#&gt; 10762:             TRUE</span>
<span class="co">#&gt; 10763:             TRUE</span>
<span class="co">#&gt; 10764:             TRUE</span></code></pre></div>
<p>We limit the study to students for whom the data sufficiency criterion is met.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Apply the criterion</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">data_sufficiency</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">]</span>

<span class="co"># Examine the result</span>
<span class="va">DT</span>
<span class="co">#&gt;         cip6        mcid   institution    program   race    sex timely_term</span>
<span class="co">#&gt;       &lt;char&gt;      &lt;char&gt;        &lt;char&gt;     &lt;char&gt; &lt;char&gt; &lt;char&gt;      &lt;char&gt;</span>
<span class="co">#&gt;    1: 140801 MID25783197 Institution M      Civil  White   Male       19923</span>
<span class="co">#&gt;    2: 140801 MID25783441 Institution M      Civil  White   Male       19973</span>
<span class="co">#&gt;    3: 140801 MID25783553 Institution M      Civil  White   Male       20073</span>
<span class="co">#&gt;   ---                                                                      </span>
<span class="co">#&gt; 8217: 143501 MID26695626 Institution L Industrial  White   Male       20143</span>
<span class="co">#&gt; 8218: 143501 MID26696116 Institution L Industrial  White Female       20153</span>
<span class="co">#&gt; 8219: 143501 MID26696429 Institution L Industrial  White Female       20153</span>
<span class="co">#&gt;       data_sufficiency</span>
<span class="co">#&gt;                 &lt;lgcl&gt;</span>
<span class="co">#&gt;    1:             TRUE</span>
<span class="co">#&gt;    2:             TRUE</span>
<span class="co">#&gt;    3:             TRUE</span>
<span class="co">#&gt;   ---                 </span>
<span class="co">#&gt; 8217:             TRUE</span>
<span class="co">#&gt; 8218:             TRUE</span>
<span class="co">#&gt; 8219:             TRUE</span></code></pre></div>
</div>
<div id="save-results" class="section level2">
<h2 class="hasAnchor">
<a href="#save-results" class="anchor" aria-hidden="true"></a>Save results</h2>
<p>We can order the rows of the result using the data.table function <code><a href="https://Rdatatable.gitlab.io/data.table/reference/setcolorder.html" class="external-link">setcolorder()</a></code>—not strictly necessary, but it does facilitate reproducibility.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Optional step to order the rows </span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setcolorder.html" class="external-link">setcolorder</a></span><span class="op">(</span><span class="va">DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"institution"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Rename before saving </span>
<span class="va">case_student</span> <span class="op">&lt;-</span> <span class="va">DT</span></code></pre></div>
<p>We save the <code>DT</code> data frame as a CSV file to the <code>results</code> directory for easy access as we work through the study.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Assumes you have a results folder in the project directory</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span><span class="va">case_student</span>, file <span class="op">=</span> <span class="st">"results/case_student.csv"</span><span class="op">)</span></code></pre></div>
<p>These results have been included with midfieldr as the built-in data set <code>study_student</code>. View its help page by running</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span> <span class="va">study_student</span></code></pre></div>
<p>View the data frame,</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study_student</span>
<span class="co">#&gt;              mcid   institution   cip6    program   race    sex timely_term</span>
<span class="co">#&gt;            &lt;char&gt;        &lt;char&gt; &lt;char&gt;     &lt;char&gt; &lt;char&gt; &lt;char&gt;      &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783197 Institution M 140801      Civil  White   Male       19923</span>
<span class="co">#&gt;    2: MID25783441 Institution M 140801      Civil  White   Male       19973</span>
<span class="co">#&gt;    3: MID25783553 Institution M 140801      Civil  White   Male       20073</span>
<span class="co">#&gt;   ---                                                                      </span>
<span class="co">#&gt; 8217: MID26695626 Institution L 143501 Industrial  White   Male       20143</span>
<span class="co">#&gt; 8218: MID26696116 Institution L 143501 Industrial  White Female       20153</span>
<span class="co">#&gt; 8219: MID26696429 Institution L 143501 Industrial  White Female       20153</span>
<span class="co">#&gt;       data_sufficiency</span>
<span class="co">#&gt;                 &lt;lgcl&gt;</span>
<span class="co">#&gt;    1:             TRUE</span>
<span class="co">#&gt;    2:             TRUE</span>
<span class="co">#&gt;    3:             TRUE</span>
<span class="co">#&gt;   ---                 </span>
<span class="co">#&gt; 8217:             TRUE</span>
<span class="co">#&gt; 8218:             TRUE</span>
<span class="co">#&gt; 8219:             TRUE</span></code></pre></div>
<p>Check that the two data frames are identical,</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/all.equal.data.table.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">case_student</span>, <span class="va">study_student</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>In subsequent vignettes, you can read in the <code>case_student</code> data from your <code>results</code> directory or you can use the <code>study_student</code> data provided with midfieldr.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor" aria-hidden="true"></a>References</h2>
<div id="refs">

</div>
</div>
<div id="appendix" class="section level2">
<h2 class="hasAnchor">
<a href="#appendix" class="anchor" aria-hidden="true"></a>Appendix</h2>
<div id="complete-script" class="section level3">
<h3 class="hasAnchor">
<a href="#complete-script" class="anchor" aria-hidden="true"></a>Complete script</h3>
<p>The vignette code chunks are collected below in a single, condensed script.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages used</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span>

<span class="co"># load data tables from midfielddata</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span><span class="op">)</span>

<span class="co"># Gather students</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_match.html">filter_match</a></span><span class="op">(</span><span class="va">term</span>,
                   match_to <span class="op">=</span> <span class="va">study_program</span>,
                   by_col <span class="op">=</span> <span class="st">"cip6"</span>,
                   select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"institution"</span>, <span class="st">"cip6"</span><span class="op">)</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_match.html">filter_match</a></span><span class="op">(</span><span class="va">DT</span>,
                   match_to <span class="op">=</span> <span class="va">student</span>,
                   by_col <span class="op">=</span> <span class="st">"mcid"</span><span class="op">)</span>

<span class="co"># Join grouping variables</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">study_program</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_race_sex.html">add_race_sex</a></span><span class="op">(</span><span class="va">DT</span>, midfield_student <span class="op">=</span> <span class="va">student</span><span class="op">)</span>

<span class="co"># Filter for data sufficiency</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">data_sufficiency</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">]</span>

<span class="co"># Save results</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setcolorder.html" class="external-link">setcolorder</a></span><span class="op">(</span><span class="va">DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"institution"</span><span class="op">)</span><span class="op">)</span>
<span class="va">case_student</span> <span class="op">&lt;-</span> <span class="va">DT</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span><span class="va">case_student</span>, file <span class="op">=</span> <span class="st">"results/case_student.csv"</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>
 <div class="col-md-3 d-none d-md-block" id="pkgdown-sidebar">
        <div class="sticky-top">
    <nav id="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
      </div>

</div>



      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/graphdr" class="external-link external-link">Richard Layton</a>, Russell Long, Matthew Ohland, US National Science Foundation.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  

  

  </body>
</html>
