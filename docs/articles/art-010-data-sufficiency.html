<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="midfieldr">
<title>Data sufficiency • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data sufficiency">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="https://midfieldr.github.io/midfieldr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">midfieldr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9025</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/art-000-getting-started.html">Getting started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-study">Case study</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-study">
    <a class="dropdown-item" href="../articles/art-001-case-goals.html">Goals</a>
    <a class="dropdown-item" href="../articles/art-002-case-data.html">Data</a>
    <a class="dropdown-item" href="../articles/art-003-case-results.html">Results</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/art-010-data-sufficiency.html">Data sufficiency</a>
    <a class="dropdown-item" href="../articles/art-020-degree-seeking.html">Degree seeking (inner joins)</a>
    <a class="dropdown-item" href="../articles/art-030-programs.html">Programs</a>
    <a class="dropdown-item" href="../articles/art-040-completion.html">Completion status</a>
    <a class="dropdown-item" href="../articles/art-050-demographics.html">Demographics (left outer joins)</a>
    <a class="dropdown-item" href="../articles/art-060-multiway.html">Multiway data and chatrs</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MIDFIELDR/midfieldr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Data sufficiency</h1>
            
            <h4 data-toc-skip class="date">2022-07-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/HEAD/vignettes/art-010-data-sufficiency.Rmd" class="external-link"><code>vignettes/art-010-data-sufficiency.Rmd</code></a></small>
      <div class="d-none name"><code>art-010-data-sufficiency.Rmd</code></div>
    </div>

    
    
<p>The time span (or range) of MIDFIELD data varies by institution. At
the upper and lower limits of a data range, a potential for false counts
exists when a metric (such as graduation rate) requires knowledge of
timely program completion. For such metrics, student records that
produce problematic results due to insufficient data are nearly always
excluded from study.</p>
<div class="section level2">
<h2 id="definitions">Definitions<a class="anchor" aria-label="anchor" href="#definitions"></a>
</h2>
<dl>
<dt>data range</dt>
<dd>
<p>The overall span of academic terms of student unit record data
provided by an institution. We are particularly interested in the lower
and upper limits of a continuous range.</p>
</dd>
<dt>timely completion term</dt>
<dd>
<p>The last term in which a student’s program completion would be
considered timely. In many cases the timely completion (TC) term is 6
years after admission. The TC term can be adjusted to account for
transfer credits. (Currently, we do not include an adjustment for
co-ops.)</p>
</dd>
<dt>data sufficiency criterion</dt>
<dd>
<p>Student records are limited to those for which available data are
sufficient to assess timely completion without biased counts of
completers or non-completers.</p>
</dd>
</dl>
</div>
<div class="section level2">
<h2 id="upper-limit-data-sufficiency">Upper-limit data sufficiency<a class="anchor" aria-label="anchor" href="#upper-limit-data-sufficiency"></a>
</h2>
<p>For students admitted too near the upper limit of their institution’s
data range, the available data cover an insufficient number of years to
know if completion is timely. To illustrate, in the figure we compare
two students admitted in different terms with representative time spans
shown for timely completion. In this scenario, we assume institution
data is available from 1986 to 1996.</p>
<p><br></p>
<p><img src="../reference/figures/art-010-data-sufficiency-upper.png" style="width:80.0%"></p>
<p><br></p>
<dl>
<dt>Student A</dt>
<dd>
<p>Student A enters in 1988 with a timely completion (TC) term in 1994.
In both of the following cases, the data sufficiency criterion is
satisfied and the records are included in a study.</p>
</dd>
</dl>
<ul>
<li>A-1: First time in college (FTIC), so we know their first term is
their entry term (i.e., they are not a continuing student) and we can
determine their TC term.</li>
<li>A-2: Transfer student, and we know their first term in a MIDFIELD
institution. We have no knowledge of how much time was spent
accumulating their pre-MIDFIELD credit hours, but we can estimate a TC
term with respect to their MIDFIELD entry level.</li>
</ul>
<dl>
<dt>Student B</dt>
<dd>
<p>Student B enters in 1993 with a TC term in 1998, two years beyond the
range of the data. We have several possible cases,</p>
</dd>
</dl>
<ul>
<li>B-1: Before the data limit, the student completes their program
(timely and known)</li>
<li>B-2: Before the data limit, the student leaves the data base
(untimely and known)</li>
<li>B-3: After the data limit, the student completes before their TC
term (timely but unknown)</li>
<li>B-4: After the data limit, the student completes after their TC term
or fails to complete (untimely and unknown)</li>
</ul>
<p>Because of unknown outcomes in cases B-3 and B-4, including case B-1
and B-2 invariably produces a miscount of completers and non-completers.
Thus the criterion is not satisfied and student B records are excluded
from the study.</p>
</div>
<div class="section level2">
<h2 id="lower-limit-data-sufficiency">Lower-limit data sufficiency<a class="anchor" aria-label="anchor" href="#lower-limit-data-sufficiency"></a>
</h2>
<p>To determine data sufficiency record exclusions at the lower limit of
the data range, we compare a student’s first term (non-summer) to the
first term of the data range (also non-summer). When these two terms are
identical, the complete unit record is excluded. We illustrate with the
three scenarios described below.</p>
<p><br></p>
<p><img src="../reference/figures/art-010-data-sufficiency-lower.png" style="width:80.0%"></p>
<p><br></p>
<dl>
<dt>Student C</dt>
<dd>
<p>Student C makes their first appearance in the database in a term
following the data lower limit. The conditions for student C (FTIC or
transfer) are identical to those for student A, thus student C is
included in a study.</p>
</dd>
<dt>Student D</dt>
<dd>
<p>Student D enters the institution before the lower limit of the data
range (a “continuing” student) or they enter the institution at the
lower limit precisely.</p>
</dd>
</dl>
<ul>
<li>D-1: If student D is continuing, regardless of status (FTIC or
transfer), making an estimate of their TC term invariably leads to false
counts because we have no knowledge of how much time was spent
accumulating credit hours at their MIDFIELD institution before the lower
data limit. Including D-1 also produces false counts because of student
E (discussed below).</li>
<li>D-2: If student D is not continuing, that is, their first time entry
to a MIDFIELD institution is at the lower data limit (here, 1986), we
would include them in a study if we could. Unfortunately, we cannot
distinguish them from continuing students. Having to exclude D-1
inherently excludes D-2 as well.</li>
</ul>
<dl>
<dt>Student E</dt>
<dd>
<p>Student E enters the institution at the same time as continuing
student D but leaves the database before the data lower limit term.</p>
</dd>
</dl>
<ul>
<li>E-1: Student E did not timely-complete their program. In this case,
if we include student D our count of <em>non-completers</em> is low (E-1
cases are missing), resulting in an inflated ratio of completers to
non-completers.</li>
<li>E-2: Student E did timely-complete their program. Here, if we
include student D our count of <em>completers</em> is low (E-2 cases are
missing), resulting in a diminished ratio of completers to
non-completers.</li>
</ul>
<p>The balance of these two effects is unknowable. Since student E
cannot possibly be included, Student D must also be excluded.</p>
</div>
<div class="section level2">
<h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>The data sufficiency criterion is applied when a metric requires
counting the number of students who complete their programs in a timely
fashion. Specific student unit records at the upper and lower limits of
an institution’s data range must be excluded to prevent false counts due
to insufficient data.</p>
<p>The method for applying the data sufficiency criterion is to exclude
observations that</p>
<ul>
<li>are present in the non-summer lower limit of the institution data
range</li>
<li>have a timely completion term that exceeds the upper limit of the
data range</li>
</ul>
<p>This is the method implemented by
<code><a href="../reference/add_data_sufficiency.html">add_data_sufficiency()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="population">Population<a class="anchor" aria-label="anchor" href="#population"></a>
</h2>
<p>Of the four MIDFIELD data tables, <code>course</code> and
<code>term</code> are the most inclusive, with observations of all
students enrolled in a course in a term. Since <code>term</code> is the
smaller of the two, we generally start an analysis with the term data
frame.</p>
<p>If you are writing your own script to follow along, we start with
these packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing options for data.table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>  datatable.print.nrows <span class="op">=</span> <span class="fl">55</span>,</span>
<span>  datatable.print.topn <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  datatable.print.class <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Importing.</strong> Load the midfielddata data table. Copy
the <code>term</code> data set to create the working data frame
(<code>DT</code>), leaving <code>term</code> unaltered for later
use.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data set from midfielddata</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a working data frame</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Classes 'data.table' and 'data.frame':   710841 obs. of  13 variables:</span></span>
<span><span class="co">#&gt;  $ mcid               : chr  "MID25783135" "MID25783135" "MID25783156" "MID25783156" ...</span></span>
<span><span class="co">#&gt;  $ institution        : chr  "Institution M" "Institution M" "Institution M" "Institution M" ...</span></span>
<span><span class="co">#&gt;  $ term               : chr  "19911" "19913" "20011" "20013" ...</span></span>
<span><span class="co">#&gt;  $ cip6               : chr  "520101" "520101" "040201" "040201" ...</span></span>
<span><span class="co">#&gt;  $ level              : chr  "01 Freshman" "02 Sophomore" "01 Freshman" "02 Sophomore" ...</span></span>
<span><span class="co">#&gt;  $ standing           : chr  "Good Standing" "Good Standing" "Good Standing" "Good Standing" ...</span></span>
<span><span class="co">#&gt;  $ coop               : chr  "No" "No" "No" "No" ...</span></span>
<span><span class="co">#&gt;  $ hours_term         : num  19 14 14 16 16 17 18 18 17 9 ...</span></span>
<span><span class="co">#&gt;  $ hours_term_attempt : num  19 14 14 16 16 17 18 18 17 13 ...</span></span>
<span><span class="co">#&gt;  $ hours_cumul        : num  19 33 14 30 46 63 81 99 17 26 ...</span></span>
<span><span class="co">#&gt;  $ hours_cumul_attempt: num  19 33 14 30 46 63 81 99 17 30 ...</span></span>
<span><span class="co">#&gt;  $ gpa_term           : num  2.47 3.21 3.07 3.62 3.13 3.82 4 3.5 2.53 1.61 ...</span></span>
<span><span class="co">#&gt;  $ gpa_cumul          : num  2.47 2.79 3.07 3.36 3.28 3.42 3.55 3.54 2.53 2.13 ...</span></span>
<span><span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  - attr(*, "index")= int(0)</span></span></code></pre>
<p>The result has 710,841 observations. We will usually note the number
of observations as they change.</p>
<p>To apply the data sufficiency criterion, two variables are required:
a student’s ID and their timely completion term.</p>
<p><strong>Filtering.</strong> For illustrating the functions, we need
start with the ID column only.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retain the minimum number of columns</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>In this form, the data frame will have duplicate rows for the
multiple terms in which a student is enrolled in a program. We filter
unique IDs.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;               mcid</span></span>
<span><span class="co">#&gt;             &lt;char&gt;</span></span>
<span><span class="co">#&gt;     1: MID25783135</span></span>
<span><span class="co">#&gt;     2: MID25783156</span></span>
<span><span class="co">#&gt;     3: MID25783162</span></span>
<span><span class="co">#&gt;     4: MID25783178</span></span>
<span><span class="co">#&gt;     5: MID25783188</span></span>
<span><span class="co">#&gt;    ---            </span></span>
<span><span class="co">#&gt; 94024: MID26697680</span></span>
<span><span class="co">#&gt; 94025: MID26697682</span></span>
<span><span class="co">#&gt; 94026: MID26697685</span></span>
<span><span class="co">#&gt; 94027: MID26697689</span></span>
<span><span class="co">#&gt; 94028: MID26697702</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count unique IDs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">mcid</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 94028</span></span></code></pre>
<p>The result has 94,028 unique observations.</p>
</div>
<div class="section level2">
<h2 id="add_timely_term">
<code>add_timely_term()</code><a class="anchor" aria-label="anchor" href="#add_timely_term"></a>
</h2>
<p>Starting with a data frame of Student Unit Record (SUR) observations
(like <code>DT</code> above) that includes an ID variable, we add a
timely completion term column using <code><a href="../reference/add_timely_term.html">add_timely_term()</a></code>. You
can view the help page by running</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run in Console</span></span>
<span><span class="op">?</span> <span class="va">add_timely_term</span></span></code></pre></div>
<p><strong>Arguments:</strong></p>
<dl>
<dt><code>dframe</code></dt>
<dd>
<p>Data frame of student unit record (SUR) observations keyed by student
ID. Required variable (column) is <code>mcid</code>.</p>
</dd>
<dt><code>midfield_term</code></dt>
<dd>
<p>Data frame of SUR term observations keyed by student ID. Default is
<code>term</code>. Required variables (columns) are <code>mcid</code>,
<code>term</code>, and <code>level</code>.</p>
</dd>
<dt><code>span</code></dt>
<dd>
<p>Optional integer scalar, number of years to define timely completion.
Commonly used values are are 100%, 150%, and 200% of
<code>sched_span</code>. Default 6 years.</p>
</dd>
<dt><code>sched_span</code></dt>
<dd>
<p>Optional integer scalar, the number of years an institution
officially schedules for completing a program. Default 4 years.</p>
</dd>
</dl>
<p><strong>Columns added:</strong></p>
<dl>
<dt><code>term_i</code></dt>
<dd>
<p>Student initial term, encoded YYYYT.</p>
</dd>
<dt><code>level_i</code></dt>
<dd>
<p>Student level (01 Freshman, 02 Sophomore, etc.) in their initial
term.</p>
</dd>
<dt><code>adj_span</code></dt>
<dd>
<p>Integer span of years for timely completion, adjusted for a student’s
initial level</p>
</dd>
<dt><code>timely_term</code></dt>
<dd>
<p>Latest term by which program completion would be considered timely.
Encoded YYYYT.</p>
</dd>
</dl>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display timely term and supporting variables</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;               mcid term_i     level_i adj_span timely_term</span></span>
<span><span class="co">#&gt;             &lt;char&gt; &lt;char&gt;      &lt;char&gt;    &lt;num&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt;     1: MID25783135  19911 01 Freshman        6       19963</span></span>
<span><span class="co">#&gt;     2: MID25783156  20011 01 Freshman        6       20063</span></span>
<span><span class="co">#&gt;     3: MID25783162  19921 01 Freshman        6       19973</span></span>
<span><span class="co">#&gt;     4: MID25783178  19946 01 Freshman        6       20003</span></span>
<span><span class="co">#&gt;     5: MID25783188  19991 01 Freshman        6       20043</span></span>
<span><span class="co">#&gt;    ---                                                    </span></span>
<span><span class="co">#&gt; 94024: MID26697680  20163 01 Freshman        6       20221</span></span>
<span><span class="co">#&gt; 94025: MID26697682  20163 01 Freshman        6       20221</span></span>
<span><span class="co">#&gt; 94026: MID26697685  20151 01 Freshman        6       20203</span></span>
<span><span class="co">#&gt; 94027: MID26697689  20163   04 Senior        3       20191</span></span>
<span><span class="co">#&gt; 94028: MID26697702  20161 01 Freshman        6       20213</span></span></code></pre>
<p><strong>Closer look.</strong> Let’s examine two specific observations
to illustrate.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25783135"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;           mcid term_i     level_i adj_span timely_term</span></span>
<span><span class="co">#&gt;         &lt;char&gt; &lt;char&gt;      &lt;char&gt;    &lt;num&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: MID25783135  19911 01 Freshman        6       19963</span></span></code></pre>
<p>The student’s initial term is Fall 1991 (encoded <code>19911</code>)
and their initial level is <code>01 Freshman</code>. The number of years
to timely completion is 6 years, that is, academic years 1991–92, 92–93,
93–94, 94–95, 95–96, 96–97. Thus their timely completion term is Spring
1997 (encoded <code>19963</code>).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID26697689"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;           mcid term_i   level_i adj_span timely_term</span></span>
<span><span class="co">#&gt;         &lt;char&gt; &lt;char&gt;    &lt;char&gt;    &lt;num&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: MID26697689  20163 04 Senior        3       20191</span></span></code></pre>
<p>The student’s initial term is Spring 2017 (encoded
<code>20163</code>) and their initial level is <code>04 Senior</code>
from which we infer they have completed three years of their program,
yielding an adjusted span of 3 years. Those three years would encompass
terms <code>20163</code>–<code>20171</code>,
<code>20173</code>–<code>20181</code>, and
<code>20183</code>–<code>20191</code>, yielding a timely completion term
of Fall 2019 (encoded <code>20191</code>).</p>
<p><strong>Usage.</strong> The following implementations yield identical
results,</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Required arguments in order and explicitly named</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span>dframe <span class="op">=</span> <span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Required arguments in order, but not named</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using the implicit default for the midfield_term argument</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equality test between the data tables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>In the vignettes, I will typically write required arguments without
names to remind us which midfielddata table is being used, e.g.,</p>
<pre><code><span><span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span></code></pre>
<p>Your term data set can be named something other than
<code>term</code>. For example, if we were working with the “toy”
(exercise) data sets bundled with midfieldr, we would write something
like this,</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using term data named something else</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="va">toy_student</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">toy_DT</span>, <span class="va">toy_term</span><span class="op">)</span></span>
<span><span class="va">toy_DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            mcid term_i      level_i adj_span timely_term</span></span>
<span><span class="co">#&gt;          &lt;char&gt; &lt;char&gt;       &lt;char&gt;    &lt;num&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1: MID25784187  19885  01 Freshman        6       19943</span></span>
<span><span class="co">#&gt;  2: MID25784974  19883 02 Sophomore        5       19931</span></span>
<span><span class="co">#&gt;  3: MID25816209  19881 02 Sophomore        5       19923</span></span>
<span><span class="co">#&gt;  4: MID25819358  19946 02 Sophomore        5       19993</span></span>
<span><span class="co">#&gt;  5: MID25828870  19881  01 Freshman        6       19933</span></span>
<span><span class="co">#&gt; ---                                                     </span></span>
<span><span class="co">#&gt; 95: MID26622664  20081    03 Junior        4       20113</span></span>
<span><span class="co">#&gt; 96: MID26624815  20061  01 Freshman        6       20113</span></span>
<span><span class="co">#&gt; 97: MID26691066  20103  01 Freshman        6       20161</span></span>
<span><span class="co">#&gt; 98: MID26692025  20131    04 Senior        3       20153</span></span>
<span><span class="co">#&gt; 99: MID26692254  20143 02 Sophomore        5       20191</span></span></code></pre>
<p><strong>Caution! Silent overwriting!</strong> Existing columns with
the same names as one of the added columns are deleted and replaced.</p>
<p>Using the toy data to illustrate, I’ll drop the columns added by
timely term except <code>adj_span</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Drop three columns</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="va">toy_DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"term_i"</span>, <span class="st">"level_i"</span>, <span class="st">"timely_term"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">toy_DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            mcid adj_span</span></span>
<span><span class="co">#&gt;          &lt;char&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1: MID25784187        6</span></span>
<span><span class="co">#&gt;  2: MID25784974        5</span></span>
<span><span class="co">#&gt;  3: MID25816209        5</span></span>
<span><span class="co">#&gt;  4: MID25819358        5</span></span>
<span><span class="co">#&gt;  5: MID25828870        6</span></span>
<span><span class="co">#&gt; ---                     </span></span>
<span><span class="co">#&gt; 95: MID26622664        4</span></span>
<span><span class="co">#&gt; 96: MID26624815        6</span></span>
<span><span class="co">#&gt; 97: MID26691066        6</span></span>
<span><span class="co">#&gt; 98: MID26692025        3</span></span>
<span><span class="co">#&gt; 99: MID26692254        5</span></span></code></pre>
<p>Reapplying the function, the <code>adj_span</code> column is silently
deleted and replaced.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">toy_DT</span>, <span class="va">toy_term</span><span class="op">)</span></span>
<span><span class="va">toy_DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            mcid term_i      level_i adj_span timely_term</span></span>
<span><span class="co">#&gt;          &lt;char&gt; &lt;char&gt;       &lt;char&gt;    &lt;num&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1: MID25784187  19885  01 Freshman        6       19943</span></span>
<span><span class="co">#&gt;  2: MID25784974  19883 02 Sophomore        5       19931</span></span>
<span><span class="co">#&gt;  3: MID25816209  19881 02 Sophomore        5       19923</span></span>
<span><span class="co">#&gt;  4: MID25819358  19946 02 Sophomore        5       19993</span></span>
<span><span class="co">#&gt;  5: MID25828870  19881  01 Freshman        6       19933</span></span>
<span><span class="co">#&gt; ---                                                     </span></span>
<span><span class="co">#&gt; 95: MID26622664  20081    03 Junior        4       20113</span></span>
<span><span class="co">#&gt; 96: MID26624815  20061  01 Freshman        6       20113</span></span>
<span><span class="co">#&gt; 97: MID26691066  20103  01 Freshman        6       20161</span></span>
<span><span class="co">#&gt; 98: MID26692025  20131    04 Senior        3       20153</span></span>
<span><span class="co">#&gt; 99: MID26692254  20143 02 Sophomore        5       20191</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="add_data_sufficiency">
<code>add_data_sufficiency()</code><a class="anchor" aria-label="anchor" href="#add_data_sufficiency"></a>
</h2>
<p>Continuing with a data frame of SUR observations, we add the data
sufficiency column using <code><a href="../reference/add_data_sufficiency.html">add_data_sufficiency()</a></code>. You can
view the help page by running</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run in Console</span></span>
<span><span class="op">?</span> <span class="va">add_data_sufficiency</span></span></code></pre></div>
<p><strong>Arguments:</strong></p>
<dl>
<dt><code>dframe</code></dt>
<dd>
<p>Data frame of student unit record (SUR) observations keyed by student
ID. Required variables are <code>mcid</code> and
<code>timely_term</code>.</p>
</dd>
<dt><code>midfield_term</code></dt>
<dd>
<p>Data frame of SUR term observations keyed by student ID. Default is
<code>term</code>. Required variables are <code>mcid</code>,
<code>institution</code>, and <code>term</code>.</p>
</dd>
</dl>
<p><strong>Columns added:</strong></p>
<dl>
<dt><code>term_i</code></dt>
<dd>
<p>Student initial term, encoded YYYYT.</p>
</dd>
<dt><code>lower_limit</code></dt>
<dd>
<p>Initial term of an institution’s data range, encoded YYYYT.</p>
</dd>
<dt><code>upper_limit</code></dt>
<dd>
<p>Final term of an institution’s data range, encoded YYYYT.</p>
</dd>
<dt><code>data_sufficiency</code></dt>
<dd>
<p>Label each observation for inclusion or exclusion based on data
sufficiency: “include”, indicating that available data are sufficient
for estimating timely program completion; “exclude-upper”, indicating
that data are insufficient at the upper limit of a data range; or
“exclude-lower”, indicating that data are insufficient at the lower
limit.</p>
</dd>
</dl>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Drop unnecessary columns</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">timely_term</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display data sufficiency and supporting variables</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;               mcid timely_term term_i lower_limit upper_limit data_sufficiency</span></span>
<span><span class="co">#&gt;             &lt;char&gt;      &lt;char&gt; &lt;char&gt;      &lt;char&gt;      &lt;char&gt;           &lt;char&gt;</span></span>
<span><span class="co">#&gt;     1: MID25783135       19963  19911       19871       20036          include</span></span>
<span><span class="co">#&gt;     2: MID25783156       20063  20011       19871       20036    exclude-upper</span></span>
<span><span class="co">#&gt;     3: MID25783162       19973  19921       19871       20036          include</span></span>
<span><span class="co">#&gt;     4: MID25783178       20003  19946       19871       20036          include</span></span>
<span><span class="co">#&gt;     5: MID25783188       20043  19991       19871       20036    exclude-upper</span></span>
<span><span class="co">#&gt;    ---                                                                        </span></span>
<span><span class="co">#&gt; 94024: MID26697680       20221  20163       20021       20164    exclude-upper</span></span>
<span><span class="co">#&gt; 94025: MID26697682       20221  20163       20021       20164    exclude-upper</span></span>
<span><span class="co">#&gt; 94026: MID26697685       20203  20151       20021       20164    exclude-upper</span></span>
<span><span class="co">#&gt; 94027: MID26697689       20191  20163       20021       20164    exclude-upper</span></span>
<span><span class="co">#&gt; 94028: MID26697702       20213  20161       20021       20164    exclude-upper</span></span></code></pre>
<p><strong>Closer look.</strong> Let’s examine three specific
observations to illustrate. In these excerpts, the data range for the
institution is Fall 1987 to Summer 2003.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Student A</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25783135"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;           mcid timely_term term_i lower_limit upper_limit data_sufficiency</span></span>
<span><span class="co">#&gt;         &lt;char&gt;      &lt;char&gt; &lt;char&gt;      &lt;char&gt;      &lt;char&gt;           &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: MID25783135       19963  19911       19871       20036          include</span></span></code></pre>
<p>The student’s initial term is Fall 1991 so the lower-limit exclusion
does not apply; the student’s timely completion term is Spring 1996, so
the upper-limit exclusion does not apply. The record satisfies the data
sufficiency criterion.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Student B</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25783156"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;           mcid timely_term term_i lower_limit upper_limit data_sufficiency</span></span>
<span><span class="co">#&gt;         &lt;char&gt;      &lt;char&gt; &lt;char&gt;      &lt;char&gt;      &lt;char&gt;           &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: MID25783156       20063  20011       19871       20036    exclude-upper</span></span></code></pre>
<p>The student’s initial term is Fall 2001 so the lower-limit exclusion
does not apply; the student’s timely completion term is Spring 2006, so
the upper-limit exclusion does apply.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Student D</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25783197"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;           mcid timely_term term_i lower_limit upper_limit data_sufficiency</span></span>
<span><span class="co">#&gt;         &lt;char&gt;      &lt;char&gt; &lt;char&gt;      &lt;char&gt;      &lt;char&gt;           &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: MID25783197       19923  19871       19871       20036    exclude-lower</span></span></code></pre>
<p>The student’s initial term is Fall 1987 so the lower-limit exclusion
applies.</p>
<p><strong>Usage.</strong> The following implementations yield identical
results,</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Required arguments in order and explicitly named</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span>dframe <span class="op">=</span> <span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Required arguments in order, but not named</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using the implicit default for the midfield_term argument</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equality test between the data tables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Again, your term data set can be named something other than
<code>term</code>. For example, using the “toy” data sets again,</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using term data named something else</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="va">toy_DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">timely_term</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">toy_DT</span>, <span class="va">toy_term</span><span class="op">)</span></span>
<span><span class="va">toy_DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            mcid timely_term term_i lower_limit upper_limit data_sufficiency</span></span>
<span><span class="co">#&gt;          &lt;char&gt;      &lt;char&gt; &lt;char&gt;      &lt;char&gt;      &lt;char&gt;           &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1: MID25784187       19943  19885       19881       19995          include</span></span>
<span><span class="co">#&gt;  2: MID25784974       19931  19883       19881       19995          include</span></span>
<span><span class="co">#&gt;  3: MID25816209       19923  19881       19881       19995    exclude-lower</span></span>
<span><span class="co">#&gt;  4: MID25819358       19993  19946       19881       19995          include</span></span>
<span><span class="co">#&gt;  5: MID25828870       19933  19881       19881       19995    exclude-lower</span></span>
<span><span class="co">#&gt; ---                                                                        </span></span>
<span><span class="co">#&gt; 95: MID26622664       20113  20081       19881       20081    exclude-upper</span></span>
<span><span class="co">#&gt; 96: MID26624815       20113  20061       19881       20081    exclude-upper</span></span>
<span><span class="co">#&gt; 97: MID26691066       20161  20103       20103       20143    exclude-lower</span></span>
<span><span class="co">#&gt; 98: MID26692025       20153  20131       20103       20143    exclude-upper</span></span>
<span><span class="co">#&gt; 99: MID26692254       20191  20143       20103       20143    exclude-upper</span></span></code></pre>
<p><strong>Caution! Silent overwriting!</strong> In this case, existing
columns with the same name as one of the added columns are deleted and
replaced except for <code>term_i</code>.</p>
<p>Using the toy data to illustrate, I’ll drop the columns added by data
sufficiency except <code>upper_limit</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Drop three columns</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="va">toy_DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lower_limit"</span>, <span class="st">"data_sufficiency"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">toy_DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            mcid timely_term term_i upper_limit</span></span>
<span><span class="co">#&gt;          &lt;char&gt;      &lt;char&gt; &lt;char&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1: MID25784187       19943  19885       19995</span></span>
<span><span class="co">#&gt;  2: MID25784974       19931  19883       19995</span></span>
<span><span class="co">#&gt;  3: MID25816209       19923  19881       19995</span></span>
<span><span class="co">#&gt;  4: MID25819358       19993  19946       19995</span></span>
<span><span class="co">#&gt;  5: MID25828870       19933  19881       19995</span></span>
<span><span class="co">#&gt; ---                                           </span></span>
<span><span class="co">#&gt; 95: MID26622664       20113  20081       20081</span></span>
<span><span class="co">#&gt; 96: MID26624815       20113  20061       20081</span></span>
<span><span class="co">#&gt; 97: MID26691066       20161  20103       20143</span></span>
<span><span class="co">#&gt; 98: MID26692025       20153  20131       20143</span></span>
<span><span class="co">#&gt; 99: MID26692254       20191  20143       20143</span></span></code></pre>
<p>Reapplying the function, the <code>term_i</code> column is silently
overwritten and the other three columns added as before.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">toy_DT</span>, <span class="va">toy_term</span><span class="op">)</span></span>
<span><span class="va">toy_DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            mcid timely_term term_i lower_limit upper_limit data_sufficiency</span></span>
<span><span class="co">#&gt;          &lt;char&gt;      &lt;char&gt; &lt;char&gt;      &lt;char&gt;      &lt;char&gt;           &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1: MID25784187       19943  19885       19881       19995          include</span></span>
<span><span class="co">#&gt;  2: MID25784974       19931  19883       19881       19995          include</span></span>
<span><span class="co">#&gt;  3: MID25816209       19923  19881       19881       19995    exclude-lower</span></span>
<span><span class="co">#&gt;  4: MID25819358       19993  19946       19881       19995          include</span></span>
<span><span class="co">#&gt;  5: MID25828870       19933  19881       19881       19995    exclude-lower</span></span>
<span><span class="co">#&gt; ---                                                                        </span></span>
<span><span class="co">#&gt; 95: MID26622664       20113  20081       19881       20081    exclude-upper</span></span>
<span><span class="co">#&gt; 96: MID26624815       20113  20061       19881       20081    exclude-upper</span></span>
<span><span class="co">#&gt; 97: MID26691066       20161  20103       20103       20143    exclude-lower</span></span>
<span><span class="co">#&gt; 98: MID26692025       20153  20131       20103       20143    exclude-upper</span></span>
<span><span class="co">#&gt; 99: MID26692254       20191  20143       20103       20143    exclude-upper</span></span></code></pre>
<p><strong>Filtering.</strong> In most cases, we retain only those
observations for which the data are sufficient.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply the data sufficiency criterion</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">data_sufficiency</span> <span class="op">==</span> <span class="st">"include"</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;               mcid timely_term term_i lower_limit upper_limit data_sufficiency</span></span>
<span><span class="co">#&gt;             &lt;char&gt;      &lt;char&gt; &lt;char&gt;      &lt;char&gt;      &lt;char&gt;           &lt;char&gt;</span></span>
<span><span class="co">#&gt;     1: MID25783135       19963  19911       19871       20036          include</span></span>
<span><span class="co">#&gt;     2: MID25783162       19973  19921       19871       20036          include</span></span>
<span><span class="co">#&gt;     3: MID25783178       20003  19946       19871       20036          include</span></span>
<span><span class="co">#&gt;     4: MID25783195       19983  19931       19871       20036          include</span></span>
<span><span class="co">#&gt;     5: MID25783220       20023  19971       19871       20036          include</span></span>
<span><span class="co">#&gt;    ---                                                                        </span></span>
<span><span class="co">#&gt; 63948: MID26697574       20113  20091       20021       20164          include</span></span>
<span><span class="co">#&gt; 63949: MID26697576       20153  20101       20021       20164          include</span></span>
<span><span class="co">#&gt; 63950: MID26697599       20153  20101       20021       20164          include</span></span>
<span><span class="co">#&gt; 63951: MID26697615       20153  20101       20021       20164          include</span></span>
<span><span class="co">#&gt; 63952: MID26697623       20153  20101       20021       20164          include</span></span></code></pre>
<p>The result has 63,952 unique observations.</p>
</div>
<div class="section level2">
<h2 id="closing">Closing<a class="anchor" aria-label="anchor" href="#closing"></a>
</h2>
<p>To prepare for applying the data sufficiency criterion, we first
estimate students’ timely completion terms using
<code><a href="../reference/add_timely_term.html">add_timely_term()</a></code>. We then label observations for inclusion
and exclusion using <code><a href="../reference/add_data_sufficiency.html">add_data_sufficiency()</a></code>.</p>
<p>Subsetting a population for data sufficiency is typically the first
filter applied to SUR data.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Dowle+Srinivasan:2021:data.table" class="csl-entry">
Dowle, M., &amp; Srinivasan, A. (2021). <em><span class="nocase">data.table: Extension of data.frame</span></em>.
R package version 1.14.2. <a href="https://CRAN.R-project.org/package=data.table" class="external-link">https://CRAN.R-project.org/package=data.table</a>
</div>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<p>We conclude each vignette by collecting its code chunks in a single,
condensed script for the convenience of those who wish to copy it into
their own R file.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing options for data.table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>  datatable.print.nrows <span class="op">=</span> <span class="fl">55</span>,</span>
<span>  datatable.print.topn <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  datatable.print.class <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data set from midfielddata</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Timely completion term</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25783135"</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID26697689"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Equivalent statements</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span>dframe <span class="op">=</span> <span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using term data named something else</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="va">toy_student</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">toy_DT</span>, <span class="va">toy_term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Silent overwriting</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="va">toy_DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"term_i"</span>, <span class="st">"level_i"</span>, <span class="st">"timely_term"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">toy_DT</span>, <span class="va">toy_term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data sufficiency</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">timely_term</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25783135"</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25783156"</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25783197"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Equivalent statements</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span>dframe <span class="op">=</span> <span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using term data named something else</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="va">toy_DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">timely_term</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">toy_DT</span>, <span class="va">toy_term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Silent overwriting</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="va">toy_DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lower_limit"</span>, <span class="st">"data_sufficiency"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">toy_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">toy_DT</span>, <span class="va">toy_term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply the data sufficiency criterion</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">data_sufficiency</span> <span class="op">==</span> <span class="st">"include"</span><span class="op">]</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/graphdr" class="external-link">Richard Layton</a>, Russell Long, Matthew Ohland, Marisa Orr, Susan Lord, US National Science Foundation.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
