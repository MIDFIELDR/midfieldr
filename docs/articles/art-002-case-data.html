<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="midfieldr">
<title>Case study: Data • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case study: Data">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="https://midfieldr.github.io/midfieldr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">midfieldr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9024</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/art-000-getting-started.html">Getting started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-study">Case study</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-study">
    <a class="dropdown-item" href="../articles/art-001-case-goals.html">Goals</a>
    <a class="dropdown-item" href="../articles/art-002-case-data.html">Data</a>
    <a class="dropdown-item" href="../articles/art-003-case-results.html">Results</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/art-010-data-sufficiency.html">Data sufficiency</a>
    <a class="dropdown-item" href="../articles/art-020-degree-seeking.html">Degree seeking (inner joins)</a>
    <a class="dropdown-item" href="../articles/art-030-programs.html">Programs</a>
    <a class="dropdown-item" href="../articles/art-040-completion.html">Completion status</a>
    <a class="dropdown-item" href="../articles/art-050-demographics.html">Demographics (left outer joins)</a>
    <a class="dropdown-item" href="../articles/art-060-multiway.html">Multiway data and chatrs</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MIDFIELDR/midfieldr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Case study: Data</h1>
            
            <h4 data-toc-skip class="date">2022-07-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/HEAD/vignettes/art-002-case-data.Rmd" class="external-link"><code>vignettes/art-002-case-data.Rmd</code></a></small>
      <div class="d-none name"><code>art-002-case-data.Rmd</code></div>
    </div>

    
    
<p>Part 2 of a case study in three parts:</p>
<ul>
<li>
<a href="art-001-case-goals.html">Goals.</a> Describing the study
parameters.<br>
</li>
<li>
<a href="art-002-case-data.html">Data.</a> Transforming the data to
yield the observations of interest.</li>
<li>
<a href="art-003-case-results.html">Results.</a> Calculating summary
statistics and metrics and displaying the results.</li>
</ul>
<p>In this part, we use the midfieldr functions:</p>
<ul>
<li><code><a href="../reference/add_completion_status.html">add_completion_status()</a></code></li>
<li><code><a href="../reference/add_data_sufficiency.html">add_data_sufficiency()</a></code></li>
<li><code><a href="../reference/add_timely_term.html">add_timely_term()</a></code></li>
<li><code><a href="../reference/filter_search.html">filter_search()</a></code></li>
</ul>
<div class="section level2">
<h2 id="preface">Preface<a class="anchor" aria-label="anchor" href="#preface"></a>
</h2>
<p>Our data processing goal is to reduce the source data tables to the
specific observations needed to compute our metrics. The data processing
tasks include a combination of filtering observations (rows), creating,
renaming, and recoding variables (columns), and joining data frames.</p>
<p>The analysis is organized to produce two data frames—students ever
enrolled in the programs and students graduating from the programs—that
are joined and written to file as a starting point for the next section
of the case study.</p>
<p>If you are writing your own script to follow along, we start with
these packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span><span class="op">)</span>

<span class="co"># Printing options for data.table</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>
  datatable.print.nrows <span class="op">=</span> <span class="fl">15</span>,
  datatable.print.topn <span class="op">=</span> <span class="fl">5</span>,
  datatable.print.class <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-data">Import data<a class="anchor" aria-label="anchor" href="#import-data"></a>
</h2>
<p>All MIDFIELD data are in block-record form, that is, every row is an
observation (keyed by student ID) and every column is a variable. Data
structure is explored in greater detail in the <a href="art-000-getting-started.html">Getting started</a> vignette.</p>
<p><strong>Importing.</strong> Load three of the midfielddata data
tables.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load three data sets from midfielddata</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span>, <span class="va">degree</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gather-ever-enrolled">Gather ever enrolled<a class="anchor" aria-label="anchor" href="#gather-ever-enrolled"></a>
</h2>
<p><strong>Copying.</strong> Copy the <code>term</code> data set to
create the working data frame (<code>DT</code>), leaving
<code>term</code> unaltered for later use.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a working data frame</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt; Classes 'data.table' and 'data.frame':   710841 obs. of  13 variables:</span>
<span class="co">#&gt;  $ mcid               : chr  "MID25783135" "MID25783135" "MID25783156" "MID25783156" ...</span>
<span class="co">#&gt;  $ institution        : chr  "Institution M" "Institution M" "Institution M" "Institution M" ...</span>
<span class="co">#&gt;  $ term               : chr  "19911" "19913" "20011" "20013" ...</span>
<span class="co">#&gt;  $ cip6               : chr  "520101" "520101" "040201" "040201" ...</span>
<span class="co">#&gt;  $ level              : chr  "01 Freshman" "02 Sophomore" "01 Freshman" "02 Sophomore" ...</span>
<span class="co">#&gt;  $ standing           : chr  "Good Standing" "Good Standing" "Good Standing" "Good Standing" ...</span>
<span class="co">#&gt;  $ coop               : chr  "No" "No" "No" "No" ...</span>
<span class="co">#&gt;  $ hours_term         : num  19 14 14 16 16 17 18 18 17 9 ...</span>
<span class="co">#&gt;  $ hours_term_attempt : num  19 14 14 16 16 17 18 18 17 13 ...</span>
<span class="co">#&gt;  $ hours_cumul        : num  19 33 14 30 46 63 81 99 17 26 ...</span>
<span class="co">#&gt;  $ hours_cumul_attempt: num  19 33 14 30 46 63 81 99 17 30 ...</span>
<span class="co">#&gt;  $ gpa_term           : num  2.47 3.21 3.07 3.62 3.13 3.82 4 3.5 2.53 1.61 ...</span>
<span class="co">#&gt;  $ gpa_cumul          : num  2.47 2.79 3.07 3.36 3.28 3.42 3.55 3.54 2.53 2.13 ...</span>
<span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt; </span>
<span class="co">#&gt;  - attr(*, "index")= int(0)</span></code></pre>
<p>The result has 710,841 observations. We will usually note the number
of observations as they change.</p>
<p><strong>Filtering.</strong> In this study, only two variables from
the <code>term</code> data are needed to start: student ID
<code>mcid</code> and program code <code>cip6</code>. We drop
unnecessary columns then remove duplicate rows such that we have unique
combinations of student ID and program CIP.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Minimize the dimensions of the data</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;                mcid   cip6</span>
<span class="co">#&gt;              &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 520101</span>
<span class="co">#&gt;      2: MID25783156 040201</span>
<span class="co">#&gt;      3: MID25783162 140102</span>
<span class="co">#&gt;      4: MID25783162 520301</span>
<span class="co">#&gt;      5: MID25783162 521401</span>
<span class="co">#&gt;     ---                   </span>
<span class="co">#&gt; 161692: MID26697682 240101</span>
<span class="co">#&gt; 161693: MID26697685 300000</span>
<span class="co">#&gt; 161694: MID26697685 521201</span>
<span class="co">#&gt; 161695: MID26697689 240101</span>
<span class="co">#&gt; 161696: MID26697702 240101</span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Count unique IDs</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">mcid</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt; [1] 94028</span></code></pre>
<p>The result has 161,696 observations of 94,028 unique students. The
number of unique students is smaller than the number of observations
because some students change programs over their course of study. Here
we have one row per unique combination of student (<code>mcid</code>)
and program code (<code>cip6</code>).</p>
<p>In this form, the data are bundled with midfieldr as the
<code>study_pool</code> data set. You can view its help page by
running</p>
<pre><code><span class="co"># Run in Console to view help page</span>
<span class="op">?</span> <span class="va">study_pool</span></code></pre>
</div>
<div class="section level2">
<h2 id="filter-for-data-sufficiency">Filter for data sufficiency<a class="anchor" aria-label="anchor" href="#filter-for-data-sufficiency"></a>
</h2>
<p>Some student records near the lower and upper terms that bound the
available data must be excluded to prevent false summaries involving
timely program completion. To apply this filter, we determine the timely
completion term then data sufficiency.</p>
<p><strong>Creating variables.</strong> Using information in
<code>term</code>, we add the <code>timely_term</code> variable as well
as supporting variables used in its construction.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate a timely completion term for every student</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;                mcid   cip6 term_i     level_i adj_span timely_term</span>
<span class="co">#&gt;              &lt;char&gt; &lt;char&gt; &lt;char&gt;      &lt;char&gt;    &lt;num&gt;      &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 520101  19911 01 Freshman        6       19963</span>
<span class="co">#&gt;      2: MID25783156 040201  20011 01 Freshman        6       20063</span>
<span class="co">#&gt;      3: MID25783162 140102  19921 01 Freshman        6       19973</span>
<span class="co">#&gt;      4: MID25783162 520301  19921 01 Freshman        6       19973</span>
<span class="co">#&gt;      5: MID25783162 521401  19921 01 Freshman        6       19973</span>
<span class="co">#&gt;     ---                                                           </span>
<span class="co">#&gt; 161692: MID26697682 240101  20163 01 Freshman        6       20221</span>
<span class="co">#&gt; 161693: MID26697685 300000  20151 01 Freshman        6       20203</span>
<span class="co">#&gt; 161694: MID26697685 521201  20151 01 Freshman        6       20203</span>
<span class="co">#&gt; 161695: MID26697689 240101  20163   04 Senior        3       20191</span>
<span class="co">#&gt; 161696: MID26697702 240101  20161 01 Freshman        6       20213</span></code></pre>
<p>You may view the function’s help page by running</p>
<pre><code><span class="op">?</span> <span class="va">add_timely_term</span></code></pre>
<p><strong>Creating variables.</strong> Using information in
<code>term</code>, we add the <code>data_sufficiency</code> variable as
well as supporting variables used in its construction.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Determine data sufficiency for every student</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;                mcid   cip6     level_i adj_span timely_term term_i lower_limit</span>
<span class="co">#&gt;              &lt;char&gt; &lt;char&gt;      &lt;char&gt;    &lt;num&gt;      &lt;char&gt; &lt;char&gt;      &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 520101 01 Freshman        6       19963  19911       19871</span>
<span class="co">#&gt;      2: MID25783156 040201 01 Freshman        6       20063  20011       19871</span>
<span class="co">#&gt;      3: MID25783162 140102 01 Freshman        6       19973  19921       19871</span>
<span class="co">#&gt;      4: MID25783162 520301 01 Freshman        6       19973  19921       19871</span>
<span class="co">#&gt;      5: MID25783162 521401 01 Freshman        6       19973  19921       19871</span>
<span class="co">#&gt;     ---                                                                       </span>
<span class="co">#&gt; 161692: MID26697682 240101 01 Freshman        6       20221  20163       20021</span>
<span class="co">#&gt; 161693: MID26697685 300000 01 Freshman        6       20203  20151       20021</span>
<span class="co">#&gt; 161694: MID26697685 521201 01 Freshman        6       20203  20151       20021</span>
<span class="co">#&gt; 161695: MID26697689 240101   04 Senior        3       20191  20163       20021</span>
<span class="co">#&gt; 161696: MID26697702 240101 01 Freshman        6       20213  20161       20021</span>
<span class="co">#&gt;         upper_limit data_sufficiency</span>
<span class="co">#&gt;              &lt;char&gt;           &lt;char&gt;</span>
<span class="co">#&gt;      1:       20036          include</span>
<span class="co">#&gt;      2:       20036    exclude-upper</span>
<span class="co">#&gt;      3:       20036          include</span>
<span class="co">#&gt;      4:       20036          include</span>
<span class="co">#&gt;      5:       20036          include</span>
<span class="co">#&gt;     ---                             </span>
<span class="co">#&gt; 161692:       20164    exclude-upper</span>
<span class="co">#&gt; 161693:       20164    exclude-upper</span>
<span class="co">#&gt; 161694:       20164    exclude-upper</span>
<span class="co">#&gt; 161695:       20164    exclude-upper</span>
<span class="co">#&gt; 161696:       20164    exclude-upper</span></code></pre>
<p>You may view the function’s help page by running</p>
<pre><code><span class="op">?</span> <span class="va">add_data_sufficiency</span></code></pre>
<p><strong>Filtering.</strong> We filter to retain observations for
which the data are sufficient then drop unnecessary columns.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain observations having sufficient data</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">data_sufficiency</span> <span class="op">==</span> <span class="st">"include"</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;                mcid   cip6</span>
<span class="co">#&gt;              &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 520101</span>
<span class="co">#&gt;      2: MID25783162 140102</span>
<span class="co">#&gt;      3: MID25783162 520301</span>
<span class="co">#&gt;      4: MID25783162 521401</span>
<span class="co">#&gt;      5: MID25783178 140102</span>
<span class="co">#&gt;     ---                   </span>
<span class="co">#&gt; 111928: MID26697576 521401</span>
<span class="co">#&gt; 111929: MID26697599 110401</span>
<span class="co">#&gt; 111930: MID26697599 521201</span>
<span class="co">#&gt; 111931: MID26697615 500901</span>
<span class="co">#&gt; 111932: MID26697623 451001</span></code></pre>
<p>The result has 111,932 observations of 63,952 unique students.</p>
</div>
<div class="section level2">
<h2 id="filter-for-degree-seeking">Filter for degree-seeking<a class="anchor" aria-label="anchor" href="#filter-for-degree-seeking"></a>
</h2>
<p>In studying stickiness, we exclude non-degree-seeking students. We
filter such students using the <code>student</code> data which contains
only degree seeking students.</p>
<p><strong>Filtering.</strong> An inner join with <code>student</code>
that returns rows with matching IDs from both data frames, then selected
columns.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Inner join that filters DT</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">student</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;                mcid   cip6</span>
<span class="co">#&gt;              &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 520101</span>
<span class="co">#&gt;      2: MID25783162 140102</span>
<span class="co">#&gt;      3: MID25783162 520301</span>
<span class="co">#&gt;      4: MID25783162 521401</span>
<span class="co">#&gt;      5: MID25783178 140102</span>
<span class="co">#&gt;     ---                   </span>
<span class="co">#&gt; 111928: MID26697576 521401</span>
<span class="co">#&gt; 111929: MID26697599 110401</span>
<span class="co">#&gt; 111930: MID26697599 521201</span>
<span class="co">#&gt; 111931: MID26697615 500901</span>
<span class="co">#&gt; 111932: MID26697623 451001</span></code></pre>
<p>The result has 111,932 observations. (No change is expected in this
example because all students in the midfielddata practice data are
degree-seeking.)</p>
</div>
<div class="section level2">
<h2 id="filter-by-program">Filter by program<a class="anchor" aria-label="anchor" href="#filter-by-program"></a>
</h2>
<p>To filter by program, we have to construct a data frame of labels for
our four engineering programs keyed by the US <em>Classification of
Instructional Programs</em> (CIP) codes. These codes are bundled with
midfieldr in the <code>cip</code> data set.</p>
<p>The <code>cip6</code> variable in our data is the 6-digit code for
programs in which students are enrolled in a given term.</p>
<p>Having already searched the <code>cip</code> data set for our
programs, we report the results: Civil Engineering CIPs start with 1408,
Electrical Engineering 1410, Mechanical Engineering 1419, and
Industrial/Systems Engineering 1427, 1435, 1436, and 1437.</p>
<p><strong>Filtering</strong> Gather the 6-digit CIP codes for the
programs in the case study. Drop unnecessary variables. We keep the
<code>cip4name</code> because, in engineering at least, the 4-digit name
tends to be a disciplinary or departmental name.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Gather program CIP codes</span>
<span class="va">study_program</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_search.html">filter_search</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"^1408"</span>, <span class="st">"^1410"</span>, <span class="st">"^1419"</span>, <span class="st">"^1427"</span>, <span class="st">"^1435"</span>, <span class="st">"^1436"</span>, <span class="st">"^1437"</span><span class="op">)</span><span class="op">)</span>
<span class="va">study_program</span> <span class="op">&lt;-</span> <span class="va">study_program</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip6</span>, <span class="va">cip4name</span><span class="op">)</span><span class="op">]</span>
<span class="va">study_program</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;       cip6                                               cip4name</span>
<span class="co">#&gt;     &lt;char&gt;                                                 &lt;char&gt;</span>
<span class="co">#&gt;  1: 140801                                      Civil Engineering</span>
<span class="co">#&gt;  2: 140802                                      Civil Engineering</span>
<span class="co">#&gt;  3: 140803                                      Civil Engineering</span>
<span class="co">#&gt;  4: 140804                                      Civil Engineering</span>
<span class="co">#&gt;  5: 140805                                      Civil Engineering</span>
<span class="co">#&gt;  6: 140899                                      Civil Engineering</span>
<span class="co">#&gt;  7: 141001 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  8: 141003 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  9: 141004 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 10: 141099 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 11: 141901                                 Mechanical Engineering</span>
<span class="co">#&gt; 12: 142701                                    Systems Engineering</span>
<span class="co">#&gt; 13: 143501                                 Industrial Engineering</span>
<span class="co">#&gt; 14: 143601                              Manufacturing Engineering</span>
<span class="co">#&gt; 15: 143701                                    Operations Research</span></code></pre>
<p>You may view the function’s help page by running</p>
<pre><code><span class="op">?</span> <span class="va">filter_search</span></code></pre>
<p><strong>Creating variables.</strong> Add a variable to label each of
these 15 programs with one of the four conventional program
abbreviations we will use in comparing metrics, i.e., Civil (CE),
Electrical (EE), Mechanical (ME), and Industrial/Systems Engineering
(ISE).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Assign four program names by CIP code</span>
<span class="va">study_program</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span>
  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1408"</span>, <span class="st">"CE"</span>,
  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1410"</span>, <span class="st">"EE"</span>,
  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1419"</span>, <span class="st">"ME"</span>,
  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"142701"</span>, <span class="st">"143501"</span>, <span class="st">"143601"</span>, <span class="st">"143701"</span><span class="op">)</span>, <span class="st">"ISE"</span>
<span class="op">)</span><span class="op">]</span>

<span class="co"># Confirm that abbreviations match the longer program names</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">study_program</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip4name</span>, <span class="va">program</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt;                                                   cip4name program</span>
<span class="co">#&gt;                                                     &lt;char&gt;  &lt;char&gt;</span>
<span class="co">#&gt;  1:                                      Civil Engineering      CE</span>
<span class="co">#&gt;  2:                                      Civil Engineering      CE</span>
<span class="co">#&gt;  3:                                      Civil Engineering      CE</span>
<span class="co">#&gt;  4:                                      Civil Engineering      CE</span>
<span class="co">#&gt;  5:                                      Civil Engineering      CE</span>
<span class="co">#&gt;  6:                                      Civil Engineering      CE</span>
<span class="co">#&gt;  7: Electrical, Electronics and Communications Engineering      EE</span>
<span class="co">#&gt;  8: Electrical, Electronics and Communications Engineering      EE</span>
<span class="co">#&gt;  9: Electrical, Electronics and Communications Engineering      EE</span>
<span class="co">#&gt; 10: Electrical, Electronics and Communications Engineering      EE</span>
<span class="co">#&gt; 11:                                 Mechanical Engineering      ME</span>
<span class="co">#&gt; 12:                                    Systems Engineering     ISE</span>
<span class="co">#&gt; 13:                                 Industrial Engineering     ISE</span>
<span class="co">#&gt; 14:                              Manufacturing Engineering     ISE</span>
<span class="co">#&gt; 15:                                    Operations Research     ISE</span></code></pre>
<p><strong>Joining.</strong> Having checked that the new abbreviations
correctly represent the programs, we join the program names to the
working data frame using a left-outer join and return selected rows.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Left-outer join to DT</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">study_program</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span>, <span class="va">program</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;                mcid   cip6 program</span>
<span class="co">#&gt;              &lt;char&gt; &lt;char&gt;  &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 520101    &lt;NA&gt;</span>
<span class="co">#&gt;      2: MID25783162 140102    &lt;NA&gt;</span>
<span class="co">#&gt;      3: MID25783162 520301    &lt;NA&gt;</span>
<span class="co">#&gt;      4: MID25783162 521401    &lt;NA&gt;</span>
<span class="co">#&gt;      5: MID25783178 140102    &lt;NA&gt;</span>
<span class="co">#&gt;     ---                           </span>
<span class="co">#&gt; 111928: MID26697576 521401    &lt;NA&gt;</span>
<span class="co">#&gt; 111929: MID26697599 110401    &lt;NA&gt;</span>
<span class="co">#&gt; 111930: MID26697599 521201    &lt;NA&gt;</span>
<span class="co">#&gt; 111931: MID26697615 500901    &lt;NA&gt;</span>
<span class="co">#&gt; 111932: MID26697623 451001    &lt;NA&gt;</span></code></pre>
<p><strong>Filtering.</strong> All instances of NA programs are
dropped.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain observations in our four programs</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;              mcid   cip6 program</span>
<span class="co">#&gt;            &lt;char&gt; &lt;char&gt;  &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178 143501     ISE</span>
<span class="co">#&gt;    2: MID25783441 140801      CE</span>
<span class="co">#&gt;    3: MID25783491 141001      EE</span>
<span class="co">#&gt;    4: MID25783912 143501     ISE</span>
<span class="co">#&gt;    5: MID25784025 141901      ME</span>
<span class="co">#&gt;   ---                           </span>
<span class="co">#&gt; 7657: MID26696958 141901      ME</span>
<span class="co">#&gt; 7658: MID26696967 141901      ME</span>
<span class="co">#&gt; 7659: MID26697163 141901      ME</span>
<span class="co">#&gt; 7660: MID26697444 141901      ME</span>
<span class="co">#&gt; 7661: MID26697447 141001      EE</span></code></pre>
<p>The result has 7661 observations of 7133 unique students.</p>
<p><strong>Filtering.</strong> A program label can be associated with
multiple CIP codes. We drop the code and filter to remove duplicates to
ensure unique combinations of ID and program.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Drop duplicate rows</span>
<span class="va">DT</span><span class="op">[</span>, <span class="va">cip6</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;              mcid program</span>
<span class="co">#&gt;            &lt;char&gt;  &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178     ISE</span>
<span class="co">#&gt;    2: MID25783441      CE</span>
<span class="co">#&gt;    3: MID25783491      EE</span>
<span class="co">#&gt;    4: MID25783912     ISE</span>
<span class="co">#&gt;    5: MID25784025      ME</span>
<span class="co">#&gt;   ---                    </span>
<span class="co">#&gt; 7656: MID26696958      ME</span>
<span class="co">#&gt; 7657: MID26696967      ME</span>
<span class="co">#&gt; 7658: MID26697163      ME</span>
<span class="co">#&gt; 7659: MID26697444      ME</span>
<span class="co">#&gt; 7660: MID26697447      EE</span></code></pre>
<p>The result has 7660 observations of 7133 unique students.</p>
<p><strong>Creating variables.</strong> Add a variable to label this
group as “ever” enrolled to distinguish them from the group of graduates
to be created next. Copy the data frame to a new name to save for
later.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Conclude development of the ever-enrolled observations</span>
<span class="va">ever</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">ever</span><span class="op">[</span>, <span class="va">group</span> <span class="op">:=</span> <span class="st">"ever"</span><span class="op">]</span>
<span class="va">ever</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;              mcid program  group</span>
<span class="co">#&gt;            &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178     ISE   ever</span>
<span class="co">#&gt;    2: MID25783441      CE   ever</span>
<span class="co">#&gt;    3: MID25783491      EE   ever</span>
<span class="co">#&gt;    4: MID25783912     ISE   ever</span>
<span class="co">#&gt;    5: MID25784025      ME   ever</span>
<span class="co">#&gt;   ---                           </span>
<span class="co">#&gt; 7656: MID26696958      ME   ever</span>
<span class="co">#&gt; 7657: MID26696967      ME   ever</span>
<span class="co">#&gt; 7658: MID26697163      ME   ever</span>
<span class="co">#&gt; 7659: MID26697444      ME   ever</span>
<span class="co">#&gt; 7660: MID26697447      EE   ever</span></code></pre>
</div>
<div class="section level2">
<h2 id="gather-graduate-subset">Gather graduate subset<a class="anchor" aria-label="anchor" href="#gather-graduate-subset"></a>
</h2>
<p><strong>Filtering.</strong> Students potentially counted as graduates
must be a subset of those in the ever enrolled population. We
re-initialize the working data frame, retaining unique IDs only.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Unique IDs of students ever enrolled in the study programs</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;              mcid</span>
<span class="co">#&gt;            &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178</span>
<span class="co">#&gt;    2: MID25783441</span>
<span class="co">#&gt;    3: MID25783491</span>
<span class="co">#&gt;    4: MID25783912</span>
<span class="co">#&gt;    5: MID25784025</span>
<span class="co">#&gt;   ---            </span>
<span class="co">#&gt; 7129: MID26696958</span>
<span class="co">#&gt; 7130: MID26696967</span>
<span class="co">#&gt; 7131: MID26697163</span>
<span class="co">#&gt; 7132: MID26697444</span>
<span class="co">#&gt; 7133: MID26697447</span></code></pre>
<p><strong>Filtering.</strong> An inner join with <code>degree</code>
that returns rows with matching IDs from both data frames, then selected
columns.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Inner join that filters DT</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">degree</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;              mcid   cip6</span>
<span class="co">#&gt;            &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178 143501</span>
<span class="co">#&gt;    2: MID25783441 140801</span>
<span class="co">#&gt;    3: MID25783491 141001</span>
<span class="co">#&gt;    4: MID25783912 143501</span>
<span class="co">#&gt;    5: MID25784489 140801</span>
<span class="co">#&gt;   ---                   </span>
<span class="co">#&gt; 5386: MID26696771 141001</span>
<span class="co">#&gt; 5387: MID26696967 141901</span>
<span class="co">#&gt; 5388: MID26697163 141901</span>
<span class="co">#&gt; 5389: MID26697444 240199</span>
<span class="co">#&gt; 5390: MID26697447 141001</span></code></pre>
<p>The result has 5390 observations of 5390 unique students. These IDs
have already been filtered for data sufficiency and degree-seeking.</p>
</div>
<div class="section level2">
<h2 id="filter-by-completion-status">Filter by completion status<a class="anchor" aria-label="anchor" href="#filter-by-completion-status"></a>
</h2>
<p>To be counted as a graduate in the stickiness metric, a student must
complete their program in a timely manner (default 6 years after
admission, with reduced spans for some transfer students).</p>
<p><strong>Add variables.</strong> Completion status requires the timely
completion term variable.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate a timely completion term for every student</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;              mcid   cip6 term_i      level_i adj_span timely_term</span>
<span class="co">#&gt;            &lt;char&gt; &lt;char&gt; &lt;char&gt;       &lt;char&gt;    &lt;num&gt;      &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178 143501  19946  01 Freshman        6       20003</span>
<span class="co">#&gt;    2: MID25783441 140801  19921  01 Freshman        6       19973</span>
<span class="co">#&gt;    3: MID25783491 141001  19961  01 Freshman        6       20013</span>
<span class="co">#&gt;    4: MID25783912 143501  19971  01 Freshman        6       20023</span>
<span class="co">#&gt;    5: MID25784489 140801  19891  01 Freshman        6       19943</span>
<span class="co">#&gt;   ---                                                            </span>
<span class="co">#&gt; 5386: MID26696771 141001  20101 02 Sophomore        5       20143</span>
<span class="co">#&gt; 5387: MID26696967 141901  20101  01 Freshman        6       20153</span>
<span class="co">#&gt; 5388: MID26697163 141901  20101 02 Sophomore        5       20143</span>
<span class="co">#&gt; 5389: MID26697444 240199  20101  01 Freshman        6       20153</span>
<span class="co">#&gt; 5390: MID26697447 141001  20111  01 Freshman        6       20163</span></code></pre>
<p><strong>Creating variables.</strong> Using information in
<code>degree</code>, we add the <code>completion_status</code> variable
as well as supporting variables used in its construction.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Determine program completion status for every student</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_completion_status.html">add_completion_status</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">degree</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;              mcid   cip6 term_i      level_i adj_span timely_term term_degree</span>
<span class="co">#&gt;            &lt;char&gt; &lt;char&gt; &lt;char&gt;       &lt;char&gt;    &lt;num&gt;      &lt;char&gt;      &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178 143501  19946  01 Freshman        6       20003       20001</span>
<span class="co">#&gt;    2: MID25783441 140801  19921  01 Freshman        6       19973       19963</span>
<span class="co">#&gt;    3: MID25783491 141001  19961  01 Freshman        6       20013       20001</span>
<span class="co">#&gt;    4: MID25783912 143501  19971  01 Freshman        6       20023       20001</span>
<span class="co">#&gt;    5: MID25784489 140801  19891  01 Freshman        6       19943       19931</span>
<span class="co">#&gt;   ---                                                                        </span>
<span class="co">#&gt; 5386: MID26696771 141001  20101 02 Sophomore        5       20143       20143</span>
<span class="co">#&gt; 5387: MID26696967 141901  20101  01 Freshman        6       20153       20141</span>
<span class="co">#&gt; 5388: MID26697163 141901  20101 02 Sophomore        5       20143       20133</span>
<span class="co">#&gt; 5389: MID26697444 240199  20101  01 Freshman        6       20153       20151</span>
<span class="co">#&gt; 5390: MID26697447 141001  20111  01 Freshman        6       20163       20154</span>
<span class="co">#&gt;       completion_status</span>
<span class="co">#&gt;                  &lt;char&gt;</span>
<span class="co">#&gt;    1:            timely</span>
<span class="co">#&gt;    2:            timely</span>
<span class="co">#&gt;    3:            timely</span>
<span class="co">#&gt;    4:            timely</span>
<span class="co">#&gt;    5:            timely</span>
<span class="co">#&gt;   ---                  </span>
<span class="co">#&gt; 5386:            timely</span>
<span class="co">#&gt; 5387:            timely</span>
<span class="co">#&gt; 5388:            timely</span>
<span class="co">#&gt; 5389:            timely</span>
<span class="co">#&gt; 5390:            timely</span></code></pre>
<p>You may view the function’s help page by running</p>
<pre><code><span class="op">?</span> <span class="va">add_completion_status</span></code></pre>
<p><strong>Filtering.</strong> Retain records with “positive” completion
status (i.e. completion in 6 years or less) and drop unnecessary
variables.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain timely completers</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">completion_status</span> <span class="op">==</span> <span class="st">"timely"</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;              mcid   cip6</span>
<span class="co">#&gt;            &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178 143501</span>
<span class="co">#&gt;    2: MID25783441 140801</span>
<span class="co">#&gt;    3: MID25783491 141001</span>
<span class="co">#&gt;    4: MID25783912 143501</span>
<span class="co">#&gt;    5: MID25784489 140801</span>
<span class="co">#&gt;   ---                   </span>
<span class="co">#&gt; 4610: MID26696771 141001</span>
<span class="co">#&gt; 4611: MID26696967 141901</span>
<span class="co">#&gt; 4612: MID26697163 141901</span>
<span class="co">#&gt; 4613: MID26697444 240199</span>
<span class="co">#&gt; 4614: MID26697447 141001</span></code></pre>
<p>The result has 4614 unique observations.</p>
</div>
<div class="section level2">
<h2 id="filter-by-program-1">Filter by program<a class="anchor" aria-label="anchor" href="#filter-by-program-1"></a>
</h2>
<p>We join the program names to the working data frame using a
left-outer join and return selected rows. We then filter to retain
program names that are not NA.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Left-outer join to DT</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">study_program</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">program</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Unique observations</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;              mcid program</span>
<span class="co">#&gt;            &lt;char&gt;  &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178     ISE</span>
<span class="co">#&gt;    2: MID25783441      CE</span>
<span class="co">#&gt;    3: MID25783491      EE</span>
<span class="co">#&gt;    4: MID25783912     ISE</span>
<span class="co">#&gt;    5: MID25784489      CE</span>
<span class="co">#&gt;   ---                    </span>
<span class="co">#&gt; 3548: MID26696738      ME</span>
<span class="co">#&gt; 3549: MID26696771      EE</span>
<span class="co">#&gt; 3550: MID26696967      ME</span>
<span class="co">#&gt; 3551: MID26697163      ME</span>
<span class="co">#&gt; 3552: MID26697447      EE</span></code></pre>
<p>The result has 3552 unique observations.</p>
<p><strong>Creating variables.</strong> Add a variable to label this
group as “grad” to distinguish them from the group of ever enrolled
students created earlier.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Conclude development of the graduate observations</span>
<span class="va">grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">grad</span><span class="op">[</span>, <span class="va">group</span> <span class="op">:=</span> <span class="st">"grad"</span><span class="op">]</span>
<span class="va">grad</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;              mcid program  group</span>
<span class="co">#&gt;            &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178     ISE   grad</span>
<span class="co">#&gt;    2: MID25783441      CE   grad</span>
<span class="co">#&gt;    3: MID25783491      EE   grad</span>
<span class="co">#&gt;    4: MID25783912     ISE   grad</span>
<span class="co">#&gt;    5: MID25784489      CE   grad</span>
<span class="co">#&gt;   ---                           </span>
<span class="co">#&gt; 3548: MID26696738      ME   grad</span>
<span class="co">#&gt; 3549: MID26696771      EE   grad</span>
<span class="co">#&gt; 3550: MID26696967      ME   grad</span>
<span class="co">#&gt; 3551: MID26697163      ME   grad</span>
<span class="co">#&gt; 3552: MID26697447      EE   grad</span></code></pre>
</div>
<div class="section level2">
<h2 id="combine-ever-and-grad">Combine ever and grad<a class="anchor" aria-label="anchor" href="#combine-ever-and-grad"></a>
</h2>
<p><strong>Binding.</strong> Combine two data frames by matching column
names.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Combine two data frames</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ever</span>, <span class="va">grad</span><span class="op">)</span>, use.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;               mcid program  group</span>
<span class="co">#&gt;             &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;     1: MID25783178     ISE   ever</span>
<span class="co">#&gt;     2: MID25783441      CE   ever</span>
<span class="co">#&gt;     3: MID25783491      EE   ever</span>
<span class="co">#&gt;     4: MID25783912     ISE   ever</span>
<span class="co">#&gt;     5: MID25784025      ME   ever</span>
<span class="co">#&gt;    ---                           </span>
<span class="co">#&gt; 11208: MID26696738      ME   grad</span>
<span class="co">#&gt; 11209: MID26696771      EE   grad</span>
<span class="co">#&gt; 11210: MID26696967      ME   grad</span>
<span class="co">#&gt; 11211: MID26697163      ME   grad</span>
<span class="co">#&gt; 11212: MID26697447      EE   grad</span></code></pre>
</div>
<div class="section level2">
<h2 id="add-demographics">Add demographics<a class="anchor" aria-label="anchor" href="#add-demographics"></a>
</h2>
<p><strong>Creating variables.</strong> Using columns from
<code>student</code>, we add variables for race/ethnicity and sex using
a left-outer join. All rows and columns of DT are returned with two
columns added from <code>student</code>.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Selecting columns from student</span>
<span class="va">student_cols</span> <span class="op">&lt;-</span> <span class="va">student</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">race</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Add them to DT with a left outer join</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">student_cols</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">#&gt;               mcid            race    sex program  group</span>
<span class="co">#&gt;             &lt;char&gt;          &lt;char&gt; &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;     1: MID25783178           Black   Male     ISE   ever</span>
<span class="co">#&gt;     2: MID25783441           White   Male      CE   ever</span>
<span class="co">#&gt;     3: MID25783491           White   Male      EE   ever</span>
<span class="co">#&gt;     4: MID25783912           White   Male     ISE   ever</span>
<span class="co">#&gt;     5: MID25784025           Black   Male      ME   ever</span>
<span class="co">#&gt;    ---                                                  </span>
<span class="co">#&gt; 11208: MID26696738           White   Male      ME   grad</span>
<span class="co">#&gt; 11209: MID26696771           White Female      EE   grad</span>
<span class="co">#&gt; 11210: MID26696967           White   Male      ME   grad</span>
<span class="co">#&gt; 11211: MID26697163 Hispanic/Latinx   Male      ME   grad</span>
<span class="co">#&gt; 11212: MID26697447           Asian   Male      EE   grad</span></code></pre>
<p>The result has 11,212 observations of 7133 unique students. IDs
labeled “grad” are a subset of those labeled “ever”.</p>
</div>
<div class="section level2">
<h2 id="review">Review<a class="anchor" aria-label="anchor" href="#review"></a>
</h2>
<p>To better grasp the structure of these data, we can review selected
sets of observations by ID. In the first example, the ID produces one
observation only. The student was enrolled in Civil Engineering but
completion, if any, was not timely.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID26694225"</span><span class="op">]</span>
<span class="co">#&gt;           mcid   race    sex program  group</span>
<span class="co">#&gt;         &lt;char&gt; &lt;char&gt; &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt; 1: MID26694225  White   Male      CE   ever</span></code></pre></div>
<p>In the next example, the ID produces two observations indicating that
the student was enrolled in Civil Engineering and a timely graduate of
that program.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25786154"</span><span class="op">]</span>
<span class="co">#&gt;           mcid   race    sex program  group</span>
<span class="co">#&gt;         &lt;char&gt; &lt;char&gt; &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt; 1: MID25786154  White Female      CE   ever</span>
<span class="co">#&gt; 2: MID25786154  White Female      CE   grad</span></code></pre></div>
<p>In the next example, the ID produces two observations indicating that
the student was enrolled in Electrical Engineering and in Mechanical
Engineering but a timely graduate of neither program.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25868925"</span><span class="op">]</span>
<span class="co">#&gt;           mcid   race    sex program  group</span>
<span class="co">#&gt;         &lt;char&gt; &lt;char&gt; &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt; 1: MID25868925  Asian Female      EE   ever</span>
<span class="co">#&gt; 2: MID25868925  Asian Female      ME   ever</span></code></pre></div>
<p>In the next example, the ID produces three observations indicating
that the student was enrolled in Electrical Engineering and in Civil
Engineering and a timely graduate of Civil.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID26526757"</span><span class="op">]</span>
<span class="co">#&gt;           mcid   race    sex program  group</span>
<span class="co">#&gt;         &lt;char&gt; &lt;char&gt; &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt; 1: MID26526757  Asian Female      CE   ever</span>
<span class="co">#&gt; 2: MID26526757  Asian Female      EE   ever</span>
<span class="co">#&gt; 3: MID26526757  Asian Female      CE   grad</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="closing">Closing<a class="anchor" aria-label="anchor" href="#closing"></a>
</h2>
<p>Starting with the <code>student</code>, <code>term</code>, and
<code>degree</code> data tables, we filtered the data for data
sufficiency, degree seeking, program, and timely completion in four
programs (Civil, Electrical, Industrial/Systems, and Mechanical
Engineering) and processed the data to obtain the observations needed to
determine stickiness.</p>
<p><strong>Write to file.</strong> Results like these, used as inputs
for calculating summary statistics and metrics, are often written to
file as an intermediate result. In this case, the data frame above is
bundled with midfieldr as <code>study_observations</code>. You may view
its help page by running</p>
<pre><code><span class="op">?</span> <span class="va">study_observations</span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Dowle+Srinivasan:2021:data.table" class="csl-entry">
Dowle, M., &amp; Srinivasan, A. (2021). <em><span class="nocase">data.table: Extension of data.frame</span></em>.
R package version 1.14.2. <a href="https://CRAN.R-project.org/package=data.table" class="external-link">https://CRAN.R-project.org/package=data.table</a>
</div>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<p>We conclude each vignette by collecting its code chunks in a single,
condensed script for the convenience of those who wish to copy it into
their own R file.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span><span class="op">)</span>

<span class="co"># Import data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span>, <span class="va">degree</span><span class="op">)</span>

<span class="co"># Gather ever enrolled</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>

<span class="co"># Filter for data sufficiency</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">data_sufficiency</span> <span class="op">==</span> <span class="st">"include"</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Filter for degree-seeking</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">student</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span>

<span class="co"># Filter by program</span>
<span class="va">study_program</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_search.html">filter_search</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"^1408"</span>, <span class="st">"^1410"</span>, <span class="st">"^1419"</span>, <span class="st">"^1427"</span>, <span class="st">"^1435"</span>, <span class="st">"^1436"</span>, <span class="st">"^1437"</span><span class="op">)</span><span class="op">)</span>
<span class="va">study_program</span> <span class="op">&lt;-</span> <span class="va">study_program</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip6</span>, <span class="va">cip6name</span><span class="op">)</span><span class="op">]</span>
<span class="va">study_program</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span>
  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1408"</span>, <span class="st">"CE"</span>,
  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1410"</span>, <span class="st">"EE"</span>,
  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1419"</span>, <span class="st">"ME"</span>,
  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"142701"</span>, <span class="st">"143501"</span>, <span class="st">"143601"</span>, <span class="st">"143701"</span><span class="op">)</span>, <span class="st">"ISE"</span>
<span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">study_program</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span>, <span class="va">program</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span>, <span class="va">cip6</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">ever</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">ever</span><span class="op">[</span>, <span class="va">group</span> <span class="op">:=</span> <span class="st">"ever"</span><span class="op">]</span>

<span class="co"># Gather graduate subset</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">degree</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span>

<span class="co"># Filter by completion status</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_completion_status.html">add_completion_status</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">degree</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">completion_status</span> <span class="op">==</span> <span class="st">"positive"</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Filter by program</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">study_program</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">program</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">grad</span><span class="op">[</span>, <span class="va">group</span> <span class="op">:=</span> <span class="st">"grad"</span><span class="op">]</span>

<span class="co"># Combine two data frames and match the column names</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ever</span>, <span class="va">grad</span><span class="op">)</span>, use.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Add demographics</span>
<span class="va">student_cols</span> <span class="op">&lt;-</span> <span class="va">student</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">race</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">student_cols</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<style type="text/css">
blockquote {
    padding: 10px 20px;
    margin: 0 0 20px;
    font-size: 12px;
    border-left: 0px solid
}
</style>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/graphdr" class="external-link">Richard Layton</a>, Russell Long, Matthew Ohland, Marisa Orr, Susan Lord, US National Science Foundation.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
