<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="midfieldr">
<title>Case study: Data • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Courier_Prime-0.4.2/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case study: Data">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="https://midfieldr.github.io/midfieldr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">midfieldr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9030</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/art-000-getting-started.html">Getting started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-study">Case study</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-study">
    <a class="dropdown-item" href="../articles/art-001-case-goals.html">Goals</a>
    <a class="dropdown-item" href="../articles/art-002-case-data.html">Data</a>
    <a class="dropdown-item" href="../articles/art-003-case-results.html">Results</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/art-010-planning.html">Planning</a>
    <a class="dropdown-item" href="../articles/art-020-data-sufficiency.html">Data sufficiency</a>
    <a class="dropdown-item" href="../articles/art-030-degree-seeking.html">Degree seeking</a>
    <a class="dropdown-item" href="../articles/art-040-programs.html">Programs</a>
    <a class="dropdown-item" href="../articles/art-050-blocs.html">Blocs</a>
    <a class="dropdown-item" href="../articles/art-060-fye-proxies.html">FYE proxies</a>
    <a class="dropdown-item" href="../articles/art-070-starters.html">Starters</a>
    <a class="dropdown-item" href="../articles/art-080-graduates.html">Graduates</a>
    <a class="dropdown-item" href="../articles/art-090-groupings.html">Groupings</a>
    <a class="dropdown-item" href="../articles/art-100-grad-rate.html">Graduation rate</a>
    <a class="dropdown-item" href="../articles/art-110-stickiness.html">Stickiness</a>
    <a class="dropdown-item" href="../articles/art-120-multiway.html">Multiway data and charts</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MIDFIELDR/midfieldr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Case study: Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/HEAD/vignettes/art-002-case-data.Rmd" class="external-link"><code>vignettes/art-002-case-data.Rmd</code></a></small>
      <div class="d-none name"><code>art-002-case-data.Rmd</code></div>
    </div>

    
    
<p>Part 2 of a case study in three parts, illustrating how we work with
longitudinal student-level records.</p>
<ol style="list-style-type: decimal">
<li><p><a href="art-001-case-goals.html">Goals.</a> Briefly describe the
study.</p></li>
<li><p>Data (this page). Transforming the data to yield the observations
of interest.</p></li>
<li><p><a href="art-003-case-results.html">Results.</a> Calculating
summary statistics and metrics and displaying the results.</p></li>
</ol>
<div class="section level2">
<h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>Our data processing goal is to reduce the source data tables to the
specific observations needed to compute our metrics. The data processing
tasks include filtering observations, creating, renaming, and recoding
variables, and joining data frames.</p>
<p>The analysis is organized to produce two data frames—students ever
enrolled in the programs and students graduating from the programs—that
are joined and written to file as a starting point for <a href="art-003-case-results.html">Case study: Results</a>.</p>
<p><em>Reminder.</em>   midfielddata datasets are for practice, not
research.</p>
</div>
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p><em>Start.</em>   If you are writing your own script to follow along,
we use these packages in this article:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://midfieldr.github.io/midfieldr/">midfieldr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://midfieldr.github.io/midfielddata/" class="external-link">midfielddata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
<p><em>Load.</em>   Practice datasets. View data dictionaries via
<code><a href="https://midfieldr.github.io/midfielddata/reference/student.html" class="external-link">?student</a></code>, <code><a href="https://midfieldr.github.io/midfielddata/reference/term.html" class="external-link">?term</a></code>, <code><a href="https://midfieldr.github.io/midfielddata/reference/degree.html" class="external-link">?degree</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load practice data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span>, <span class="va">degree</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="initial-processing">Initial processing<a class="anchor" aria-label="anchor" href="#initial-processing"></a>
</h2>
<p><em>Select (optional).</em>   Reduce the number of columns to the
minimum needed by the midfieldr functions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Work with required midfieldr variables only</span></span>
<span><span class="va">student</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">student</span><span class="op">)</span></span>
<span><span class="va">term</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="va">degree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">degree</span><span class="op">)</span></span></code></pre></div>
<p><em>Initialize.</em>   Assign a working data frame. We often start
with the <code>term</code> dataset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Working data frame</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                   mcid   institution  term   cip6         level</span></span>
<span><span class="co">#&gt;      1: MCID3111142225 Institution B 19881 140901 01 First-year</span></span>
<span><span class="co">#&gt;      2: MCID3111142283 Institution J 19881 240102 01 First-year</span></span>
<span><span class="co">#&gt;      3: MCID3111142283 Institution J 19883 240102 01 First-year</span></span>
<span><span class="co">#&gt;     ---                                                        </span></span>
<span><span class="co">#&gt; 639913: MCID3112898894 Institution B 20181 451001 01 First-year</span></span>
<span><span class="co">#&gt; 639914: MCID3112898895 Institution B 20181 302001 01 First-year</span></span>
<span><span class="co">#&gt; 639915: MCID3112898940 Institution B 20181 050103 01 First-year</span></span></code></pre></div>
<p>The result has 639,915 observations. In the case study, we will
typically note the number of observations as they change.</p>
</div>
<div class="section level2">
<h2 id="filter-for-data-sufficiency">Filter for data sufficiency<a class="anchor" aria-label="anchor" href="#filter-for-data-sufficiency"></a>
</h2>
<p>Some student records near the lower and upper terms that bound the
available data must be excluded to prevent false summaries involving
timely degree completion. To apply this filter, we first determine the
timely completion term.</p>
<p><em>Add variables.</em>   Using information in <code>term</code>, we
add the <code>timely_term</code> variable as well as supporting
variables used in its construction.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Determine a timely completion term for every student</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                   mcid   institution  term   cip6         level term_i</span></span>
<span><span class="co">#&gt;      1: MCID3111142225 Institution B 19881 140901 01 First-year  19881</span></span>
<span><span class="co">#&gt;      2: MCID3111142283 Institution J 19881 240102 01 First-year  19881</span></span>
<span><span class="co">#&gt;      3: MCID3111142283 Institution J 19883 240102 01 First-year  19881</span></span>
<span><span class="co">#&gt;     ---                                                               </span></span>
<span><span class="co">#&gt; 639913: MCID3112898894 Institution B 20181 451001 01 First-year  20181</span></span>
<span><span class="co">#&gt; 639914: MCID3112898895 Institution B 20181 302001 01 First-year  20181</span></span>
<span><span class="co">#&gt; 639915: MCID3112898940 Institution B 20181 050103 01 First-year  20181</span></span>
<span><span class="co">#&gt;               level_i adj_span timely_term</span></span>
<span><span class="co">#&gt;      1: 01 First-year        6       19933</span></span>
<span><span class="co">#&gt;      2: 01 First-year        6       19933</span></span>
<span><span class="co">#&gt;      3: 01 First-year        6       19933</span></span>
<span><span class="co">#&gt;     ---                                   </span></span>
<span><span class="co">#&gt; 639913: 01 First-year        6       20233</span></span>
<span><span class="co">#&gt; 639914: 01 First-year        6       20233</span></span>
<span><span class="co">#&gt; 639915: 01 First-year        6       20233</span></span></code></pre></div>
<p><em>Add variables.</em>   Using information in <code>term</code>, we
add the <code>data_sufficiency</code> variable as well as supporting
variables used in its construction.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Determine data sufficiency for every student</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                   mcid   institution  term   cip6         level       level_i</span></span>
<span><span class="co">#&gt;      1: MCID3111142225 Institution B 19881 140901 01 First-year 01 First-year</span></span>
<span><span class="co">#&gt;      2: MCID3111142283 Institution J 19881 240102 01 First-year 01 First-year</span></span>
<span><span class="co">#&gt;      3: MCID3111142283 Institution J 19883 240102 01 First-year 01 First-year</span></span>
<span><span class="co">#&gt;     ---                                                                      </span></span>
<span><span class="co">#&gt; 639913: MCID3112898894 Institution B 20181 451001 01 First-year 01 First-year</span></span>
<span><span class="co">#&gt; 639914: MCID3112898895 Institution B 20181 302001 01 First-year 01 First-year</span></span>
<span><span class="co">#&gt; 639915: MCID3112898940 Institution B 20181 050103 01 First-year 01 First-year</span></span>
<span><span class="co">#&gt;         adj_span timely_term term_i lower_limit upper_limit data_sufficiency</span></span>
<span><span class="co">#&gt;      1:        6       19933  19881       19881       20181    exclude-lower</span></span>
<span><span class="co">#&gt;      2:        6       19933  19881       19881       20096    exclude-lower</span></span>
<span><span class="co">#&gt;      3:        6       19933  19881       19881       20096    exclude-lower</span></span>
<span><span class="co">#&gt;     ---                                                                     </span></span>
<span><span class="co">#&gt; 639913:        6       20233  20181       19881       20181    exclude-upper</span></span>
<span><span class="co">#&gt; 639914:        6       20233  20181       19881       20181    exclude-upper</span></span>
<span><span class="co">#&gt; 639915:        6       20233  20181       19881       20181    exclude-upper</span></span></code></pre></div>
<p><em>Filter.</em> We filter to retain observations for which the data
are sufficient then drop all but the ID variable.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retain observations having sufficient data</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">data_sufficiency</span> <span class="op">==</span> <span class="st">"include"</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid</span></span>
<span><span class="co">#&gt;     1: MCID3111142689</span></span>
<span><span class="co">#&gt;     2: MCID3111142782</span></span>
<span><span class="co">#&gt;     3: MCID3111142881</span></span>
<span><span class="co">#&gt;    ---               </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009</span></span></code></pre></div>
<p>The result has 76,875 observations.</p>
</div>
<div class="section level2">
<h2 id="filter-for-degree-seeking">Filter for degree seeking<a class="anchor" aria-label="anchor" href="#filter-for-degree-seeking"></a>
</h2>
<p><em>Filter.</em>   Use an inner join with <code>student</code> to
retain degree-seeking students only.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter for degree seeking, output unique IDs</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">student</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid</span></span>
<span><span class="co">#&gt;     1: MCID3111142689</span></span>
<span><span class="co">#&gt;     2: MCID3111142782</span></span>
<span><span class="co">#&gt;     3: MCID3111142881</span></span>
<span><span class="co">#&gt;    ---               </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009</span></span></code></pre></div>
<p>The result has 76,875 observations. (No change is expected in this
example because all students in the midfielddata practice data are
degree-seeking.) We preserve this data frame as a baseline set of IDs to
be used again.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="identify-programs">Identify programs<a class="anchor" aria-label="anchor" href="#identify-programs"></a>
</h2>
<p>In MIDFIELD datasets, the <code>cip6</code> variable identifies the
6-digit code for the program in which a student is enrolled in a given
term, based on the US <em>Classification of Instructional Programs</em>
(CIP) codes.</p>
<p>CIP codes and names are included with midfieldr in the
<code>cip</code> data set. We have already searched that information to
obtain the CIP codes for the four programs in our case study: Civil
Engineering CIPs start with 1408, Electrical Engineering 1410,
Mechanical Engineering 1419, and Industrial/Systems Engineering 1427,
1435, 1436, and 1437.</p>
<p>From <code>cip</code>, we obtain all codes that start with any of the
selected 4-digit codes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Four engineering programs using 4-digit CIP codes</span></span>
<span><span class="va">selected_programs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_cip.html">filter_cip</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"^1408"</span>, <span class="st">"^1410"</span>, <span class="st">"^1419"</span>, <span class="st">"^1427"</span>, <span class="st">"^1435"</span>, <span class="st">"^1436"</span>, <span class="st">"^1437"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">selected_programs</span></span>
<span><span class="co">#&gt;     cip2    cip2name cip4                  cip4name   cip6</span></span>
<span><span class="co">#&gt;  1:   14 Engineering 1408         Civil Engineering 140801</span></span>
<span><span class="co">#&gt;  2:   14 Engineering 1408         Civil Engineering 140802</span></span>
<span><span class="co">#&gt;  3:   14 Engineering 1408         Civil Engineering 140803</span></span>
<span><span class="co">#&gt; ---                                                       </span></span>
<span><span class="co">#&gt; 13:   14 Engineering 1435    Industrial Engineering 143501</span></span>
<span><span class="co">#&gt; 14:   14 Engineering 1436 Manufacturing Engineering 143601</span></span>
<span><span class="co">#&gt; 15:   14 Engineering 1437       Operations Research 143701</span></span>
<span><span class="co">#&gt;                       cip6name</span></span>
<span><span class="co">#&gt;  1: Civil Engineering, General</span></span>
<span><span class="co">#&gt;  2:   Geotechnical Engineering</span></span>
<span><span class="co">#&gt;  3:     Structural Engineering</span></span>
<span><span class="co">#&gt; ---                           </span></span>
<span><span class="co">#&gt; 13:     Industrial Engineering</span></span>
<span><span class="co">#&gt; 14:  Manufacturing Engineering</span></span>
<span><span class="co">#&gt; 15:        Operations Research</span></span></code></pre></div>
<p><em>Add a variable.</em>   User-defined program names are nearly
always required. Add a variable to label each of these 15 programs with
one of the four conventional program abbreviations we will use in
comparing metrics, i.e., Civil (CE), Electrical (EE), Mechanical (ME),
and Industrial/Systems Engineering (ISE).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recode program labels. Edit as required.</span></span>
<span><span class="va">selected_programs</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span>
<span>  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1408"</span>, <span class="st">"CE"</span>,</span>
<span>  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1410"</span>, <span class="st">"EE"</span>,</span>
<span>  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1419"</span>, <span class="st">"ME"</span>,</span>
<span>  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"142701"</span>, <span class="st">"143501"</span>, <span class="st">"143601"</span>, <span class="st">"143701"</span><span class="op">)</span>, <span class="st">"ISE"</span></span>
<span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Confirm that the abbreviations match the original 4-digit CIP names.
We also illustrate using <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> to change the number of
data.table rows to print.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Preserve settings</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Edit number of rows to print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>datatable.print.nrows <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Confirm that abbreviations match the longer program names</span></span>
<span><span class="va">selected_programs</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip4name</span>, <span class="va">program</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                                   cip4name program</span></span>
<span><span class="co">#&gt;  1:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  2:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  3:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  4:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  5:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  6:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  7: Electrical, Electronics and Communications Engineering      EE</span></span>
<span><span class="co">#&gt;  8: Electrical, Electronics and Communications Engineering      EE</span></span>
<span><span class="co">#&gt;  9: Electrical, Electronics and Communications Engineering      EE</span></span>
<span><span class="co">#&gt; 10: Electrical, Electronics and Communications Engineering      EE</span></span>
<span><span class="co">#&gt; 11:                                 Mechanical Engineering      ME</span></span>
<span><span class="co">#&gt; 12:                                    Systems Engineering     ISE</span></span>
<span><span class="co">#&gt; 13:                                 Industrial Engineering     ISE</span></span>
<span><span class="co">#&gt; 14:                              Manufacturing Engineering     ISE</span></span>
<span><span class="co">#&gt; 15:                                    Operations Research     ISE</span></span></code></pre></div>
<p>Having checked that the new abbreviations correctly represent the
programs, we can finalize the data frame of program CIPs and names.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selected_programs</span> <span class="op">&lt;-</span> <span class="va">selected_programs</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip6</span>, <span class="va">program</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">selected_programs</span></span>
<span><span class="co">#&gt;       cip6 program</span></span>
<span><span class="co">#&gt;  1: 140801      CE</span></span>
<span><span class="co">#&gt;  2: 140802      CE</span></span>
<span><span class="co">#&gt;  3: 140803      CE</span></span>
<span><span class="co">#&gt;  4: 140804      CE</span></span>
<span><span class="co">#&gt;  5: 140805      CE</span></span>
<span><span class="co">#&gt;  6: 140899      CE</span></span>
<span><span class="co">#&gt;  7: 141001      EE</span></span>
<span><span class="co">#&gt;  8: 141003      EE</span></span>
<span><span class="co">#&gt;  9: 141004      EE</span></span>
<span><span class="co">#&gt; 10: 141099      EE</span></span>
<span><span class="co">#&gt; 11: 141901      ME</span></span>
<span><span class="co">#&gt; 12: 142701     ISE</span></span>
<span><span class="co">#&gt; 13: 143501     ISE</span></span>
<span><span class="co">#&gt; 14: 143601     ISE</span></span>
<span><span class="co">#&gt; 15: 143701     ISE</span></span>
<span></span>
<span><span class="co"># Restore original settings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gather-ever-enrolled">Gather ever-enrolled<a class="anchor" aria-label="anchor" href="#gather-ever-enrolled"></a>
</h2>
<p><em>Reset</em>   The data frame of baseline IDs is the intake for
this section.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IDs of data-sufficient, degree-seeking students</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">baseline</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid</span></span>
<span><span class="co">#&gt;     1: MCID3111142689</span></span>
<span><span class="co">#&gt;     2: MCID3111142782</span></span>
<span><span class="co">#&gt;     3: MCID3111142881</span></span>
<span><span class="co">#&gt;    ---               </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009</span></span></code></pre></div>
<p>The result has 76,875 observations.</p>
<p><em>Left join (add a variable).</em>   A left join merges
<code>term</code> with <code>DT</code>, returns all rows from
<code>DT</code>, and returns rows from <code>term</code> that match on
<code>mcid</code>—in effect, adding the <code>cip6</code> variable to
<code>DT</code>. Additionally, because <code>term</code> contains
multiple rows per ID, the merged data frame also has the possibility of
multiple rows per ID.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Left-outer join from term to DT</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">term</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                   mcid   cip6</span></span>
<span><span class="co">#&gt;      1: MCID3111142689 090401</span></span>
<span><span class="co">#&gt;      2: MCID3111142782 260101</span></span>
<span><span class="co">#&gt;      3: MCID3111142881 450601</span></span>
<span><span class="co">#&gt;     ---                      </span></span>
<span><span class="co">#&gt; 127347: MCID3112800920 240102</span></span>
<span><span class="co">#&gt; 127348: MCID3112800920 240199</span></span>
<span><span class="co">#&gt; 127349: MCID3112870009 240102</span></span></code></pre></div>
<p>The result has 127,349 observations.</p>
<p><em>Inner join (add a variable, filter observations).</em>   An inner
join merges <code>study_programs</code> with <code>DT</code> and returns
rows in both tables that match on <code>cip6</code>. In effect, we add a
column of program labels to <code>DT</code> and simultaneously filter
<code>DT</code> to retain rows that match the four case study programs
only.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join program names and retain desired programs only</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">study_programs</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;         cip6 program           mcid</span></span>
<span><span class="co">#&gt;    1: 141001      EE MCID3111142965</span></span>
<span><span class="co">#&gt;    2: 141001      EE MCID3111145102</span></span>
<span><span class="co">#&gt;    3: 141001      EE MCID3111146537</span></span>
<span><span class="co">#&gt;   ---                              </span></span>
<span><span class="co">#&gt; 5655: 141901      ME MCID3112641399</span></span>
<span><span class="co">#&gt; 5656: 141901      ME MCID3112641535</span></span>
<span><span class="co">#&gt; 5657: 141901      ME MCID3112698681</span></span></code></pre></div>
<p>The result has 5657 observations.</p>
<p><em>Filter.</em>   Because students can change CIP codes but remain
within the same labeled group (e.g., ISE), we drop the <code>cip6</code>
code and filter for unique combinations of ID and program label.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter for unique ID-program combinations</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">cip6</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;       program           mcid</span></span>
<span><span class="co">#&gt;    1:      EE MCID3111142965</span></span>
<span><span class="co">#&gt;    2:      EE MCID3111145102</span></span>
<span><span class="co">#&gt;    3:      EE MCID3111146537</span></span>
<span><span class="co">#&gt;   ---                       </span></span>
<span><span class="co">#&gt; 5651:      ME MCID3112641399</span></span>
<span><span class="co">#&gt; 5652:      ME MCID3112641535</span></span>
<span><span class="co">#&gt; 5653:      ME MCID3112698681</span></span></code></pre></div>
<p>The result has 5653 observations.</p>
<p><em>Copy.</em>   Set aside the ever enrolled information under a new
name to use later for joining with graduates.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare for joining</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setcolorder.html" class="external-link">setcolorder</a></span><span class="op">(</span><span class="va">DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"program"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ever_enrolled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">ever_enrolled</span></span>
<span><span class="co">#&gt;                 mcid program</span></span>
<span><span class="co">#&gt;    1: MCID3111142965      EE</span></span>
<span><span class="co">#&gt;    2: MCID3111145102      EE</span></span>
<span><span class="co">#&gt;    3: MCID3111146537      EE</span></span>
<span><span class="co">#&gt;   ---                       </span></span>
<span><span class="co">#&gt; 5651: MCID3112641399      ME</span></span>
<span><span class="co">#&gt; 5652: MCID3112641535      ME</span></span>
<span><span class="co">#&gt; 5653: MCID3112698681      ME</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gather-graduates">Gather graduates<a class="anchor" aria-label="anchor" href="#gather-graduates"></a>
</h2>
<p><em>Reset</em>   The data frame of baseline IDs is the intake for
this section. As before, the result has 76,875 observations.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IDs of data-sufficient, degree-seeking students</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">baseline</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid</span></span>
<span><span class="co">#&gt;     1: MCID3111142689</span></span>
<span><span class="co">#&gt;     2: MCID3111142782</span></span>
<span><span class="co">#&gt;     3: MCID3111142881</span></span>
<span><span class="co">#&gt;    ---               </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009</span></span></code></pre></div>
<p><em>Add variables.</em>   We use <code>term</code> to again add the
<code>timely_term</code> variable and its supporting variables.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add timely completion term</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid term_i       level_i adj_span timely_term</span></span>
<span><span class="co">#&gt;     1: MCID3111142689  19883 01 First-year        6       19941</span></span>
<span><span class="co">#&gt;     2: MCID3111142782  19883 01 First-year        6       19941</span></span>
<span><span class="co">#&gt;     3: MCID3111142881  19893 01 First-year        6       19951</span></span>
<span><span class="co">#&gt;    ---                                                         </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480  20071 01 First-year        6       20123</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920  20101 01 First-year        6       20153</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009  19951 01 First-year        6       20003</span></span></code></pre></div>
<p><em>Add variables.</em>   We use <code>degree</code> to add the
<code>completion_status</code> variable and its supporting
variables.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add completion status</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_completion_status.html">add_completion_status</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">degree</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid term_i       level_i adj_span timely_term term_degree</span></span>
<span><span class="co">#&gt;     1: MCID3111142689  19883 01 First-year        6       19941       19913</span></span>
<span><span class="co">#&gt;     2: MCID3111142782  19883 01 First-year        6       19941       19903</span></span>
<span><span class="co">#&gt;     3: MCID3111142881  19893 01 First-year        6       19951       19894</span></span>
<span><span class="co">#&gt;    ---                                                                     </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480  20071 01 First-year        6       20123        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920  20101 01 First-year        6       20153        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009  19951 01 First-year        6       20003        &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        completion_status</span></span>
<span><span class="co">#&gt;     1:            timely</span></span>
<span><span class="co">#&gt;     2:            timely</span></span>
<span><span class="co">#&gt;     3:            timely</span></span>
<span><span class="co">#&gt;    ---                  </span></span>
<span><span class="co">#&gt; 76873:              &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 76874:              &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 76875:              &lt;NA&gt;</span></span></code></pre></div>
<p><em>Filter.</em>   Retain observations of timely completers only.
Drop unnecessary variables.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retain timely completers</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">completion_status</span> <span class="op">==</span> <span class="st">"timely"</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid</span></span>
<span><span class="co">#&gt;     1: MCID3111142689</span></span>
<span><span class="co">#&gt;     2: MCID3111142782</span></span>
<span><span class="co">#&gt;     3: MCID3111142881</span></span>
<span><span class="co">#&gt;    ---               </span></span>
<span><span class="co">#&gt; 40438: MCID3112692944</span></span>
<span><span class="co">#&gt; 40439: MCID3112694738</span></span>
<span><span class="co">#&gt; 40440: MCID3112730841</span></span></code></pre></div>
<p>The result has 40,440 observations.</p>
<p><em>Left join (add variables).</em>   We use a left-join with
<code>degree</code> to add the CIP codes and terms of the degrees
earned.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">degree</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">term_degree</span>, <span class="va">cip6</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid term_degree   cip6</span></span>
<span><span class="co">#&gt;     1: MCID3111142689       19913 090401</span></span>
<span><span class="co">#&gt;     2: MCID3111142782       19903 260101</span></span>
<span><span class="co">#&gt;     3: MCID3111142881       19894 450601</span></span>
<span><span class="co">#&gt;    ---                                  </span></span>
<span><span class="co">#&gt; 40538: MCID3112692944       20153 090101</span></span>
<span><span class="co">#&gt; 40539: MCID3112694738       20143 230101</span></span>
<span><span class="co">#&gt; 40540: MCID3112730841       20164 040401</span></span></code></pre></div>
<p>The result has 40,540 observations.</p>
<p><em>Inner join (add a variable, filter observations)</em>   Again,
add a column of program labels and filter by program.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join programs</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">study_programs</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;         cip6 program           mcid term_degree</span></span>
<span><span class="co">#&gt;    1: 141001      EE MCID3111142965       19901</span></span>
<span><span class="co">#&gt;    2: 141001      EE MCID3111145102       19893</span></span>
<span><span class="co">#&gt;    3: 141001      EE MCID3111146537       19913</span></span>
<span><span class="co">#&gt;   ---                                          </span></span>
<span><span class="co">#&gt; 3264: 141901      ME MCID3112618976       20153</span></span>
<span><span class="co">#&gt; 3265: 141001      EE MCID3112619484       20133</span></span>
<span><span class="co">#&gt; 3266: 141901      ME MCID3112641535       20143</span></span></code></pre></div>
<p>The result has 3266 observations.</p>
<p><em>Filter.</em>   Students may have earned multiple degrees in
different terms. We retain degrees earned in their first degree term
only.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="va">.SD</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">term_degree</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">"mcid"</span><span class="op">]</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                 mcid   cip6 program term_degree</span></span>
<span><span class="co">#&gt;    1: MCID3111142965 141001      EE       19901</span></span>
<span><span class="co">#&gt;    2: MCID3111145102 141001      EE       19893</span></span>
<span><span class="co">#&gt;    3: MCID3111146537 141001      EE       19913</span></span>
<span><span class="co">#&gt;   ---                                          </span></span>
<span><span class="co">#&gt; 3262: MCID3112618976 141901      ME       20153</span></span>
<span><span class="co">#&gt; 3263: MCID3112619484 141001      EE       20133</span></span>
<span><span class="co">#&gt; 3264: MCID3112641535 141901      ME       20143</span></span></code></pre></div>
<p>The result has 3264 observations.</p>
<p><em>Filter.</em>   Drop unnecessary variables and filter for unique
observations of ID and program label.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter for unique ID-program combinations</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span>, <span class="st">"term_degree"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                 mcid program</span></span>
<span><span class="co">#&gt;    1: MCID3111142965      EE</span></span>
<span><span class="co">#&gt;    2: MCID3111145102      EE</span></span>
<span><span class="co">#&gt;    3: MCID3111146537      EE</span></span>
<span><span class="co">#&gt;   ---                       </span></span>
<span><span class="co">#&gt; 3262: MCID3112618976      ME</span></span>
<span><span class="co">#&gt; 3263: MCID3112619484      EE</span></span>
<span><span class="co">#&gt; 3264: MCID3112641535      ME</span></span></code></pre></div>
<p><em>Copy.</em>   Set aside the graduates information under a new name
to use for joining with ever enrolled.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare for joining</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setcolorder.html" class="external-link">setcolorder</a></span><span class="op">(</span><span class="va">DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"program"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">graduates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">graduates</span></span>
<span><span class="co">#&gt;                 mcid program</span></span>
<span><span class="co">#&gt;    1: MCID3111142965      EE</span></span>
<span><span class="co">#&gt;    2: MCID3111145102      EE</span></span>
<span><span class="co">#&gt;    3: MCID3111146537      EE</span></span>
<span><span class="co">#&gt;   ---                       </span></span>
<span><span class="co">#&gt; 3262: MCID3112618976      ME</span></span>
<span><span class="co">#&gt; 3263: MCID3112619484      EE</span></span>
<span><span class="co">#&gt; 3264: MCID3112641535      ME</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-groupings">Add groupings<a class="anchor" aria-label="anchor" href="#add-groupings"></a>
</h2>
<p>We plan to group the data by program, bloc, race/ethnicity, and sex.
Program is already present. Bloc labels are added next.</p>
<p><em>Add a variable.</em>   We add a <code>bloc</code> variable to the
ever enrolled and graduates data frames before joining.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ever_enrolled</span><span class="op">[</span>, <span class="va">bloc</span> <span class="op">:=</span> <span class="st">"ever_enrolled"</span><span class="op">]</span></span>
<span><span class="va">graduates</span><span class="op">[</span>, <span class="va">bloc</span> <span class="op">:=</span> <span class="st">"graduates"</span><span class="op">]</span></span></code></pre></div>
<p><em>Join.</em>   Combine the two data frames by rows, binding by
matching column names.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine two data frames</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ever_enrolled</span>, <span class="va">graduates</span><span class="op">)</span>, use.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                 mcid program          bloc</span></span>
<span><span class="co">#&gt;    1: MCID3111142965      EE ever_enrolled</span></span>
<span><span class="co">#&gt;    2: MCID3111145102      EE ever_enrolled</span></span>
<span><span class="co">#&gt;    3: MCID3111146537      EE ever_enrolled</span></span>
<span><span class="co">#&gt;   ---                                     </span></span>
<span><span class="co">#&gt; 8915: MCID3112618976      ME     graduates</span></span>
<span><span class="co">#&gt; 8916: MCID3112619484      EE     graduates</span></span>
<span><span class="co">#&gt; 8917: MCID3112641535      ME     graduates</span></span></code></pre></div>
<p>The result has 8917 observations.</p>
<p><em>Add variables.</em>   Use a left join, matching on
<code>mcid</code>, to add race/ethnicity and sex to the data frame.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join race/ethnicity and sex</span></span>
<span><span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="va">student</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">race</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">cols_we_want</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                 mcid          race    sex program          bloc</span></span>
<span><span class="co">#&gt;    1: MCID3111142965 International   Male      EE ever_enrolled</span></span>
<span><span class="co">#&gt;    2: MCID3111145102         White   Male      EE ever_enrolled</span></span>
<span><span class="co">#&gt;    3: MCID3111146537         Asian Female      EE ever_enrolled</span></span>
<span><span class="co">#&gt;   ---                                                          </span></span>
<span><span class="co">#&gt; 8915: MCID3112618976         White   Male      ME     graduates</span></span>
<span><span class="co">#&gt; 8916: MCID3112619484         White   Male      EE     graduates</span></span>
<span><span class="co">#&gt; 8917: MCID3112641535         White   Male      ME     graduates</span></span></code></pre></div>
<p><em>Verify prepared data.</em>   <code>study_observations</code>,
included with midfieldr, contains the case study information developed
above. Here we verify that the two data frames have the same
content.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate equivalence</span></span>
<span><span class="fu"><a href="../reference/same_content.html">same_content</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">study_observations</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>In this form, the observations are the starting point for part 3 of
the case study.</p>
</div>
<div class="section level2">
<h2 id="closer-look">Closer look<a class="anchor" aria-label="anchor" href="#closer-look"></a>
</h2>
<p>We examine the study observations for a few specific students to
better illustrate the structure of these data.</p>
<p><em>Example 1.</em>   This ID yields one observation only. The
student was enrolled in Electrical Engineering but did not complete one
of the four case study programs.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display one student by ID</span></span>
<span><span class="va">mcid_we_want</span> <span class="op">&lt;-</span> <span class="st">"MCID3111171519"</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;              mcid  race  sex program          bloc</span></span>
<span><span class="co">#&gt; 1: MCID3111171519 White Male      EE ever_enrolled</span></span></code></pre></div>
<p>A closer look at the student’s <code>term</code> record confirms the
result: the student was enrolled in CIP 141001 (Electrical Engineering)
but switched to CIP 110701 (Computer Science). The <code>degree</code>
record indicates that the student graduated in Computer Science.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Closer look at term</span></span>
<span><span class="va">term</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;              mcid   institution  term   cip6              level</span></span>
<span><span class="co">#&gt; 1: MCID3111171519 Institution B 19883 149999     02 Second-year</span></span>
<span><span class="co">#&gt; 2: MCID3111171519 Institution B 19891 141001     02 Second-year</span></span>
<span><span class="co">#&gt; 3: MCID3111171519 Institution B 19893 141001      03 Third-year</span></span>
<span><span class="co">#&gt; 4: MCID3111171519 Institution B 19901 141001      03 Third-year</span></span>
<span><span class="co">#&gt; 5: MCID3111171519 Institution B 19903 110701     04 Fourth-year</span></span>
<span><span class="co">#&gt; 6: MCID3111171519 Institution B 19913 110701     04 Fourth-year</span></span>
<span><span class="co">#&gt; 7: MCID3111171519 Institution B 19921 110701 05 Fifth-year Plus</span></span>
<span><span class="co">#&gt; 8: MCID3111171519 Institution B 19923 110701 05 Fifth-year Plus</span></span>
<span><span class="co">#&gt; 9: MCID3111171519 Institution B 19924 110701 05 Fifth-year Plus</span></span>
<span></span>
<span><span class="co"># Closer look at degree</span></span>
<span><span class="va">degree</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;              mcid   institution term_degree   cip6</span></span>
<span><span class="co">#&gt; 1: MCID3111171519 Institution B       19924 110701</span></span></code></pre></div>
<p><em>Example 2.</em>   This ID yields two observations indicating that
the student was enrolled in Industrial/Systems Engineering and a timely
graduate of that program.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display one student by ID</span></span>
<span><span class="va">mcid_we_want</span> <span class="op">&lt;-</span> <span class="st">"MCID3111150194"</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;              mcid  race  sex program          bloc</span></span>
<span><span class="co">#&gt; 1: MCID3111150194 Black Male     ISE ever_enrolled</span></span>
<span><span class="co">#&gt; 2: MCID3111150194 Black Male     ISE     graduates</span></span></code></pre></div>
<p>The <code>term</code> and <code>degree</code> excerpts confirm those
observations.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Closer look at terms</span></span>
<span><span class="va">term</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;              mcid   institution  term   cip6              level</span></span>
<span><span class="co">#&gt; 1: MCID3111150194 Institution J 19883 140102      01 First-year</span></span>
<span><span class="co">#&gt; 2: MCID3111150194 Institution J 19891 140102     02 Second-year</span></span>
<span><span class="co">#&gt; 3: MCID3111150194 Institution J 19893 140102     02 Second-year</span></span>
<span><span class="co">#&gt; 4: MCID3111150194 Institution J 19903 143501      03 Third-year</span></span>
<span><span class="co">#&gt; 5: MCID3111150194 Institution J 19911 143501     04 Fourth-year</span></span>
<span><span class="co">#&gt; 6: MCID3111150194 Institution J 19913 143501     04 Fourth-year</span></span>
<span><span class="co">#&gt; 7: MCID3111150194 Institution J 19921 143501 05 Fifth-year Plus</span></span>
<span><span class="co">#&gt; 8: MCID3111150194 Institution J 19923 143501 05 Fifth-year Plus</span></span>
<span></span>
<span><span class="co"># Closer look at degree</span></span>
<span><span class="va">degree</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;              mcid   institution term_degree   cip6</span></span>
<span><span class="co">#&gt; 1: MCID3111150194 Institution J       19923 143501</span></span></code></pre></div>
<p><em>Example 3.</em>   This ID yields two observations indicating that
the student was enrolled in Electrical Engineering and in Civil
Engineering but a timely graduate of neither program.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display one student by ID</span></span>
<span><span class="va">mcid_we_want</span> <span class="op">&lt;-</span> <span class="st">"MCID3111264877"</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;              mcid  race  sex program          bloc</span></span>
<span><span class="co">#&gt; 1: MCID3111264877 White Male      EE ever_enrolled</span></span>
<span><span class="co">#&gt; 2: MCID3111264877 White Male      CE ever_enrolled</span></span></code></pre></div>
<p>The <code>term</code> excerpt agrees; the <code>degree</code> record
shows they graduated in CIP 261399 (Biological and Biomedical
Sciences).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Closer look at term</span></span>
<span><span class="va">term</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;               mcid   institution  term   cip6              level</span></span>
<span><span class="co">#&gt;  1: MCID3111264877 Institution B 19901 141001      01 First-year</span></span>
<span><span class="co">#&gt;  2: MCID3111264877 Institution B 19903 140201     02 Second-year</span></span>
<span><span class="co">#&gt;  3: MCID3111264877 Institution B 19911 140201     02 Second-year</span></span>
<span><span class="co">#&gt;  4: MCID3111264877 Institution B 19913 140801      03 Third-year</span></span>
<span><span class="co">#&gt;  5: MCID3111264877 Institution B 19914 140801      03 Third-year</span></span>
<span><span class="co">#&gt;  6: MCID3111264877 Institution B 19921 240199      03 Third-year</span></span>
<span><span class="co">#&gt;  7: MCID3111264877 Institution B 19923 261399     04 Fourth-year</span></span>
<span><span class="co">#&gt;  8: MCID3111264877 Institution B 19931 261399     04 Fourth-year</span></span>
<span><span class="co">#&gt;  9: MCID3111264877 Institution B 19933 261399 05 Fifth-year Plus</span></span>
<span><span class="co">#&gt; 10: MCID3111264877 Institution B 19941 261399 05 Fifth-year Plus</span></span>
<span></span>
<span><span class="co"># Closer look at degree</span></span>
<span><span class="va">degree</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;              mcid   institution term_degree   cip6</span></span>
<span><span class="co">#&gt; 1: MCID3111264877 Institution B       19941 261399</span></span></code></pre></div>
<p><em>Example 4.</em>   This ID yields four observations indicating
that the student was enrolled in Civil, Electrical, and Mechanical
Engineering and a timely graduate of Mechanical.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display one student by ID</span></span>
<span><span class="va">mcid_we_want</span> <span class="op">&lt;-</span> <span class="st">"MCID3112470255"</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;              mcid  race  sex program          bloc</span></span>
<span><span class="co">#&gt; 1: MCID3112470255 White Male      CE ever_enrolled</span></span>
<span><span class="co">#&gt; 2: MCID3112470255 White Male      EE ever_enrolled</span></span>
<span><span class="co">#&gt; 3: MCID3112470255 White Male      ME ever_enrolled</span></span>
<span><span class="co">#&gt; 4: MCID3112470255 White Male      ME     graduates</span></span></code></pre></div>
<p>The <code>term</code> and <code>degree</code> excerpts confirm those
observations.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Closer look at term</span></span>
<span><span class="va">term</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;               mcid   institution  term   cip6              level</span></span>
<span><span class="co">#&gt;  1: MCID3112470255 Institution C 20101 140801      01 First-year</span></span>
<span><span class="co">#&gt;  2: MCID3112470255 Institution C 20103 141001      01 First-year</span></span>
<span><span class="co">#&gt;  3: MCID3112470255 Institution C 20111 141901     02 Second-year</span></span>
<span><span class="co">#&gt;  4: MCID3112470255 Institution C 20113 141901     02 Second-year</span></span>
<span><span class="co">#&gt;  5: MCID3112470255 Institution C 20121 141901      03 Third-year</span></span>
<span><span class="co">#&gt;  6: MCID3112470255 Institution C 20123 141901      03 Third-year</span></span>
<span><span class="co">#&gt;  7: MCID3112470255 Institution C 20124 141901      03 Third-year</span></span>
<span><span class="co">#&gt;  8: MCID3112470255 Institution C 20131 141901     04 Fourth-year</span></span>
<span><span class="co">#&gt;  9: MCID3112470255 Institution C 20133 141901     04 Fourth-year</span></span>
<span><span class="co">#&gt; 10: MCID3112470255 Institution C 20141 141901 05 Fifth-year Plus</span></span>
<span><span class="co">#&gt; 11: MCID3112470255 Institution C 20143 141901 05 Fifth-year Plus</span></span>
<span></span>
<span><span class="co"># Closer look at degree</span></span>
<span><span class="va">degree</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="va">mcid_we_want</span><span class="op">]</span></span>
<span><span class="co">#&gt;              mcid   institution term_degree   cip6</span></span>
<span><span class="co">#&gt; 1: MCID3112470255 Institution C       20143 141901</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs">

</div>
<style type="text/css">
blockquote {
    padding:     10px 20px;
    margin:      0 0 20px;
    border-left: 0px
}
caption {
    color:       #525252;
    text-align:  left;
    font-weight: normal;
    font-size:   medium;
    line-height: 1.5;
}
</style>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/graphdr" class="external-link">Richard Layton</a>, Russell Long, Matthew Ohland, Marisa Orr, Susan Lord.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
