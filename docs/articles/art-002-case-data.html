<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="midfieldr">
<title>Case study: Data • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Courier_Prime-0.4.2/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case study: Data">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="https://midfieldr.github.io/midfieldr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">midfieldr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9029</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/art-000-getting-started.html">Getting started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-study">Case study</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-study">
    <a class="dropdown-item" href="../articles/art-001-case-goals.html">Goals</a>
    <a class="dropdown-item" href="../articles/art-002-case-data.html">Data</a>
    <a class="dropdown-item" href="../articles/art-003-case-results.html">Results</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/art-010-planning.html">Planning</a>
    <a class="dropdown-item" href="../articles/art-020-data-sufficiency.html">Data sufficiency</a>
    <a class="dropdown-item" href="../articles/art-030-degree-seeking.html">Degree seeking</a>
    <a class="dropdown-item" href="../articles/art-040-programs.html">Programs</a>
    <a class="dropdown-item" href="../articles/art-050-blocs.html">Blocs</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MIDFIELDR/midfieldr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Case study: Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/HEAD/vignettes/art-002-case-data.Rmd" class="external-link"><code>vignettes/art-002-case-data.Rmd</code></a></small>
      <div class="d-none name"><code>art-002-case-data.Rmd</code></div>
    </div>

    
    
<p>Part 2 of a case study in three parts, illustrating how we work with
longitudinal Student Unit Records (SUR).</p>
<ol style="list-style-type: decimal">
<li><p><a href="art-001-case-goals.html">Goals.</a> Briefly describe the
study.</p></li>
<li><p>Data (this page). Transforming the data to yield the observations
of interest.</p></li>
<li><p><a href="art-003-case-results.html">Results.</a> Calculating
summary statistics and metrics and displaying the results.</p></li>
</ol>
<div class="section level2">
<h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>Our data processing goal is to reduce the source data tables to the
specific observations needed to compute our metrics. The data processing
tasks include filtering observations (rows), creating, renaming, and
recoding variables (columns), and joining data frames.</p>
<p>The analysis is organized to produce two data frames—students ever
enrolled in the programs and students graduating from the programs—that
are joined and written to file as a starting point for <a href="art-003-case-results.html">Case study: Results</a>.</p>
<p><em>Reminder.</em>   midfielddata is suitable for learning to work
with student-level data but not for drawing inferences about program
attributes or student experiences. midfielddata supplies practice data,
not research data.</p>
</div>
<div class="section level2">
<h2 id="load-practice-data">Load practice data<a class="anchor" aria-label="anchor" href="#load-practice-data"></a>
</h2>
<p><em>Start a script</em>. If you are writing your own script to follow
along, we use these packages in this article:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Case study: Data</span></span>
<span><span class="co"># midfieldr article</span></span>
<span></span>
<span><span class="co"># Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://midfieldr.github.io/midfieldr/">midfieldr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://midfieldr.github.io/midfielddata/" class="external-link">midfielddata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing options for data.table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>  datatable.print.nrows <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  datatable.print.topn <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  datatable.print.class <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><em>Load source data.</em> MIDFIELD practice data tables as described
in <a href="art-000-getting-started.html">Getting started</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load practice data sets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span>, <span class="va">degree</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="initial-processing">Initial processing<a class="anchor" aria-label="anchor" href="#initial-processing"></a>
</h2>
<p><em>Optional.</em> Reduce the dimensions of MIDFIELD data tables. A
convenience function to reduce the dimensions of a MIDFIELD data table
at the start of a session by selecting only those columns typically
required by other midfieldr functions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Work with required midfieldr variables only</span></span>
<span><span class="va">student</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">student</span><span class="op">)</span></span>
<span><span class="va">term</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="va">degree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">degree</span><span class="op">)</span></span></code></pre></div>
<p><em>Copying.</em> Prevents operations on <code>DT</code> from
affecting <code>term</code> by reference <span class="citation">(<a href="#ref-data.table-reference-semantics" role="doc-biblioref">Dowle
&amp; Srinivasan, 2022</a>)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Working data frame</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   mcid   institution   term   cip6          level</span></span>
<span><span class="co">#&gt;                 &lt;char&gt;        &lt;char&gt; &lt;char&gt; &lt;char&gt;         &lt;char&gt;</span></span>
<span><span class="co">#&gt;      1: MCID3111142225 Institution B  19881 140901  01 First-year</span></span>
<span><span class="co">#&gt;      2: MCID3111142283 Institution J  19881 240102  01 First-year</span></span>
<span><span class="co">#&gt;      3: MCID3111142283 Institution J  19883 240102  01 First-year</span></span>
<span><span class="co">#&gt;      4: MCID3111142283 Institution J  19885 190601  01 First-year</span></span>
<span><span class="co">#&gt;      5: MCID3111142283 Institution J  19891 190601 02 Second-year</span></span>
<span><span class="co">#&gt;     ---                                                          </span></span>
<span><span class="co">#&gt; 639911: MCID3112898886 Institution B  20181 500501  01 First-year</span></span>
<span><span class="co">#&gt; 639912: MCID3112898890 Institution B  20181 451101  01 First-year</span></span>
<span><span class="co">#&gt; 639913: MCID3112898894 Institution B  20181 451001  01 First-year</span></span>
<span><span class="co">#&gt; 639914: MCID3112898895 Institution B  20181 302001  01 First-year</span></span>
<span><span class="co">#&gt; 639915: MCID3112898940 Institution B  20181 050103  01 First-year</span></span></code></pre></div>
<p>The result has 639,915 observations. We will usually note the number
of observations as they change.</p>
<p><em>Filtering.</em> In this study, only two variables from the
<code>term</code> data are needed to start: student ID <code>mcid</code>
and program code <code>cip6</code>. We drop unnecessary columns then
remove duplicate rows such that we have unique combinations of student
ID and program CIP.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Minimize the dimensions of the data</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   mcid   cip6</span></span>
<span><span class="co">#&gt;                 &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;      1: MCID3111142225 140901</span></span>
<span><span class="co">#&gt;      2: MCID3111142283 240102</span></span>
<span><span class="co">#&gt;      3: MCID3111142283 190601</span></span>
<span><span class="co">#&gt;      4: MCID3111142283 450601</span></span>
<span><span class="co">#&gt;      5: MCID3111142290 140102</span></span>
<span><span class="co">#&gt;     ---                      </span></span>
<span><span class="co">#&gt; 159135: MCID3112898886 500501</span></span>
<span><span class="co">#&gt; 159136: MCID3112898890 451101</span></span>
<span><span class="co">#&gt; 159137: MCID3112898894 451001</span></span>
<span><span class="co">#&gt; 159138: MCID3112898895 302001</span></span>
<span><span class="co">#&gt; 159139: MCID3112898940 050103</span></span>
<span></span>
<span><span class="co"># Count unique IDs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">mcid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 97555</span></span></code></pre></div>
<p>The result has 159,139 observations of 97,555 unique students. The
number of unique students is smaller than the number of observations
because some students change programs over their course of study. Here
we have one row per unique combination of student (<code>mcid</code>)
and program code (<code>cip6</code>).</p>
</div>
<div class="section level2">
<h2 id="filter-for-data-sufficiency">Filter for data sufficiency<a class="anchor" aria-label="anchor" href="#filter-for-data-sufficiency"></a>
</h2>
<p>Some student records near the lower and upper terms that bound the
available data must be excluded to prevent false summaries involving
timely degree completion. To apply this filter, we determine the timely
completion term then data sufficiency.</p>
<p><em>Creating variables.</em> Using information in <code>term</code>,
we add the <code>timely_term</code> variable as well as supporting
variables used in its construction.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate a timely completion term for every student</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   mcid   cip6 term_i       level_i adj_span timely_term</span></span>
<span><span class="co">#&gt;                 &lt;char&gt; &lt;char&gt; &lt;char&gt;        &lt;char&gt;    &lt;num&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt;      1: MCID3111142225 140901  19881 01 First-year        6       19933</span></span>
<span><span class="co">#&gt;      2: MCID3111142283 190601  19881 01 First-year        6       19933</span></span>
<span><span class="co">#&gt;      3: MCID3111142283 240102  19881 01 First-year        6       19933</span></span>
<span><span class="co">#&gt;      4: MCID3111142283 450601  19881 01 First-year        6       19933</span></span>
<span><span class="co">#&gt;      5: MCID3111142290 140102  19881 01 First-year        6       19933</span></span>
<span><span class="co">#&gt;     ---                                                                </span></span>
<span><span class="co">#&gt; 159135: MCID3112898886 500501  20181 01 First-year        6       20233</span></span>
<span><span class="co">#&gt; 159136: MCID3112898890 451101  20181 01 First-year        6       20233</span></span>
<span><span class="co">#&gt; 159137: MCID3112898894 451001  20181 01 First-year        6       20233</span></span>
<span><span class="co">#&gt; 159138: MCID3112898895 302001  20181 01 First-year        6       20233</span></span>
<span><span class="co">#&gt; 159139: MCID3112898940 050103  20181 01 First-year        6       20233</span></span></code></pre></div>
<p><em>Creating variables.</em> Using information in <code>term</code>,
we add the <code>data_sufficiency</code> variable as well as supporting
variables used in its construction.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Determine data sufficiency for every student</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   mcid   cip6       level_i adj_span timely_term term_i</span></span>
<span><span class="co">#&gt;                 &lt;char&gt; &lt;char&gt;        &lt;char&gt;    &lt;num&gt;      &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;      1: MCID3111142225 140901 01 First-year        6       19933  19881</span></span>
<span><span class="co">#&gt;      2: MCID3111142283 190601 01 First-year        6       19933  19881</span></span>
<span><span class="co">#&gt;      3: MCID3111142283 240102 01 First-year        6       19933  19881</span></span>
<span><span class="co">#&gt;      4: MCID3111142283 450601 01 First-year        6       19933  19881</span></span>
<span><span class="co">#&gt;      5: MCID3111142290 140102 01 First-year        6       19933  19881</span></span>
<span><span class="co">#&gt;     ---                                                                </span></span>
<span><span class="co">#&gt; 159135: MCID3112898886 500501 01 First-year        6       20233  20181</span></span>
<span><span class="co">#&gt; 159136: MCID3112898890 451101 01 First-year        6       20233  20181</span></span>
<span><span class="co">#&gt; 159137: MCID3112898894 451001 01 First-year        6       20233  20181</span></span>
<span><span class="co">#&gt; 159138: MCID3112898895 302001 01 First-year        6       20233  20181</span></span>
<span><span class="co">#&gt; 159139: MCID3112898940 050103 01 First-year        6       20233  20181</span></span>
<span><span class="co">#&gt;         lower_limit upper_limit data_sufficiency</span></span>
<span><span class="co">#&gt;              &lt;char&gt;      &lt;char&gt;           &lt;char&gt;</span></span>
<span><span class="co">#&gt;      1:       19881       20181    exclude-lower</span></span>
<span><span class="co">#&gt;      2:       19881       20096    exclude-lower</span></span>
<span><span class="co">#&gt;      3:       19881       20096    exclude-lower</span></span>
<span><span class="co">#&gt;      4:       19881       20096    exclude-lower</span></span>
<span><span class="co">#&gt;      5:       19881       20096    exclude-lower</span></span>
<span><span class="co">#&gt;     ---                                         </span></span>
<span><span class="co">#&gt; 159135:       19881       20181    exclude-upper</span></span>
<span><span class="co">#&gt; 159136:       19881       20181    exclude-upper</span></span>
<span><span class="co">#&gt; 159137:       19881       20181    exclude-upper</span></span>
<span><span class="co">#&gt; 159138:       19881       20181    exclude-upper</span></span>
<span><span class="co">#&gt; 159139:       19881       20181    exclude-upper</span></span></code></pre></div>
<p><em>Filtering.</em> We filter to retain observations for which the
data are sufficient then drop unnecessary columns.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retain observations having sufficient data</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">data_sufficiency</span> <span class="op">==</span> <span class="st">"include"</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   mcid   cip6</span></span>
<span><span class="co">#&gt;                 &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;      1: MCID3111142689 090401</span></span>
<span><span class="co">#&gt;      2: MCID3111142782 260101</span></span>
<span><span class="co">#&gt;      3: MCID3111142881 450601</span></span>
<span><span class="co">#&gt;      4: MCID3111142884 260406</span></span>
<span><span class="co">#&gt;      5: MCID3111142893 400801</span></span>
<span><span class="co">#&gt;     ---                      </span></span>
<span><span class="co">#&gt; 127345: MCID3112785480 240102</span></span>
<span><span class="co">#&gt; 127346: MCID3112785480 261201</span></span>
<span><span class="co">#&gt; 127347: MCID3112800920 240102</span></span>
<span><span class="co">#&gt; 127348: MCID3112800920 240199</span></span>
<span><span class="co">#&gt; 127349: MCID3112870009 240102</span></span></code></pre></div>
<p>The result has 127,349 observations of 76,875 unique students.</p>
</div>
<div class="section level2">
<h2 id="filter-for-degree-seeking">Filter for degree-seeking<a class="anchor" aria-label="anchor" href="#filter-for-degree-seeking"></a>
</h2>
<p>In studying stickiness, we exclude non-degree-seeking students. We
filter such students using the <code>student</code> data which contains
only degree seeking students.</p>
<p><em>Filtering.</em> An inner join with <code>student</code> that
returns rows with matching IDs from both data frames, then selected
columns.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inner join that filters DT</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">student</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   mcid   cip6</span></span>
<span><span class="co">#&gt;                 &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;      1: MCID3111142689 090401</span></span>
<span><span class="co">#&gt;      2: MCID3111142782 260101</span></span>
<span><span class="co">#&gt;      3: MCID3111142881 450601</span></span>
<span><span class="co">#&gt;      4: MCID3111142884 260406</span></span>
<span><span class="co">#&gt;      5: MCID3111142893 400801</span></span>
<span><span class="co">#&gt;     ---                      </span></span>
<span><span class="co">#&gt; 127345: MCID3112785480 240102</span></span>
<span><span class="co">#&gt; 127346: MCID3112785480 261201</span></span>
<span><span class="co">#&gt; 127347: MCID3112800920 240102</span></span>
<span><span class="co">#&gt; 127348: MCID3112800920 240199</span></span>
<span><span class="co">#&gt; 127349: MCID3112870009 240102</span></span></code></pre></div>
<p>The result has 127,349 observations. (No change is expected in this
example because all students in the midfielddata practice data are
degree-seeking.)</p>
</div>
<div class="section level2">
<h2 id="identify-programs">Identify programs<a class="anchor" aria-label="anchor" href="#identify-programs"></a>
</h2>
<p>The <code>cip6</code> variable in our data identifies the program in
which a student is enrolled in a given term, based on the US
<em>Classification of Instructional Programs</em> (CIP) codes.</p>
<p>CIP codes and names are included with midfieldr in the
<code>cip</code> data set. We have searched that information to obtain
the CIP codes for the four programs in our case study: Civil Engineering
CIPs start with 1408, Electrical Engineering 1410, Mechanical
Engineering 1419, and Industrial/Systems Engineering 1427, 1435, 1436,
and 1437.</p>
<p><em>Filtering</em> Gather the 6-digit CIP codes for the programs in
the case study. Drop unnecessary variables. We keep the
<code>cip4name</code> because, in engineering at least, the 4-digit name
tends to be a disciplinary or departmental name.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gather program CIP codes</span></span>
<span><span class="va">case_programs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_cip.html">filter_cip</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"^1408"</span>, <span class="st">"^1410"</span>, <span class="st">"^1419"</span>, <span class="st">"^1427"</span>, <span class="st">"^1435"</span>, <span class="st">"^1436"</span>, <span class="st">"^1437"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">case_programs</span> <span class="op">&lt;-</span> <span class="va">case_programs</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip6</span>, <span class="va">cip4name</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">case_programs</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;       cip6                                               cip4name</span></span>
<span><span class="co">#&gt;     &lt;char&gt;                                                 &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1: 140801                                      Civil Engineering</span></span>
<span><span class="co">#&gt;  2: 140802                                      Civil Engineering</span></span>
<span><span class="co">#&gt;  3: 140803                                      Civil Engineering</span></span>
<span><span class="co">#&gt;  4: 140804                                      Civil Engineering</span></span>
<span><span class="co">#&gt;  5: 140805                                      Civil Engineering</span></span>
<span><span class="co">#&gt;  6: 140899                                      Civil Engineering</span></span>
<span><span class="co">#&gt;  7: 141001 Electrical, Electronics and Communications Engineering</span></span>
<span><span class="co">#&gt;  8: 141003 Electrical, Electronics and Communications Engineering</span></span>
<span><span class="co">#&gt;  9: 141004 Electrical, Electronics and Communications Engineering</span></span>
<span><span class="co">#&gt; 10: 141099 Electrical, Electronics and Communications Engineering</span></span>
<span><span class="co">#&gt; 11: 141901                                 Mechanical Engineering</span></span>
<span><span class="co">#&gt; 12: 142701                                    Systems Engineering</span></span>
<span><span class="co">#&gt; 13: 143501                                 Industrial Engineering</span></span>
<span><span class="co">#&gt; 14: 143601                              Manufacturing Engineering</span></span>
<span><span class="co">#&gt; 15: 143701                                    Operations Research</span></span></code></pre></div>
<p><em>Creating variables.</em> Add a variable to label each of these 15
programs with one of the four conventional program abbreviations we will
use in comparing metrics, i.e., Civil (CE), Electrical (EE), Mechanical
(ME), and Industrial/Systems Engineering (ISE).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign four program names by CIP code</span></span>
<span><span class="va">case_programs</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span>
<span>  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1408"</span>, <span class="st">"CE"</span>,</span>
<span>  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1410"</span>, <span class="st">"EE"</span>,</span>
<span>  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1419"</span>, <span class="st">"ME"</span>,</span>
<span>  <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"142701"</span>, <span class="st">"143501"</span>, <span class="st">"143601"</span>, <span class="st">"143701"</span><span class="op">)</span>, <span class="st">"ISE"</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Confirm that abbreviations match the longer program names</span></span>
<span><span class="va">case_programs</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip4name</span>, <span class="va">program</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                                   cip4name program</span></span>
<span><span class="co">#&gt;                                                     &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  2:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  3:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  4:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  5:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  6:                                      Civil Engineering      CE</span></span>
<span><span class="co">#&gt;  7: Electrical, Electronics and Communications Engineering      EE</span></span>
<span><span class="co">#&gt;  8: Electrical, Electronics and Communications Engineering      EE</span></span>
<span><span class="co">#&gt;  9: Electrical, Electronics and Communications Engineering      EE</span></span>
<span><span class="co">#&gt; 10: Electrical, Electronics and Communications Engineering      EE</span></span>
<span><span class="co">#&gt; 11:                                 Mechanical Engineering      ME</span></span>
<span><span class="co">#&gt; 12:                                    Systems Engineering     ISE</span></span>
<span><span class="co">#&gt; 13:                                 Industrial Engineering     ISE</span></span>
<span><span class="co">#&gt; 14:                              Manufacturing Engineering     ISE</span></span>
<span><span class="co">#&gt; 15:                                    Operations Research     ISE</span></span></code></pre></div>
<p>Having checked that the new abbreviations correctly represent the
programs, we can finalize the data frame of program CIPs and names.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Case study CIPs and program names</span></span>
<span><span class="va">case_programs</span><span class="op">[</span>, <span class="va">cip4name</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">case_programs</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;       cip6 program</span></span>
<span><span class="co">#&gt;     &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1: 140801      CE</span></span>
<span><span class="co">#&gt;  2: 140802      CE</span></span>
<span><span class="co">#&gt;  3: 140803      CE</span></span>
<span><span class="co">#&gt;  4: 140804      CE</span></span>
<span><span class="co">#&gt;  5: 140805      CE</span></span>
<span><span class="co">#&gt;  6: 140899      CE</span></span>
<span><span class="co">#&gt;  7: 141001      EE</span></span>
<span><span class="co">#&gt;  8: 141003      EE</span></span>
<span><span class="co">#&gt;  9: 141004      EE</span></span>
<span><span class="co">#&gt; 10: 141099      EE</span></span>
<span><span class="co">#&gt; 11: 141901      ME</span></span>
<span><span class="co">#&gt; 12: 142701     ISE</span></span>
<span><span class="co">#&gt; 13: 143501     ISE</span></span>
<span><span class="co">#&gt; 14: 143601     ISE</span></span>
<span><span class="co">#&gt; 15: 143701     ISE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gather-ever-enrolled">Gather ever enrolled<a class="anchor" aria-label="anchor" href="#gather-ever-enrolled"></a>
</h2>
<p><em>Joining.</em> We join the program names in
<code>case_programs</code> to the working data frame using a left-outer
join and return selected rows.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Left-outer join to DT</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">case_programs</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span>, <span class="va">program</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   mcid   cip6 program</span></span>
<span><span class="co">#&gt;                 &lt;char&gt; &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">#&gt;      1: MCID3111142689 090401    &lt;NA&gt;</span></span>
<span><span class="co">#&gt;      2: MCID3111142782 260101    &lt;NA&gt;</span></span>
<span><span class="co">#&gt;      3: MCID3111142881 450601    &lt;NA&gt;</span></span>
<span><span class="co">#&gt;      4: MCID3111142884 260406    &lt;NA&gt;</span></span>
<span><span class="co">#&gt;      5: MCID3111142893 400801    &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     ---                              </span></span>
<span><span class="co">#&gt; 127345: MCID3112785480 240102    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 127346: MCID3112785480 261201    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 127347: MCID3112800920 240102    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 127348: MCID3112800920 240199    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 127349: MCID3112870009 240102    &lt;NA&gt;</span></span></code></pre></div>
<p><em>Filtering.</em> All instances of NA programs are dropped.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retain observations in our four programs</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid   cip6 program</span></span>
<span><span class="co">#&gt;               &lt;char&gt; &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965 141001      EE</span></span>
<span><span class="co">#&gt;    2: MCID3111145102 141001      EE</span></span>
<span><span class="co">#&gt;    3: MCID3111146537 141001      EE</span></span>
<span><span class="co">#&gt;    4: MCID3111146674 141001      EE</span></span>
<span><span class="co">#&gt;    5: MCID3111150194 143501     ISE</span></span>
<span><span class="co">#&gt;   ---                              </span></span>
<span><span class="co">#&gt; 5653: MCID3112619484 141001      EE</span></span>
<span><span class="co">#&gt; 5654: MCID3112619666 141901      ME</span></span>
<span><span class="co">#&gt; 5655: MCID3112641399 141901      ME</span></span>
<span><span class="co">#&gt; 5656: MCID3112641535 141901      ME</span></span>
<span><span class="co">#&gt; 5657: MCID3112698681 141901      ME</span></span></code></pre></div>
<p>The result has 5657 observations of 5427 unique students.</p>
<p><em>Filtering.</em> A program label can be associated with multiple
CIP codes. We drop the code and filter to remove duplicates to ensure
unique combinations of ID and program.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Drop duplicate rows</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">cip6</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid program</span></span>
<span><span class="co">#&gt;               &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965      EE</span></span>
<span><span class="co">#&gt;    2: MCID3111145102      EE</span></span>
<span><span class="co">#&gt;    3: MCID3111146537      EE</span></span>
<span><span class="co">#&gt;    4: MCID3111146674      EE</span></span>
<span><span class="co">#&gt;    5: MCID3111150194     ISE</span></span>
<span><span class="co">#&gt;   ---                       </span></span>
<span><span class="co">#&gt; 5649: MCID3112619484      EE</span></span>
<span><span class="co">#&gt; 5650: MCID3112619666      ME</span></span>
<span><span class="co">#&gt; 5651: MCID3112641399      ME</span></span>
<span><span class="co">#&gt; 5652: MCID3112641535      ME</span></span>
<span><span class="co">#&gt; 5653: MCID3112698681      ME</span></span></code></pre></div>
<p>The result has 5653 observations of 5427 unique students.</p>
<p><em>Creating variables.</em> Add a variable to label this group as
“ever” enrolled to distinguish them from the group of graduates to be
created next. Copy the data frame to a new name to save for later.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Conclude development of the ever-enrolled observations</span></span>
<span><span class="va">ever</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">ever</span><span class="op">[</span>, <span class="va">group</span> <span class="op">:=</span> <span class="st">"ever"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">ever</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid program  group</span></span>
<span><span class="co">#&gt;               &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965      EE   ever</span></span>
<span><span class="co">#&gt;    2: MCID3111145102      EE   ever</span></span>
<span><span class="co">#&gt;    3: MCID3111146537      EE   ever</span></span>
<span><span class="co">#&gt;    4: MCID3111146674      EE   ever</span></span>
<span><span class="co">#&gt;    5: MCID3111150194     ISE   ever</span></span>
<span><span class="co">#&gt;   ---                              </span></span>
<span><span class="co">#&gt; 5649: MCID3112619484      EE   ever</span></span>
<span><span class="co">#&gt; 5650: MCID3112619666      ME   ever</span></span>
<span><span class="co">#&gt; 5651: MCID3112641399      ME   ever</span></span>
<span><span class="co">#&gt; 5652: MCID3112641535      ME   ever</span></span>
<span><span class="co">#&gt; 5653: MCID3112698681      ME   ever</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="subset-for-graduates">Subset for graduates<a class="anchor" aria-label="anchor" href="#subset-for-graduates"></a>
</h2>
<p><em>Filtering.</em> Students potentially counted as graduates must be
a subset of those in the ever enrolled population. We re-initialize the
working data frame, retaining unique IDs only.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Unique IDs of students ever enrolled in the study programs</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid</span></span>
<span><span class="co">#&gt;               &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965</span></span>
<span><span class="co">#&gt;    2: MCID3111145102</span></span>
<span><span class="co">#&gt;    3: MCID3111146537</span></span>
<span><span class="co">#&gt;    4: MCID3111146674</span></span>
<span><span class="co">#&gt;    5: MCID3111150194</span></span>
<span><span class="co">#&gt;   ---               </span></span>
<span><span class="co">#&gt; 5423: MCID3112619484</span></span>
<span><span class="co">#&gt; 5424: MCID3112619666</span></span>
<span><span class="co">#&gt; 5425: MCID3112641399</span></span>
<span><span class="co">#&gt; 5426: MCID3112641535</span></span>
<span><span class="co">#&gt; 5427: MCID3112698681</span></span></code></pre></div>
<p><em>Filtering.</em> An inner join with <code>degree</code> that
returns rows with matching IDs from both data frames, then selected
columns.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inner join that filters DT</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">degree</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid   cip6</span></span>
<span><span class="co">#&gt;               &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965 141001</span></span>
<span><span class="co">#&gt;    2: MCID3111145102 141001</span></span>
<span><span class="co">#&gt;    3: MCID3111146537 141001</span></span>
<span><span class="co">#&gt;    4: MCID3111146674 141001</span></span>
<span><span class="co">#&gt;    5: MCID3111150194 143501</span></span>
<span><span class="co">#&gt;   ---                      </span></span>
<span><span class="co">#&gt; 4194: MCID3112618976 141901</span></span>
<span><span class="co">#&gt; 4195: MCID3112619484 141001</span></span>
<span><span class="co">#&gt; 4196: MCID3112641399 270301</span></span>
<span><span class="co">#&gt; 4197: MCID3112641535 141901</span></span>
<span><span class="co">#&gt; 4198: MCID3112698681 110701</span></span></code></pre></div>
<p>The result has 4198 observations of 4182 unique students. These IDs
have already been filtered for data sufficiency and degree-seeking.</p>
</div>
<div class="section level2">
<h2 id="filter-graduates-by-completion-status">Filter graduates by completion status<a class="anchor" aria-label="anchor" href="#filter-graduates-by-completion-status"></a>
</h2>
<p>To be counted as a graduate in the stickiness metric, a student must
complete their program in a timely manner (default 6 years after
admission, with reduced spans for some transfer students).</p>
<p><em>Add variables.</em> Completion status requires the timely
completion term variable.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate a timely completion term for every student</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid   cip6 term_i        level_i adj_span timely_term</span></span>
<span><span class="co">#&gt;               &lt;char&gt; &lt;char&gt; &lt;char&gt;         &lt;char&gt;    &lt;num&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965 141001  19883  01 First-year        6       19941</span></span>
<span><span class="co">#&gt;    2: MCID3111145102 141001  19883  01 First-year        6       19941</span></span>
<span><span class="co">#&gt;    3: MCID3111146537 141001  19883 02 Second-year        5       19931</span></span>
<span><span class="co">#&gt;    4: MCID3111146674 141001  19883  01 First-year        6       19941</span></span>
<span><span class="co">#&gt;    5: MCID3111150194 143501  19883  01 First-year        6       19941</span></span>
<span><span class="co">#&gt;   ---                                                                 </span></span>
<span><span class="co">#&gt; 4194: MCID3112618976 141901  20123  01 First-year        6       20181</span></span>
<span><span class="co">#&gt; 4195: MCID3112619484 141001  20123  01 First-year        6       20181</span></span>
<span><span class="co">#&gt; 4196: MCID3112641399 270301  20123  01 First-year        6       20181</span></span>
<span><span class="co">#&gt; 4197: MCID3112641535 141901  20121  01 First-year        6       20173</span></span>
<span><span class="co">#&gt; 4198: MCID3112698681 110701  20113  01 First-year        6       20171</span></span></code></pre></div>
<p><em>Creating variables.</em> Using information in
<code>degree</code>, we add the <code>completion_status</code> variable
as well as supporting variables used in its construction.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Determine completion status for every student</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_completion_status.html">add_completion_status</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">degree</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid   cip6 term_i        level_i adj_span timely_term</span></span>
<span><span class="co">#&gt;               &lt;char&gt; &lt;char&gt; &lt;char&gt;         &lt;char&gt;    &lt;num&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965 141001  19883  01 First-year        6       19941</span></span>
<span><span class="co">#&gt;    2: MCID3111145102 141001  19883  01 First-year        6       19941</span></span>
<span><span class="co">#&gt;    3: MCID3111146537 141001  19883 02 Second-year        5       19931</span></span>
<span><span class="co">#&gt;    4: MCID3111146674 141001  19883  01 First-year        6       19941</span></span>
<span><span class="co">#&gt;    5: MCID3111150194 143501  19883  01 First-year        6       19941</span></span>
<span><span class="co">#&gt;   ---                                                                 </span></span>
<span><span class="co">#&gt; 4194: MCID3112618976 141901  20123  01 First-year        6       20181</span></span>
<span><span class="co">#&gt; 4195: MCID3112619484 141001  20123  01 First-year        6       20181</span></span>
<span><span class="co">#&gt; 4196: MCID3112641399 270301  20123  01 First-year        6       20181</span></span>
<span><span class="co">#&gt; 4197: MCID3112641535 141901  20121  01 First-year        6       20173</span></span>
<span><span class="co">#&gt; 4198: MCID3112698681 110701  20113  01 First-year        6       20171</span></span>
<span><span class="co">#&gt;       term_degree completion_status</span></span>
<span><span class="co">#&gt;            &lt;char&gt;            &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1:       19901            timely</span></span>
<span><span class="co">#&gt;    2:       19893            timely</span></span>
<span><span class="co">#&gt;    3:       19913            timely</span></span>
<span><span class="co">#&gt;    4:       19921            timely</span></span>
<span><span class="co">#&gt;    5:       19923            timely</span></span>
<span><span class="co">#&gt;   ---                              </span></span>
<span><span class="co">#&gt; 4194:       20153            timely</span></span>
<span><span class="co">#&gt; 4195:       20133            timely</span></span>
<span><span class="co">#&gt; 4196:       20163            timely</span></span>
<span><span class="co">#&gt; 4197:       20143            timely</span></span>
<span><span class="co">#&gt; 4198:       20181              late</span></span></code></pre></div>
<p><em>Filtering.</em> Retain records with “positive” completion status
(i.e. completion in 6 years or less) and drop unnecessary variables.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retain timely completers</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">completion_status</span> <span class="op">==</span> <span class="st">"timely"</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid   cip6</span></span>
<span><span class="co">#&gt;               &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965 141001</span></span>
<span><span class="co">#&gt;    2: MCID3111145102 141001</span></span>
<span><span class="co">#&gt;    3: MCID3111146537 141001</span></span>
<span><span class="co">#&gt;    4: MCID3111146674 141001</span></span>
<span><span class="co">#&gt;    5: MCID3111150194 143501</span></span>
<span><span class="co">#&gt;   ---                      </span></span>
<span><span class="co">#&gt; 3912: MCID3112618574 141901</span></span>
<span><span class="co">#&gt; 3913: MCID3112618976 141901</span></span>
<span><span class="co">#&gt; 3914: MCID3112619484 141001</span></span>
<span><span class="co">#&gt; 3915: MCID3112641399 270301</span></span>
<span><span class="co">#&gt; 3916: MCID3112641535 141901</span></span></code></pre></div>
<p>The result has 3916 unique observations.</p>
</div>
<div class="section level2">
<h2 id="filter-graduates-by-program">Filter graduates by program<a class="anchor" aria-label="anchor" href="#filter-graduates-by-program"></a>
</h2>
<p>We join the program names to the working data frame using a
left-outer join and return selected rows. We then filter to retain
program names that are not NA.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Left-outer join to DT</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">case_programs</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">program</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Unique observations</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid program</span></span>
<span><span class="co">#&gt;               &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965      EE</span></span>
<span><span class="co">#&gt;    2: MCID3111145102      EE</span></span>
<span><span class="co">#&gt;    3: MCID3111146537      EE</span></span>
<span><span class="co">#&gt;    4: MCID3111146674      EE</span></span>
<span><span class="co">#&gt;    5: MCID3111150194     ISE</span></span>
<span><span class="co">#&gt;   ---                       </span></span>
<span><span class="co">#&gt; 3249: MCID3112618553      ME</span></span>
<span><span class="co">#&gt; 3250: MCID3112618574      ME</span></span>
<span><span class="co">#&gt; 3251: MCID3112618976      ME</span></span>
<span><span class="co">#&gt; 3252: MCID3112619484      EE</span></span>
<span><span class="co">#&gt; 3253: MCID3112641535      ME</span></span></code></pre></div>
<p>The result has 3253 unique observations.</p>
<p><em>Creating variables.</em> Add a variable to label this group as
“grad” to distinguish them from the group of ever enrolled students
created earlier.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Conclude development of the graduate observations</span></span>
<span><span class="va">grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">grad</span><span class="op">[</span>, <span class="va">group</span> <span class="op">:=</span> <span class="st">"grad"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">grad</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid program  group</span></span>
<span><span class="co">#&gt;               &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965      EE   grad</span></span>
<span><span class="co">#&gt;    2: MCID3111145102      EE   grad</span></span>
<span><span class="co">#&gt;    3: MCID3111146537      EE   grad</span></span>
<span><span class="co">#&gt;    4: MCID3111146674      EE   grad</span></span>
<span><span class="co">#&gt;    5: MCID3111150194     ISE   grad</span></span>
<span><span class="co">#&gt;   ---                              </span></span>
<span><span class="co">#&gt; 3249: MCID3112618553      ME   grad</span></span>
<span><span class="co">#&gt; 3250: MCID3112618574      ME   grad</span></span>
<span><span class="co">#&gt; 3251: MCID3112618976      ME   grad</span></span>
<span><span class="co">#&gt; 3252: MCID3112619484      EE   grad</span></span>
<span><span class="co">#&gt; 3253: MCID3112641535      ME   grad</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combine-ever-and-grad">Combine ever and grad<a class="anchor" aria-label="anchor" href="#combine-ever-and-grad"></a>
</h2>
<p><em>Binding.</em> Combine two data frames by matching column
names.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine two data frames</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ever</span>, <span class="va">grad</span><span class="op">)</span>, use.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid program  group</span></span>
<span><span class="co">#&gt;               &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965      EE   ever</span></span>
<span><span class="co">#&gt;    2: MCID3111145102      EE   ever</span></span>
<span><span class="co">#&gt;    3: MCID3111146537      EE   ever</span></span>
<span><span class="co">#&gt;    4: MCID3111146674      EE   ever</span></span>
<span><span class="co">#&gt;    5: MCID3111150194     ISE   ever</span></span>
<span><span class="co">#&gt;   ---                              </span></span>
<span><span class="co">#&gt; 8902: MCID3112618553      ME   grad</span></span>
<span><span class="co">#&gt; 8903: MCID3112618574      ME   grad</span></span>
<span><span class="co">#&gt; 8904: MCID3112618976      ME   grad</span></span>
<span><span class="co">#&gt; 8905: MCID3112619484      EE   grad</span></span>
<span><span class="co">#&gt; 8906: MCID3112641535      ME   grad</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-demographics">Add demographics<a class="anchor" aria-label="anchor" href="#add-demographics"></a>
</h2>
<p><em>Creating variables.</em> Using columns from <code>student</code>,
we add variables for race/ethnicity and sex using a left-outer join. All
rows and columns of DT are returned with two columns added from
<code>student</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Selecting columns from student</span></span>
<span><span class="va">student_cols</span> <span class="op">&lt;-</span> <span class="va">student</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">race</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Add them to DT with a left join</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">student_cols</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 mcid          race    sex program  group</span></span>
<span><span class="co">#&gt;               &lt;char&gt;        &lt;char&gt; &lt;char&gt;  &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MCID3111142965 International   Male      EE   ever</span></span>
<span><span class="co">#&gt;    2: MCID3111145102         White   Male      EE   ever</span></span>
<span><span class="co">#&gt;    3: MCID3111146537         Asian Female      EE   ever</span></span>
<span><span class="co">#&gt;    4: MCID3111146674         Asian   Male      EE   ever</span></span>
<span><span class="co">#&gt;    5: MCID3111150194         Black   Male     ISE   ever</span></span>
<span><span class="co">#&gt;   ---                                                   </span></span>
<span><span class="co">#&gt; 8902: MCID3112618553 International   Male      ME   grad</span></span>
<span><span class="co">#&gt; 8903: MCID3112618574 International   Male      ME   grad</span></span>
<span><span class="co">#&gt; 8904: MCID3112618976         White   Male      ME   grad</span></span>
<span><span class="co">#&gt; 8905: MCID3112619484         White   Male      EE   grad</span></span>
<span><span class="co">#&gt; 8906: MCID3112641535         White   Male      ME   grad</span></span></code></pre></div>
<p>The result has 8906 observations of 5427 unique students. IDs labeled
“grad” are a subset of those labeled “ever”.</p>
<p><em>Verify built-in data.</em> To avoid deriving this data frame each
time it is needed in other articles, the same information is provided in
the <code>study_observations</code> data frame included with midfieldr.
Here we verify that the two data frames are identical.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate equivalence</span></span>
<span><span class="fu"><a href="../reference/same_content.html">same_content</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">study_observations</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Different number of rows"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="review">Review<a class="anchor" aria-label="anchor" href="#review"></a>
</h2>
<p>To better grasp the structure of these data, we can review selected
sets of observations by ID. In the first example, the ID produces one
observation only. The student was enrolled in Civil Engineering but
completion, if any, was not timely.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display one student by ID</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID26694225"</span><span class="op">]</span></span>
<span><span class="co">#&gt; Empty data.table (0 rows and 5 cols): mcid,race,sex,program,group</span></span></code></pre></div>
<p>In the next example, the ID produces two observations indicating that
the student was enrolled in Civil Engineering and a timely graduate of
that program.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display one student by ID</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25786154"</span><span class="op">]</span></span>
<span><span class="co">#&gt; Empty data.table (0 rows and 5 cols): mcid,race,sex,program,group</span></span></code></pre></div>
<p>In the next example, the ID produces two observations indicating that
the student was enrolled in Electrical Engineering and in Mechanical
Engineering but a timely graduate of neither program.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display one student by ID</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID25868925"</span><span class="op">]</span></span>
<span><span class="co">#&gt; Empty data.table (0 rows and 5 cols): mcid,race,sex,program,group</span></span></code></pre></div>
<p>In the next example, the ID produces three observations indicating
that the student was enrolled in Electrical Engineering and in Civil
Engineering and a timely graduate of Civil.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display one student by ID</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MID26526757"</span><span class="op">]</span></span>
<span><span class="co">#&gt; Empty data.table (0 rows and 5 cols): mcid,race,sex,program,group</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="closing">Closing<a class="anchor" aria-label="anchor" href="#closing"></a>
</h2>
<p>Starting with the <code>student</code>, <code>term</code>, and
<code>degree</code> data tables, we filtered the data for data
sufficiency, degree seeking, program, and timely completion in four
programs (Civil, Electrical, Industrial/Systems, and Mechanical
Engineering) and processed the data to obtain the observations needed to
determine stickiness.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-data.table-reference-semantics" class="csl-entry">
Dowle, M., &amp; Srinivasan, A. (2022). <em><span class="nocase">Reference semantics [data.table]</span></em>. <a href="https://rdatatable.gitlab.io/data.table/articles/datatable-reference-semantics.html" class="external-link">https://rdatatable.gitlab.io/data.table/articles/datatable-reference-semantics.html</a>
</div>
</div>
<style type="text/css">
blockquote {
    padding:     10px 20px;
    margin:      0 0 20px;
    border-left: 0px
}
caption {
    color:       #525252;
    text-align:  left;
    font-weight: normal;
    font-size:   medium;
    line-height: 1.5;
}
</style>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/graphdr" class="external-link">Richard Layton</a>, Russell Long, Matthew Ohland, Marisa Orr, Susan Lord.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
