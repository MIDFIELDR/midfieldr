<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="midfieldr">
<title>Case study---data • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case study---data">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="https://midfieldr.github.io/midfieldr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">midfieldr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9021</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/art-000-getting-started.html">Getting started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-study">Case study</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-study">
    <a class="dropdown-item" href="../articles/art-001-case-goals.html">Goals</a>
    <a class="dropdown-item" href="../articles/art-002-case-data.html">Data</a>
    <a class="dropdown-item" href="../articles/art-003-case-metrics.html">Metrics</a>
    <a class="dropdown-item" href="../articles/art-004-case-displays.html">Displays</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/art-020-data-sufficiency.html">Data sufficiency</a>
    <a class="dropdown-item" href="../articles/art-010-program-codes.html">Program codes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MIDFIELDR/midfieldr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Case study---data</h1>
                        <h4 data-toc-skip class="author">Richard
Layton</h4>
            
            <h4 data-toc-skip class="date">2022-06-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/HEAD/vignettes/art-002-case-data.Rmd" class="external-link"><code>vignettes/art-002-case-data.Rmd</code></a></small>
      <div class="d-none name"><code>art-002-case-data.Rmd</code></div>
    </div>

    
    
<p>Part 2 of a case study in four parts:</p>
<ul>
<li>
<a href="art-001-case-goals.html">Goals.</a> Describing the study
parameters.<br>
</li>
<li>
<a href="art-002-case-data.html">Data.</a> Transforming the data to
yield the observations of interest.</li>
<li>
<a href="art-003-case-metrics.html">Metrics.</a> Calculating summary
statistics and metrics.</li>
<li>
<a href="art-004-case-displays.html">Displays.</a> Creating tables
and charts to display results.</li>
</ul>
<div class="section level2">
<h2 id="preface">Preface<a class="anchor" aria-label="anchor" href="#preface"></a>
</h2>
<p>Our data manipulation goal is to reduce the source data tables to the
specific observations needed to compute our metrics. The data
manipulation tasks include selecting, renaming, and recoding variables,
creating new variables, joining data frames, and filtering
observations.</p>
<p>Computing the stickiness metric requires two data summaries: the
count of students ever enrolled in the study programs and the count of
students graduating from the programs. Therefore, this analysis is
organized to produce a data frame with an ever-enrolled variable and
timely-completion variable with observations keyed by student ID.</p>
<p>If you are writing your own script to follow along, we start with
these packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span><span class="op">)</span>

<span class="co"># Printing options for data.table</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>
  datatable.print.nrows <span class="op">=</span> <span class="fl">15</span>,
  datatable.print.topn <span class="op">=</span> <span class="fl">3</span>,
  datatable.print.class <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-data">Import data<a class="anchor" aria-label="anchor" href="#import-data"></a>
</h2>
<p>All MIDFIELD data are in block-record form, that is, every row is an
observation (keyed by student ID) and every column is a variable. Data
structure is explored in greater detail in the <a href="art-000-getting-started.html">Getting started</a> vignette.</p>
<p><strong>Importing.</strong> Load three of the midfielddata data
tables.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load practice data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span>, <span class="va">degree</span><span class="op">)</span></code></pre></div>
<p>Copy the <code>term</code> data set to create the working data frame
(<code>DT</code>), leaving <code>term</code> unaltered for later
use.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Initialize the working data table</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="co">#&gt; Classes 'data.table' and 'data.frame':   710841 obs. of  13 variables:</span>
<span class="co">#&gt;  $ mcid               : chr  "MID25783135" "MID25783135" "MID25783156" "MID25783156" ...</span>
<span class="co">#&gt;  $ institution        : chr  "Institution M" "Institution M" "Institution M" "Institution M" ...</span>
<span class="co">#&gt;  $ term               : chr  "19911" "19913" "20011" "20013" ...</span>
<span class="co">#&gt;  $ cip6               : chr  "520101" "520101" "040201" "040201" ...</span>
<span class="co">#&gt;  $ level              : chr  "01 Freshman" "02 Sophomore" "01 Freshman" "02 Sophomore" ...</span>
<span class="co">#&gt;  $ standing           : chr  "Good Standing" "Good Standing" "Good Standing" "Good Standing" ...</span>
<span class="co">#&gt;  $ coop               : chr  "No" "No" "No" "No" ...</span>
<span class="co">#&gt;  $ hours_term         : num  19 14 14 16 16 17 18 18 17 9 ...</span>
<span class="co">#&gt;  $ hours_term_attempt : num  19 14 14 16 16 17 18 18 17 13 ...</span>
<span class="co">#&gt;  $ hours_cumul        : num  19 33 14 30 46 63 81 99 17 26 ...</span>
<span class="co">#&gt;  $ hours_cumul_attempt: num  19 33 14 30 46 63 81 99 17 30 ...</span>
<span class="co">#&gt;  $ gpa_term           : num  2.47 3.21 3.07 3.62 3.13 3.82 4 3.5 2.53 1.61 ...</span>
<span class="co">#&gt;  $ gpa_cumul          : num  2.47 2.79 3.07 3.36 3.28 3.42 3.55 3.54 2.53 2.13 ...</span>
<span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt; </span>
<span class="co">#&gt;  - attr(*, "index")= int(0)</span></code></pre></div>
<p>The result has 710,841 observations. We will usually note the number
of observations as they change.</p>
<p><strong>Selecting.</strong> For the stickiness metric, only three
variables are needed: <code>mcid</code> is a key;
<code>institution</code> is required for data sufficiency;
<code>cip6</code> is required for labeling programs. We drop unnecessary
columns.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain necessary columns</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">institution</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;                mcid   institution   cip6</span>
<span class="co">#&gt;              &lt;char&gt;        &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 Institution M 520101</span>
<span class="co">#&gt;      2: MID25783135 Institution M 520101</span>
<span class="co">#&gt;      3: MID25783156 Institution M 040201</span>
<span class="co">#&gt;     ---                                 </span>
<span class="co">#&gt; 710839: MID26697702 Institution L 240101</span>
<span class="co">#&gt; 710840: MID26697702 Institution L 240101</span>
<span class="co">#&gt; 710841: MID26697702 Institution L 240101</span></code></pre></div>
<p><strong>Filtering.</strong> Remove duplicate rows.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain unique observations</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;                mcid   institution   cip6</span>
<span class="co">#&gt;              &lt;char&gt;        &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 Institution M 520101</span>
<span class="co">#&gt;      2: MID25783156 Institution M 040201</span>
<span class="co">#&gt;      3: MID25783162 Institution M 140102</span>
<span class="co">#&gt;     ---                                 </span>
<span class="co">#&gt; 161694: MID26697685 Institution L 521201</span>
<span class="co">#&gt; 161695: MID26697689 Institution L 240101</span>
<span class="co">#&gt; 161696: MID26697702 Institution L 240101</span>

<span class="co"># Count unique IDs</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">mcid</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 94028</span></code></pre></div>
<p>The result has 161,696 observations. The number of unique students is
smaller than the number of observations because students change majors.
Here we have one row per unique combination of student
(<code>mcid</code>) and program (<code>cip6</code>).</p>
</div>
<div class="section level2">
<h2 id="filter-by-data-sufficiency">Filter by data sufficiency<a class="anchor" aria-label="anchor" href="#filter-by-data-sufficiency"></a>
</h2>
<p>The time span of records varies by institution, each having their own
lower and upper bounds. The bounds themselves create ambiguity in some
records, specifically in our estimates of a student’s <em>timely
completion term,</em> the last term by which completing their program
would be considered timely (typically a 6-year span).</p>
<p>We filter observations to retain those with sufficient data.</p>
<p><strong>Creating variables.</strong> Using information in
<code>term</code>, we add <code>timely_term</code>—an estimated timely
completion term for every student.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Data sufficiency requires a timely term </span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_timely_term.html">add_timely_term</a></span><span class="op">(</span><span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;                mcid   institution   cip6 timely_term</span>
<span class="co">#&gt;              &lt;char&gt;        &lt;char&gt; &lt;char&gt;      &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 Institution M 520101       19963</span>
<span class="co">#&gt;      2: MID25783156 Institution M 040201       20063</span>
<span class="co">#&gt;      3: MID25783162 Institution M 140102       19973</span>
<span class="co">#&gt;     ---                                             </span>
<span class="co">#&gt; 161694: MID26697685 Institution L 521201       20203</span>
<span class="co">#&gt; 161695: MID26697689 Institution L 240101       20191</span>
<span class="co">#&gt; 161696: MID26697702 Institution L 240101       20213</span></code></pre></div>
<p><strong>Creating variables.</strong> Again using information in
<code>term</code>, we add <code>data_sufficiency</code>—indicating that
data are sufficient (TRUE/FALSE) for estimating timely completion.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add data sufficiency variable</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_data_sufficiency.html">add_data_sufficiency</a></span><span class="op">(</span><span class="va">DT</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;                mcid   institution   cip6 timely_term data_sufficiency</span>
<span class="co">#&gt;              &lt;char&gt;        &lt;char&gt; &lt;char&gt;      &lt;char&gt;           &lt;lgcl&gt;</span>
<span class="co">#&gt;      1: MID25783135 Institution M 520101       19963             TRUE</span>
<span class="co">#&gt;      2: MID25783156 Institution M 040201       20063            FALSE</span>
<span class="co">#&gt;      3: MID25783162 Institution M 140102       19973             TRUE</span>
<span class="co">#&gt;     ---                                                              </span>
<span class="co">#&gt; 161694: MID26697685 Institution L 521201       20203            FALSE</span>
<span class="co">#&gt; 161695: MID26697689 Institution L 240101       20191            FALSE</span>
<span class="co">#&gt; 161696: MID26697702 Institution L 240101       20213            FALSE</span></code></pre></div>
<p><strong>Filtering.</strong> We filter to retain observations for
which the data are sufficient.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Filter for data sufficiency</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">data_sufficiency</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;                mcid   institution   cip6 timely_term data_sufficiency</span>
<span class="co">#&gt;              &lt;char&gt;        &lt;char&gt; &lt;char&gt;      &lt;char&gt;           &lt;lgcl&gt;</span>
<span class="co">#&gt;      1: MID25783135 Institution M 520101       19963             TRUE</span>
<span class="co">#&gt;      2: MID25783162 Institution M 140102       19973             TRUE</span>
<span class="co">#&gt;      3: MID25783162 Institution M 520301       19973             TRUE</span>
<span class="co">#&gt;     ---                                                              </span>
<span class="co">#&gt; 116071: MID26697599 Institution L 521201       20153             TRUE</span>
<span class="co">#&gt; 116072: MID26697615 Institution L 500901       20153             TRUE</span>
<span class="co">#&gt; 116073: MID26697623 Institution L 451001       20153             TRUE</span>

<span class="co"># Count unique IDs</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">mcid</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 65968</span></code></pre></div>
<p>The result has 116,073 observations of 65,968 unique students.</p>
<p><strong>Selecting.</strong> Drop unnecessary columns.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain necessary columns</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span>, <span class="va">timely_term</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;                mcid   cip6 timely_term</span>
<span class="co">#&gt;              &lt;char&gt; &lt;char&gt;      &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 520101       19963</span>
<span class="co">#&gt;      2: MID25783162 140102       19973</span>
<span class="co">#&gt;      3: MID25783162 520301       19973</span>
<span class="co">#&gt;     ---                               </span>
<span class="co">#&gt; 116071: MID26697599 521201       20153</span>
<span class="co">#&gt; 116072: MID26697615 500901       20153</span>
<span class="co">#&gt; 116073: MID26697623 451001       20153</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="filter-for-degree-seeking">Filter for degree-seeking<a class="anchor" aria-label="anchor" href="#filter-for-degree-seeking"></a>
</h2>
<p>The <code>term</code> data table (and therefore <code>DT</code>)
includes all students enrolled, degree-seeking or not. The
<code>student</code> data table contains only students admitted as
degree-seeking. In a study of program stickiness, we must exclude
non-degree-seeking students.</p>
<p><strong>Filtering.</strong> Retain degree-seeking students only.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain degree-seeking students</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_match.html">filter_match</a></span><span class="op">(</span><span class="va">DT</span>, match_to <span class="op">=</span> <span class="va">student</span>, by_col <span class="op">=</span> <span class="st">"mcid"</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;                mcid   cip6 timely_term</span>
<span class="co">#&gt;              &lt;char&gt; &lt;char&gt;      &lt;char&gt;</span>
<span class="co">#&gt;      1: MID25783135 520101       19963</span>
<span class="co">#&gt;      2: MID25783162 140102       19973</span>
<span class="co">#&gt;      3: MID25783162 520301       19973</span>
<span class="co">#&gt;     ---                               </span>
<span class="co">#&gt; 116071: MID26697599 521201       20153</span>
<span class="co">#&gt; 116072: MID26697615 500901       20153</span>
<span class="co">#&gt; 116073: MID26697623 451001       20153</span></code></pre></div>
<p>The result has 116,073 observations. (No change is expected in this
example because all students in the midfielddata practice data are
degree-seeking.)</p>
</div>
<div class="section level2">
<h2 id="filter-by-program">Filter by program<a class="anchor" aria-label="anchor" href="#filter-by-program"></a>
</h2>
<p>The US Classification of Instructional Programs (CIP) provides an
encoding of academic programs. The <code>cip6</code> variable is the
6-digit CIP code of the program in which a student is enrolled in a
given term.</p>
<p>For example, CIPs for Civil Engineering programs start with 1408,
Electrical Engineering 1410, Mechanical Engineering 1419, and
Industrial/Systems Engineering 1427, 1435, 1436, and 1437.</p>
<p><strong>Importing.</strong> The <code>cip</code> data set bundled
with midfieldr contains all 6-digit CIP codes for the programs in the
case study.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Collect a CIP subset </span>
<span class="va">study_program</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_search.html">filter_search</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"^1408"</span>, <span class="st">"^1410"</span>, <span class="st">"^1419"</span>, <span class="st">"^1427"</span>, <span class="st">"^1435"</span>, <span class="st">"^1436"</span>, <span class="st">"^1437"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Retain necessary columns</span>
<span class="va">study_program</span> <span class="op">&lt;-</span> <span class="va">study_program</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip6</span>, <span class="va">cip6name</span><span class="op">)</span><span class="op">]</span>
<span class="va">study_program</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;       cip6                                                      cip6name</span>
<span class="co">#&gt;     &lt;char&gt;                                                        &lt;char&gt;</span>
<span class="co">#&gt;  1: 140801                                    Civil Engineering, General</span>
<span class="co">#&gt;  2: 140802                                      Geotechnical Engineering</span>
<span class="co">#&gt;  3: 140803                                        Structural Engineering</span>
<span class="co">#&gt;  4: 140804                        Transportation and Highway Engineering</span>
<span class="co">#&gt;  5: 140805                                   Water Resources Engineering</span>
<span class="co">#&gt;  6: 140899                                      Civil Engineering, Other</span>
<span class="co">#&gt;  7: 141001        Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  8: 141003                                 Laser and Optical Engineering</span>
<span class="co">#&gt;  9: 141004                                Telecommunications Engineering</span>
<span class="co">#&gt; 10: 141099 Electrical, Electronics and Communications Engineering, Other</span>
<span class="co">#&gt; 11: 141901                                        Mechanical Engineering</span>
<span class="co">#&gt; 12: 142701                                           Systems Engineering</span>
<span class="co">#&gt; 13: 143501                                        Industrial Engineering</span>
<span class="co">#&gt; 14: 143601                                     Manufacturing Engineering</span>
<span class="co">#&gt; 15: 143701                                           Operations Research</span></code></pre></div>
<p><strong>Creating variables.</strong> Add a variable to label each of
these 15 programs with one of the four conventional program
abbreviations we will use in comparing metrics, i.e., Civil (CE),
Electrical (EE), Mechanical (ME), and Industrial/Systems Engineering
(ISE).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add a custom program abbreviation</span>
<span class="va">study_program</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span>
    <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1408"</span>, <span class="st">"CE"</span>, 
    <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1410"</span>, <span class="st">"EE"</span>, 
    <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1419"</span>, <span class="st">"ME"</span>, 
    <span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/between.html" class="external-link">%between%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"142701"</span>, <span class="st">"143701"</span><span class="op">)</span>, <span class="st">"ISE"</span>
<span class="op">)</span><span class="op">]</span>

<span class="co"># View partial result</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">study_program</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip6name</span>, <span class="va">program</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;                                                          cip6name program</span>
<span class="co">#&gt;                                                            &lt;char&gt;  &lt;char&gt;</span>
<span class="co">#&gt;  1:                                    Civil Engineering, General      CE</span>
<span class="co">#&gt;  2:                                      Geotechnical Engineering      CE</span>
<span class="co">#&gt;  3:                                        Structural Engineering      CE</span>
<span class="co">#&gt;  4:                        Transportation and Highway Engineering      CE</span>
<span class="co">#&gt;  5:                                   Water Resources Engineering      CE</span>
<span class="co">#&gt;  6:                                      Civil Engineering, Other      CE</span>
<span class="co">#&gt;  7:        Electrical, Electronics and Communications Engineering      EE</span>
<span class="co">#&gt;  8:                                 Laser and Optical Engineering      EE</span>
<span class="co">#&gt;  9:                                Telecommunications Engineering      EE</span>
<span class="co">#&gt; 10: Electrical, Electronics and Communications Engineering, Other      EE</span>
<span class="co">#&gt; 11:                                        Mechanical Engineering      ME</span>
<span class="co">#&gt; 12:                                           Systems Engineering     ISE</span>
<span class="co">#&gt; 13:                                        Industrial Engineering     ISE</span>
<span class="co">#&gt; 14:                                     Manufacturing Engineering     ISE</span>
<span class="co">#&gt; 15:                                           Operations Research     ISE</span></code></pre></div>
<p><strong>Selecting.</strong> Having checked that the new abbreviations
correctly represent the programs, we drop the <code>cip6name</code>
variable.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain necessary columns</span>
<span class="va">study_program</span><span class="op">[</span>, <span class="va">cip6name</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span>
<span class="va">study_program</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;       cip6 program</span>
<span class="co">#&gt;     &lt;char&gt;  &lt;char&gt;</span>
<span class="co">#&gt;  1: 140801      CE</span>
<span class="co">#&gt;  2: 140802      CE</span>
<span class="co">#&gt;  3: 140803      CE</span>
<span class="co">#&gt;  4: 140804      CE</span>
<span class="co">#&gt;  5: 140805      CE</span>
<span class="co">#&gt;  6: 140899      CE</span>
<span class="co">#&gt;  7: 141001      EE</span>
<span class="co">#&gt;  8: 141003      EE</span>
<span class="co">#&gt;  9: 141004      EE</span>
<span class="co">#&gt; 10: 141099      EE</span>
<span class="co">#&gt; 11: 141901      ME</span>
<span class="co">#&gt; 12: 142701     ISE</span>
<span class="co">#&gt; 13: 143501     ISE</span>
<span class="co">#&gt; 14: 143601     ISE</span>
<span class="co">#&gt; 15: 143701     ISE</span></code></pre></div>
<p><strong>Joining.</strong> Join program names for students ever
enrolled in the study programs.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Label program in every term </span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">study_program</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;           cip6        mcid timely_term program</span>
<span class="co">#&gt;         &lt;char&gt;      &lt;char&gt;      &lt;char&gt;  &lt;char&gt;</span>
<span class="co">#&gt;      1: 010000 MID25787629       20033    &lt;NA&gt;</span>
<span class="co">#&gt;      2: 010000 MID25788554       19993    &lt;NA&gt;</span>
<span class="co">#&gt;      3: 010000 MID25788738       19963    &lt;NA&gt;</span>
<span class="co">#&gt;     ---                                       </span>
<span class="co">#&gt; 116071: 999999 MID26613108       20091    &lt;NA&gt;</span>
<span class="co">#&gt; 116072: 999999 MID26613476       20093    &lt;NA&gt;</span>
<span class="co">#&gt; 116073: 999999 MID26622821       20091    &lt;NA&gt;</span></code></pre></div>
<p><strong>Filtering.</strong> All instances of <code>program</code> not
equal to NA are retained.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain observations in the study programs</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;         cip6        mcid timely_term program</span>
<span class="co">#&gt;       &lt;char&gt;      &lt;char&gt;      &lt;char&gt;  &lt;char&gt;</span>
<span class="co">#&gt;    1: 140801 MID25783197       19923      CE</span>
<span class="co">#&gt;    2: 140801 MID25783441       19973      CE</span>
<span class="co">#&gt;    3: 140801 MID25784209       20003      CE</span>
<span class="co">#&gt;   ---                                       </span>
<span class="co">#&gt; 8071: 143501 MID26695626       20143     ISE</span>
<span class="co">#&gt; 8072: 143501 MID26696116       20153     ISE</span>
<span class="co">#&gt; 8073: 143501 MID26696429       20153     ISE</span>

<span class="co"># Count unique IDs</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">mcid</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 7515</span></code></pre></div>
<p>The result has 8073 observations of 7515 unique students.</p>
</div>
<div class="section level2">
<h2 id="determine-timely-completion">Determine timely completion<a class="anchor" aria-label="anchor" href="#determine-timely-completion"></a>
</h2>
<p><em>Timely completion</em> is defined as program completion no later
than the timely completion term (default 6 years after admission). For
transfer students, the timely completion span can be reduced to account
for transfer credits.</p>
<p><strong>Creating variables.</strong> Add
<code>completion_timely</code> with values of TRUE or FALSE with FALSE
also assigned to non-completers. Setting <code>detail = TRUE</code>
yields the CIP code for graduates’ degree programs.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add the completion timely variable</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_completion_timely.html">add_completion_timely</a></span><span class="op">(</span><span class="va">DT</span>, midfield_degree <span class="op">=</span> <span class="va">degree</span>, detail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;         cip6        mcid timely_term program term_degree cip6_degree completion</span>
<span class="co">#&gt;       &lt;char&gt;      &lt;char&gt;      &lt;char&gt;  &lt;char&gt;      &lt;char&gt;      &lt;char&gt;     &lt;lgcl&gt;</span>
<span class="co">#&gt;    1: 140801 MID25783197       19923      CE       19911      140801       TRUE</span>
<span class="co">#&gt;    2: 140801 MID25783441       19973      CE       19963      140801       TRUE</span>
<span class="co">#&gt;    3: 140801 MID25784209       20003      CE        &lt;NA&gt;        &lt;NA&gt;      FALSE</span>
<span class="co">#&gt;   ---                                                                          </span>
<span class="co">#&gt; 8071: 143501 MID26695626       20143     ISE       20133      143501       TRUE</span>
<span class="co">#&gt; 8072: 143501 MID26696116       20153     ISE       20133      143501       TRUE</span>
<span class="co">#&gt; 8073: 143501 MID26696429       20153     ISE       20133      143501       TRUE</span>
<span class="co">#&gt;       completion_timely</span>
<span class="co">#&gt;                  &lt;lgcl&gt;</span>
<span class="co">#&gt;    1:              TRUE</span>
<span class="co">#&gt;    2:              TRUE</span>
<span class="co">#&gt;    3:             FALSE</span>
<span class="co">#&gt;   ---                  </span>
<span class="co">#&gt; 8071:              TRUE</span>
<span class="co">#&gt; 8072:              TRUE</span>
<span class="co">#&gt; 8073:              TRUE</span></code></pre></div>
<p>For the stickiness metric, an untimely completer is counted as a
non-completer.</p>
<p><strong>Recoding.</strong> Recode <code>cip6_degree</code> for
untimely completers as NA. (Non-completers are already encoded as
NA.)</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Recode untimely completers</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">completion_timely</span> <span class="op">==</span> <span class="cn">FALSE</span>, <span class="va">cip6_degree</span><span class="op">:=</span> <span class="cn">NA_character_</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;         cip6        mcid timely_term program term_degree cip6_degree completion</span>
<span class="co">#&gt;       &lt;char&gt;      &lt;char&gt;      &lt;char&gt;  &lt;char&gt;      &lt;char&gt;      &lt;char&gt;     &lt;lgcl&gt;</span>
<span class="co">#&gt;    1: 140801 MID25783197       19923      CE       19911      140801       TRUE</span>
<span class="co">#&gt;    2: 140801 MID25783441       19973      CE       19963      140801       TRUE</span>
<span class="co">#&gt;    3: 140801 MID25784209       20003      CE        &lt;NA&gt;        &lt;NA&gt;      FALSE</span>
<span class="co">#&gt;   ---                                                                          </span>
<span class="co">#&gt; 8071: 143501 MID26695626       20143     ISE       20133      143501       TRUE</span>
<span class="co">#&gt; 8072: 143501 MID26696116       20153     ISE       20133      143501       TRUE</span>
<span class="co">#&gt; 8073: 143501 MID26696429       20153     ISE       20133      143501       TRUE</span>
<span class="co">#&gt;       completion_timely</span>
<span class="co">#&gt;                  &lt;lgcl&gt;</span>
<span class="co">#&gt;    1:              TRUE</span>
<span class="co">#&gt;    2:              TRUE</span>
<span class="co">#&gt;    3:             FALSE</span>
<span class="co">#&gt;   ---                  </span>
<span class="co">#&gt; 8071:              TRUE</span>
<span class="co">#&gt; 8072:              TRUE</span>
<span class="co">#&gt; 8073:              TRUE</span></code></pre></div>
<p><strong>Selecting.</strong> Drop unnecessary variables.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain necessary columns</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">program</span>, <span class="va">cip6_degree</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;              mcid program cip6_degree</span>
<span class="co">#&gt;            &lt;char&gt;  &lt;char&gt;      &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783197      CE      140801</span>
<span class="co">#&gt;    2: MID25783441      CE      140801</span>
<span class="co">#&gt;    3: MID25784209      CE        &lt;NA&gt;</span>
<span class="co">#&gt;   ---                                </span>
<span class="co">#&gt; 8071: MID26695626     ISE      143501</span>
<span class="co">#&gt; 8072: MID26696116     ISE      143501</span>
<span class="co">#&gt; 8073: MID26696429     ISE      143501</span></code></pre></div>
<p>We want to join the study program labels to the degree CIPs. We
rename two variables to facilitate the join.</p>
<p><strong>Renaming.</strong> Prepare for labeling degree CIPs with
program names. The <code>program_ever</code> variable is used for
summarizing the ever-enrolled population.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Prepare for next join operation </span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html" class="external-link">setnames</a></span><span class="op">(</span><span class="va">DT</span>, 
         old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"cip6_degree"</span><span class="op">)</span>, 
         new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"program_ever"</span>, <span class="st">"cip6"</span><span class="op">)</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;              mcid program_ever   cip6</span>
<span class="co">#&gt;            &lt;char&gt;       &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783197           CE 140801</span>
<span class="co">#&gt;    2: MID25783441           CE 140801</span>
<span class="co">#&gt;    3: MID25784209           CE   &lt;NA&gt;</span>
<span class="co">#&gt;   ---                                </span>
<span class="co">#&gt; 8071: MID26695626          ISE 143501</span>
<span class="co">#&gt; 8072: MID26696116          ISE 143501</span>
<span class="co">#&gt; 8073: MID26696429          ISE 143501</span></code></pre></div>
<p><strong>Joining.</strong> Join program names for program
completers.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Label completed degree programs</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">study_program</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;         cip6        mcid program_ever program</span>
<span class="co">#&gt;       &lt;char&gt;      &lt;char&gt;       &lt;char&gt;  &lt;char&gt;</span>
<span class="co">#&gt;    1:   &lt;NA&gt; MID25784209           CE    &lt;NA&gt;</span>
<span class="co">#&gt;    2:   &lt;NA&gt; MID25787414           CE    &lt;NA&gt;</span>
<span class="co">#&gt;    3:   &lt;NA&gt; MID25787496           CE    &lt;NA&gt;</span>
<span class="co">#&gt;   ---                                        </span>
<span class="co">#&gt; 8071: 540101 MID26685236           ME    &lt;NA&gt;</span>
<span class="co">#&gt; 8072: 540101 MID26505032          ISE    &lt;NA&gt;</span>
<span class="co">#&gt; 8073: 540104 MID26400780           EE    &lt;NA&gt;</span></code></pre></div>
<p><strong>Renaming.</strong> The <code>program_grad</code> variable is
used for summarizing the timely-completion population.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Naming for consistency of usage </span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html" class="external-link">setnames</a></span><span class="op">(</span><span class="va">DT</span>, old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"program"</span><span class="op">)</span>, new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"program_grad"</span><span class="op">)</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;         cip6        mcid program_ever program_grad</span>
<span class="co">#&gt;       &lt;char&gt;      &lt;char&gt;       &lt;char&gt;       &lt;char&gt;</span>
<span class="co">#&gt;    1:   &lt;NA&gt; MID25784209           CE         &lt;NA&gt;</span>
<span class="co">#&gt;    2:   &lt;NA&gt; MID25787414           CE         &lt;NA&gt;</span>
<span class="co">#&gt;    3:   &lt;NA&gt; MID25787496           CE         &lt;NA&gt;</span>
<span class="co">#&gt;   ---                                             </span>
<span class="co">#&gt; 8071: 540101 MID26685236           ME         &lt;NA&gt;</span>
<span class="co">#&gt; 8072: 540101 MID26505032          ISE         &lt;NA&gt;</span>
<span class="co">#&gt; 8073: 540104 MID26400780           EE         &lt;NA&gt;</span></code></pre></div>
<p><strong>Selecting.</strong> Drop unnecessary variables.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain necessary columns</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">program_ever</span>, <span class="va">program_grad</span><span class="op">)</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;              mcid program_ever program_grad</span>
<span class="co">#&gt;            &lt;char&gt;       &lt;char&gt;       &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25784209           CE         &lt;NA&gt;</span>
<span class="co">#&gt;    2: MID25787414           CE         &lt;NA&gt;</span>
<span class="co">#&gt;    3: MID25787496           CE         &lt;NA&gt;</span>
<span class="co">#&gt;   ---                                      </span>
<span class="co">#&gt; 8071: MID26685236           ME         &lt;NA&gt;</span>
<span class="co">#&gt; 8072: MID26505032          ISE         &lt;NA&gt;</span>
<span class="co">#&gt; 8073: MID26400780           EE         &lt;NA&gt;</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-demographics">Add demographics<a class="anchor" aria-label="anchor" href="#add-demographics"></a>
</h2>
<p><strong>Creating variables.</strong> Here we add a variable with a
student’s race/ethnicity and sex using information in the
<code>student</code> data table.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Additional grouping variables </span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_race_sex.html">add_race_sex</a></span><span class="op">(</span><span class="va">DT</span>, midfield_student <span class="op">=</span> <span class="va">student</span><span class="op">)</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;              mcid program_ever program_grad            race    sex</span>
<span class="co">#&gt;            &lt;char&gt;       &lt;char&gt;       &lt;char&gt;          &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178          ISE          ISE           Black   Male</span>
<span class="co">#&gt;    2: MID25783197           CE           CE           White   Male</span>
<span class="co">#&gt;    3: MID25783388           ME         &lt;NA&gt;           White   Male</span>
<span class="co">#&gt;   ---                                                             </span>
<span class="co">#&gt; 8071: MID26697163           ME           ME Hispanic/Latinx   Male</span>
<span class="co">#&gt; 8072: MID26697444           ME         &lt;NA&gt;           White   Male</span>
<span class="co">#&gt; 8073: MID26697447           EE           EE           Asian   Male</span></code></pre></div>
<p><strong>Filtering.</strong> Suppose our study design excludes
students whose race/ethnicity is unknown or “International”. We filter
on the <code>race</code> variable to remove those observations.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain "domestic" students with known race/ethnicity</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">DT</span><span class="op">$</span><span class="va">race</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"International"</span>, <span class="st">"Other/Unknown"</span><span class="op">)</span>
<span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>
<span class="va">DT</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;              mcid program_ever program_grad            race    sex</span>
<span class="co">#&gt;            &lt;char&gt;       &lt;char&gt;       &lt;char&gt;          &lt;char&gt; &lt;char&gt;</span>
<span class="co">#&gt;    1: MID25783178          ISE          ISE           Black   Male</span>
<span class="co">#&gt;    2: MID25783197           CE           CE           White   Male</span>
<span class="co">#&gt;    3: MID25783388           ME         &lt;NA&gt;           White   Male</span>
<span class="co">#&gt;   ---                                                             </span>
<span class="co">#&gt; 7798: MID26697163           ME           ME Hispanic/Latinx   Male</span>
<span class="co">#&gt; 7799: MID26697444           ME         &lt;NA&gt;           White   Male</span>
<span class="co">#&gt; 7800: MID26697447           EE           EE           Asian   Male</span>

<span class="co"># Count unique IDs</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">mcid</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 7259</span></code></pre></div>
<p>The result has 7800 observations of 7259 unique students.</p>
</div>
<div class="section level2">
<h2 id="closing">Closing<a class="anchor" aria-label="anchor" href="#closing"></a>
</h2>
<p>Starting with the <code>student</code>, <code>term</code>, and
<code>degree</code> data tables, we have reduced the observations needed
to determine stickiness.</p>
<p><strong>Write to file.</strong> Results like these, used as inputs
for calculating summary statistics and metrics, are often written to
file as an intermediate result. In this case, the final data frame above
is bundled with midfieldr as <code>study_reduced_data</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/graphdr" class="external-link">Richard Layton</a>, Russell Long, Matthew Ohland, Marisa Orr, Susan Lord, US National Science Foundation.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
