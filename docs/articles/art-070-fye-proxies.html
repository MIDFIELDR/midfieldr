<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="midfieldr">
<title>FYE proxies • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="FYE proxies">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="https://midfieldr.github.io/midfieldr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">midfieldr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9027</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/art-000-getting-started.html">Getting started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-study">Case study</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-study">
    <a class="dropdown-item" href="../articles/art-001-case-goals.html">Goals</a>
    <a class="dropdown-item" href="../articles/art-002-case-data.html">Data</a>
    <a class="dropdown-item" href="../articles/art-003-case-results.html">Results</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/art-009-planning.html">Planning</a>
    <a class="dropdown-item" href="../articles/art-010-data-sufficiency.html">Data sufficiency</a>
    <a class="dropdown-item" href="../articles/art-020-degree-seeking.html">Degree seeking (inner joins)</a>
    <a class="dropdown-item" href="../articles/art-030-programs.html">Programs</a>
    <a class="dropdown-item" href="../articles/art-035-blocs.html">Blocs</a>
    <a class="dropdown-item" href="../articles/art-040-completion.html">Completion status</a>
    <a class="dropdown-item" href="../articles/art-070-fye-proxies.html">FYE proxies</a>
    <a class="dropdown-item" href="../articles/art-080-starters.html">Starters</a>
    <a class="dropdown-item" href="../articles/art-050-demographics.html">Demographics (left outer joins)</a>
    <a class="dropdown-item" href="../articles/art-090-grad-rate.html">Graduation rate</a>
    <a class="dropdown-item" href="../articles/art-060-multiway.html">Multiway data and charts</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MIDFIELDR/midfieldr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="art-070-fye-proxies_files/kePrint-0.0.1/kePrint.js"></script><link href="art-070-fye-proxies_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>FYE proxies</h1>
            
            <h4 data-toc-skip class="date">2022-10-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/HEAD/vignettes/art-070-fye-proxies.Rmd" class="external-link"><code>vignettes/art-070-fye-proxies.Rmd</code></a></small>
      <div class="d-none name"><code>art-070-fye-proxies.Rmd</code></div>
    </div>

    
    
<p>A treatment of First-Year Engineering (FYE) programs when a count of
starters is required. We estimate the 6-digit CIP codes of the
degree-granting engineering programs FYE students would have declared
had they not been required to enroll in FYE.</p>
<p>Users of midfielddata practice data are not required to reproduce
this vignette—the results are included with midfieldr in the
<code>fye_proxy</code> data set.</p>
<p>You can skip this vignette if your study includes no FYE-style
Engineering programs.</p>
<div class="section level2">
<h2 id="potential-for-starter-miscounts">Potential for starter miscounts<a class="anchor" aria-label="anchor" href="#potential-for-starter-miscounts"></a>
</h2>
<p>At some US institutions, engineering students are required to
complete a First-Year Engineering (FYE) program as a prerequisite for
declaring an engineering major. Administratively, degree-granting
engineering programs such as Electrical Engineering or Mechanical
Engineering treat their incoming post-FYE students as their “starting”
cohorts. However, when computing a metric such as graduation rate that
requires a count of starters, FYE records must be treated with special
care to avoid a miscount.</p>
<p>To illustrate the potential for miscounting starters, suppose we wish
to calculate a Mechanical Engineering (ME) graduation rate. Students
starting in ME constitute the starting pool and the fraction of that
pool graduating in ME is the graduation rate.</p>
<p>At FYE institutions, an ME program would typically define their
starting pool as the post-FYE cohort entering their program. This may be
the best information available, but it invariably undercounts starters
by failing to account for FYE students who do not transition (post-FYE)
to degree-granting engineering programs—students who may have left the
institution or switched to non-engineering majors. In the absence of the
FYE requirement some of these students would have been ME starters. By
neglecting these students, the count of ME starters is artificially low
resulting in an ME graduation rate that is artificially high. The same
is true for every degree-granting engineering major in an FYE
institution.</p>
<p>Because of the special nature of FYE programs, we cannot address
starter miscounts by grouping FYE students with those admitted with
“undecided” or “unknown” CIP codes—FYE students are neither. They were
admitted as Engineering majors (2-digit CIP 14). We simply don’t know to
which degree-granting program (6-digit CIP) they intended to
transition.</p>
<p>Therefore, to avoid miscounting starters at FYE institutions, we
estimate the 6-digit CIP codes of the degree-granting engineering
programs that FYE students would have declared had they not been
required to enroll in FYE.</p>
</div>
<div class="section level2">
<h2 id="definitions">Definitions<a class="anchor" aria-label="anchor" href="#definitions"></a>
</h2>
<dl>
<dt>FYE</dt>
<dd>
<p>First-Year Engineering program, a common-first-year curriculum that
is a prerequisite for declaring an engineering major at some US
institutions. Denoted by its own CIP code, FYE is not a degree-granting
program.</p>
</dd>
<dt>FYE proxy</dt>
<dd>
<p>Our estimate of the degree-granting engineering program in which an
FYE student would have enrolled had they not been required to enroll in
FYE. The proxy, a 6-digit CIP code, denotes the program of which the FYE
student can be considered a starter.</p>
</dd>
<dt>starter</dt>
<dd>
<p>A degree-seeking student in their initial term enrolled in a
degree-granting program.</p>
</dd>
<dt>migrator</dt>
<dd>
<p>A student who leaves one program to enroll in another. Also called
<em>switchers.</em></p>
</dd>
<dt>multiple imputation</dt>
<dd>
<p>Method of imputing missing categorical data, in this case, imputing
the FYE proxy 6-digit CIP codes.</p>
</dd>
</dl>
</div>
<div class="section level2">
<h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>We apply <code><a href="../reference/prep_fye_mice.html">prep_fye_mice()</a></code> to the <code>student</code> and
<code>term</code> source files to construct a data frame suitable for
imputation using the mice R package. The procedure has four steps:</p>
<ol style="list-style-type: decimal">
<li><p>Use <code><a href="../reference/prep_fye_mice.html">prep_fye_mice()</a></code> from the midfieldr package to
estimate some of the FYE proxy CIPs, treat the remainder as missing
values, and structure the data frame for imputation.</p></li>
<li><p>Optional. If the default predictor variables (institution,
race/ethnicity, and sex) do not meet the needs of your study, you can
define your own.</p></li>
<li><p>Use <code><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice()</a></code> from the mice package to impute the
6-digit CIP missing values.</p></li>
<li><p>Post-processing to limit the results to first-term FYE students
only.</p></li>
</ol>
<p>Three outcomes are possible, depending on your goals and available
data:</p>
<ul>
<li><p>Using midfielddata practice data, recreate the
<code>fye_proxy</code> data set included with midfieldr—as we do in this
vignette.</p></li>
<li><p>Using midfielddata practice data, create an alternate set of FYE
proxies using a different random number generator seed or using
different predictor variables for imputation. The resulting data frame
will have the same IDs and number of rows as <code>fye_proxy</code> but
different ID-proxy pairings.</p></li>
<li><p>Using MIDFIELD research data, construct your own FYE proxies. The
resulting data frame will have as many rows as your research data has
first-term FYE students.</p></li>
</ul>
<p>For a given set of source files, FYE proxies need be created only
once and written to file. The result can be used as needed unless the
source files change.</p>
<p>This vignette in the MIDFIELD workflow.</p>
<ol style="list-style-type: decimal">
<li>Planning<br>
</li>
<li>Initial processing<br>
</li>
<li>Blocs
<ul>
<li>Ever-enrolled in programs<br>
</li>
<li>Graduates of programs<br>
</li>
<li>Completion status<br>
</li>
<li>
<span style=" font-weight: bold;    color: #b35806 !important;">FYE
proxies</span><br>
</li>
<li>Starters in programs<br>
</li>
</ul>
</li>
<li>Grouping variables<br>
</li>
<li>Metrics<br>
</li>
<li>Results</li>
</ol>
<p><em>Caveat:</em> The Student Unit Records included with midfieldr and
midfielddata are practice data, not research data, suitable for practice
working with SURs but not for drawing inferences about program
attributes or student experiences.</p>
</div>
<div class="section level2">
<h2 id="load-practice-data">Load practice data<a class="anchor" aria-label="anchor" href="#load-practice-data"></a>
</h2>
<p><em>Start a script</em>. If you are writing your own script to follow
along, we use these packages in this vignette:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># FYE proxies</span></span>
<span><span class="co"># midfieldr vignette</span></span>
<span></span>
<span><span class="co"># Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/amices/mice" class="external-link">"mice"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing options for data.table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>  datatable.print.nrows <span class="op">=</span> <span class="fl">17</span>,</span>
<span>  datatable.print.topn <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  datatable.print.class <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><em>Load source data.</em> MIDFIELD practice data tables as described
in <a href="art-000-getting-started.html">Getting started</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load practice data sets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span>, package <span class="op">=</span> <span class="st">"midfielddata"</span><span class="op">)</span></span></code></pre></div>
<p><em>Optional.</em> A step to reduce the number of columns in the
source data table(s) to the minimum number required by midfieldr
functions. Particularly useful in interactive sessions when viewing the
data tables at various stages of an analysis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select required midfieldr variables</span></span>
<span><span class="va">student</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">student</span><span class="op">)</span></span>
<span><span class="va">term</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View top few rows of the result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">student</span>, n <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span>
<span><span class="co">#&gt;           mcid   institution   race    sex</span></span>
<span><span class="co">#&gt;         &lt;char&gt;        &lt;char&gt; &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: MID25783135 Institution M  White   Male</span></span>
<span><span class="co">#&gt; 2: MID25783147 Institution M  White Female</span></span>
<span><span class="co">#&gt; 3: MID25783156 Institution M  White Female</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">term</span>, n <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span>
<span><span class="co">#&gt;           mcid   institution   term   cip6        level</span></span>
<span><span class="co">#&gt;         &lt;char&gt;        &lt;char&gt; &lt;char&gt; &lt;char&gt;       &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: MID25783135 Institution M  19911 520101  01 Freshman</span></span>
<span><span class="co">#&gt; 2: MID25783135 Institution M  19913 520101 02 Sophomore</span></span>
<span><span class="co">#&gt; 3: MID25783156 Institution M  20011 040201  01 Freshman</span></span></code></pre></div>
<p><em>Prepared data.</em> <code>study_programs</code>, included with
midfieldr, contains the CIP codes and custom program names for the case
study as developed in <a href="art-030-programs.html#case-study">Programs</a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display prepared data</span></span>
<span><span class="va">study_programs</span></span>
<span><span class="co">#&gt;       cip6 program</span></span>
<span><span class="co">#&gt;     &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1: 140801      CE</span></span>
<span><span class="co">#&gt;  2: 140802      CE</span></span>
<span><span class="co">#&gt;  3: 140803      CE</span></span>
<span><span class="co">#&gt;  4: 140804      CE</span></span>
<span><span class="co">#&gt;  5: 140805      CE</span></span>
<span><span class="co">#&gt;  6: 140899      CE</span></span>
<span><span class="co">#&gt;  7: 141001      EE</span></span>
<span><span class="co">#&gt;  8: 141003      EE</span></span>
<span><span class="co">#&gt;  9: 141004      EE</span></span>
<span><span class="co">#&gt; 10: 141099      EE</span></span>
<span><span class="co">#&gt; 11: 141901      ME</span></span>
<span><span class="co">#&gt; 12: 142701     ISE</span></span>
<span><span class="co">#&gt; 13: 143501     ISE</span></span>
<span><span class="co">#&gt; 14: 143601     ISE</span></span>
<span><span class="co">#&gt; 15: 143701     ISE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prep_fye_mice">
<code>prep_fye_mice()</code><a class="anchor" aria-label="anchor" href="#prep_fye_mice"></a>
</h2>
<p>The purpose of <code><a href="../reference/prep_fye_mice.html">prep_fye_mice()</a></code> is preparing a data frame
for the mice R package. Operates on the complete, unfiltered
<code>student</code> and <code>term</code> source data to create a data
frame with three predictor variables and an FYE proxy variable. The
values in <code>proxy</code> are determined by a student’s first
post-FYE program code, as follows:</p>
<ol style="list-style-type: decimal">
<li><p><em>Post-FYE: Engineering.</em> The student completes FYE and
enrolls in an engineering major. For this outcome, we know that at the
student’s first opportunity, they enrolled in an engineering major of
their choosing. The CIP code of that program is returned as the
student’s FYE proxy.</p></li>
<li><p><em>Post-FYE: Non-engineering.</em> The student migrates to a
non-engineering major or has no post-FYE records in the database. The
data provide no indication of the student’s preferred degree-granting
engineering major. Thus their FYE proxy value is returned as NA, to be
treated as missing data.</p></li>
</ol>
<p><em>Arguments</em></p>
<ul>
<li><p><strong><code>midfield_student</code></strong>   Data frame of
student observations, keyed by student ID. Default is
<code>student</code>. Required variables are <code>mcid</code>,
<code>race</code>, and <code>sex</code>. Use all rows of your source
<code>student</code> data table.</p></li>
<li><p><strong><code>midfield_term</code></strong>   Data frame of term
observations keyed by student ID. Default is <code>term</code>. Required
variables are <code>mcid</code>, <code>institution</code>,
<code>term</code>, and <code>cip6</code>. Use all rows of your source
<code>term</code> data table.</p></li>
<li><p><strong><code>fye_codes</code></strong>   Optional character
vector of 6-digit CIP codes assigned to FYE programs. Default is
“140102”. Argument to be used by name.</p></li>
</ul>
<p><em>Implicit arguments.</em>   The following implementations yield
identical results.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Required arguments in order and explicitly named</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fye_mice.html">prep_fye_mice</a></span><span class="op">(</span>midfield_student <span class="op">=</span> <span class="va">student</span>, midfield_term <span class="op">=</span> <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Required arguments in order, but not named</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fye_mice.html">prep_fye_mice</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using the implicit defaults</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fye_mice.html">prep_fye_mice</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equality test between the data tables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p><em>Output.</em>   The function returns one row per FYE student keyed
by student ID. As required by <code><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice()</a></code>, all variables except
ID are factors.</p>
<ul>
<li>
<code>mcid</code> (character)</li>
<li>
<code>race</code> (factor)</li>
<li>
<code>sex</code> (factor)</li>
<li>
<code>institution</code> (factor)</li>
<li>
<code>proxy</code> (factor) 6-digit CIP code or NA</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Working data frame</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fye_mice.html">prep_fye_mice</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;              mcid   race    sex   institution  proxy</span></span>
<span><span class="co">#&gt;            &lt;char&gt; &lt;fctr&gt; &lt;fctr&gt;        &lt;fctr&gt; &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;    1: MID26060301  Asian Female Institution C   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    2: MID25995980 Latine Female Institution C   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    3: MID25997636 Latine Female Institution C   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    4: MID26086310 Latine Female Institution C   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    5: MID26000057  White Female Institution C   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   ---                                               </span></span>
<span><span class="co">#&gt; 4488: MID25844276  White   Male Institution M 143501</span></span>
<span><span class="co">#&gt; 4489: MID25846316  White   Male Institution M 143501</span></span>
<span><span class="co">#&gt; 4490: MID25847220  White   Male Institution M 143501</span></span>
<span><span class="co">#&gt; 4491: MID25848589  White   Male Institution M 143501</span></span>
<span><span class="co">#&gt; 4492: MID25828870  White   Male Institution M 149999</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<p>The output of <code>prep_fye_mive()</code> should contain missing
values in the proxy column only. Other variables are complete. A
race/ethnicity or sex value of “unknown” is treated as an observed
value, not missing data. And while no values of ID or institution are
unknown or missing in this example, such observations (if they existed)
would have to be removed.</p>
<p>Checking that all variables except <code>proxy</code> are
complete.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of unique IDs</span></span>
<span><span class="op">(</span><span class="va">N_mcid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">mcid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4492</span></span>
<span></span>
<span><span class="co"># Number of complete cases on four variables</span></span>
<span><span class="op">(</span><span class="va">N_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">race</span>, <span class="va">sex</span>, <span class="va">institution</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4492</span></span>
<span></span>
<span><span class="co"># Confirm equality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">N_mcid</span>, <span class="va">N_complete</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Number of missing observations in <code>proxy</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number NAs in proxy</span></span>
<span><span class="op">(</span><span class="va">N_impute</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">proxy</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1689</span></span></code></pre></div>
<p><em>Missing at random (MAR).</em> These missing <code>proxy</code>
data are caused by a student’s decision to migrate to a non-engineering
major or to leave the database. At the time of making that decision, the
FYE student would not yet have enrolled in a degree-granting engineering
major, thus their decision is unlikely to be related to any specific
engineering major.</p>
<p>That a CIP is missing, therefore, is unlikely to be related to a
specific CIP value—but may be related to other observations such as
institution, race/ethnicity, or sex. Missing data of this type are
classified as “missing at random” (MAR) which are suitable for multiple
imputation and yield unbiased results <span class="citation">(<a href="#ref-GraceMartin:2012" role="doc-biblioref">Grace-Martin,
2012</a>)</span>.</p>
<p><em>Multiple imputation.</em> Lastly, while 5–10 imputations are
generally considered adequate for unbiasedness, Bodner <span class="citation">(<a href="#ref-Bodner:2008" role="doc-biblioref">2008</a>)</span> recommends having as many
imputations as the percentage of missing data. As shown here, the
overall percentage of missing data is 38%, suggesting we set the number
of imputations to 38.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Percent missing proxies</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">N_impute</span> <span class="op">/</span> <span class="va">N_complete</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 37.6</span></span></code></pre></div>
<p><em>Chart.</em> Percent missing data by category is shown in the
chart. (The script, given in the <a href="#chart-script">Chart
script</a> appendix, uses a copy of <code>DT</code> that we set aside
here.)</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set aside for the chart</span></span>
<span><span class="va">NA_proxies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span></code></pre></div>
<p>The vertical dashed line indicates the 38% percent missing data
overall.</p>
<div class="figure">
<img src="../reference/figures/art-070-fye-proxies-pct-missing.png" style="width:100.0%" alt=""><p class="caption">Figure1: Percent missing data by category.</p>
</div>
</div>
<div class="section level2">
<h2 id="setting-up-mice">Setting up <code>mice()</code><a class="anchor" aria-label="anchor" href="#setting-up-mice"></a>
</h2>
<p>The mice package <span class="citation">(<a href="#ref-vanBuuren+Oudshoorn:2011" role="doc-biblioref">van Buuren
&amp; Groothuis-Oudshoorn, 2011</a>)</span> implements multiple
imputation by chained equations (MICE). MICE is also known as “fully
conditional specification” or “sequential regression multiple
imputation” and is suitable for categorical variables such as ours <span class="citation">(<a href="#ref-azur2011" role="doc-biblioref">Azur et
al., 2011</a>)</span>. Our computational procedure follows the approach
suggested by Dhana <span class="citation">(<a href="#ref-dhana2017" role="doc-biblioref">2017</a>)</span>.</p>
<div class="section level3">
<h3 id="standard-predictors">Standard predictors<a class="anchor" aria-label="anchor" href="#standard-predictors"></a>
</h3>
<p><em>Framework.</em> Our first use of <code><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice()</a></code> is to
examine the imputation framework by calling the function with zero
iterations on the <code>DT</code> data frame. <code><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice()</a></code>
produces a “multiply-imputed data set”, an R object of class “mids”.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imputation framework</span></span>
<span><span class="va">framework</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span><span class="va">DT</span>, maxit <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the results</span></span>
<span><span class="va">framework</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Class: mids</span></span>
<span><span class="co">#&gt; Number of multiple imputations:  5 </span></span>
<span><span class="co">#&gt; Imputation methods:</span></span>
<span><span class="co">#&gt;        mcid        race         sex institution       proxy </span></span>
<span><span class="co">#&gt;          ""          ""          ""          ""   "polyreg" </span></span>
<span><span class="co">#&gt; PredictorMatrix:</span></span>
<span><span class="co">#&gt;             mcid race sex institution proxy</span></span>
<span><span class="co">#&gt; mcid           0    1   1           1     1</span></span>
<span><span class="co">#&gt; race           0    0   1           1     1</span></span>
<span><span class="co">#&gt; sex            0    1   0           1     1</span></span>
<span><span class="co">#&gt; institution    0    1   1           0     1</span></span>
<span><span class="co">#&gt; proxy          0    1   1           1     0</span></span>
<span><span class="co">#&gt; Number of logged events:  1 </span></span>
<span><span class="co">#&gt;   it im dep     meth  out</span></span>
<span><span class="co">#&gt; 1  0  0     constant mcid</span></span></code></pre>
<p><em>Imputation methods.</em> We look more closely at two elements of
this framework. The first is the imputation method vector.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imputation method</span></span>
<span><span class="va">method_vector</span> <span class="op">&lt;-</span> <span class="va">framework</span><span class="op">[[</span><span class="st">"method"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the results</span></span>
<span><span class="va">method_vector</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;        mcid        race         sex institution       proxy </span></span>
<span><span class="co">#&gt;          ""          ""          ""          ""   "polyreg"</span></span></code></pre>
<p>The “polyreg” imputation method (polytomous logistic regression) is
appropriate for data, like ours, comprising unordered categorical
variables. Variable <code>proxy</code> is imputed using the polyreg
method; the other variables, being predictors, are not imputed, thus
their methods are empty.</p>
<p>Had the method not been correctly assigned, we would assign it as
follows,</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually assign the variable(s) being imputed</span></span>
<span><span class="va">method_vector</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"proxy"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"polyreg"</span></span>
<span></span>
<span><span class="co"># Manually assign the variable(s) not being imputed</span></span>
<span><span class="va">method_vector</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"institution"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span></span>
<span><span class="co"># Display the results</span></span>
<span><span class="va">method_vector</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;        mcid        race         sex institution       proxy </span></span>
<span><span class="co">#&gt;          ""          ""          ""          ""   "polyreg"</span></span></code></pre>
<p><em>Predictor matrix.</em> The second element to review is the
predictor matrix. A row label identifies the variable being predicted;
the columns indicate the predictor variables.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imputation predictor matrix</span></span>
<span><span class="va">predictor_matrix</span> <span class="op">&lt;-</span> <span class="va">framework</span><span class="op">[[</span><span class="st">"predictorMatrix"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the results</span></span>
<span><span class="va">predictor_matrix</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;             mcid race sex institution proxy</span></span>
<span><span class="co">#&gt; mcid           0    1   1           1     1</span></span>
<span><span class="co">#&gt; race           0    0   1           1     1</span></span>
<span><span class="co">#&gt; sex            0    1   0           1     1</span></span>
<span><span class="co">#&gt; institution    0    1   1           0     1</span></span>
<span><span class="co">#&gt; proxy          0    1   1           1     0</span></span></code></pre>
<p>However, only those variables assigned a method are imputed. In our
case, the only variable to be imputed is <code>proxy</code>, so the only
row of this matrix that gets used is the last row.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Predictor row for this example</span></span>
<span><span class="va">predictor_matrix</span><span class="op">[</span><span class="st">"proxy"</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;        mcid        race         sex institution       proxy </span></span>
<span><span class="co">#&gt;           0           1           1           1           0</span></span></code></pre>
<p>The zeros and ones tell us that <code>proxy</code> is going to be
predicted by institution, race, and sex.</p>
<p>Had the default setting been incorrect, we can set them manually.
Again, note that the bottom row is the only row we need because only the
<code>proxy</code> variable is being imputed.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually assign zero columns</span></span>
<span><span class="va">predictor_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"proxy"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Manually assign predictor columns</span></span>
<span><span class="va">predictor_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"institution"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">predictor_matrix</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;             mcid race sex institution proxy</span></span>
<span><span class="co">#&gt; mcid           0    0   0           0     0</span></span>
<span><span class="co">#&gt; race           0    0   0           0     0</span></span>
<span><span class="co">#&gt; sex            0    0   0           0     0</span></span>
<span><span class="co">#&gt; institution    0    0   0           0     0</span></span>
<span><span class="co">#&gt; proxy          0    1   1           1     0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="optional-predictors">Optional predictors<a class="anchor" aria-label="anchor" href="#optional-predictors"></a>
</h3>
<p>The default predictors set up by <code><a href="../reference/prep_fye_mice.html">prep_fye_mice()</a></code> are
institution (required), race/ethnicity, and sex. If these are
acceptable, you can skip to the next section, <a href="#imputing-missing-values">Imputing missing values</a>.</p>
<p>Predictors can be edited or added before invoking
<code><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice()</a></code>. As before, ensure that the only missing values are
in the proxy column. Other variables are expected to be complete (no NA
values). A value of “unknown” in a predictor column, e.g.,
race/ethnicity or sex, is an acceptable value, not missing data.
Observations with missing or unknown values in the ID or institution
columns should be removed.</p>
<p>For example, suppose we wish to replace race/ethnicity and sex with a
<code>people</code> variable that has four possible values
(<code>Domestic Female</code>, <code>Domestic Male</code>,
<code>International Female</code>, and <code>International Male</code>)
where “domestic” means a US citizen; and we want to add a variable that
encodes the <code>year</code> of a student’s first term in FYE.</p>
<p><em>Creating variables.</em> Remove any unknown observations of
race/ethnicity and sex to create the desired <code>people</code>
variable.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data frame to illustrate optional predictors</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Factor to character</span></span>
<span><span class="va">cols_to_edit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="op">(</span><span class="va">cols_to_edit</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">as.character</span><span class="op">)</span>, .SDcols <span class="op">=</span> <span class="va">cols_to_edit</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Filter unknown race and sex</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">opt_DT</span><span class="op">[</span><span class="va">sex</span> <span class="op">!=</span> <span class="st">"Unknown"</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">opt_DT</span><span class="op">[</span><span class="va">race</span> <span class="op">!=</span> <span class="st">"Other/Unknown"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create origin variable</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">origin</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span>
<span>    <span class="va">race</span> <span class="op">!=</span> <span class="st">"International"</span>, <span class="st">"Domestic"</span>, </span>
<span>    <span class="va">race</span> <span class="op">==</span> <span class="st">"International"</span>, <span class="st">"International"</span>, </span>
<span>    default <span class="op">=</span> <span class="cn">NA_character_</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">opt_DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create people variable</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">people</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">people</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">people</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"race"</span>, <span class="st">"sex"</span>, <span class="st">"origin"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display result</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setcolorder.html" class="external-link">setcolorder</a></span><span class="op">(</span><span class="va">opt_DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"people"</span>, <span class="st">"institution"</span>, <span class="st">"proxy"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;              mcid          people   institution  proxy</span></span>
<span><span class="co">#&gt;            &lt;char&gt;          &lt;fctr&gt;        &lt;fctr&gt; &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;    1: MID26060301 Domestic Female Institution C   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    2: MID25995980 Domestic Female Institution C   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    3: MID25997636 Domestic Female Institution C   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    4: MID26086310 Domestic Female Institution C   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    5: MID26000057 Domestic Female Institution C   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   ---                                                 </span></span>
<span><span class="co">#&gt; 4339: MID25844276   Domestic Male Institution M 143501</span></span>
<span><span class="co">#&gt; 4340: MID25846316   Domestic Male Institution M 143501</span></span>
<span><span class="co">#&gt; 4341: MID25847220   Domestic Male Institution M 143501</span></span>
<span><span class="co">#&gt; 4342: MID25848589   Domestic Male Institution M 143501</span></span>
<span><span class="co">#&gt; 4343: MID25828870   Domestic Male Institution M 149999</span></span></code></pre>
<p>Check the unique values.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display unique people</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">opt_DT</span><span class="op">$</span><span class="va">people</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] Domestic Female      Domestic Male        International Female</span></span>
<span><span class="co">#&gt; [4] International Male  </span></span>
<span><span class="co">#&gt; 4 Levels: Domestic Female Domestic Male ... International Male</span></span></code></pre></div>
<p><em>Adding a variable.</em> Obtain the student’s first term in the
data set from the <code>term</code> data table using a left-outer
join.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add all term variables by ID</span></span>
<span><span class="va">cols_to_join</span> <span class="op">&lt;-</span> <span class="va">term</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">term</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">cols_to_join</span><span class="op">[</span><span class="va">opt_DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Filter for first term</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html" class="external-link">setkeyv</a></span><span class="op">(</span><span class="va">opt_DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"term"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">opt_DT</span><span class="op">[</span>, <span class="va">.SD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create year variable</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">year</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">term</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">year</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">term</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display result</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setcolorder.html" class="external-link">setcolorder</a></span><span class="op">(</span><span class="va">opt_DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"people"</span>, <span class="st">"institution"</span>, <span class="st">"year"</span>, <span class="st">"proxy"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;              mcid               people   institution   year  proxy</span></span>
<span><span class="co">#&gt;            &lt;char&gt;               &lt;fctr&gt;        &lt;fctr&gt; &lt;fctr&gt; &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;    1: MID25783162        Domestic Male Institution M   1992   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    2: MID25783178        Domestic Male Institution M   1994 140701</span></span>
<span><span class="co">#&gt;    3: MID25783197        Domestic Male Institution M   1987 140701</span></span>
<span><span class="co">#&gt;    4: MID25783259        Domestic Male Institution M   1988   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    5: MID25783388        Domestic Male Institution M   1987 141901</span></span>
<span><span class="co">#&gt;   ---                                                             </span></span>
<span><span class="co">#&gt; 4339: MID26648422        Domestic Male Institution J   2009   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4340: MID26648484        Domestic Male Institution J   2009   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4341: MID26648508 International Female Institution J   2009   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4342: MID26648517        Domestic Male Institution J   2009   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4343: MID26648553        Domestic Male Institution J   2009   &lt;NA&gt;</span></span></code></pre>
<p><em>Filtering.</em> Ensure complete cases except in
<code>proxy</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify complete cases in predictor variables </span></span>
<span><span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">opt_DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">people</span>, <span class="va">institution</span>, <span class="va">year</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter for complete predictors</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">opt_DT</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;              mcid               people   institution   year  proxy</span></span>
<span><span class="co">#&gt;            &lt;char&gt;               &lt;fctr&gt;        &lt;fctr&gt; &lt;fctr&gt; &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;    1: MID25783162        Domestic Male Institution M   1992   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    2: MID25783178        Domestic Male Institution M   1994 140701</span></span>
<span><span class="co">#&gt;    3: MID25783197        Domestic Male Institution M   1987 140701</span></span>
<span><span class="co">#&gt;    4: MID25783259        Domestic Male Institution M   1988   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    5: MID25783388        Domestic Male Institution M   1987 141901</span></span>
<span><span class="co">#&gt;   ---                                                             </span></span>
<span><span class="co">#&gt; 4339: MID26648422        Domestic Male Institution J   2009   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4340: MID26648484        Domestic Male Institution J   2009   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4341: MID26648508 International Female Institution J   2009   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4342: MID26648517        Domestic Male Institution J   2009   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4343: MID26648553        Domestic Male Institution J   2009   &lt;NA&gt;</span></span></code></pre>
<p><em>Framework</em> for optional predictors.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imputation framework</span></span>
<span><span class="va">opt_framework</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span><span class="va">opt_DT</span>, maxit <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the results</span></span>
<span><span class="va">opt_framework</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Class: mids</span></span>
<span><span class="co">#&gt; Number of multiple imputations:  5 </span></span>
<span><span class="co">#&gt; Imputation methods:</span></span>
<span><span class="co">#&gt;        mcid      people institution        year       proxy </span></span>
<span><span class="co">#&gt;          ""          ""          ""          ""   "polyreg" </span></span>
<span><span class="co">#&gt; PredictorMatrix:</span></span>
<span><span class="co">#&gt;             mcid people institution year proxy</span></span>
<span><span class="co">#&gt; mcid           0      1           1    1     1</span></span>
<span><span class="co">#&gt; people         0      0           1    1     1</span></span>
<span><span class="co">#&gt; institution    0      1           0    1     1</span></span>
<span><span class="co">#&gt; year           0      1           1    0     1</span></span>
<span><span class="co">#&gt; proxy          0      1           1    1     0</span></span>
<span><span class="co">#&gt; Number of logged events:  1 </span></span>
<span><span class="co">#&gt;   it im dep     meth  out</span></span>
<span><span class="co">#&gt; 1  0  0     constant mcid</span></span></code></pre>
<p><em>Imputation method</em> for optional predictors.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imputation framework</span></span>
<span><span class="va">opt_method_vector</span> <span class="op">&lt;-</span> <span class="va">opt_framework</span><span class="op">[[</span><span class="st">"method"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the results</span></span>
<span><span class="va">opt_method_vector</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;        mcid      people institution        year       proxy </span></span>
<span><span class="co">#&gt;          ""          ""          ""          ""   "polyreg"</span></span></code></pre>
<p><em>Predictor matrix</em> for optional predictors.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imputation predictor matrix</span></span>
<span><span class="va">opt_predictor_matrix</span> <span class="op">&lt;-</span> <span class="va">opt_framework</span><span class="op">[[</span><span class="st">"predictorMatrix"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the results</span></span>
<span><span class="va">opt_predictor_matrix</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;             mcid people institution year proxy</span></span>
<span><span class="co">#&gt; mcid           0      1           1    1     1</span></span>
<span><span class="co">#&gt; people         0      0           1    1     1</span></span>
<span><span class="co">#&gt; institution    0      1           0    1     1</span></span>
<span><span class="co">#&gt; year           0      1           1    0     1</span></span>
<span><span class="co">#&gt; proxy          0      1           1    1     0</span></span></code></pre>
<p><em>Percent missing data</em> for setting the number of multiple
imputations.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N_impute</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">opt_DT</span><span class="op">$</span><span class="va">proxy</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">N_fye</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">opt_DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Percent missing data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">N_impute</span> <span class="op">/</span> <span class="va">N_fye</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 37</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="imputing-missing-values">Imputing missing values<a class="anchor" aria-label="anchor" href="#imputing-missing-values"></a>
</h2>
<p>The three essential arguments for <code><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice()</a></code> are the
<code>DT</code> data frame, the <code>method_vector</code>, and the
<code>predictor_matrix</code>. The number of multiple imputations
<code>m</code> is set to 38 as discussed in <a href="#missing-data">Missing data</a>. The default <code>seed</code>
argument is NULL, but by setting the seed as shown the vignette results
are reproducible. Setting <code>printFlag = TRUE</code> displays
progress in the console.</p>
<p>For the practice data, 5 iterations of 38 imputations takes about 3
minutes (depending on your machine). For MIDFIELD research data,
however, imputation runs significantly longer.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Impute missing proxy data</span></span>
<span><span class="va">DT_mids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">DT</span>,</span>
<span>  m <span class="op">=</span> <span class="fl">38</span>, </span>
<span>  maxit <span class="op">=</span> <span class="fl">5</span>, <span class="co"># default</span></span>
<span>  method <span class="op">=</span> <span class="va">method_vector</span>,</span>
<span>  predictorMatrix <span class="op">=</span> <span class="va">predictor_matrix</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">20180624</span>,</span>
<span>  printFlag <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># output in console with printFlag = TRUE</span></span>
<span><span class="co"># &gt;  iter imp variable</span></span>
<span><span class="co"># &gt;   1   1  proxy</span></span>
<span><span class="co"># &gt;   1   2  proxy</span></span>
<span><span class="co"># &gt;   1   3  proxy</span></span>
<span><span class="co"># &gt;   1   4  proxy</span></span>
<span><span class="co"># &gt;   1   5  proxy</span></span>
<span><span class="co"># &gt;   ---</span></span>
<span><span class="co"># &gt;   5  34  proxy</span></span>
<span><span class="co"># &gt;   5  35  proxy</span></span>
<span><span class="co"># &gt;   5  36  proxy</span></span>
<span><span class="co"># &gt;   5  37  proxy</span></span>
<span><span class="co"># &gt;   5  38  proxy</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="post-processing">Post-processing<a class="anchor" aria-label="anchor" href="#post-processing"></a>
</h2>
<p><em>Extracting the result.</em> We apply
<code><a href="https://tidyr.tidyverse.org/reference/complete.html" class="external-link">mice::complete()</a></code> to extract the data from the
<code>mids</code> object. The missing data have been replaced by imputed
values.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revert to default random number generation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract data from the mids object</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html" class="external-link">complete</a></span><span class="op">(</span><span class="va">DT_mids</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to data.table structure</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;              mcid          race    sex   institution  proxy</span></span>
<span><span class="co">#&gt;            &lt;char&gt;        &lt;fctr&gt; &lt;fctr&gt;        &lt;fctr&gt; &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;    1: MID25783162         White   Male Institution M 140801</span></span>
<span><span class="co">#&gt;    2: MID25783178         Black   Male Institution M 140701</span></span>
<span><span class="co">#&gt;    3: MID25783197         White   Male Institution M 140701</span></span>
<span><span class="co">#&gt;    4: MID25783259         White   Male Institution M 141901</span></span>
<span><span class="co">#&gt;    5: MID25783388         White   Male Institution M 141901</span></span>
<span><span class="co">#&gt;   ---                                                      </span></span>
<span><span class="co">#&gt; 4488: MID26648422         White   Male Institution J 142101</span></span>
<span><span class="co">#&gt; 4489: MID26648484        Latine   Male Institution J 143501</span></span>
<span><span class="co">#&gt; 4490: MID26648508 International Female Institution J 143501</span></span>
<span><span class="co">#&gt; 4491: MID26648517        Latine   Male Institution J 140201</span></span>
<span><span class="co">#&gt; 4492: MID26648553         White   Male Institution J 141901</span></span></code></pre>
<p><em>Selecting columns.</em> To use the result, we need only two
columns: IDs and the the predicted starting programs.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset the data</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">proxy</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;              mcid  proxy</span></span>
<span><span class="co">#&gt;            &lt;char&gt; &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;    1: MID25783162 140801</span></span>
<span><span class="co">#&gt;    2: MID25783178 140701</span></span>
<span><span class="co">#&gt;    3: MID25783197 140701</span></span>
<span><span class="co">#&gt;    4: MID25783259 141901</span></span>
<span><span class="co">#&gt;    5: MID25783388 141901</span></span>
<span><span class="co">#&gt;   ---                   </span></span>
<span><span class="co">#&gt; 4488: MID26648422 142101</span></span>
<span><span class="co">#&gt; 4489: MID26648484 143501</span></span>
<span><span class="co">#&gt; 4490: MID26648508 143501</span></span>
<span><span class="co">#&gt; 4491: MID26648517 140201</span></span>
<span><span class="co">#&gt; 4492: MID26648553 141901</span></span></code></pre>
<p><em>Recoding.</em> We convert the CIP codes from factor to
character.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert factors</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">proxy</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;              mcid  proxy</span></span>
<span><span class="co">#&gt;            &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MID25783162 140801</span></span>
<span><span class="co">#&gt;    2: MID25783178 140701</span></span>
<span><span class="co">#&gt;    3: MID25783197 140701</span></span>
<span><span class="co">#&gt;    4: MID25783259 141901</span></span>
<span><span class="co">#&gt;    5: MID25783388 141901</span></span>
<span><span class="co">#&gt;   ---                   </span></span>
<span><span class="co">#&gt; 4488: MID26648422 142101</span></span>
<span><span class="co">#&gt; 4489: MID26648484 143501</span></span>
<span><span class="co">#&gt; 4490: MID26648508 143501</span></span>
<span><span class="co">#&gt; 4491: MID26648517 140201</span></span>
<span><span class="co">#&gt; 4492: MID26648553 141901</span></span></code></pre>
<p><em>Filtering.</em> Proxies are substitutes for students
<em>starting</em> in FYE. Thus we filter to remove migrators, retaining
the proxies of first-term FYE students only.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Order term data by ID and term</span></span>
<span><span class="va">ordered_term</span> <span class="op">&lt;-</span> <span class="va">term</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">term</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorderv</a></span><span class="op">(</span><span class="va">ordered_term</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"term"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtain first term of all students</span></span>
<span><span class="va">first_term</span> <span class="op">&lt;-</span> <span class="va">ordered_term</span><span class="op">[</span>, <span class="va">.SD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Reduce to first term in FYE</span></span>
<span><span class="va">first_term_fye_mcid</span> <span class="op">&lt;-</span> <span class="va">first_term</span><span class="op">[</span><span class="va">cip6</span> <span class="op">==</span> <span class="st">"140102"</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Inner join to remove migrators from working data frame</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">first_term_fye_mcid</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;              mcid  proxy</span></span>
<span><span class="co">#&gt;            &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: MID25783162 140801</span></span>
<span><span class="co">#&gt;    2: MID25783178 140701</span></span>
<span><span class="co">#&gt;    3: MID25783197 140701</span></span>
<span><span class="co">#&gt;    4: MID25783388 141901</span></span>
<span><span class="co">#&gt;    5: MID25783441 140801</span></span>
<span><span class="co">#&gt;   ---                   </span></span>
<span><span class="co">#&gt; 3734: MID26648222 141901</span></span>
<span><span class="co">#&gt; 3735: MID26648283 141901</span></span>
<span><span class="co">#&gt; 3736: MID26648422 142101</span></span>
<span><span class="co">#&gt; 3737: MID26648484 143501</span></span>
<span><span class="co">#&gt; 3738: MID26648553 141901</span></span></code></pre>
<p><em>Verify built-in data.</em> To avoid deriving this data frame each
time it is needed in other vignettes, the same information is provided
in the <code>fye_proxy</code> data frame included with midfieldr. Here
we verify that the two data frames are identical.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Verify built-in data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">fye_proxy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p><em>This step concludes the procedure for creating FYE proxy
data.</em></p>
</div>
<div class="section level2">
<h2 id="assessing-fye-proxies">Assessing FYE proxies<a class="anchor" aria-label="anchor" href="#assessing-fye-proxies"></a>
</h2>
<div class="section level3">
<h3 id="credibility">Credibility<a class="anchor" aria-label="anchor" href="#credibility"></a>
</h3>
<p>Here we summarize the FYE proxy data set to see how many students our
algorithm assigned to which engineering majors. Start by extracting the
unique set of CIP codes from the proxy data set.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify unique CIP codes in the proxy data</span></span>
<span><span class="va">proxy_cips</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">fye_proxy</span><span class="op">$</span><span class="va">proxy</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the results</span></span>
<span><span class="va">proxy_cips</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] "140201" "140301" "140501" "140601" "140701" "140801" "140901" "141001"</span></span>
<span><span class="co">#&gt;  [9] "141101" "141301" "141401" "141801" "141901" "142101" "143301" "143501"</span></span>
<span><span class="co">#&gt; [17] "149999"</span></span></code></pre>
<p>Obtain the program names from the <code>cip</code> data set (provided
with midfieldr). We use the 4-digit names that in engineering generally
represent department-level programs.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtain the 4-digit program names corresponding to these codes</span></span>
<span><span class="va">proxy_program_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_search.html">filter_search</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="va">proxy_cips</span><span class="op">)</span></span>
<span><span class="va">proxy_program_names</span> <span class="op">&lt;-</span> <span class="va">proxy_program_names</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip6</span>, program <span class="op">=</span> <span class="va">cip4name</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">proxy_program_names</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;       cip6                                                 program</span></span>
<span><span class="co">#&gt;     &lt;char&gt;                                                  &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1: 140201   Aerospace, Aeronautical and Astronautical Engineering</span></span>
<span><span class="co">#&gt;  2: 140301 Agricultural, Biological Engineering and Bioengineering</span></span>
<span><span class="co">#&gt;  3: 140501                         Biomedical, Medical Engineering</span></span>
<span><span class="co">#&gt;  4: 140601                        Ceramic Sciences and Engineering</span></span>
<span><span class="co">#&gt;  5: 140701                                    Chemical Engineering</span></span>
<span><span class="co">#&gt;  6: 140801                                       Civil Engineering</span></span>
<span><span class="co">#&gt;  7: 140901                           Computer Engineering, General</span></span>
<span><span class="co">#&gt;  8: 141001  Electrical, Electronics and Communications Engineering</span></span>
<span><span class="co">#&gt;  9: 141101                                   Engineering Mechanics</span></span>
<span><span class="co">#&gt; 10: 141301                                     Engineering Science</span></span>
<span><span class="co">#&gt; 11: 141401         Environmental, Environmental Health Engineering</span></span>
<span><span class="co">#&gt; 12: 141801                                   Materials Engineering</span></span>
<span><span class="co">#&gt; 13: 141901                                  Mechanical Engineering</span></span>
<span><span class="co">#&gt; 14: 142101                          Mining and Mineral Engineering</span></span>
<span><span class="co">#&gt; 15: 143301                                Construction Engineering</span></span>
<span><span class="co">#&gt; 16: 143501                                  Industrial Engineering</span></span>
<span><span class="co">#&gt; 17: 149999                                      Engineering, Other</span></span></code></pre>
<p>Join these names to the proxy data set, summarize by program, and
order the rows by descending N.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join these program names to the proxy data</span></span>
<span><span class="va">proxy_programs</span> <span class="op">&lt;-</span> <span class="va">proxy_program_names</span><span class="op">[</span><span class="va">fye_proxy</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>cip6 <span class="op">=</span> <span class="va">proxy</span><span class="op">)</span><span class="op">]</span>, <span class="fu">.</span><span class="op">(</span><span class="va">program</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Count by program and order rows in descending magnitude</span></span>
<span><span class="va">proxy_programs</span> <span class="op">&lt;-</span> <span class="va">proxy_programs</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"program"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorderv</a></span><span class="op">(</span><span class="va">proxy_programs</span>, order <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the result</span></span>
<span><span class="va">proxy_programs</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;                                                     program     N</span></span>
<span><span class="co">#&gt;                                                      &lt;char&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1:                                  Mechanical Engineering   938</span></span>
<span><span class="co">#&gt;  2:                                       Civil Engineering   562</span></span>
<span><span class="co">#&gt;  3:  Electrical, Electronics and Communications Engineering   515</span></span>
<span><span class="co">#&gt;  4:                           Computer Engineering, General   407</span></span>
<span><span class="co">#&gt;  5:                                    Chemical Engineering   339</span></span>
<span><span class="co">#&gt;  6:   Aerospace, Aeronautical and Astronautical Engineering   311</span></span>
<span><span class="co">#&gt;  7:                                  Industrial Engineering   287</span></span>
<span><span class="co">#&gt;  8: Agricultural, Biological Engineering and Bioengineering    85</span></span>
<span><span class="co">#&gt;  9:                          Mining and Mineral Engineering    80</span></span>
<span><span class="co">#&gt; 10:                                   Engineering Mechanics    75</span></span>
<span><span class="co">#&gt; 11:                        Ceramic Sciences and Engineering    63</span></span>
<span><span class="co">#&gt; 12:                                   Materials Engineering    60</span></span>
<span><span class="co">#&gt; 13:                                     Engineering Science     7</span></span>
<span><span class="co">#&gt; 14:         Environmental, Environmental Health Engineering     4</span></span>
<span><span class="co">#&gt; 15:                                Construction Engineering     3</span></span>
<span><span class="co">#&gt; 16:                                      Engineering, Other     1</span></span>
<span><span class="co">#&gt; 17:                         Biomedical, Medical Engineering     1</span></span></code></pre>
<p>For comparison, the National Science Foundation (NSF) reports that in
2012, the top seven US engineering majors ranked by enrollment were
<span class="citation">(<a href="#ref-NSF:2014" role="doc-biblioref">NSF, 2014</a>)</span>:</p>
<ul>
<li>Mechanical</li>
<li>Electrical</li>
<li>Civil</li>
<li>Chemical</li>
<li>Industrial</li>
<li>Aerospace</li>
<li>Materials</li>
</ul>
<p>The NSF data table does not break out Computer Engineering as a
separate observation—if we can assume that Computer Engineering is
combined with Electrical Engineering (a practice followed at many
Engineering colleges), we obtain the following programs in order of
enrollment,</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine Electrical and Computer Engineering</span></span>
<span><span class="va">new_row</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  program <span class="op">=</span> <span class="st">"Electrical/Computer Engineering"</span>,</span>
<span>  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">proxy_programs</span><span class="op">[</span><span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"Electrical|Computer"</span>, <span class="va">N</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Drop the separate Electrical and Computer rows</span></span>
<span><span class="va">proxy_programs</span> <span class="op">&lt;-</span> <span class="va">proxy_programs</span><span class="op">[</span><span class="op">!</span><span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"Electrical|Computer"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Bind the new row and order</span></span>
<span><span class="va">proxy_programs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">proxy_programs</span>, <span class="va">new_row</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorderv</a></span><span class="op">(</span><span class="va">proxy_programs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Display the top 7 programs from the full set of FYE proxies (not
limited to the case study), listed in order of decreasing
<em>N</em>.</p>
<table class="table  lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<caption>
Table 1: Top seven FYE proxies ranked by the number of students assigned
to major.
</caption>
<thead><tr>
<th style="text-align:left;background-color: #c7eae5 !important;">
program
</th>
<th style="text-align:right;background-color: #c7eae5 !important;">
N
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Mechanical Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
938
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Electrical/Computer Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
922
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Civil Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
562
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Chemical Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
339
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Aerospace, Aeronautical and Astronautical Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
311
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Industrial Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
287
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Agricultural, Biological Engineering and Bioengineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
85
</td>
</tr>
</tbody>
</table>
<p>The NSF results are for a single year while the practice data used in
our analysis span 30 years (1987–2016), so some differences are to be
expected. Nevertheless, this listing matches the top six programs in the
NSF list in nearly the same order (rows 5 and 6 have swapped
places).</p>
<p>We conclude that the imputation is credible at least to the extent
that the ranking of the majors is consistent with expectations.</p>
</div>
<div class="section level3">
<h3 id="quantifying-potential-miscounts">Quantifying potential miscounts<a class="anchor" aria-label="anchor" href="#quantifying-potential-miscounts"></a>
</h3>
<p>The main goal of estimating FYE proxies is to prevent starter
miscounts. Here, we assess the potential for miscounts if FYE records
are not treated as recommended.</p>
<p>We start with the <code>first_term</code> data frame created earlier
(in <a href="#post-processing">Post-processing</a>) containing the
initial term information of all students in the practice data.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First term of all students</span></span>
<span><span class="va">first_term</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;               mcid   term   cip6</span></span>
<span><span class="co">#&gt;             &lt;char&gt; &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;     1: MID25783135  19911 520101</span></span>
<span><span class="co">#&gt;     2: MID25783156  20011 040201</span></span>
<span><span class="co">#&gt;     3: MID25783162  19921 140102</span></span>
<span><span class="co">#&gt;     4: MID25783178  19946 140102</span></span>
<span><span class="co">#&gt;     5: MID25783188  19991 513808</span></span>
<span><span class="co">#&gt;    ---                          </span></span>
<span><span class="co">#&gt; 94024: MID26697680  20163 300000</span></span>
<span><span class="co">#&gt; 94025: MID26697682  20163 240101</span></span>
<span><span class="co">#&gt; 94026: MID26697685  20151 300000</span></span>
<span><span class="co">#&gt; 94027: MID26697689  20163 240101</span></span>
<span><span class="co">#&gt; 94028: MID26697702  20161 240101</span></span></code></pre></div>
<p>Identify starters, including FYE proxies, in the four case study
programs. (This procedure is more fully developed in the <a href="art-080-starters.html">Starters</a> vignette.)</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join proxies by ID (left-outer join) to first-term data</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">fye_proxy</span><span class="op">[</span><span class="va">first_term</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span>, <span class="va">proxy</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Distinguish FYE from direct matriculants</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">matric</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span>, <span class="st">"direct"</span>,</span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span>, <span class="st">"fye"</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create start variable</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">start</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span>
<span> <span class="va">matric</span> <span class="op">==</span> <span class="st">"fye"</span>, <span class="va">proxy</span>, </span>
<span> <span class="va">matric</span> <span class="op">==</span> <span class="st">"direct"</span>, <span class="va">cip6</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Filter to retain case study program starters</span></span>
<span><span class="va">join_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">study_programs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html" class="external-link">setnames</a></span><span class="op">(</span><span class="va">join_labels</span>, old <span class="op">=</span> <span class="st">"cip6"</span>, new <span class="op">=</span> <span class="st">"start"</span><span class="op">)</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">join_labels</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"start"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">matric</span>, <span class="va">start</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;        start program        mcid   cip6  proxy matric</span></span>
<span><span class="co">#&gt;       &lt;char&gt;  &lt;char&gt;      &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: 140801      CE MID25787414 140801   &lt;NA&gt; direct</span></span>
<span><span class="co">#&gt;    2: 140801      CE MID25794372 140801   &lt;NA&gt; direct</span></span>
<span><span class="co">#&gt;    3: 140801      CE MID25796088 140801   &lt;NA&gt; direct</span></span>
<span><span class="co">#&gt;    4: 140801      CE MID25801036 140801   &lt;NA&gt; direct</span></span>
<span><span class="co">#&gt;    5: 140801      CE MID25801582 140801   &lt;NA&gt; direct</span></span>
<span><span class="co">#&gt;   ---                                                </span></span>
<span><span class="co">#&gt; 7705: 143501     ISE MID26638466 140102 143501    fye</span></span>
<span><span class="co">#&gt; 7706: 143501     ISE MID26638728 140102 143501    fye</span></span>
<span><span class="co">#&gt; 7707: 143501     ISE MID26640900 140102 143501    fye</span></span>
<span><span class="co">#&gt; 7708: 143501     ISE MID26648141 140102 143501    fye</span></span>
<span><span class="co">#&gt; 7709: 143501     ISE MID26648484 140102 143501    fye</span></span></code></pre>
<p>This data frame contains all direct-matriculation starters in the
case study programs plus the FYE students with one of these programs as
their estimated proxy.</p>
<p>Grouping by program and type of matriculation, we can determine the
FYE percentage of all starters.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matric"</span>, <span class="st">"program"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Transform to row-record form</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/dcast.data.table.html" class="external-link">dcast</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">program</span> <span class="op">~</span> <span class="va">matric</span>, value.var <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute FYE as fraction of total</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">N_starters</span> <span class="op">:=</span> <span class="va">direct</span> <span class="op">+</span> <span class="va">fye</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">fye_pct</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">fye</span> <span class="op">/</span> <span class="va">N_starters</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display result</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;    program direct   fye N_starters fye_pct</span></span>
<span><span class="co">#&gt;     &lt;char&gt;  &lt;int&gt; &lt;int&gt;      &lt;int&gt;   &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      CE   1120   562       1682    33.4</span></span>
<span><span class="co">#&gt; 2:      EE   1763   515       2278    22.6</span></span>
<span><span class="co">#&gt; 3:     ISE    532   287        819    35.0</span></span>
<span><span class="co">#&gt; 4:      ME   1992   938       2930    32.0</span></span></code></pre>
<p>The results indicate (for the case study data) a potential
under-count of 23% to 35% if FYE proxies are excluded when counting
starters.</p>
</div>
</div>
<div class="section level2">
<h2 id="closing">Closing<a class="anchor" aria-label="anchor" href="#closing"></a>
</h2>
<p>We estimated the 6-digit CIP codes of the degree-granting engineering
programs FYE students would have declared had they not been required to
enroll in FYE. We find the estimates credible. For this case study, the
potential under-count if FYE students are excluded from a count of
starters is between 23–35%.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-azur2011" class="csl-entry">
Azur, M. J., Stuart, E. A., Frangakis, C., &amp; Leaf, P. J. (2011).
Multiple imputation by chained equations: <span>W</span>hat is it and
how does it work? <em>International Journal of Methods in Psychiatric
Research</em>, <em>20</em>(1), 40–49.
</div>
<div id="ref-Bodner:2008" class="csl-entry">
Bodner, T. E. (2008). <span class="nocase">What improves with increased
missing data imputations?</span> <em><span>Structural Equation Modeling:
A Multidisciplinary Journal</span></em>, <em>15</em>(4), 651–675. <a href="https://doi.org/10.1080/10705510802339072" class="external-link">https://doi.org/10.1080/10705510802339072</a>
</div>
<div id="ref-dhana2017" class="csl-entry">
Dhana, K. (2017). <em>Handling missing data with <span>MICE</span>
package: A simple approach</em> (D. S. Plus, Ed.). <a href="https://datascienceplus.com/handling-missing-data-with-mice-package-a-simple-approach/" class="external-link uri">https://datascienceplus.com/handling-missing-data-with-mice-package-a-simple-approach/</a>.
</div>
<div id="ref-Dowle+Srinivasan:2021:data.table" class="csl-entry">
Dowle, M., &amp; Srinivasan, A. (2021). <em><span class="nocase">data.table: Extension of data.frame</span></em>.
R package version 1.14.2. <a href="https://CRAN.R-project.org/package=data.table" class="external-link">https://CRAN.R-project.org/package=data.table</a>
</div>
<div id="ref-GraceMartin:2012" class="csl-entry">
Grace-Martin, K. (2012). <em><span class="nocase">Two recommended
solutions for missing data: Multiple imputation and maximum
likelihood</span></em>. Blog post. <a href="https://www.theanalysisfactor.com/missing-data-two-recommended-solutions/" class="external-link">https://www.theanalysisfactor.com/missing-data-two-recommended-solutions/</a>
</div>
<div id="ref-NSF:2014" class="csl-entry">
NSF. (2014). <em><span class="nocase">Science and Engineering Indicators
Report</span></em>. <span>National Science Foundation</span>. <a href="https://www.nsf.gov/nsb/sei/edTool/data/engineering-01.html" class="external-link">https://www.nsf.gov/nsb/sei/edTool/data/engineering-01.html</a>
</div>
<div id="ref-vanBuuren+Oudshoorn:2011" class="csl-entry">
van Buuren, S., &amp; Groothuis-Oudshoorn, K. (2011). <span class="nocase">mice: Multivariate Imputation by Chained Equations in
R</span>. <em>Journal of Statistical Software</em>, <em>45</em>(3),
1–67. <a href="https://www.jstatsoft.org/v45/i03/" class="external-link">https://www.jstatsoft.org/v45/i03/</a>
</div>
<div id="ref-Wickham:2016:ggplot2" class="csl-entry">
Wickham, H. (2016). <em><span class="nocase">ggplot2: Elegant Graphics
for Data Analysis</span></em>. <span>ISBN 978-3-319-24277-4</span>;
Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org" class="external-link">https://ggplot2.tidyverse.org</a>
</div>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="complete-script">Complete script<a class="anchor" aria-label="anchor" href="#complete-script"></a>
</h3>
<p>The vignette code chunks are collected below in a single, condensed
script.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/amices/mice" class="external-link">"mice"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing options for data.table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>  datatable.print.nrows <span class="op">=</span> <span class="fl">17</span>,</span>
<span>  datatable.print.topn <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  datatable.print.class <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span>, package <span class="op">=</span> <span class="st">"midfielddata"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Working data frame</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fye_mice.html">prep_fye_mice</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Missing data</span></span>
<span><span class="va">N_mcid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">mcid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">N_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">race</span>, <span class="va">sex</span>, <span class="va">institution</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">N_mcid</span>, <span class="va">N_complete</span><span class="op">)</span></span>
<span><span class="va">N_impute</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">proxy</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">N_impute</span> <span class="op">/</span> <span class="va">N_complete</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">NA_proxies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using mice()</span></span>
<span><span class="va">framework</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span><span class="va">DT</span>, maxit <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">method_vector</span> <span class="op">&lt;-</span> <span class="va">framework</span><span class="op">[[</span><span class="st">"method"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">method_vector</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"proxy"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"polyreg"</span></span>
<span><span class="va">method_vector</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"institution"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span></span>
<span><span class="va">predictor_matrix</span> <span class="op">&lt;-</span> <span class="va">framework</span><span class="op">[[</span><span class="st">"predictorMatrix"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">predictor_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"proxy"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">predictor_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"institution"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optional predictors</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">cols_to_edit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="op">(</span><span class="va">cols_to_edit</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">as.character</span><span class="op">)</span>, .SDcols <span class="op">=</span> <span class="va">cols_to_edit</span><span class="op">]</span></span>
<span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">opt_DT</span><span class="op">[</span><span class="va">sex</span> <span class="op">!=</span> <span class="st">"Unknown"</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">opt_DT</span><span class="op">[</span><span class="va">race</span> <span class="op">!=</span> <span class="st">"Other/Unknown"</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">origin</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span>
<span>    <span class="va">race</span> <span class="op">!=</span> <span class="st">"International"</span>, <span class="st">"Domestic"</span>, </span>
<span>    <span class="va">race</span> <span class="op">==</span> <span class="st">"International"</span>, <span class="st">"International"</span>, </span>
<span>    default <span class="op">=</span> <span class="cn">NA_character_</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">opt_DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">people</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">people</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">people</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"race"</span>, <span class="st">"sex"</span>, <span class="st">"origin"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setcolorder.html" class="external-link">setcolorder</a></span><span class="op">(</span><span class="va">opt_DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"people"</span>, <span class="st">"institution"</span>, <span class="st">"proxy"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">opt_DT</span><span class="op">$</span><span class="va">people</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cols_to_join</span> <span class="op">&lt;-</span> <span class="va">term</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">term</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">cols_to_join</span><span class="op">[</span><span class="va">opt_DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html" class="external-link">setkeyv</a></span><span class="op">(</span><span class="va">opt_DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"term"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">opt_DT</span><span class="op">[</span>, <span class="va">.SD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">year</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">term</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">year</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">opt_DT</span><span class="op">[</span>, <span class="va">term</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setcolorder.html" class="external-link">setcolorder</a></span><span class="op">(</span><span class="va">opt_DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"people"</span>, <span class="st">"institution"</span>, <span class="st">"year"</span>, <span class="st">"proxy"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">opt_DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">people</span>, <span class="va">institution</span>, <span class="va">year</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">opt_DT</span> <span class="op">&lt;-</span> <span class="va">opt_DT</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span></span>
<span></span>
<span><span class="va">opt_framework</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span><span class="va">opt_DT</span>, maxit <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">opt_method_vector</span> <span class="op">&lt;-</span> <span class="va">opt_framework</span><span class="op">[[</span><span class="st">"method"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">opt_predictor_matrix</span> <span class="op">&lt;-</span> <span class="va">opt_framework</span><span class="op">[[</span><span class="st">"predictorMatrix"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">N_impute</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">opt_DT</span><span class="op">$</span><span class="va">proxy</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">N_fye</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">opt_DT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">N_impute</span> <span class="op">/</span> <span class="va">N_fye</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Imputing missing values</span></span>
<span><span class="va">DT_mids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">DT</span>,</span>
<span>  m <span class="op">=</span> <span class="fl">38</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">5</span>, <span class="co"># default</span></span>
<span>  method <span class="op">=</span> <span class="va">method_vector</span>,</span>
<span>  predictorMatrix <span class="op">=</span> <span class="va">predictor_matrix</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">20180624</span>,</span>
<span>  printFlag <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Post-processing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html" class="external-link">complete</a></span><span class="op">(</span><span class="va">DT_mids</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">proxy</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">proxy</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">ordered_term</span> <span class="op">&lt;-</span> <span class="va">term</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">term</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorderv</a></span><span class="op">(</span><span class="va">ordered_term</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"term"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_term</span> <span class="op">&lt;-</span> <span class="va">ordered_term</span><span class="op">[</span>, <span class="va">.SD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">first_term_fye_mcid</span> <span class="op">&lt;-</span> <span class="va">first_term</span><span class="op">[</span><span class="va">cip6</span> <span class="op">==</span> <span class="st">"140102"</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">first_term_fye_mcid</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">fye_proxy</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Credibility</span></span>
<span><span class="va">proxy_cips</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">fye_proxy</span><span class="op">$</span><span class="va">proxy</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">proxy_program_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_search.html">filter_search</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="va">proxy_cips</span><span class="op">)</span></span>
<span><span class="va">proxy_program_names</span> <span class="op">&lt;-</span> <span class="va">proxy_program_names</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cip6</span>, program <span class="op">=</span> <span class="va">cip4name</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">proxy_programs</span> <span class="op">&lt;-</span> <span class="va">proxy_program_names</span><span class="op">[</span><span class="va">fye_proxy</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>cip6 <span class="op">=</span> <span class="va">proxy</span><span class="op">)</span><span class="op">]</span>, <span class="fu">.</span><span class="op">(</span><span class="va">program</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">proxy_programs</span> <span class="op">&lt;-</span> <span class="va">proxy_programs</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"program"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorderv</a></span><span class="op">(</span><span class="va">proxy_programs</span>, order <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">new_row</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  program <span class="op">=</span> <span class="st">"Electrical/Computer Engineering"</span>,</span>
<span>  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">proxy_programs</span><span class="op">[</span><span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"Electrical|Computer"</span>, <span class="va">N</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">proxy_programs</span> <span class="op">&lt;-</span> <span class="va">proxy_programs</span><span class="op">[</span><span class="op">!</span><span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"Electrical|Computer"</span><span class="op">]</span></span>
<span><span class="va">proxy_programs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">proxy_programs</span>, <span class="va">new_row</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorderv</a></span><span class="op">(</span><span class="va">proxy_programs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">proxy_programs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Quantifying potential miscounts</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">fye_proxy</span><span class="op">[</span><span class="va">first_term</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span>, <span class="va">proxy</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">matric</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span>, <span class="st">"direct"</span>,</span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span>, <span class="st">"fye"</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">start</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span>
<span> <span class="va">matric</span> <span class="op">==</span> <span class="st">"fye"</span>, <span class="va">proxy</span>, </span>
<span> <span class="va">matric</span> <span class="op">==</span> <span class="st">"direct"</span>, <span class="va">cip6</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">join_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">study_programs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html" class="external-link">setnames</a></span><span class="op">(</span><span class="va">join_labels</span>, old <span class="op">=</span> <span class="st">"cip6"</span>, new <span class="op">=</span> <span class="st">"start"</span><span class="op">)</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">join_labels</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"start"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matric"</span>, <span class="st">"program"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/dcast.data.table.html" class="external-link">dcast</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">program</span> <span class="op">~</span> <span class="va">matric</span>, value.var <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">N_starters</span> <span class="op">:=</span> <span class="va">direct</span> <span class="op">+</span> <span class="va">fye</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">fye_pct</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">fye</span> <span class="op">/</span> <span class="va">N_starters</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="chart-script">Chart script<a class="anchor" aria-label="anchor" href="#chart-script"></a>
</h3>
<p>Script for creating the chart of percent missing data grouped by
category.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># New memory location</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">NA_proxies</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert factors to characters</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Overall percentage missing proxies</span></span>
<span><span class="va">overall_miss</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function for determining percent missing proxies by category</span></span>
<span><span class="va">missing_fraction</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">DT</span>, <span class="va">cat_level</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">DT</span><span class="op">[</span>, <span class="va">group</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span>, <span class="st">"missing"</span>, </span>
<span>      default <span class="op">=</span> <span class="st">"not_missing"</span></span>
<span>  <span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span>, <span class="st">"cat_level"</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/dcast.data.table.html" class="external-link">dcast</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">cat_level</span> <span class="op">~</span> <span class="va">group</span>, value.var <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span>
<span>  <span class="va">DT</span><span class="op">[</span>, <span class="va">pct_miss</span> <span class="op">:=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">missing</span> <span class="op">/</span> <span class="op">(</span><span class="va">missing</span> <span class="op">+</span> <span class="va">not_missing</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">cat_level</span>, <span class="va">pct_miss</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply to institution category</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>cat_level <span class="op">=</span> <span class="va">institution</span>, <span class="va">proxy</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">inst</span> <span class="op">&lt;-</span> <span class="fu">missing_fraction</span><span class="op">(</span><span class="va">y</span>, cat_level <span class="op">=</span> <span class="st">"institution"</span><span class="op">)</span></span>
<span><span class="va">inst</span><span class="op">[</span>, <span class="va">category</span> <span class="op">:=</span> <span class="st">"institution"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Apply to race/ethnicity category</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>cat_level <span class="op">=</span> <span class="va">race</span>, <span class="va">proxy</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">race</span> <span class="op">&lt;-</span> <span class="fu">missing_fraction</span><span class="op">(</span><span class="va">y</span>, cat_level <span class="op">=</span> <span class="st">"race"</span><span class="op">)</span></span>
<span><span class="va">race</span><span class="op">[</span>, <span class="va">category</span> <span class="op">:=</span> <span class="st">"race"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Apply to sex category</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>cat_level <span class="op">=</span> <span class="va">sex</span>, <span class="va">proxy</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu">missing_fraction</span><span class="op">(</span><span class="va">y</span>, cat_level <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span></span>
<span><span class="va">sex</span><span class="op">[</span>, <span class="va">category</span> <span class="op">:=</span> <span class="st">"sex"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Gather results and plot</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">inst</span>, <span class="va">race</span>, <span class="va">sex</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">DT</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pct_miss</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">cat_level</span>, <span class="va">pct_miss</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">overall_miss</span>, linetype <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"gray35"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">category</span>, <span class="va">pct_miss</span><span class="op">)</span><span class="op">)</span>, </span>
<span>               as.table <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>               scales <span class="op">=</span> <span class="st">"free_y"</span>,</span>
<span>               space <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"FYE proxy missing values (%)"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<style type="text/css">
blockquote {
    padding:     10px 20px;
    margin:      0 0 20px;
    border-left: 0px
}
caption {
    color:       #525252;
    text-align:  left;
    font-weight: normal;
    font-size:   medium;
    line-height: 1.5;
}
</style>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/graphdr" class="external-link">Richard Layton</a>, Russell Long, Matthew Ohland, Marisa Orr, Susan Lord, US National Science Foundation.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
