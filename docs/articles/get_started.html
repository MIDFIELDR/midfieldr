<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">midfieldr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9007</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_basics.html">Data basics</a>
    </li>
    <li>
      <a href="../articles/multiway_graphs.html">Multiway graphs and tables</a>
    </li>
    <li>
      <a href="../articles/identify_programs.html">Identify programs</a>
    </li>
    <li>
      <a href="../articles/handle_fye.html">Handle FYE programs</a>
    </li>
    <li>
      <a href="../articles/feasible_completion.html">Feasible completion</a>
    </li>
    <li>
      <a href="../articles/graduation_rate.html">Graduation rate</a>
    </li>
    <li>
      <a href="../articles/stickiness_metric.html">Stickiness metric</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/pages/get_session.html">Session info</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/pages/about_midfield.html">About</a>
</li>
<li>
  <a href="https://github.com/MIDFIELDR/midfieldr">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="get_started_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/master/vignettes/get_started.Rmd"><code>vignettes/get_started.Rmd</code></a></small>
      <div class="hidden name"><code>get_started.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>In the midfielddata sample, the programs with the greatest numbers of students are Business and Engineering. In this vignette, we compare the number of students ever enrolled in these programs, grouped by sex and race/ethnicity.</p>
<p>We use midfieldr functions to access midfielddata student records. We condition, group and summarize the data, and graph a result. For data carpentry, we use base R and selected syntax from the data.table package.</p>
<div id="this-vignette-uses" class="section level3">
<h3 class="hasAnchor">
<a href="#this-vignette-uses" class="anchor"></a>This vignette uses</h3>
<p>midfieldr functions</p>
<ul>
<li><code><a href="../reference/filter_text.html">filter_text()</a></code></li>
<li><code><a href="../reference/subset_feasible.html">subset_feasible()</a></code></li>
<li><code><a href="../reference/prepare_multiway.html">prepare_multiway()</a></code></li>
</ul>
<p>packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages used</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfieldr">midfieldr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfielddata">midfielddata</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://Rdatatable.gitlab.io/data.table">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="co"># print max 20 rows, otherwise 10 rows each head/tail</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>datatable.print.nrows <span class="op">=</span> <span class="fl">20</span>, datatable.print.topn <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="gather-programs" class="section level2">
<h2 class="hasAnchor">
<a href="#gather-programs" class="anchor"></a>Gather programs</h2>
<p>Instructional programs are encoded by a 6-digit CIP code. <code><a href="../reference/filter_text.html">filter_text()</a></code> accesses the <code>cip</code> data set and retrieves all the 6-digit codes that satisfy stated conditions. In this case, we want all codes that start with 14 (engineering) and 52 (business).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># engineering</span>
<span class="va">engineering</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="st">"^14"</span>, keep_col <span class="op">=</span> <span class="st">"cip6"</span><span class="op">)</span>

<span class="co"># add program label</span>
<span class="va">engineering</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Engineering"</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">engineering</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;       cip6     program</span>
<span class="co">#&gt;  1: 140101 Engineering</span>
<span class="co">#&gt;  2: 140102 Engineering</span>
<span class="co">#&gt;  3: 140201 Engineering</span>
<span class="co">#&gt;  4: 140301 Engineering</span>
<span class="co">#&gt;  5: 140401 Engineering</span>
<span class="co">#&gt;  6: 140501 Engineering</span>
<span class="co">#&gt;  7: 140601 Engineering</span>
<span class="co">#&gt;  8: 140701 Engineering</span>
<span class="co">#&gt;  9: 140702 Engineering</span>
<span class="co">#&gt; 10: 140799 Engineering</span>
<span class="co">#&gt; ---                   </span>
<span class="co">#&gt; 47: 143901 Engineering</span>
<span class="co">#&gt; 48: 144001 Engineering</span>
<span class="co">#&gt; 49: 144101 Engineering</span>
<span class="co">#&gt; 50: 144201 Engineering</span>
<span class="co">#&gt; 51: 144301 Engineering</span>
<span class="co">#&gt; 52: 144401 Engineering</span>
<span class="co">#&gt; 53: 144501 Engineering</span>
<span class="co">#&gt; 54: 149999 Engineering</span>
<span class="co">#&gt; 55: 14XXXX Engineering</span>
<span class="co">#&gt; 56: 14YYYY Engineering</span></code></pre></div>
<p>Repeat for business.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># business</span>
<span class="va">business</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="st">"^52"</span>, keep_col <span class="op">=</span> <span class="st">"cip6"</span><span class="op">)</span>

<span class="co"># add program label</span>
<span class="va">business</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Business"</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">business</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;       cip6  program</span>
<span class="co">#&gt;  1: 520101 Business</span>
<span class="co">#&gt;  2: 520201 Business</span>
<span class="co">#&gt;  3: 520202 Business</span>
<span class="co">#&gt;  4: 520203 Business</span>
<span class="co">#&gt;  5: 520204 Business</span>
<span class="co">#&gt;  6: 520205 Business</span>
<span class="co">#&gt;  7: 520206 Business</span>
<span class="co">#&gt;  8: 520207 Business</span>
<span class="co">#&gt;  9: 520208 Business</span>
<span class="co">#&gt; 10: 520209 Business</span>
<span class="co">#&gt; ---                </span>
<span class="co">#&gt; 85: 521905 Business</span>
<span class="co">#&gt; 86: 521906 Business</span>
<span class="co">#&gt; 87: 521907 Business</span>
<span class="co">#&gt; 88: 521908 Business</span>
<span class="co">#&gt; 89: 521909 Business</span>
<span class="co">#&gt; 90: 521910 Business</span>
<span class="co">#&gt; 91: 521999 Business</span>
<span class="co">#&gt; 92: 522001 Business</span>
<span class="co">#&gt; 93: 522101 Business</span>
<span class="co">#&gt; 94: 529999 Business</span></code></pre></div>
<p>Bind the two data frames.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># bind the two data frames</span>
<span class="va">program_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span><span class="op">(</span><span class="va">engineering</span>, <span class="va">business</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">program_group</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">cip6</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;        cip6     program</span>
<span class="co">#&gt;   1: 140101 Engineering</span>
<span class="co">#&gt;   2: 140102 Engineering</span>
<span class="co">#&gt;   3: 140201 Engineering</span>
<span class="co">#&gt;   4: 140301 Engineering</span>
<span class="co">#&gt;   5: 140401 Engineering</span>
<span class="co">#&gt;   6: 140501 Engineering</span>
<span class="co">#&gt;   7: 140601 Engineering</span>
<span class="co">#&gt;   8: 140701 Engineering</span>
<span class="co">#&gt;   9: 140702 Engineering</span>
<span class="co">#&gt;  10: 140799 Engineering</span>
<span class="co">#&gt;  ---                   </span>
<span class="co">#&gt; 141: 521905    Business</span>
<span class="co">#&gt; 142: 521906    Business</span>
<span class="co">#&gt; 143: 521907    Business</span>
<span class="co">#&gt; 144: 521908    Business</span>
<span class="co">#&gt; 145: 521909    Business</span>
<span class="co">#&gt; 146: 521910    Business</span>
<span class="co">#&gt; 147: 521999    Business</span>
<span class="co">#&gt; 148: 522001    Business</span>
<span class="co">#&gt; 149: 522101    Business</span>
<span class="co">#&gt; 150: 529999    Business</span></code></pre></div>
<p>We extract the <code>cip6</code> column as a character vector to use later to extract student data by their CIP codes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract a vector of 6-digit CIP codes</span>
<span class="va">group_cip</span> <span class="op">&lt;-</span> <span class="va">program_group</span><span class="op">$</span><span class="va">cip6</span>

<span class="co"># examine the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">group_cip</span><span class="op">)</span>
<span class="co">#&gt;  chr [1:150] "140101" "140102" "140201" "140301" "140401" "140501" "140601" ...</span></code></pre></div>
<p>Related vignettes</p>
<ul>
<li>
<em>Identify programs</em> <a href="identify_programs.html">(link)</a> illustrates search strategies using <code><a href="../reference/filter_text.html">filter_text()</a></code> and program labeling options</li>
</ul>
</div>
<div id="gather-students" class="section level2">
<h2 class="hasAnchor">
<a href="#gather-students" class="anchor"></a>Gather students</h2>
<p>We access <code>midfieldterms</code> to obtain the IDs of all students ever enrolled in these programs.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract students ever enrolled from terms data</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"cip6"</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">$</span><span class="va">cip6</span> <span class="op">%in%</span> <span class="va">group_cip</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">enrollees</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                 id   cip6</span>
<span class="co">#&gt;     1: MID25783135 520101</span>
<span class="co">#&gt;     2: MID25783162 14XXXX</span>
<span class="co">#&gt;     3: MID25783162 520301</span>
<span class="co">#&gt;     4: MID25783162 521401</span>
<span class="co">#&gt;     5: MID25783166 14XXXX</span>
<span class="co">#&gt;     6: MID25783167 14XXXX</span>
<span class="co">#&gt;     7: MID25783167 140901</span>
<span class="co">#&gt;     8: MID25783178 14XXXX</span>
<span class="co">#&gt;     9: MID25783178 140701</span>
<span class="co">#&gt;    10: MID25783178 143501</span>
<span class="co">#&gt;    ---                   </span>
<span class="co">#&gt; 50956: MID26697447 140701</span>
<span class="co">#&gt; 50957: MID26697447 141001</span>
<span class="co">#&gt; 50958: MID26697449 520201</span>
<span class="co">#&gt; 50959: MID26697449 521003</span>
<span class="co">#&gt; 50960: MID26697471 520201</span>
<span class="co">#&gt; 50961: MID26697484 521401</span>
<span class="co">#&gt; 50962: MID26697576 520301</span>
<span class="co">#&gt; 50963: MID26697576 521401</span>
<span class="co">#&gt; 50964: MID26697599 521201</span>
<span class="co">#&gt; 50965: MID26697685 521201</span></code></pre></div>
<p>There may be students matriculating in our programs who do not appear in the terms data. To account for these students, we apply a similar process to <code>midfieldstudents</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract students from matriculant data</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">$</span><span class="va">cip6</span> <span class="op">%in%</span> <span class="va">group_cip</span>
<span class="va">matriculants</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span></code></pre></div>
<p>Combine the data frames and remove duplicates.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># combine findings</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">matriculants</span><span class="op">)</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">enrollees</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                 id   cip6</span>
<span class="co">#&gt;     1: MID25783135 520101</span>
<span class="co">#&gt;     2: MID25783162 14XXXX</span>
<span class="co">#&gt;     3: MID25783162 520301</span>
<span class="co">#&gt;     4: MID25783162 521401</span>
<span class="co">#&gt;     5: MID25783166 14XXXX</span>
<span class="co">#&gt;     6: MID25783167 14XXXX</span>
<span class="co">#&gt;     7: MID25783167 140901</span>
<span class="co">#&gt;     8: MID25783178 14XXXX</span>
<span class="co">#&gt;     9: MID25783178 140701</span>
<span class="co">#&gt;    10: MID25783178 143501</span>
<span class="co">#&gt;    ---                   </span>
<span class="co">#&gt; 52543: MID26697449 521003</span>
<span class="co">#&gt; 52544: MID26697471 520201</span>
<span class="co">#&gt; 52545: MID26697484 521401</span>
<span class="co">#&gt; 52546: MID26697484 521099</span>
<span class="co">#&gt; 52547: MID26697576 520301</span>
<span class="co">#&gt; 52548: MID26697576 521401</span>
<span class="co">#&gt; 52549: MID26697599 521201</span>
<span class="co">#&gt; 52550: MID26697623 520301</span>
<span class="co">#&gt; 52551: MID26697641 521201</span>
<span class="co">#&gt; 52552: MID26697685 521201</span></code></pre></div>
<p>For some of these students, completing their program may not be feasible given the range of data available. <code><a href="../reference/subset_feasible.html">subset_feasible()</a></code> subsets the enrollees IDs, retaining those who matriculate at least six years before the last term in the data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># apply the feasible completion filter</span>
<span class="va">feasible_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_feasible.html">subset_feasible</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>

<span class="co"># subset the enrollees</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="va">feasible_ids</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">enrollees</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                 id   cip6</span>
<span class="co">#&gt;     1: MID25783135 520101</span>
<span class="co">#&gt;     2: MID25783162 14XXXX</span>
<span class="co">#&gt;     3: MID25783162 520301</span>
<span class="co">#&gt;     4: MID25783162 521401</span>
<span class="co">#&gt;     5: MID25783178 14XXXX</span>
<span class="co">#&gt;     6: MID25783178 140701</span>
<span class="co">#&gt;     7: MID25783178 143501</span>
<span class="co">#&gt;     8: MID25783195 521401</span>
<span class="co">#&gt;     9: MID25783197 14XXXX</span>
<span class="co">#&gt;    10: MID25783197 140701</span>
<span class="co">#&gt;    ---                   </span>
<span class="co">#&gt; 40981: MID26697447 141001</span>
<span class="co">#&gt; 40982: MID26697449 520201</span>
<span class="co">#&gt; 40983: MID26697449 521003</span>
<span class="co">#&gt; 40984: MID26697471 520201</span>
<span class="co">#&gt; 40985: MID26697484 521401</span>
<span class="co">#&gt; 40986: MID26697484 521099</span>
<span class="co">#&gt; 40987: MID26697576 520301</span>
<span class="co">#&gt; 40988: MID26697576 521401</span>
<span class="co">#&gt; 40989: MID26697599 521201</span>
<span class="co">#&gt; 40990: MID26697623 520301</span></code></pre></div>
<p>Related vignettes</p>
<ul>
<li>
<em>Feasible completion</em> <a href="feasible_completion.html">(link)</a> describes how completion feasibility is determined</li>
</ul>
</div>
<div id="join-the-grouping-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#join-the-grouping-variables" class="anchor"></a>Join the grouping variables</h2>
<p>In this example, the results are eventually grouped by program, race/ethnicity, and sex. Here, we join these variables to the working data frame.</p>
<p>We access <code>midfieldstudents</code> to obtain students’ race/ethnicity and sex as self-reported at matriculation.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="va">feasible_ids</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">race_sex</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">race_sex</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                 id     race    sex</span>
<span class="co">#&gt;     1: MID25783135    White   Male</span>
<span class="co">#&gt;     2: MID25783162    White   Male</span>
<span class="co">#&gt;     3: MID25783178    Black   Male</span>
<span class="co">#&gt;     4: MID25783195    White   Male</span>
<span class="co">#&gt;     5: MID25783197    White   Male</span>
<span class="co">#&gt;     6: MID25783227    White   Male</span>
<span class="co">#&gt;     7: MID25783259    White   Male</span>
<span class="co">#&gt;     8: MID25783306    White Female</span>
<span class="co">#&gt;     9: MID25783360    White   Male</span>
<span class="co">#&gt;    10: MID25783388    White   Male</span>
<span class="co">#&gt;    ---                            </span>
<span class="co">#&gt; 28675: MID26697355 Hispanic Female</span>
<span class="co">#&gt; 28676: MID26697367 Hispanic   Male</span>
<span class="co">#&gt; 28677: MID26697444    White   Male</span>
<span class="co">#&gt; 28678: MID26697447    Asian   Male</span>
<span class="co">#&gt; 28679: MID26697449    White Female</span>
<span class="co">#&gt; 28680: MID26697471    Black Female</span>
<span class="co">#&gt; 28681: MID26697484    White Female</span>
<span class="co">#&gt; 28682: MID26697576    Asian   Male</span>
<span class="co">#&gt; 28683: MID26697599    White   Male</span>
<span class="co">#&gt; 28684: MID26697623    Black Female</span></code></pre></div>
<p>Join the race/ethnicity and sex data frame to the enrollees data frame by <code>id</code>. Then join the program names from <code>program_group</code> to our working data frame by <code>cip6</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># left-join demographics to enrollees</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">race_sex</span>, by <span class="op">=</span> <span class="st">"id"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># left-join program_group to enrollees</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">program_group</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">enrollees</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;          cip6          id  race    sex     program</span>
<span class="co">#&gt;     1: 520101 MID25783135 White   Male    Business</span>
<span class="co">#&gt;     2: 14XXXX MID25783162 White   Male Engineering</span>
<span class="co">#&gt;     3: 520301 MID25783162 White   Male    Business</span>
<span class="co">#&gt;     4: 521401 MID25783162 White   Male    Business</span>
<span class="co">#&gt;     5: 140701 MID25783178 Black   Male Engineering</span>
<span class="co">#&gt;     6: 143501 MID25783178 Black   Male Engineering</span>
<span class="co">#&gt;     7: 14XXXX MID25783178 Black   Male Engineering</span>
<span class="co">#&gt;     8: 521401 MID25783195 White   Male    Business</span>
<span class="co">#&gt;     9: 140701 MID25783197 White   Male Engineering</span>
<span class="co">#&gt;    10: 140801 MID25783197 White   Male Engineering</span>
<span class="co">#&gt;    ---                                            </span>
<span class="co">#&gt; 40981: 141001 MID26697447 Asian   Male Engineering</span>
<span class="co">#&gt; 40982: 520201 MID26697449 White Female    Business</span>
<span class="co">#&gt; 40983: 521003 MID26697449 White Female    Business</span>
<span class="co">#&gt; 40984: 520201 MID26697471 Black Female    Business</span>
<span class="co">#&gt; 40985: 521099 MID26697484 White Female    Business</span>
<span class="co">#&gt; 40986: 521401 MID26697484 White Female    Business</span>
<span class="co">#&gt; 40987: 520301 MID26697576 Asian   Male    Business</span>
<span class="co">#&gt; 40988: 521401 MID26697576 Asian   Male    Business</span>
<span class="co">#&gt; 40989: 521201 MID26697599 White   Male    Business</span>
<span class="co">#&gt; 40990: 520301 MID26697623 Black Female    Business</span></code></pre></div>
<p>Here we edit one last time by deleting the CIP column and removing duplicates. In this way, students who migrate within engineering, for example, are not counted twice, but a student who transfers from engineering to business (or vice versa) is counted in both programs.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># remove the CIP codes</span>
<span class="va">enrollees</span><span class="op">[</span>, <span class="va">cip6</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span>

<span class="co"># remove duplicates</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">enrollees</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                 id     race    sex     program</span>
<span class="co">#&gt;     1: MID25783135    White   Male    Business</span>
<span class="co">#&gt;     2: MID25783162    White   Male Engineering</span>
<span class="co">#&gt;     3: MID25783162    White   Male    Business</span>
<span class="co">#&gt;     4: MID25783178    Black   Male Engineering</span>
<span class="co">#&gt;     5: MID25783195    White   Male    Business</span>
<span class="co">#&gt;     6: MID25783197    White   Male Engineering</span>
<span class="co">#&gt;     7: MID25783227    White   Male Engineering</span>
<span class="co">#&gt;     8: MID25783259    White   Male Engineering</span>
<span class="co">#&gt;     9: MID25783306    White Female    Business</span>
<span class="co">#&gt;    10: MID25783360    White   Male    Business</span>
<span class="co">#&gt;    ---                                        </span>
<span class="co">#&gt; 30153: MID26697355 Hispanic Female    Business</span>
<span class="co">#&gt; 30154: MID26697367 Hispanic   Male Engineering</span>
<span class="co">#&gt; 30155: MID26697444    White   Male Engineering</span>
<span class="co">#&gt; 30156: MID26697447    Asian   Male Engineering</span>
<span class="co">#&gt; 30157: MID26697449    White Female    Business</span>
<span class="co">#&gt; 30158: MID26697471    Black Female    Business</span>
<span class="co">#&gt; 30159: MID26697484    White Female    Business</span>
<span class="co">#&gt; 30160: MID26697576    Asian   Male    Business</span>
<span class="co">#&gt; 30161: MID26697599    White   Male    Business</span>
<span class="co">#&gt; 30162: MID26697623    Black Female    Business</span></code></pre></div>
</div>
<div id="group-and-summarize" class="section level2">
<h2 class="hasAnchor">
<a href="#group-and-summarize" class="anchor"></a>Group and summarize</h2>
<p>To frame our results in terms of program, race/ethnicity, and sex, we group by these variables and count the number of students in each grouping using syntax from the data.table package. The count is assigned to the new <code>ever</code> column.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># assign</span>
<span class="va">grouping_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>

<span class="co"># aggregate using data.table syntax</span>
<span class="va">grouped_enrollees</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>ever <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">grouping_variables</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">grouped_enrollees</span>
<span class="co">#&gt;         program            race    sex ever</span>
<span class="co">#&gt;  1: Engineering           Other   Male  165</span>
<span class="co">#&gt;  2: Engineering           White Female 2230</span>
<span class="co">#&gt;  3: Engineering           Asian   Male  734</span>
<span class="co">#&gt;  4: Engineering           White   Male 8729</span>
<span class="co">#&gt;  5: Engineering           Black Female  628</span>
<span class="co">#&gt;  6: Engineering        Hispanic Female  115</span>
<span class="co">#&gt;  7: Engineering           Asian Female  217</span>
<span class="co">#&gt;  8: Engineering Native American   Male   60</span>
<span class="co">#&gt;  9: Engineering           Black   Male  987</span>
<span class="co">#&gt; 10: Engineering        Hispanic   Male  379</span>
<span class="co">#&gt; ---                                        </span>
<span class="co">#&gt; 23:    Business           Asian Female  308</span>
<span class="co">#&gt; 24:    Business           Other Female   81</span>
<span class="co">#&gt; 25:    Business   International Female   61</span>
<span class="co">#&gt; 26:    Business        Hispanic   Male  348</span>
<span class="co">#&gt; 27:    Business         Unknown Female   50</span>
<span class="co">#&gt; 28:    Business        Hispanic Female  264</span>
<span class="co">#&gt; 29:    Business         Unknown   Male   55</span>
<span class="co">#&gt; 30:    Business   International   Male  106</span>
<span class="co">#&gt; 31:    Business Native American Female   33</span>
<span class="co">#&gt; 32:    Business Native American   Male   41</span></code></pre></div>
</div>
<div id="condition-the-data-for-display" class="section level2">
<h2 class="hasAnchor">
<a href="#condition-the-data-for-display" class="anchor"></a>Condition the data for display</h2>
<p>To prepare the results for graphing, we construct a “pre-multiway” version of the data frame. We begin by removing ambiguous levels of race/ethnicity.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># initialize the pre-multiway data frame</span>
<span class="va">pre_mw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span><span class="op">(</span><span class="va">grouped_enrollees</span><span class="op">)</span>

<span class="co"># remove ambiguous levels of race/ethnicity</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">pre_mw</span><span class="op">$</span><span class="va">race</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Unknown"</span>, <span class="st">"International"</span>, <span class="st">"Other"</span><span class="op">)</span>
<span class="va">pre_mw</span> <span class="op">&lt;-</span> <span class="va">pre_mw</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">pre_mw</span><span class="op">$</span><span class="va">race</span><span class="op">)</span>
<span class="co">#&gt; [1] "White"           "Asian"           "Black"           "Hispanic"       </span>
<span class="co">#&gt; [5] "Native American"</span></code></pre></div>
<p>To protect confidentiality, we omit observations with 10 or fewer students ever enrolled.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># protect confidentiality of small populations</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">pre_mw</span><span class="op">$</span><span class="va">ever</span> <span class="op">&gt;</span> <span class="fl">10</span>
<span class="va">pre_mw</span> <span class="op">&lt;-</span> <span class="va">pre_mw</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>

<span class="co"># order rows for viewing</span>
<span class="va">pre_mw</span> <span class="op">&lt;-</span> <span class="va">pre_mw</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span><span class="op">(</span><span class="va">program</span>, <span class="va">race</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">pre_mw</span>
<span class="co">#&gt;         program            race    sex ever</span>
<span class="co">#&gt;  1:    Business           Asian Female  308</span>
<span class="co">#&gt;  2:    Business           Asian   Male  353</span>
<span class="co">#&gt;  3:    Business           Black Female 1047</span>
<span class="co">#&gt;  4:    Business           Black   Male  854</span>
<span class="co">#&gt;  5:    Business        Hispanic Female  264</span>
<span class="co">#&gt;  6:    Business        Hispanic   Male  348</span>
<span class="co">#&gt;  7:    Business Native American Female   33</span>
<span class="co">#&gt;  8:    Business Native American   Male   41</span>
<span class="co">#&gt;  9:    Business           White Female 4977</span>
<span class="co">#&gt; 10:    Business           White   Male 6785</span>
<span class="co">#&gt; 11: Engineering           Asian Female  217</span>
<span class="co">#&gt; 12: Engineering           Asian   Male  734</span>
<span class="co">#&gt; 13: Engineering           Black Female  628</span>
<span class="co">#&gt; 14: Engineering           Black   Male  987</span>
<span class="co">#&gt; 15: Engineering        Hispanic Female  115</span>
<span class="co">#&gt; 16: Engineering        Hispanic   Male  379</span>
<span class="co">#&gt; 17: Engineering Native American Female   16</span>
<span class="co">#&gt; 18: Engineering Native American   Male   60</span>
<span class="co">#&gt; 19: Engineering           White Female 2230</span>
<span class="co">#&gt; 20: Engineering           White   Male 8729</span></code></pre></div>
<p>In intersectional studies, we have found combined race/ethnicity and sex to be a useful category. We unite two columns to create the <code>race_sex</code> column.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a new category</span>
<span class="va">pre_mw</span><span class="op">[</span>, <span class="va">race_sex</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">race</span>, <span class="va">sex</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">pre_mw</span>
<span class="co">#&gt;         program            race    sex ever               race_sex</span>
<span class="co">#&gt;  1:    Business           Asian Female  308           Asian Female</span>
<span class="co">#&gt;  2:    Business           Asian   Male  353             Asian Male</span>
<span class="co">#&gt;  3:    Business           Black Female 1047           Black Female</span>
<span class="co">#&gt;  4:    Business           Black   Male  854             Black Male</span>
<span class="co">#&gt;  5:    Business        Hispanic Female  264        Hispanic Female</span>
<span class="co">#&gt;  6:    Business        Hispanic   Male  348          Hispanic Male</span>
<span class="co">#&gt;  7:    Business Native American Female   33 Native American Female</span>
<span class="co">#&gt;  8:    Business Native American   Male   41   Native American Male</span>
<span class="co">#&gt;  9:    Business           White Female 4977           White Female</span>
<span class="co">#&gt; 10:    Business           White   Male 6785             White Male</span>
<span class="co">#&gt; 11: Engineering           Asian Female  217           Asian Female</span>
<span class="co">#&gt; 12: Engineering           Asian   Male  734             Asian Male</span>
<span class="co">#&gt; 13: Engineering           Black Female  628           Black Female</span>
<span class="co">#&gt; 14: Engineering           Black   Male  987             Black Male</span>
<span class="co">#&gt; 15: Engineering        Hispanic Female  115        Hispanic Female</span>
<span class="co">#&gt; 16: Engineering        Hispanic   Male  379          Hispanic Male</span>
<span class="co">#&gt; 17: Engineering Native American Female   16 Native American Female</span>
<span class="co">#&gt; 18: Engineering Native American   Male   60   Native American Male</span>
<span class="co">#&gt; 19: Engineering           White Female 2230           White Female</span>
<span class="co">#&gt; 20: Engineering           White   Male 8729             White Male</span></code></pre></div>
<p><em>Multiway data</em> are characterized by two categorical variables and one quantitative variable <span class="citation">(<a href="#ref-Cleveland:1993" role="doc-biblioref">Cleveland, 1993</a>)</span>. In this example, the two categories are program and race/ethnicity/sex and the quantitative variable is the number of students ever enrolled.</p>
<p>To structure the data in multiway form, we select the three multiway variables.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># select the three multiway variables</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"race_sex"</span>, <span class="st">"ever"</span><span class="op">)</span>
<span class="va">pre_mw</span> <span class="op">&lt;-</span> <span class="va">pre_mw</span><span class="op">[</span>, <span class="va">..cols_we_want</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">pre_mw</span>
<span class="co">#&gt;         program               race_sex ever</span>
<span class="co">#&gt;  1:    Business           Asian Female  308</span>
<span class="co">#&gt;  2:    Business             Asian Male  353</span>
<span class="co">#&gt;  3:    Business           Black Female 1047</span>
<span class="co">#&gt;  4:    Business             Black Male  854</span>
<span class="co">#&gt;  5:    Business        Hispanic Female  264</span>
<span class="co">#&gt;  6:    Business          Hispanic Male  348</span>
<span class="co">#&gt;  7:    Business Native American Female   33</span>
<span class="co">#&gt;  8:    Business   Native American Male   41</span>
<span class="co">#&gt;  9:    Business           White Female 4977</span>
<span class="co">#&gt; 10:    Business             White Male 6785</span>
<span class="co">#&gt; 11: Engineering           Asian Female  217</span>
<span class="co">#&gt; 12: Engineering             Asian Male  734</span>
<span class="co">#&gt; 13: Engineering           Black Female  628</span>
<span class="co">#&gt; 14: Engineering             Black Male  987</span>
<span class="co">#&gt; 15: Engineering        Hispanic Female  115</span>
<span class="co">#&gt; 16: Engineering          Hispanic Male  379</span>
<span class="co">#&gt; 17: Engineering Native American Female   16</span>
<span class="co">#&gt; 18: Engineering   Native American Male   60</span>
<span class="co">#&gt; 19: Engineering           White Female 2230</span>
<span class="co">#&gt; 20: Engineering             White Male 8729</span></code></pre></div>
<p>The second attribute of multiway data is that the levels of the categories are ordered by the median value of the quantitative variable. <code><a href="../reference/prepare_multiway.html">prepare_multiway()</a></code> converts the categorical variables to factors and orders the category levels.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># order the category levels</span>
<span class="va">data_mw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_multiway.html">prepare_multiway</a></span><span class="op">(</span><span class="va">pre_mw</span><span class="op">)</span></code></pre></div>
<p>The median values are attributes of the data frame. We can view them as follows. Note that <code>program</code> and <code>race_sex</code> are now factors ordered by the median enrolled numbers (recorded under the <code>scores</code> attribute).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">data_mw</span>, FUN <span class="op">=</span> <span class="va">attributes</span><span class="op">)</span>
<span class="co">#&gt; $program</span>
<span class="co">#&gt; $program$levels</span>
<span class="co">#&gt; [1] "Business"    "Engineering"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $program$class</span>
<span class="co">#&gt; [1] "factor"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $program$scores</span>
<span class="co">#&gt;    Business Engineering </span>
<span class="co">#&gt;       350.5       503.5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $race_sex</span>
<span class="co">#&gt; $race_sex$levels</span>
<span class="co">#&gt;  [1] "Native American Female" "Native American Male"   "Hispanic Female"       </span>
<span class="co">#&gt;  [4] "Asian Female"           "Hispanic Male"          "Asian Male"            </span>
<span class="co">#&gt;  [7] "Black Female"           "Black Male"             "White Female"          </span>
<span class="co">#&gt; [10] "White Male"            </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $race_sex$class</span>
<span class="co">#&gt; [1] "factor"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $race_sex$scores</span>
<span class="co">#&gt;           Asian Female             Asian Male           Black Female </span>
<span class="co">#&gt;                  262.5                  543.5                  837.5 </span>
<span class="co">#&gt;             Black Male        Hispanic Female          Hispanic Male </span>
<span class="co">#&gt;                  920.5                  189.5                  363.5 </span>
<span class="co">#&gt; Native American Female   Native American Male           White Female </span>
<span class="co">#&gt;                   24.5                   50.5                 3603.5 </span>
<span class="co">#&gt;             White Male </span>
<span class="co">#&gt;                 7757.0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ever</span>
<span class="co">#&gt; NULL</span></code></pre></div>
<p>Related vignettes</p>
<ul>
<li>
<em>Multiway graphs and tables</em> <a href="multiway_graphs.html">(link)</a> describes multiway data and graphs in detail</li>
</ul>
</div>
<div id="graph-the-results" class="section level2">
<h2 class="hasAnchor">
<a href="#graph-the-results" class="anchor"></a>Graph the results</h2>
<p>We use ggplot2 to graph the multiway data. Rows and panels, from top to bottom, are ordered by decreasing medians. We use a logarithmic scale because the numbers differ by orders of magnitude. In a log base-2 scale, every grid line represents a doubling of the previous grid line.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_mw</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ever</span>, y <span class="op">=</span> <span class="va">race_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, as.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>
    trans <span class="op">=</span> <span class="st">"log2"</span>,
    breaks <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">14</span><span class="op">)</span>,
    limits <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">14</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Number of students (log-2 scale)"</span>,
    y <span class="op">=</span> <span class="st">""</span>,
    title <span class="op">=</span> <span class="st">"Ever enrolled in the program"</span>,
    caption <span class="op">=</span> <span class="st">"Source: midfielddata"</span>
  <span class="op">)</span></code></pre></div>
<p><img src="../man/figures/vignette-get-started-fig1-1.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Cleveland:1993" class="csl-entry">
Cleveland, William S. (1993) <em><span>Visualizing Data</span></em>. Summit, NJ: <span>Hobart Press</span>.
</div>
<div id="ref-Dowle+Srinivasan:2020:data-table" class="csl-entry">
Dowle, Matt and Srinivasan, Arun (2020) <em><span class="nocase">data.table: Extension of data.frame</span></em>. R package version 1.13.0. Available at: <a href="https://CRAN.R-project.org/package=data.table">https://CRAN.R-project.org/package=data.table</a>.
</div>
</div>
</div>
<div id="appendix" class="section level2">
<h2 class="hasAnchor">
<a href="#appendix" class="anchor"></a>Appendix</h2>
<div id="complete-script" class="section level3">
<h3 class="hasAnchor">
<a href="#complete-script" class="anchor"></a>Complete script</h3>
<p>The vignette code chunks are collected below in a single, condensed script.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages used</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfieldr">midfieldr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MIDFIELDR/midfielddata">midfielddata</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://Rdatatable.gitlab.io/data.table">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="co"># gather programs</span>
<span class="va">engineering</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="st">"^14"</span>, keep_col <span class="op">=</span> <span class="st">"cip6"</span><span class="op">)</span>
<span class="va">engineering</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Engineering"</span><span class="op">]</span>
<span class="va">business</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">cip</span>, keep_text <span class="op">=</span> <span class="st">"^52"</span>, keep_col <span class="op">=</span> <span class="st">"cip6"</span><span class="op">)</span>
<span class="va">business</span> <span class="op">&lt;-</span> <span class="va">business</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Business"</span><span class="op">]</span>
<span class="va">program_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span><span class="op">(</span><span class="va">engineering</span>, <span class="va">business</span><span class="op">)</span>
<span class="va">group_cip</span> <span class="op">&lt;-</span> <span class="va">program_group</span><span class="op">$</span><span class="va">cip6</span>

<span class="co"># gather students</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"cip6"</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">$</span><span class="va">cip6</span> <span class="op">%in%</span> <span class="va">group_cip</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="va">midfieldterms</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">$</span><span class="va">cip6</span> <span class="op">%in%</span> <span class="va">group_cip</span>
<span class="va">matriculants</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">matriculants</span><span class="op">)</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">)</span>

<span class="co"># apply feasible completion</span>
<span class="va">feasible_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_feasible.html">subset_feasible</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="va">feasible_ids</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>

<span class="co"># join grouping variables</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="va">feasible_ids</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="va">race_sex</span> <span class="op">&lt;-</span> <span class="va">midfieldstudents</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">race_sex</span>, by <span class="op">=</span> <span class="st">"id"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">enrollees</span>, <span class="va">program_group</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">enrollees</span><span class="op">[</span>, <span class="va">cip6</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span>
<span class="va">enrollees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">enrollees</span><span class="op">)</span>

<span class="co"># group and summarize</span>
<span class="va">grouping_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="va">grouped_enrollees</span> <span class="op">&lt;-</span> <span class="va">enrollees</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>ever <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">grouping_variables</span><span class="op">]</span>

<span class="co"># condition the data for display</span>
<span class="va">pre_mw</span> <span class="op">&lt;-</span> <span class="va">grouped_enrollees</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">pre_mw</span><span class="op">$</span><span class="va">race</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Unknown"</span>, <span class="st">"International"</span>, <span class="st">"Other"</span><span class="op">)</span>
<span class="va">pre_mw</span> <span class="op">&lt;-</span> <span class="va">pre_mw</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">pre_mw</span><span class="op">$</span><span class="va">ever</span> <span class="op">&gt;</span> <span class="fl">10</span>
<span class="va">pre_mw</span> <span class="op">&lt;-</span> <span class="va">pre_mw</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>
<span class="va">pre_mw</span><span class="op">[</span>, <span class="va">race_sex</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">race</span>, <span class="va">sex</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">]</span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"race_sex"</span>, <span class="st">"ever"</span><span class="op">)</span>
<span class="va">pre_mw</span> <span class="op">&lt;-</span> <span class="va">pre_mw</span><span class="op">[</span>, <span class="va">..cols_we_want</span><span class="op">]</span>
<span class="va">data_mw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_multiway.html">prepare_multiway</a></span><span class="op">(</span><span class="va">pre_mw</span><span class="op">)</span>

<span class="co"># graph results</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_mw</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ever</span>, y <span class="op">=</span> <span class="va">race_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">program</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, as.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>
    trans <span class="op">=</span> <span class="st">"log2"</span>,
    breaks <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">14</span><span class="op">)</span>,
    limits <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">14</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Number of students (log-2 scale)"</span>,
    y <span class="op">=</span> <span class="st">""</span>,
    title <span class="op">=</span> <span class="st">"Ever enrolled in the program"</span>,
    caption <span class="op">=</span> <span class="st">"Source: midfielddata"</span>
  <span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Richard Layton, Russell Long, Matthew Ohland, US National Science Foundation.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
