<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="midfieldr">
<title>Groupings • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Courier_Prime-0.4.2/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Groupings">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="https://midfieldr.github.io/midfieldr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">midfieldr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9030</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/art-000-getting-started.html">Getting started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-study">Case study</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-study">
    <a class="dropdown-item" href="../articles/art-001-case-goals.html">Goals</a>
    <a class="dropdown-item" href="../articles/art-002-case-data.html">Data</a>
    <a class="dropdown-item" href="../articles/art-003-case-results.html">Results</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/art-010-planning.html">Planning</a>
    <a class="dropdown-item" href="../articles/art-020-data-sufficiency.html">Data sufficiency</a>
    <a class="dropdown-item" href="../articles/art-030-degree-seeking.html">Degree seeking</a>
    <a class="dropdown-item" href="../articles/art-040-programs.html">Programs</a>
    <a class="dropdown-item" href="../articles/art-050-blocs.html">Blocs</a>
    <a class="dropdown-item" href="../articles/art-060-fye-proxies.html">FYE proxies</a>
    <a class="dropdown-item" href="../articles/art-070-starters.html">Starters</a>
    <a class="dropdown-item" href="../articles/art-080-graduates.html">Graduates</a>
    <a class="dropdown-item" href="../articles/art-090-groupings.html">Groupings</a>
    <a class="dropdown-item" href="../articles/art-100-grad-rate.html">Graduation rate</a>
    <a class="dropdown-item" href="../articles/art-110-stickiness.html">Stickiness</a>
    <a class="dropdown-item" href="../articles/art-120-multiway.html">Multiway data and charts</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MIDFIELDR/midfieldr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Groupings</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/HEAD/vignettes/art-090-groupings.Rmd" class="external-link"><code>vignettes/art-090-groupings.Rmd</code></a></small>
      <div class="d-none name"><code>art-090-groupings.Rmd</code></div>
    </div>

    
    
<p>We add grouping variables from the MIDFIELD data tables to our blocs
in progress. We select these variables to provide the aggregating
categories we want for a particular metric. Program labels and student
demographics are two of the most common sets of grouping variables we
use.</p>
<p>This vignette in the MIDFIELD workflow.</p>
<ol style="list-style-type: decimal">
<li>Planning<br>
</li>
<li>Initial processing</li>
<li>Blocs<br>
</li>
<li>
<span style=" font-weight: bold;    color: #b35806 !important;">Groupings</span>
<ul>
<li><span style=" font-weight: bold;    color: #b35806 !important;">Program
labels</span></li>
<li><span style=" font-weight: bold;    color: #b35806 !important;">Demographics</span></li>
<li>
<span style=" font-weight: bold;    color: #b35806 !important;">Other
variables</span><br>
</li>
</ul>
</li>
<li>Metrics<br>
</li>
<li>Displays</li>
</ol>
<div class="section level2">
<h2 id="definitions">Definitions<a class="anchor" aria-label="anchor" href="#definitions"></a>
</h2>
<dl>
<dt>bloc</dt>
<dd>
<p>A grouping of student-level data dealt with as a unit, for example,
starters, students ever-enrolled, graduates, transfer students,
traditional and non-traditional students, migrators, etc.</p>
</dd>
<dt>grouping variables</dt>
<dd>
<p>Detailed information in the student-level data that further
characterize a bloc of records, typically used to create bloc subsets
for comparison, for example, program, race/ethnicity, sex, age, grade
level, grades, etc.</p>
</dd>
</dl>
</div>
<div class="section level2">
<h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>We join grouping variables to a bloc after initial processing (data
sufficiency and degree seeking) and any other subsetting criteria that
define a bloc. The two most common join operations to add grouping
variables are:</p>
<ul>
<li><p><em>Program labels</em>   using an <a href="art-030-degree-seeking.html#inner-joins">inner join</a> on
CIPs.</p></li>
<li><p><em>Demographics</em>   using a <a href="art-050-blocs.html#left-joins">left join</a> on IDs.</p></li>
</ul>
<p>Other variables too can be usefully joined for grouping operations.
We include examples from <code>student</code>, <code>term</code>, and
<code>degree</code>.</p>
<p><em>Reminder.</em>   midfielddata datasets are for practice, not
research.</p>
</div>
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p><em>Start.</em>   If you are writing your own script to follow along,
we use these packages in this article:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://midfieldr.github.io/midfieldr/">midfieldr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://midfieldr.github.io/midfielddata/" class="external-link">midfielddata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
<p><em>Load.</em>   Practice datasets. View data dictionaries via
<code><a href="https://midfieldr.github.io/midfielddata/reference/student.html" class="external-link">?student</a></code>, <code><a href="https://midfieldr.github.io/midfielddata/reference/term.html" class="external-link">?term</a></code>, <code><a href="https://midfieldr.github.io/midfielddata/reference/degree.html" class="external-link">?degree</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load practice data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">student</span>, <span class="va">term</span>, <span class="va">degree</span><span class="op">)</span></span></code></pre></div>
<p><em>Loads with midfieldr.</em>   Prepared data. View data
dictionaries via <code><a href="../reference/study_programs.html">?study_programs</a></code>,
<code><a href="../reference/baseline_mcid.html">?baseline_mcid</a></code>.</p>
<ul>
<li><p><code>study_programs</code> (derived in <a href="art-040-programs.html#assigning-program-names">Programs</a>).</p></li>
<li><p><code>baseline_mcid</code> (derived in <a href="art-050-blocs.html#initial-processing">Blocs</a>).</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="initial-processing">Initial processing<a class="anchor" aria-label="anchor" href="#initial-processing"></a>
</h2>
<p><em>Select (optional).</em>   Reduce the number of columns. Code
reproduced from <a href="art-000-getting-started.html#reusable-code">Getting
started</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Optional. Copy of source files with all variables</span></span>
<span><span class="va">source_student</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">student</span><span class="op">)</span></span>
<span><span class="va">source_term</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="va">source_degree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">degree</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optional. Select variables required by midfieldr functions</span></span>
<span><span class="va">student</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">source_student</span><span class="op">)</span></span>
<span><span class="va">term</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">source_term</span><span class="op">)</span></span>
<span><span class="va">degree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_required.html">select_required</a></span><span class="op">(</span><span class="va">source_degree</span><span class="op">)</span></span></code></pre></div>
<p><em>Initialize.</em>   From <code>term</code> and
<code>student</code>, construct a data frame of student IDs filtered for
data sufficiency and degree seeking as described in <a href="art-050-blocs.html#initial-processing">Blocs</a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Working data frame</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">baseline_mcid</span><span class="op">)</span></span></code></pre></div>
<p>We join a CIP variable for examples that join by CIP.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reusable starting state with CIP</span></span>
<span><span class="va">baseline_cip</span> <span class="op">&lt;-</span> <span class="va">term</span><span class="op">[</span><span class="va">DT</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">baseline_cip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">baseline_cip</span><span class="op">)</span></span>
<span><span class="va">baseline_cip</span></span>
<span><span class="co">#&gt;                   mcid   cip6</span></span>
<span><span class="co">#&gt;      1: MCID3111142689 090401</span></span>
<span><span class="co">#&gt;      2: MCID3111142782 260101</span></span>
<span><span class="co">#&gt;      3: MCID3111142881 450601</span></span>
<span><span class="co">#&gt;     ---                      </span></span>
<span><span class="co">#&gt; 127347: MCID3112800920 240102</span></span>
<span><span class="co">#&gt; 127348: MCID3112800920 240199</span></span>
<span><span class="co">#&gt; 127349: MCID3112870009 240102</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="program-labels">Program labels<a class="anchor" aria-label="anchor" href="#program-labels"></a>
</h2>
<p>At this point in a typical workflow, we have a bloc of student-level
records in progress and a data frame of program labels (similar to
<code>study_programs</code>). Both data frames have a 6-digit CIP
variable to join by.</p>
<p>Program labels serve two main functions:</p>
<ul>
<li><p><em>Filtering variable</em>   to finalize a bloc. For example,
“starters” or “graduates” usually mean starters or graduates <em>in
specific programs</em>. Thus a bloc procedure typically concludes with a
program filter as in <a href="art-050-blocs.html#filter-by-program">Ever-enrolled</a>, <a href="art-070-starters.html#filter-by-program">Starters</a>, or <a href="art-080-graduates.html#filter-by-program">Graduates</a>.</p></li>
<li><p><em>Grouping variable</em>   for summarizing data. Having
filtered a bloc to retain records in specific programs, the program
label is retained and used with other grouping variables such as
race/ethnicity and sex when computing and comparing metrics. Because of
its role in groupings, the program label join is developed in detail in
this vignette.</p></li>
</ul>
<p><em>Rationale for the inner join.</em>   An inner join accomplishes
two tasks: adds a column of program labels to the bloc; and filters the
bloc to retain only those observations with CIPs matching the desired
programs.</p>
<p><em>Reset</em>   The CIP baseline data frame we preserved earlier is
the intake for this section.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reusable starting state</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">baseline_cip</span><span class="op">)</span></span></code></pre></div>
<p><em>Filter.</em>   An inner join adds the program label and filters
for matching CIPs.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join program labels via inner join</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">study_programs</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;         cip6 program           mcid</span></span>
<span><span class="co">#&gt;    1: 141001      EE MCID3111142965</span></span>
<span><span class="co">#&gt;    2: 141001      EE MCID3111145102</span></span>
<span><span class="co">#&gt;    3: 141001      EE MCID3111146537</span></span>
<span><span class="co">#&gt;   ---                              </span></span>
<span><span class="co">#&gt; 5655: 141901      ME MCID3112641399</span></span>
<span><span class="co">#&gt; 5656: 141901      ME MCID3112641535</span></span>
<span><span class="co">#&gt; 5657: 141901      ME MCID3112698681</span></span></code></pre></div>
<p>We can see the filtering effect by noting that the baseline data
frame had 127,349 observations while the inner join on the selected
programs returned 5657 observations. We can also verify the selected
programs, e.g.,</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Verify program labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">program</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CE"  "EE"  "ISE" "ME"</span></span>
<span></span>
<span><span class="co"># Verify program CIP codes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">cip6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "140801" "141001" "141901" "142701" "143501"</span></span></code></pre></div>
<p>Students can migrate between majors having different 6-digit CIP
codes, but those codes might be grouped under a single program label. A
common example in Engineering is the “Industrial/Systems Engineering”
label we assign to following CIP codes:</p>
<ul>
<li>142701 Systems Engineering</li>
<li>143501 Industrial Engineering</li>
<li>143601 Manufacturing Engineering</li>
<li>143701 Operations Research</li>
</ul>
<p>A student migrating among these CIPs would appear in multiple rows in
the current bloc, yet we would not consider their change of CIP a change
of major. The next step addresses this anomaly.</p>
<p><em>Select.</em>   Drop the CIP code.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare to filter</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">cip6</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;       program           mcid</span></span>
<span><span class="co">#&gt;    1:      EE MCID3111142965</span></span>
<span><span class="co">#&gt;    2:      EE MCID3111145102</span></span>
<span><span class="co">#&gt;    3:      EE MCID3111146537</span></span>
<span><span class="co">#&gt;   ---                       </span></span>
<span><span class="co">#&gt; 5655:      ME MCID3112641399</span></span>
<span><span class="co">#&gt; 5656:      ME MCID3112641535</span></span>
<span><span class="co">#&gt; 5657:      ME MCID3112698681</span></span></code></pre></div>
<p><em>Filter.</em>   Filter for unique observations.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Case study ever enrolled</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;       program           mcid</span></span>
<span><span class="co">#&gt;    1:      EE MCID3111142965</span></span>
<span><span class="co">#&gt;    2:      EE MCID3111145102</span></span>
<span><span class="co">#&gt;    3:      EE MCID3111146537</span></span>
<span><span class="co">#&gt;   ---                       </span></span>
<span><span class="co">#&gt; 5651:      ME MCID3112641399</span></span>
<span><span class="co">#&gt; 5652:      ME MCID3112641535</span></span>
<span><span class="co">#&gt; 5653:      ME MCID3112698681</span></span></code></pre></div>
<p>The difference in the number of observations indicates that this
example includes one student in ISE with two CIPs. We examine that
student’s record below.</p>
<div class="section level3">
<h3 id="closer-look">Closer look<a class="anchor" aria-label="anchor" href="#closer-look"></a>
</h3>
<p>Examining the records of selected students in detail.</p>
<p><em>Example 1.</em>   This student’s <code>term</code> record
includes CIP 142701 (Systems Engineering) and CIP 143501 (Industrial
Engineering), both of which are majors in our combined
Industrial/Systems Engineering (ISE) major, illustrating our rationale
for filtering for unique observations by ID/program pairs and not ID/CIP
pairs.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All terms, one ID</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">term</span><span class="op">[</span><span class="va">mcid</span> <span class="op">==</span> <span class="st">"MCID3111251565"</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Join case study program labels</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">study_programs</span><span class="op">[</span><span class="va">x</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Unique CIPs for this student</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;      cip6 program           mcid</span></span>
<span><span class="co">#&gt; 1: 143501     ISE MCID3111251565</span></span>
<span><span class="co">#&gt; 2: 142701     ISE MCID3111251565</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="demographics">Demographics<a class="anchor" aria-label="anchor" href="#demographics"></a>
</h2>
<p>Demographic variables (race/ethnicity and sex) are regularly
left-joined to blocs for grouping and summarizing.</p>
<p><em>Reset</em>   The data frame of baseline IDs is the intake for
this section.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reusable starting state</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">baseline_mcid</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid</span></span>
<span><span class="co">#&gt;     1: MCID3111142689</span></span>
<span><span class="co">#&gt;     2: MCID3111142782</span></span>
<span><span class="co">#&gt;     3: MCID3111142881</span></span>
<span><span class="co">#&gt;    ---               </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009</span></span></code></pre></div>
<p><em>Select.</em>   From <code>student</code>, select the join-by
variable (student ID) and the variables we want to add. By selecting
columns here, we don’t have to select columns in the join operation to
follow.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract desired columns</span></span>
<span><span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="va">student</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">race</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">cols_we_want</span></span>
<span><span class="co">#&gt;                  mcid          race    sex</span></span>
<span><span class="co">#&gt;     1: MCID3111142225         Asian   Male</span></span>
<span><span class="co">#&gt;     2: MCID3111142283         Asian Female</span></span>
<span><span class="co">#&gt;     3: MCID3111142290         Asian   Male</span></span>
<span><span class="co">#&gt;    ---                                    </span></span>
<span><span class="co">#&gt; 97553: MCID3112898894         White Female</span></span>
<span><span class="co">#&gt; 97554: MCID3112898895         White Female</span></span>
<span><span class="co">#&gt; 97555: MCID3112898940 Other/Unknown   Male</span></span></code></pre></div>
<p><em>Add variables.</em>   Left join two data frames, retaining all
variables from both.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add demographics</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">cols_we_want</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid          race    sex</span></span>
<span><span class="co">#&gt;     1: MCID3111142689        Latine Female</span></span>
<span><span class="co">#&gt;     2: MCID3111142782        Latine Female</span></span>
<span><span class="co">#&gt;     3: MCID3111142881 International   Male</span></span>
<span><span class="co">#&gt;    ---                                    </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480         White   Male</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920         White Female</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009         White   Male</span></span></code></pre></div>
<div class="section level3">
<h3 id="unknown-race-or-sex">Unknown <code>race</code> or <code>sex</code><a class="anchor" aria-label="anchor" href="#unknown-race-or-sex"></a>
</h3>
<p>We often want to remove records for which race/ethnicity or sex are
“unknown”.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">race</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Latine"          "International"   "White"           "Asian"          </span></span>
<span><span class="co">#&gt; [5] "Black"           "Native American" "Other/Unknown"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Female"  "Male"    "Unknown"</span></span></code></pre></div>
<p><em>Filter.</em>   In data.table syntax, we can use
<code>x %ilike% pattern</code> as a case-insensitive wrapper around
<code><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl()</a></code> to find matches and partial matches.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove records with unknown sex, if any</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">!</span><span class="va">sex</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"unknown"</span><span class="op">]</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;                  mcid          race    sex</span></span>
<span><span class="co">#&gt;     1: MCID3111142689        Latine Female</span></span>
<span><span class="co">#&gt;     2: MCID3111142782        Latine Female</span></span>
<span><span class="co">#&gt;     3: MCID3111142881 International   Male</span></span>
<span><span class="co">#&gt;    ---                                    </span></span>
<span><span class="co">#&gt; 76872: MCID3112785480         White   Male</span></span>
<span><span class="co">#&gt; 76873: MCID3112800920         White Female</span></span>
<span><span class="co">#&gt; 76874: MCID3112870009         White   Male</span></span></code></pre></div>
<p>Removing unknown race observations is similar.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove records with unknown sex, if any</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">!</span><span class="va">race</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"unknown"</span><span class="op">]</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;                  mcid          race    sex</span></span>
<span><span class="co">#&gt;     1: MCID3111142689        Latine Female</span></span>
<span><span class="co">#&gt;     2: MCID3111142782        Latine Female</span></span>
<span><span class="co">#&gt;     3: MCID3111142881 International   Male</span></span>
<span><span class="co">#&gt;    ---                                    </span></span>
<span><span class="co">#&gt; 73774: MCID3112785480         White   Male</span></span>
<span><span class="co">#&gt; 73775: MCID3112800920         White Female</span></span>
<span><span class="co">#&gt; 73776: MCID3112870009         White   Male</span></span></code></pre></div>
<p>Alternatively, these statements can be combined.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove unknowns in either of two columns</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">sex</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"unknown"</span> <span class="op">|</span> <span class="va">race</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"unknown"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Verify equivalence</span></span>
<span><span class="fu"><a href="../reference/same_content.html">same_content</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">DT</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>With “unknowns” removed, the <code>race</code> and <code>sex</code>
values are:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">race</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Asian"           "Black"           "International"   "Latine"         </span></span>
<span><span class="co">#&gt; [5] "Native American" "White"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Female" "Male"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-origin">Add <code>origin</code><a class="anchor" aria-label="anchor" href="#add-origin"></a>
</h3>
<p><code>origin</code> is a demographic variable we use to distinguish
“domestic” students from “international” students. The variable is a
recoding of the <code>race</code> variable.</p>
<p><em>Add a variable.</em>   Assuming that race/ethnicity “unknown”
have been removed, we use a conditional assignment to create the
“origin” variable.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Two values for origin</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="va">origin</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">race</span> <span class="op">==</span> <span class="st">"International"</span>, <span class="st">"International"</span>, <span class="st">"Domestic"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;                  mcid          race    sex        origin</span></span>
<span><span class="co">#&gt;     1: MCID3111142689        Latine Female      Domestic</span></span>
<span><span class="co">#&gt;     2: MCID3111142782        Latine Female      Domestic</span></span>
<span><span class="co">#&gt;     3: MCID3111142881 International   Male International</span></span>
<span><span class="co">#&gt;    ---                                                  </span></span>
<span><span class="co">#&gt; 73774: MCID3112785480         White   Male      Domestic</span></span>
<span><span class="co">#&gt; 73775: MCID3112800920         White Female      Domestic</span></span>
<span><span class="co">#&gt; 73776: MCID3112870009         White   Male      Domestic</span></span></code></pre></div>
<p>With “unknowns” removed, the <code>origin</code> values are:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">origin</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Domestic"      "International"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-people">Add <code>people</code><a class="anchor" aria-label="anchor" href="#add-people"></a>
</h3>
<p><code>people</code> is a demographic variable we use in many of our
summaries. The variable combines the <code>race</code> and
<code>sex</code> variables.</p>
<p><em>Add a variable.</em>   We combine race/ethnicity and sex to
create a grouping variable.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="va">people</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">race</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">x</span></span></code></pre></div>
<p>With “unknowns” removed, the <code>people</code> values are:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">people</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Asian Female"           "Asian Male"             "Black Female"          </span></span>
<span><span class="co">#&gt;  [4] "Black Male"             "International Female"   "International Male"    </span></span>
<span><span class="co">#&gt;  [7] "Latine Female"          "Latine Male"            "Native American Female"</span></span>
<span><span class="co">#&gt; [10] "Native American Male"   "White Female"           "White Male"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-people-by-origin">Add <code>people</code> by <code>origin</code><a class="anchor" aria-label="anchor" href="#add-people-by-origin"></a>
</h3>
<p>Combining the two ideas above, again assuming that the observations
on unknown race/ethnicity and sex have been removed,</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Two values for origin</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="va">origin</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">race</span> <span class="op">==</span> <span class="st">"International"</span>, <span class="st">"International"</span>, <span class="st">"Domestic"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Combine with sex</span></span>
<span><span class="va">x</span><span class="op">[</span>, <span class="va">people</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Omit unnecessary variables</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">people</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;                  mcid             people</span></span>
<span><span class="co">#&gt;     1: MCID3111142689    Domestic Female</span></span>
<span><span class="co">#&gt;     2: MCID3111142782    Domestic Female</span></span>
<span><span class="co">#&gt;     3: MCID3111142881 International Male</span></span>
<span><span class="co">#&gt;    ---                                  </span></span>
<span><span class="co">#&gt; 73774: MCID3112785480      Domestic Male</span></span>
<span><span class="co">#&gt; 73775: MCID3112800920    Domestic Female</span></span>
<span><span class="co">#&gt; 73776: MCID3112870009      Domestic Male</span></span></code></pre></div>
<p>The possible <code>people</code> values are:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">people</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Domestic Female"      "Domestic Male"        "International Female"</span></span>
<span><span class="co">#&gt; [4] "International Male"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="other-variables">Other variables<a class="anchor" aria-label="anchor" href="#other-variables"></a>
</h2>
<p>Depending on one’s research question, any number of MIDFIELD
variables might be used for grouping records. In this section we
illustrate joining other variables from <code>student</code>,
<code>term</code>, and <code>degree</code> to a working data frame.</p>
<p>We use the original source files copied earlier because some
variables we want to use were removed when we applied
<code><a href="../reference/select_required.html">select_required()</a></code>.</p>
<div class="section level3">
<h3 id="from-student">From <code>student</code><a class="anchor" aria-label="anchor" href="#from-student"></a>
</h3>
<p><em>Reset</em>   Reset the working data frame.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reusable starting state</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">baseline_mcid</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid</span></span>
<span><span class="co">#&gt;     1: MCID3111142689</span></span>
<span><span class="co">#&gt;     2: MCID3111142782</span></span>
<span><span class="co">#&gt;     3: MCID3111142881</span></span>
<span><span class="co">#&gt;    ---               </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009</span></span></code></pre></div>
<p>The available variables in the source <code>student</code> data
are:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Variables in the practice data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">source_student</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "mcid"           "institution"    "transfer"       "hours_transfer"</span></span>
<span><span class="co">#&gt;  [5] "race"           "sex"            "age_desc"       "us_citizen"    </span></span>
<span><span class="co">#&gt;  [9] "home_zip"       "high_school"    "sat_math"       "sat_verbal"    </span></span>
<span><span class="co">#&gt; [13] "act_comp"</span></span></code></pre></div>
<p><em>Select.</em>   Select our variables and the key (ID).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract desired columns</span></span>
<span><span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="va">source_student</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">transfer</span>, <span class="va">hours_transfer</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p><em>Add variables.</em>   Left join to add new columns.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add desired columns</span></span>
<span><span class="va">cols_we_want</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;                  mcid            transfer hours_transfer</span></span>
<span><span class="co">#&gt;     1: MCID3111142689 First-Time Transfer             NA</span></span>
<span><span class="co">#&gt;     2: MCID3111142782 First-Time Transfer             NA</span></span>
<span><span class="co">#&gt;     3: MCID3111142881 First-Time Transfer             NA</span></span>
<span><span class="co">#&gt;    ---                                                  </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480 First-Time Transfer              1</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920 First-Time Transfer             15</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009 First-Time Transfer             80</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="from-term">From <code>term</code><a class="anchor" aria-label="anchor" href="#from-term"></a>
</h3>
<p><em>Reset</em>   Reset the working data frame.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reusable starting state</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">baseline_mcid</span><span class="op">)</span></span></code></pre></div>
<p>The available variables in the source <code>term</code> data are:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Variables in the practice data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">source_term</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "mcid"                "institution"         "term"               </span></span>
<span><span class="co">#&gt;  [4] "cip6"                "level"               "standing"           </span></span>
<span><span class="co">#&gt;  [7] "coop"                "hours_term"          "hours_term_attempt" </span></span>
<span><span class="co">#&gt; [10] "hours_cumul"         "hours_cumul_attempt" "gpa_term"           </span></span>
<span><span class="co">#&gt; [13] "gpa_cumul"</span></span></code></pre></div>
<p><em>Select.</em>   Select our variables and the key (ID).</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract desired columns</span></span>
<span><span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="va">source_term</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">term</span>, <span class="va">hours_term</span>, <span class="va">gpa_term</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p><em>Add variables.</em>   Left join to add new columns.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add desired columns</span></span>
<span><span class="va">cols_we_want</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   mcid  term hours_term gpa_term</span></span>
<span><span class="co">#&gt;      1: MCID3111142689 19883          9     3.33</span></span>
<span><span class="co">#&gt;      2: MCID3111142782 19883         16     2.80</span></span>
<span><span class="co">#&gt;      3: MCID3111142782 19885          4     3.00</span></span>
<span><span class="co">#&gt;     ---                                         </span></span>
<span><span class="co">#&gt; 531417: MCID3112870009 19953         12     3.57</span></span>
<span><span class="co">#&gt; 531418: MCID3112870009 19954          1     4.00</span></span>
<span><span class="co">#&gt; 531419: MCID3112870009 19983          7     4.00</span></span></code></pre></div>
<p><em>Rows in X with multiple matches in Y.</em>   Consistent with the
left join matching rules, students in enrolled in multiple terms will
have multiple rows in the joined data frame. Thus this result has
531,419 observations of 76,875 unique students.</p>
</div>
<div class="section level3">
<h3 id="from-degree">From <code>degree</code><a class="anchor" aria-label="anchor" href="#from-degree"></a>
</h3>
<p><em>Reset</em>   Reset the working data frame.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reusable starting state</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">baseline_mcid</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#&gt;                  mcid</span></span>
<span><span class="co">#&gt;     1: MCID3111142689</span></span>
<span><span class="co">#&gt;     2: MCID3111142782</span></span>
<span><span class="co">#&gt;     3: MCID3111142881</span></span>
<span><span class="co">#&gt;    ---               </span></span>
<span><span class="co">#&gt; 76873: MCID3112785480</span></span>
<span><span class="co">#&gt; 76874: MCID3112800920</span></span>
<span><span class="co">#&gt; 76875: MCID3112870009</span></span></code></pre></div>
<p>The available variables in the source <code>degree</code> data
are:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Variables in the practice data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">source_degree</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "mcid"        "institution" "term_degree" "cip6"        "degree"</span></span></code></pre></div>
<p><em>Select.</em>   Select two variables and the key (ID).</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract desired columns</span></span>
<span><span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="va">source_degree</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">cip6</span>, <span class="va">degree</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p><em>Add variables.</em>   Left join to add new columns.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add desired columns</span></span>
<span><span class="va">cols_we_want</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;                  mcid   cip6                                     degree</span></span>
<span><span class="co">#&gt;     1: MCID3111142689 090401             Bachelor of Arts in Journalism</span></span>
<span><span class="co">#&gt;     2: MCID3111142782 260101 Bachelor of Science in Biological Sciences</span></span>
<span><span class="co">#&gt;     3: MCID3111142881 450601              Bachelor of Arts in Economics</span></span>
<span><span class="co">#&gt;    ---                                                                 </span></span>
<span><span class="co">#&gt; 76990: MCID3112785480   &lt;NA&gt;                                       &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 76991: MCID3112800920   &lt;NA&gt;                                       &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 76992: MCID3112870009   &lt;NA&gt;                                       &lt;NA&gt;</span></span></code></pre></div>
<p><em>Rows in X with no match in Y.</em>   Consistent with the left
join matching rules, students in <code>DT</code> who do not graduate
will have NA values in the <code>term_degree</code> and
<code>cip6</code> columns of the joined data tables. Thus this result
has 76,875 unique students of whom 43,786 earned degrees.</p>
</div>
</div>
<div class="section level2">
<h2 id="reusable-code">Reusable code<a class="anchor" aria-label="anchor" href="#reusable-code"></a>
</h2>
<p><em>Program labels preparation.</em>   The CIP baseline data frame we
preserved earlier is the intake for this section.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">baseline_cip</span><span class="op">)</span></span></code></pre></div>
<p><em>Program labels.</em>   A summary code chunk for ready reference.
In gathering a bloc of <em>starters</em>, the join-by variable might be
<code>start</code> instead of <code>cip6</code>.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter by program</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">study_programs</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span>, nomatch <span class="op">=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="va">cip6</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span></code></pre></div>
<p><em>Demographics preparation.</em>   The data frame of baseline IDs
is the intake for this section.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">baseline_mcid</span><span class="op">)</span></span></code></pre></div>
<p><em>Demographics.</em>   A summary code chunk for ready
reference.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join race/ethnicity and sex</span></span>
<span><span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="va">student</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mcid</span>, <span class="va">race</span>, <span class="va">sex</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">cols_we_want</span><span class="op">[</span><span class="va">DT</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<!-- ## References -->
<!-- <div id="refs"> -->
<style type="text/css">
blockquote {
    padding:     10px 20px;
    margin:      0 0 20px;
    border-left: 0px
}
caption {
    color:       #525252;
    text-align:  left;
    font-weight: normal;
    font-size:   medium;
    line-height: 1.5;
}
</style>
<hr>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/graphdr" class="external-link">Richard Layton</a>, Russell Long, Matthew Ohland, Marisa Orr, Susan Lord.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
