<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case selection • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Case selection">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="https://midfieldr.github.io/midfieldr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">midfieldr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9013</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/art-02-midfield-data.html">MIDFIELD practice data</a>
    </li>
    <li>
      <a href="../articles/art-03-multiway.html">Multiway graphs and tables</a>
    </li>
    <li>
      <a href="../articles/art-04-program-codes.html">Program codes</a>
    </li>
    <li>
      <a href="../articles/art-06-case-selection.html">Case selection</a>
    </li>
    <li>
      <a href="../articles/art-07-timely-completion.html">Timely completion</a>
    </li>
    <li>
      <a href="../articles/art-05-fye-programs.html">FYE programs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MIDFIELDR/midfieldr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="art-06-case-selection_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Case selection</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/master/vignettes/art-06-case-selection.Rmd" class="external-link"><code>vignettes/art-06-case-selection.Rmd</code></a></small>
      <div class="hidden name"><code>art-06-case-selection.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>Introduction</h2>
<p>In studying student records, a common first step is to select a specific set of programs to explore. In this vignette, we illustrate this first step by constructing a data frame of program CIP codes and program names for four engineering programs (Civil, Electrical, Industrial, and Mechanical).</p>
<p>We use this case selection in subsequent vignettes to illustrate typical workflows using midfieldr functions and MIDFIELD data tables.</p>
<div id="this-vignette-uses" class="section level3">
<h3 class="hasAnchor">
<a href="#this-vignette-uses" class="anchor" aria-hidden="true"></a>This vignette uses</h3>
<p>midfieldr functions</p>
<ul>
<li><code><a href="../reference/filter_by_key.html">filter_by_key()</a></code></li>
<li><code><a href="../reference/filter_text.html">filter_text()</a></code></li>
</ul>
<p>packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages used</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span>

<span class="co"># optional code to control data.table printing</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>datatable.print.nrows <span class="op">=</span> <span class="fl">6</span>, datatable.print.topn <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="identify-program-codes" class="section level2">
<h2 class="hasAnchor">
<a href="#identify-program-codes" class="anchor" aria-hidden="true"></a>Identify program codes</h2>
<p>We know the conventional names of the desired programs (Civil, Electrical, Industrial, and Mechanical Engineering) but these are not necessarily the exact program names used in the CIP. Thus we have to search CIP thoroughly to make sure we find all 6-digit CIP codes associated with these disciplines.</p>
<p>We start with a text search of <code>cip</code> for <code>engineering</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subset rows of the CIP data matching conditions</span>
<span class="va">pass01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">cip</span>, <span class="st">"engineering"</span><span class="op">)</span>
<span class="va">pass01</span>
<span class="co">#&gt;      cip2                                         cip2name cip4</span>
<span class="co">#&gt;   1:   14                                      Engineering 1401</span>
<span class="co">#&gt;   2:   14                                      Engineering 1401</span>
<span class="co">#&gt;   3:   14                                      Engineering 1402</span>
<span class="co">#&gt;  ---                                                           </span>
<span class="co">#&gt; 117:   29                            Military Technologies 2903</span>
<span class="co">#&gt; 118:   29                            Military Technologies 2903</span>
<span class="co">#&gt; 119:   51 Health Professions and Related Clinical Sciences 5123</span>
<span class="co">#&gt;                                                   cip4name   cip6</span>
<span class="co">#&gt;   1:                                  Engineering, General 140101</span>
<span class="co">#&gt;   2:                                  Engineering, General 140102</span>
<span class="co">#&gt;   3: Aerospace, Aeronautical and Astronautical Engineering 140201</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 117:                             Military Applied Sciences 290301</span>
<span class="co">#&gt; 118:                             Military Applied Sciences 290303</span>
<span class="co">#&gt; 119:            Rehabilitation and Therapeutic Professions 512312</span>
<span class="co">#&gt;                                                              cip6name</span>
<span class="co">#&gt;   1:                                             Engineering, General</span>
<span class="co">#&gt;   2:                                                  Pre-Engineering</span>
<span class="co">#&gt;   3:     Aerospace, Aeronautical and Astronautical, Space Engineering</span>
<span class="co">#&gt;  ---                                                                 </span>
<span class="co">#&gt; 117:                                       Combat Systems Engineering</span>
<span class="co">#&gt; 118:                                            Engineering Acoustics</span>
<span class="co">#&gt; 119: Assistive, Augmentative Technology and Rehabiliation Engineering</span></code></pre></div>
<p>We have a number of 2-digit codes reported. let’s examine those more closely</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip2"</span>, <span class="st">"cip2name"</span><span class="op">)</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pass01</span><span class="op">[</span>, <span class="va">..cols_we_want</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;    cip2                                         cip2name</span>
<span class="co">#&gt; 1:   14                                      Engineering</span>
<span class="co">#&gt; 2:   15                           Engineering Technology</span>
<span class="co">#&gt; 3:   29                            Military Technologies</span>
<span class="co">#&gt; 4:   51 Health Professions and Related Clinical Sciences</span></code></pre></div>
<p>Only one of these (14) will have the programs we are looking for. So we can restrict our search to codes starting with 14.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pass02</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">pass01</span>, <span class="st">"^14"</span><span class="op">)</span>
<span class="va">pass02</span>
<span class="co">#&gt;     cip2    cip2name cip4                                              cip4name</span>
<span class="co">#&gt;  1:   14 Engineering 1401                                  Engineering, General</span>
<span class="co">#&gt;  2:   14 Engineering 1401                                  Engineering, General</span>
<span class="co">#&gt;  3:   14 Engineering 1402 Aerospace, Aeronautical and Astronautical Engineering</span>
<span class="co">#&gt; ---                                                                            </span>
<span class="co">#&gt; 52:   14 Engineering 1444                                 Engineering Chemistry</span>
<span class="co">#&gt; 53:   14 Engineering 1445                    Biological, Biosystems Engineering</span>
<span class="co">#&gt; 54:   14 Engineering 1499                                    Engineering, Other</span>
<span class="co">#&gt;       cip6                                                     cip6name</span>
<span class="co">#&gt;  1: 140101                                         Engineering, General</span>
<span class="co">#&gt;  2: 140102                                              Pre-Engineering</span>
<span class="co">#&gt;  3: 140201 Aerospace, Aeronautical and Astronautical, Space Engineering</span>
<span class="co">#&gt; ---                                                                    </span>
<span class="co">#&gt; 52: 144401                                        Engineering Chemistry</span>
<span class="co">#&gt; 53: 144501                           Biological, Biosystems Engineering</span>
<span class="co">#&gt; 54: 149999                                           Engineering, Other</span></code></pre></div>
<p>Let’s try restricting our search to the four conventional terms: civil, electrical, industrial, and mechanical. The search is not case-sensitive.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># optional code to control data.table printing</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>datatable.print.nrows <span class="op">=</span> <span class="fl">13</span>, datatable.print.topn <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>

<span class="va">pass03</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">pass02</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"civil"</span>, <span class="st">"electrical"</span>, <span class="st">"industrial"</span>, <span class="st">"mechanical"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pass03</span>
<span class="co">#&gt;     cip2    cip2name cip4</span>
<span class="co">#&gt;  1:   14 Engineering 1408</span>
<span class="co">#&gt;  2:   14 Engineering 1408</span>
<span class="co">#&gt;  3:   14 Engineering 1408</span>
<span class="co">#&gt;  4:   14 Engineering 1408</span>
<span class="co">#&gt;  5:   14 Engineering 1408</span>
<span class="co">#&gt;  6:   14 Engineering 1408</span>
<span class="co">#&gt;  7:   14 Engineering 1410</span>
<span class="co">#&gt;  8:   14 Engineering 1410</span>
<span class="co">#&gt;  9:   14 Engineering 1410</span>
<span class="co">#&gt; 10:   14 Engineering 1410</span>
<span class="co">#&gt; 11:   14 Engineering 1419</span>
<span class="co">#&gt; 12:   14 Engineering 1435</span>
<span class="co">#&gt; 13:   14 Engineering 1441</span>
<span class="co">#&gt;                                                   cip4name   cip6</span>
<span class="co">#&gt;  1:                                      Civil Engineering 140801</span>
<span class="co">#&gt;  2:                                      Civil Engineering 140802</span>
<span class="co">#&gt;  3:                                      Civil Engineering 140803</span>
<span class="co">#&gt;  4:                                      Civil Engineering 140804</span>
<span class="co">#&gt;  5:                                      Civil Engineering 140805</span>
<span class="co">#&gt;  6:                                      Civil Engineering 140899</span>
<span class="co">#&gt;  7: Electrical, Electronics and Communications Engineering 141001</span>
<span class="co">#&gt;  8: Electrical, Electronics and Communications Engineering 141003</span>
<span class="co">#&gt;  9: Electrical, Electronics and Communications Engineering 141004</span>
<span class="co">#&gt; 10: Electrical, Electronics and Communications Engineering 141099</span>
<span class="co">#&gt; 11:                                 Mechanical Engineering 141901</span>
<span class="co">#&gt; 12:                                 Industrial Engineering 143501</span>
<span class="co">#&gt; 13:                          Electromechanical Engineering 144101</span>
<span class="co">#&gt;                                                          cip6name</span>
<span class="co">#&gt;  1:                                    Civil Engineering, General</span>
<span class="co">#&gt;  2:                                      Geotechnical Engineering</span>
<span class="co">#&gt;  3:                                        Structural Engineering</span>
<span class="co">#&gt;  4:                        Transportation and Highway Engineering</span>
<span class="co">#&gt;  5:                                   Water Resources Engineering</span>
<span class="co">#&gt;  6:                                      Civil Engineering, Other</span>
<span class="co">#&gt;  7:        Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  8:                                 Laser and Optical Engineering</span>
<span class="co">#&gt;  9:                                Telecommunications Engineering</span>
<span class="co">#&gt; 10: Electrical, Electronics and Communications Engineering, Other</span>
<span class="co">#&gt; 11:                                        Mechanical Engineering</span>
<span class="co">#&gt; 12:                                        Industrial Engineering</span>
<span class="co">#&gt; 13:                                 Electromechanical Engineering</span></code></pre></div>
<p>In this result, only Electromechanical Engineering is superfluous.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pass04</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">pass03</span>, drop_text <span class="op">=</span> <span class="st">"electromechanical"</span><span class="op">)</span>
<span class="va">pass04</span>
<span class="co">#&gt;     cip2    cip2name cip4</span>
<span class="co">#&gt;  1:   14 Engineering 1408</span>
<span class="co">#&gt;  2:   14 Engineering 1408</span>
<span class="co">#&gt;  3:   14 Engineering 1408</span>
<span class="co">#&gt;  4:   14 Engineering 1408</span>
<span class="co">#&gt;  5:   14 Engineering 1408</span>
<span class="co">#&gt;  6:   14 Engineering 1408</span>
<span class="co">#&gt;  7:   14 Engineering 1410</span>
<span class="co">#&gt;  8:   14 Engineering 1410</span>
<span class="co">#&gt;  9:   14 Engineering 1410</span>
<span class="co">#&gt; 10:   14 Engineering 1410</span>
<span class="co">#&gt; 11:   14 Engineering 1419</span>
<span class="co">#&gt; 12:   14 Engineering 1435</span>
<span class="co">#&gt;                                                   cip4name   cip6</span>
<span class="co">#&gt;  1:                                      Civil Engineering 140801</span>
<span class="co">#&gt;  2:                                      Civil Engineering 140802</span>
<span class="co">#&gt;  3:                                      Civil Engineering 140803</span>
<span class="co">#&gt;  4:                                      Civil Engineering 140804</span>
<span class="co">#&gt;  5:                                      Civil Engineering 140805</span>
<span class="co">#&gt;  6:                                      Civil Engineering 140899</span>
<span class="co">#&gt;  7: Electrical, Electronics and Communications Engineering 141001</span>
<span class="co">#&gt;  8: Electrical, Electronics and Communications Engineering 141003</span>
<span class="co">#&gt;  9: Electrical, Electronics and Communications Engineering 141004</span>
<span class="co">#&gt; 10: Electrical, Electronics and Communications Engineering 141099</span>
<span class="co">#&gt; 11:                                 Mechanical Engineering 141901</span>
<span class="co">#&gt; 12:                                 Industrial Engineering 143501</span>
<span class="co">#&gt;                                                          cip6name</span>
<span class="co">#&gt;  1:                                    Civil Engineering, General</span>
<span class="co">#&gt;  2:                                      Geotechnical Engineering</span>
<span class="co">#&gt;  3:                                        Structural Engineering</span>
<span class="co">#&gt;  4:                        Transportation and Highway Engineering</span>
<span class="co">#&gt;  5:                                   Water Resources Engineering</span>
<span class="co">#&gt;  6:                                      Civil Engineering, Other</span>
<span class="co">#&gt;  7:        Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  8:                                 Laser and Optical Engineering</span>
<span class="co">#&gt;  9:                                Telecommunications Engineering</span>
<span class="co">#&gt; 10: Electrical, Electronics and Communications Engineering, Other</span>
<span class="co">#&gt; 11:                                        Mechanical Engineering</span>
<span class="co">#&gt; 12:                                        Industrial Engineering</span></code></pre></div>
<p>We see that</p>
<ul>
<li>the 4-digit level describes these programs with the customary names<br>
</li>
<li>Civil Engineering encompasses six programs at the 6-digit level</li>
<li>Electrical Engineering encompasses four programs at the 6-digit level</li>
<li>Mechanical and Industrial have one program each at the 6-digit level</li>
</ul>
<p>All MIDFIELD data tables that have a column of CIP codes use 6-digit codes. Therefore, for a case study, we only need the <code>cip6</code> column from the work above. The names we want (in this case), however, are at the 4-digit level. We can take one final pass and keep only those columns we need,</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">case_study</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">pass04</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span>, <span class="st">"cip4name"</span><span class="op">)</span><span class="op">)</span>
<span class="va">case_study</span>
<span class="co">#&gt;       cip6                                               cip4name</span>
<span class="co">#&gt;  1: 140801                                      Civil Engineering</span>
<span class="co">#&gt;  2: 140802                                      Civil Engineering</span>
<span class="co">#&gt;  3: 140803                                      Civil Engineering</span>
<span class="co">#&gt;  4: 140804                                      Civil Engineering</span>
<span class="co">#&gt;  5: 140805                                      Civil Engineering</span>
<span class="co">#&gt;  6: 140899                                      Civil Engineering</span>
<span class="co">#&gt;  7: 141001 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  8: 141003 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  9: 141004 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 10: 141099 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 11: 141901                                 Mechanical Engineering</span>
<span class="co">#&gt; 12: 143501                                 Industrial Engineering</span></code></pre></div>
</div>
<div id="assign-program-names" class="section level2">
<h2 class="hasAnchor">
<a href="#assign-program-names" class="anchor" aria-hidden="true"></a>Assign program names</h2>
<p>As the study proceeds, we will want to compare and contrast the programs by name. In this case, the names in <code>cip4name</code> are suitable for this purpose except for “Electrical, Electronics and Communications Engineering” which we would prefer to replace it with the more generally used (if less specific) “Electrical Engineering”.</p>
<p>A general approach is to create a new variable <code>program</code> that has the names we want to use. We leave the <code>cip4name</code> column in place for now to be able to check the work.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">case_study</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="va">cip4name</span><span class="op">]</span>
<span class="va">case_study</span>
<span class="co">#&gt;       cip6                                               cip4name</span>
<span class="co">#&gt;  1: 140801                                      Civil Engineering</span>
<span class="co">#&gt;  2: 140802                                      Civil Engineering</span>
<span class="co">#&gt;  3: 140803                                      Civil Engineering</span>
<span class="co">#&gt;  4: 140804                                      Civil Engineering</span>
<span class="co">#&gt;  5: 140805                                      Civil Engineering</span>
<span class="co">#&gt;  6: 140899                                      Civil Engineering</span>
<span class="co">#&gt;  7: 141001 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  8: 141003 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  9: 141004 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 10: 141099 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 11: 141901                                 Mechanical Engineering</span>
<span class="co">#&gt; 12: 143501                                 Industrial Engineering</span>
<span class="co">#&gt;                                                    program</span>
<span class="co">#&gt;  1:                                      Civil Engineering</span>
<span class="co">#&gt;  2:                                      Civil Engineering</span>
<span class="co">#&gt;  3:                                      Civil Engineering</span>
<span class="co">#&gt;  4:                                      Civil Engineering</span>
<span class="co">#&gt;  5:                                      Civil Engineering</span>
<span class="co">#&gt;  6:                                      Civil Engineering</span>
<span class="co">#&gt;  7: Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  8: Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  9: Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 10: Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 11:                                 Mechanical Engineering</span>
<span class="co">#&gt; 12:                                 Industrial Engineering</span></code></pre></div>
<p>There are a number of ways to recode the values in the <code>program</code> column. We’ll show three approaches.</p>
<div id="use-program-fcase-to-edit-all-values" class="section level3">
<h3 class="hasAnchor">
<a href="#use-program-fcase-to-edit-all-values" class="anchor" aria-hidden="true"></a>1. Use <code>program := fcase()</code> to edit all values</h3>
<p>In this approach, we use the data.table <code><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase()</a></code> function to change all of the program names to abbreviations. The <code>%like%</code> function is essentially a wrapper function around the base R <code><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl()</a></code> function. The <code>%ilike%</code> variant sets <code>ignore.case = TRUE</code>. See its help page by running (the back-ticks facilitate a help search for terms starting with a symbol):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span> <span class="va">`%like%`</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">case_study</span><span class="op">)</span>
<span class="va">dframe</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span>
  <span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"civil"</span>     , <span class="st">"CVE"</span>, 
  <span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"electrical"</span>, <span class="st">"ECE"</span>, 
  <span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"mechanical"</span>, <span class="st">"MCE"</span>, 
  <span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"industrial"</span>, <span class="st">"ISE"</span>
<span class="op">)</span><span class="op">]</span>
<span class="va">dframe</span>
<span class="co">#&gt;       cip6                                               cip4name program</span>
<span class="co">#&gt;  1: 140801                                      Civil Engineering     CVE</span>
<span class="co">#&gt;  2: 140802                                      Civil Engineering     CVE</span>
<span class="co">#&gt;  3: 140803                                      Civil Engineering     CVE</span>
<span class="co">#&gt;  4: 140804                                      Civil Engineering     CVE</span>
<span class="co">#&gt;  5: 140805                                      Civil Engineering     CVE</span>
<span class="co">#&gt;  6: 140899                                      Civil Engineering     CVE</span>
<span class="co">#&gt;  7: 141001 Electrical, Electronics and Communications Engineering     ECE</span>
<span class="co">#&gt;  8: 141003 Electrical, Electronics and Communications Engineering     ECE</span>
<span class="co">#&gt;  9: 141004 Electrical, Electronics and Communications Engineering     ECE</span>
<span class="co">#&gt; 10: 141099 Electrical, Electronics and Communications Engineering     ECE</span>
<span class="co">#&gt; 11: 141901                                 Mechanical Engineering     MCE</span>
<span class="co">#&gt; 12: 143501                                 Industrial Engineering     ISE</span></code></pre></div>
</div>
<div id="use-program-like-to-edit-one-value" class="section level3">
<h3 class="hasAnchor">
<a href="#use-program-like-to-edit-one-value" class="anchor" aria-hidden="true"></a>2. Use <code>program %like%</code> to edit one value</h3>
<p>In this approach, we search for one distinctive term only.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># return matches in the cip4name column </span>
<span class="va">dframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">case_study</span><span class="op">)</span> 
<span class="va">rows_to_edit</span> <span class="op">&lt;-</span> <span class="va">dframe</span><span class="op">$</span><span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"electrical"</span>
<span class="va">dframe</span><span class="op">[</span><span class="va">rows_to_edit</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Electrical Engineering"</span><span class="op">]</span>
<span class="va">dframe</span>
<span class="co">#&gt;       cip6                                               cip4name</span>
<span class="co">#&gt;  1: 140801                                      Civil Engineering</span>
<span class="co">#&gt;  2: 140802                                      Civil Engineering</span>
<span class="co">#&gt;  3: 140803                                      Civil Engineering</span>
<span class="co">#&gt;  4: 140804                                      Civil Engineering</span>
<span class="co">#&gt;  5: 140805                                      Civil Engineering</span>
<span class="co">#&gt;  6: 140899                                      Civil Engineering</span>
<span class="co">#&gt;  7: 141001 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  8: 141003 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  9: 141004 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 10: 141099 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 11: 141901                                 Mechanical Engineering</span>
<span class="co">#&gt; 12: 143501                                 Industrial Engineering</span>
<span class="co">#&gt;                    program</span>
<span class="co">#&gt;  1:      Civil Engineering</span>
<span class="co">#&gt;  2:      Civil Engineering</span>
<span class="co">#&gt;  3:      Civil Engineering</span>
<span class="co">#&gt;  4:      Civil Engineering</span>
<span class="co">#&gt;  5:      Civil Engineering</span>
<span class="co">#&gt;  6:      Civil Engineering</span>
<span class="co">#&gt;  7: Electrical Engineering</span>
<span class="co">#&gt;  8: Electrical Engineering</span>
<span class="co">#&gt;  9: Electrical Engineering</span>
<span class="co">#&gt; 10: Electrical Engineering</span>
<span class="co">#&gt; 11: Mechanical Engineering</span>
<span class="co">#&gt; 12: Industrial Engineering</span></code></pre></div>
</div>
<div id="use-cip6-like-to-edit-one-value" class="section level3">
<h3 class="hasAnchor">
<a href="#use-cip6-like-to-edit-one-value" class="anchor" aria-hidden="true"></a>3. Use <code>cip6 %like%</code> to edit one value</h3>
<p>In our final approach, we use the <code>%like%</code> function again, but apply it to the CIP codes. Here we use the regular expression <code>^1410</code> meaning “starts with 1410.”</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># return matches that start with 1410</span>
<span class="va">rows_to_edit</span> <span class="op">&lt;-</span> <span class="va">case_study</span><span class="op">$</span><span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1410"</span>
<span class="va">case_study</span><span class="op">[</span><span class="va">rows_to_edit</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Electrical Engineering"</span><span class="op">]</span>
<span class="va">case_study</span>
<span class="co">#&gt;       cip6                                               cip4name</span>
<span class="co">#&gt;  1: 140801                                      Civil Engineering</span>
<span class="co">#&gt;  2: 140802                                      Civil Engineering</span>
<span class="co">#&gt;  3: 140803                                      Civil Engineering</span>
<span class="co">#&gt;  4: 140804                                      Civil Engineering</span>
<span class="co">#&gt;  5: 140805                                      Civil Engineering</span>
<span class="co">#&gt;  6: 140899                                      Civil Engineering</span>
<span class="co">#&gt;  7: 141001 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  8: 141003 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt;  9: 141004 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 10: 141099 Electrical, Electronics and Communications Engineering</span>
<span class="co">#&gt; 11: 141901                                 Mechanical Engineering</span>
<span class="co">#&gt; 12: 143501                                 Industrial Engineering</span>
<span class="co">#&gt;                    program</span>
<span class="co">#&gt;  1:      Civil Engineering</span>
<span class="co">#&gt;  2:      Civil Engineering</span>
<span class="co">#&gt;  3:      Civil Engineering</span>
<span class="co">#&gt;  4:      Civil Engineering</span>
<span class="co">#&gt;  5:      Civil Engineering</span>
<span class="co">#&gt;  6:      Civil Engineering</span>
<span class="co">#&gt;  7: Electrical Engineering</span>
<span class="co">#&gt;  8: Electrical Engineering</span>
<span class="co">#&gt;  9: Electrical Engineering</span>
<span class="co">#&gt; 10: Electrical Engineering</span>
<span class="co">#&gt; 11: Mechanical Engineering</span>
<span class="co">#&gt; 12: Industrial Engineering</span></code></pre></div>
<p>Which ever of these approaches you prefer, the result is the same. Reviewing the results, we see that the program names are adequate substitutes for the original <code>cip4name</code> values, which we can now drop.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">case_study</span><span class="op">[</span>, <span class="va">cip4name</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span>

<span class="va">case_study</span>
<span class="co">#&gt;       cip6                program</span>
<span class="co">#&gt;  1: 140801      Civil Engineering</span>
<span class="co">#&gt;  2: 140802      Civil Engineering</span>
<span class="co">#&gt;  3: 140803      Civil Engineering</span>
<span class="co">#&gt;  4: 140804      Civil Engineering</span>
<span class="co">#&gt;  5: 140805      Civil Engineering</span>
<span class="co">#&gt;  6: 140899      Civil Engineering</span>
<span class="co">#&gt;  7: 141001 Electrical Engineering</span>
<span class="co">#&gt;  8: 141003 Electrical Engineering</span>
<span class="co">#&gt;  9: 141004 Electrical Engineering</span>
<span class="co">#&gt; 10: 141099 Electrical Engineering</span>
<span class="co">#&gt; 11: 141901 Mechanical Engineering</span>
<span class="co">#&gt; 12: 143501 Industrial Engineering</span></code></pre></div>
</div>
</div>
<div id="save-results" class="section level2">
<h2 class="hasAnchor">
<a href="#save-results" class="anchor" aria-hidden="true"></a>Save results</h2>
<p>Having identified a set of codes and names for the programs we want to study, we should save it to use later without rerunning the code that created it.</p>
<p>Before proceeding, you might want to check or edit your directory structure. The code snippets in this section assume that you are working in an RStudio Project and that your project directory has a <code>data</code> subdirectory. In addition, a minimal project setup would include at least some of the following directories:</p>
<pre><code>project-name/
  |- data/ 
  |- data-raw/
  |- documents/
  |- figures/
  |- scripts/
  |- project-name.Rproj</code></pre>
<p>We save the <code>case_study</code> data frame as a CSV file to the <code>data</code> directory for easy access as we work through the study.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># save an intermediate result</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span><span class="va">case_study</span>, file <span class="op">=</span> <span class="st">"data/case_study.csv"</span><span class="op">)</span></code></pre></div>
<p>Let’s read it in using <code><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread()</a></code>. We use the <code>colClasses</code> argument to ensure that the <code>cip6</code> variable type is read as a character, not an integer.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read from the data directory</span>
<span class="va">case_study</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span>
  <span class="st">"data/case_study.csv"</span>,
  colClasses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>character <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>We suggest saving intermediate results like these at each significant milestone of a study, especially after steps requiring a lot of computing time.</p>
<p>For instance, the case study program codes and names we developed above are saved in the midfieldr package as the data set <code>study_programs</code>. View its help page by running</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span> <span class="va">study_programs</span></code></pre></div>
<p>View the data frame,</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study_programs</span>
<span class="co">#&gt;       cip6                program</span>
<span class="co">#&gt;  1: 140801      Civil Engineering</span>
<span class="co">#&gt;  2: 140802      Civil Engineering</span>
<span class="co">#&gt;  3: 140803      Civil Engineering</span>
<span class="co">#&gt;  4: 140804      Civil Engineering</span>
<span class="co">#&gt;  5: 140805      Civil Engineering</span>
<span class="co">#&gt;  6: 140899      Civil Engineering</span>
<span class="co">#&gt;  7: 141001 Electrical Engineering</span>
<span class="co">#&gt;  8: 141003 Electrical Engineering</span>
<span class="co">#&gt;  9: 141004 Electrical Engineering</span>
<span class="co">#&gt; 10: 141099 Electrical Engineering</span>
<span class="co">#&gt; 11: 141901 Mechanical Engineering</span>
<span class="co">#&gt; 12: 143501 Industrial Engineering</span></code></pre></div>
<p>Going forward, we’ll use <code>study_programs</code>.</p>
</div>
<div id="apply-results" class="section level2">
<h2 class="hasAnchor">
<a href="#apply-results" class="anchor" aria-hidden="true"></a>Apply results</h2>
<p>Once a set of programs is identified by their 6-digit CIP codes, the usual application is to use the codes to subset one or more of the MIDFIELD data tables (<code>student</code>, <code>course</code>, <code>term</code>, or <code>degree</code>) and merge the program names.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># optional code to control data.table printing</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>datatable.print.nrows <span class="op">=</span> <span class="fl">10</span>, datatable.print.topn <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div id="example-1--subset-by-program-code" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1--subset-by-program-code" class="anchor" aria-hidden="true"></a>Example 1. Subset by program code</h3>
<p>For example, to extract all the students in the case study who graduated, we subset rows of <code>degree</code> to keep values of <code>cip6</code> that match values of <code>cip6</code> in <code>study_programs</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subset degree rows</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">degree</span><span class="op">[</span>, <span class="va">cip6</span><span class="op">]</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="va">study_programs</span><span class="op">[</span>, <span class="va">cip6</span><span class="op">]</span>
<span class="va">case_degree</span> <span class="op">&lt;-</span> <span class="va">degree</span><span class="op">[</span><span class="va">rows_we_want</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">case_degree</span>
<span class="co">#&gt;              mcid   institution  term   cip6              degree</span>
<span class="co">#&gt;    1: MID25783178 Institution M 20001 143501 Bachelor of Science</span>
<span class="co">#&gt;    2: MID25783197 Institution M 19911 140801 Bachelor of Science</span>
<span class="co">#&gt;    3: MID25783441 Institution M 19963 140801 Bachelor of Science</span>
<span class="co">#&gt;    4: MID25783491 Institution M 20001 141001 Bachelor of Science</span>
<span class="co">#&gt;    5: MID25783912 Institution M 20001 143501 Bachelor of Science</span>
<span class="co">#&gt;   ---                                                           </span>
<span class="co">#&gt; 4672: MID26696738 Institution L 20133 141901 Bachelor of Science</span>
<span class="co">#&gt; 4673: MID26696771 Institution L 20143 141001 Bachelor of Science</span>
<span class="co">#&gt; 4674: MID26696967 Institution L 20141 141901 Bachelor of Science</span>
<span class="co">#&gt; 4675: MID26697163 Institution L 20133 141901 Bachelor of Science</span>
<span class="co">#&gt; 4676: MID26697447 Institution L 20154 141001 Bachelor of Science</span></code></pre></div>
<p>We often want to select specific rows at the same time, e.g.,</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subset degree rows and columns </span>
<span class="va">cols_we_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"institution"</span>, <span class="st">"cip6"</span><span class="op">)</span>
<span class="va">rows_we_want</span> <span class="op">&lt;-</span> <span class="va">degree</span><span class="op">[</span>, <span class="va">cip6</span><span class="op">]</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="va">study_programs</span><span class="op">[</span>, <span class="va">cip6</span><span class="op">]</span>
<span class="va">case_degree</span> <span class="op">&lt;-</span> <span class="va">degree</span><span class="op">[</span><span class="va">rows_we_want</span>, <span class="va">..cols_we_want</span><span class="op">]</span>

<span class="co"># examine the result</span>
<span class="va">case_degree</span>
<span class="co">#&gt;              mcid   institution   cip6</span>
<span class="co">#&gt;    1: MID25783178 Institution M 143501</span>
<span class="co">#&gt;    2: MID25783197 Institution M 140801</span>
<span class="co">#&gt;    3: MID25783441 Institution M 140801</span>
<span class="co">#&gt;    4: MID25783491 Institution M 141001</span>
<span class="co">#&gt;    5: MID25783912 Institution M 143501</span>
<span class="co">#&gt;   ---                                 </span>
<span class="co">#&gt; 4672: MID26696738 Institution L 141901</span>
<span class="co">#&gt; 4673: MID26696771 Institution L 141001</span>
<span class="co">#&gt; 4674: MID26696967 Institution L 141901</span>
<span class="co">#&gt; 4675: MID26697163 Institution L 141901</span>
<span class="co">#&gt; 4676: MID26697447 Institution L 141001</span></code></pre></div>
<p>This code chunk above represents a routine we encounter fairly often: subset rows of one data frame to keep values of a key variable that match values of the same key variable in a second data frame. We can use <code><a href="../reference/filter_by_key.html">filter_by_key()</a></code> to accomplish the entire task.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subset degree table</span>
<span class="va">dframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_by_key.html">filter_by_key</a></span><span class="op">(</span><span class="va">degree</span>, 
                        match_to <span class="op">=</span> <span class="va">study_programs</span>, 
                        key_col <span class="op">=</span> <span class="st">"cip6"</span>, 
                        select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"institution"</span>, <span class="st">"cip6"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># compare to the DT we obtained above after ordering rows the same way</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/all.equal.data.table.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">case_degree</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">order</a></span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span>, <span class="va">dframe</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">order</a></span><span class="op">(</span><span class="va">mcid</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="example-2--subset-by-id" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2--subset-by-id" class="anchor" aria-hidden="true"></a>Example 2. Subset by ID</h3>
<p>Another common data access task is to retrieve information from <code>student</code> by ID. Suppose we wanted to examine the transfer status at the time of admission of the students with degrees we subset above. We use <code><a href="../reference/filter_by_key.html">filter_by_key()</a></code> again to subset rows of <code>student</code> to keep values of <code>mcid</code> that match values of <code>mcid</code> in <code>case_degree</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subset student table</span>
<span class="va">case_student</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_by_key.html">filter_by_key</a></span><span class="op">(</span><span class="va">student</span>, 
                        match_to <span class="op">=</span> <span class="va">case_degree</span>, 
                        key_col <span class="op">=</span> <span class="st">"mcid"</span>, 
                        select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"transfer"</span>, <span class="st">"hours_transfer"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># examine the result</span>
<span class="va">case_student</span>
<span class="co">#&gt;              mcid              transfer hours_transfer</span>
<span class="co">#&gt;    1: MID25783178 First-Time in College             NA</span>
<span class="co">#&gt;    2: MID25783197 First-Time in College             NA</span>
<span class="co">#&gt;    3: MID25783441 First-Time in College             NA</span>
<span class="co">#&gt;    4: MID25783491 First-Time in College             NA</span>
<span class="co">#&gt;    5: MID25783912 First-Time in College             NA</span>
<span class="co">#&gt;   ---                                                 </span>
<span class="co">#&gt; 4672: MID26696738   First-Time Transfer             84</span>
<span class="co">#&gt; 4673: MID26696771 First-Time in College             NA</span>
<span class="co">#&gt; 4674: MID26696967 First-Time in College             NA</span>
<span class="co">#&gt; 4675: MID26697163 First-Time in College             NA</span>
<span class="co">#&gt; 4676: MID26697447 First-Time in College             NA</span></code></pre></div>
<p>If the next step was to compare the numbers of students by their transfer status, we use <code>.N</code> from data.table. For example,</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">case_student</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="st">"transfer"</span><span class="op">]</span>
<span class="co">#&gt;                 transfer    N</span>
<span class="co">#&gt; 1: First-Time in College 3873</span>
<span class="co">#&gt; 2:   First-Time Transfer  803</span></code></pre></div>
</div>
<div id="example-3--merge-program-names" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3--merge-program-names" class="anchor" aria-hidden="true"></a>Example 3. Merge program names</h3>
<p>Another common use of the <code>study_programs</code> data is to merge its program names with another data frame by matching <code>cip6</code> values. The program names can then be used for grouping and summarizing.</p>
<p>For example, let’s join the program names to the case degree data frame we created above. The <code>all.x = TRUE</code> argument performs the merge as a “left outer join”, retaining all rows of <code>case_degree</code> (the “left” data frame).</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># join program names </span>
<span class="va">case_degree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">case_degree</span>, <span class="va">study_programs</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># examine the result</span>
<span class="va">case_degree</span>
<span class="co">#&gt;         cip6        mcid   institution                program</span>
<span class="co">#&gt;    1: 140801 MID25783197 Institution M      Civil Engineering</span>
<span class="co">#&gt;    2: 140801 MID25783441 Institution M      Civil Engineering</span>
<span class="co">#&gt;    3: 140801 MID25784334 Institution M      Civil Engineering</span>
<span class="co">#&gt;    4: 140801 MID25784418 Institution M      Civil Engineering</span>
<span class="co">#&gt;    5: 140801 MID25784489 Institution M      Civil Engineering</span>
<span class="co">#&gt;   ---                                                        </span>
<span class="co">#&gt; 4672: 143501 MID26689274 Institution L Industrial Engineering</span>
<span class="co">#&gt; 4673: 143501 MID26692926 Institution L Industrial Engineering</span>
<span class="co">#&gt; 4674: 143501 MID26695626 Institution L Industrial Engineering</span>
<span class="co">#&gt; 4675: 143501 MID26696116 Institution L Industrial Engineering</span>
<span class="co">#&gt; 4676: 143501 MID26696429 Institution L Industrial Engineering</span></code></pre></div>
<p>If the next step was to group and summarize by program, we use <code>.N</code> again, for example,</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">case_degree</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="st">"program"</span><span class="op">]</span>
<span class="co">#&gt;                   program    N</span>
<span class="co">#&gt; 1:      Civil Engineering 1053</span>
<span class="co">#&gt; 2: Electrical Engineering 1221</span>
<span class="co">#&gt; 3: Mechanical Engineering 1646</span>
<span class="co">#&gt; 4: Industrial Engineering  756</span></code></pre></div>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor" aria-hidden="true"></a>References</h2>
<div id="refs">

</div>
</div>
<div id="appendix" class="section level2">
<h2 class="hasAnchor">
<a href="#appendix" class="anchor" aria-hidden="true"></a>Appendix</h2>
<div id="complete-script" class="section level3">
<h3 class="hasAnchor">
<a href="#complete-script" class="anchor" aria-hidden="true"></a>Complete script</h3>
<p>The vignette code chunks are collected below in a single, condensed script.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages used</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfieldr" class="external-link">"midfieldr"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/MIDFIELDR/midfielddata" class="external-link">"midfielddata"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span>

<span class="co"># identify program codes</span>
<span class="va">pass01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">cip</span>, <span class="st">"engineering"</span><span class="op">)</span>
<span class="va">pass02</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">pass01</span>, <span class="st">"^14"</span><span class="op">)</span>
<span class="va">pass03</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">pass02</span>, 
                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"civil"</span>, <span class="st">"electrical"</span>, <span class="st">"industrial"</span>, <span class="st">"mechanical"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pass04</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">pass03</span>, drop_text <span class="op">=</span> <span class="st">"electromechanical"</span><span class="op">)</span>
<span class="va">case_study</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_text.html">filter_text</a></span><span class="op">(</span><span class="va">pass04</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cip6"</span>, <span class="st">"cip4name"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># assign program names</span>
<span class="va">case_study</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="va">cip4name</span><span class="op">]</span>
<span class="va">dframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">case_study</span><span class="op">)</span>
<span class="va">dframe</span><span class="op">[</span>, <span class="va">program</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span>
  <span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"civil"</span>     , <span class="st">"CVE"</span>, 
  <span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"electrical"</span>, <span class="st">"ECE"</span>, 
  <span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"mechanical"</span>, <span class="st">"MCE"</span>, 
  <span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"industrial"</span>, <span class="st">"ISE"</span>
<span class="op">)</span><span class="op">]</span>
<span class="va">dframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">case_study</span><span class="op">)</span> 
<span class="va">rows_to_edit</span> <span class="op">&lt;-</span> <span class="va">dframe</span><span class="op">$</span><span class="va">program</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%ilike%</a></span> <span class="st">"electrical"</span>
<span class="va">dframe</span><span class="op">[</span><span class="va">rows_to_edit</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Electrical Engineering"</span><span class="op">]</span>
<span class="va">rows_to_edit</span> <span class="op">&lt;-</span> <span class="va">case_study</span><span class="op">$</span><span class="va">cip6</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">"^1410"</span>
<span class="va">case_study</span><span class="op">[</span><span class="va">rows_to_edit</span>, <span class="va">program</span> <span class="op">:=</span> <span class="st">"Electrical Engineering"</span><span class="op">]</span>
<span class="va">case_study</span><span class="op">[</span>, <span class="va">cip4name</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span>

<span class="co"># apply results</span>
<span class="va">case_degree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_by_key.html">filter_by_key</a></span><span class="op">(</span><span class="va">degree</span>, 
                        match_to <span class="op">=</span> <span class="va">study_programs</span>, 
                        key_col <span class="op">=</span> <span class="st">"cip6"</span>, 
                        select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"institution"</span>, <span class="st">"cip6"</span><span class="op">)</span><span class="op">)</span>
<span class="va">case_student</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_by_key.html">filter_by_key</a></span><span class="op">(</span><span class="va">student</span>, 
                        match_to <span class="op">=</span> <span class="va">case_degree</span>, 
                        key_col <span class="op">=</span> <span class="st">"mcid"</span>, 
                        select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"transfer"</span>, <span class="st">"hours_transfer"</span><span class="op">)</span><span class="op">)</span>
<span class="va">case_student</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="st">"transfer"</span><span class="op">]</span>
<span class="va">case_degree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">case_degree</span>, <span class="va">study_programs</span>, by <span class="op">=</span> <span class="st">"cip6"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">case_degree</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="st">"program"</span><span class="op">]</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Richard Layton, Russell Long, Matthew Ohland, Marisa Orr, US National Science Foundation.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
