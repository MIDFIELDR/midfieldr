<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Impute FYE starting programs • midfieldr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Impute FYE starting programs">
<meta property="og:description" content="midfieldr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">midfieldr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/explore_multiway.html">Explore multiway data</a>
    </li>
    <li>
      <a href="../articles/explore_cip.html">Explore program CIP codes</a>
    </li>
    <li>
      <a href="../articles/get_programs.html">Gather programs</a>
    </li>
    <li>
      <a href="../articles/compute_stickiness.html">Compute stickiness</a>
    </li>
    <li>
      <a href="../articles/feasible_completion.html">Filter for program completion feasibility</a>
    </li>
    <li>
      <a href="../articles/compute_grad_rate.html">Compute graduation rate</a>
    </li>
    <li>
      <a href="../articles/impute_fye.html">Impute FYE starting majors</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Papers/Talks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pages/talks.html">Talks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/pages/get_session.html">Session info</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/pages/about_midfield.html">About</a>
</li>
<li>
  <a href="https://github.com/MIDFIELDR/midfieldr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="impute_fye_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="impute_fye_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Impute FYE starting programs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MIDFIELDR/midfieldr/blob/master/vignettes/impute_fye.Rmd"><code>vignettes/impute_fye.Rmd</code></a></small>
      <div class="hidden name"><code>impute_fye.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Some US institutions have first year engineering (FYE) programs—typically a common first year curriculum that is a prerequisite for declaring an degree-granting engineering major.</p>
<p>FYE programs are problematic for some persistence metrics. The “graduation rate” metric, for example, defines successful graduation as students graduating (within 6 years) from the same program in which they matriculate. An FYE student cannot satisfy this requirement.</p>
<p>However, FYE students are neither undecided nor is their program “unknown”—their institutions have admitted them as engineering students. We know their 2-digit CIP code (“14”) but not their preferred 6-digit CIP code. Hence, midfielddata FYE codes are “14XXXX” and “14YYYY”.</p>
<p>To include an FYE student in metrics such as graduation rate, we have to predict their “starting program”: a 6-digit CIP code representing the engineering program they would have declared had they not been required to enroll in FYE. The vignette describes the prediction process and how the results are used.</p>
<div id="options-for-predicting-starting-programs" class="section level3">
<h3 class="hasAnchor">
<a href="#options-for-predicting-starting-programs" class="anchor"></a>Options for predicting starting programs</h3>
<ol style="list-style-type: decimal">
<li><p>Ready-to-use predictions in <code>fye_start</code>, a data set in midfieldr. Starting programs are predicted for every FYE student in midfielddata.</p></li>
<li><p>Perform your own prediction. Use <code><a href="../reference/fye_mi_prep.html">fye_mi_prep()</a></code> to operate on MIDFIELD data to prepare a data frame for imputation. Use the mice package (Multivariate Imputation by Chained Equations) to impute 6-digit CIP codes. The vignette describes the process that produces the <code>fye_start</code> data set.</p></li>
</ol>
</div>
<div id="this-vignette-uses" class="section level3">
<h3 class="hasAnchor">
<a href="#this-vignette-uses" class="anchor"></a>This vignette uses</h3>
<p>midfieldr functions</p>
<ul>
<li><code><a href="../reference/filter_by_id.html">filter_by_id()</a></code></li>
<li><code><a href="../reference/fye_mi_prep.html">fye_mi_prep()</a></code></li>
</ul>
<p>data.table syntax</p>
<ul>
<li>
<code><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT()</a></code> create data table</li>
<li>
<code><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames()</a></code> rename columns</li>
<li>
<code>DT[]</code> print the data frame</li>
<li>
<code>DT[order(col)]</code> arrange rows</li>
<li>
<code>DT[rows_we_want]</code> subset rows</li>
<li>
<code>DT[, .(col1, col2)]</code> select columns</li>
<li>
<code>DT[, .(new_col = .N), by = grouping_variables]</code> count N by group</li>
<li>
<code>DT[, new_col := FUN]</code> create new column as a function of old columns</li>
</ul>
<p>mice functions (optional, for performing the imputation yourself)</p>
<ul>
<li>
<code><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice()</a></code> multiple imputation</li>
<li>
<code><a href="http://stefvanbuuren.github.io/mice/reference/complete.mids.html">complete()</a></code> extract completed data from <code><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice()</a></code> output</li>
</ul>
<p>packages</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># packages used</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">midfieldr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">midfielddata</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">data.table</span>)

<span class="co"># optional</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mice</span>)

<span class="co"># print max 20 rows, otherwise 10 rows each head/tail</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">datatable.print.nrows</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">datatable.print.topn</span> <span class="kw">=</span> <span class="fl">10</span>)</pre></body></html></div>
<p><br><a href="#top">▲ top of page</a></p>
</div>
</div>
<div id="option-1-ready-to-use-starting-programs" class="section level2">
<h2 class="hasAnchor">
<a href="#option-1-ready-to-use-starting-programs" class="anchor"></a>Option 1: Ready-to-use starting programs</h2>
<p>The work described in this option is for using the ready-to-use predicted programs in <code>fye_start</code> instead of performing the computationally-expensive imputation yourself.</p>
<div id="examine-data-set-fye_start" class="section level3">
<h3 class="hasAnchor">
<a href="#examine-data-set-fye_start" class="anchor"></a>Examine data set <code>fye_start</code>
</h3>
<p>The data set <code>fye_start</code> contains predicted starting programs for all midfielddata FYE students. View its help page by running</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">? <span class="no">fye_start</span></pre></body></html></div>
<p>The data are loaded with midfieldr. The start column is the 6-digit CIP code predicted for FYE students. The prediction is the actual post-FYE engineering program for all students who continue in engineering. The prediction is an imputed value for all other FYE students.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># FYE predicted starting programs </span>
<span class="no">fye_start</span>
<span class="co">#&gt;                id  start</span>
<span class="co">#&gt;    1: MID25783162 140901</span>
<span class="co">#&gt;    2: MID25783166 141901</span>
<span class="co">#&gt;    3: MID25783167 140901</span>
<span class="co">#&gt;    4: MID25783178 140701</span>
<span class="co">#&gt;    5: MID25783197 140701</span>
<span class="co">#&gt;    6: MID25783199 140301</span>
<span class="co">#&gt;    7: MID25783227 141001</span>
<span class="co">#&gt;    8: MID25783257 140701</span>
<span class="co">#&gt;    9: MID25783275 140501</span>
<span class="co">#&gt;   10: MID25783388 141901</span>
<span class="co">#&gt;   ---                   </span>
<span class="co">#&gt; 5983: MID26648334 140801</span>
<span class="co">#&gt; 5984: MID26648354 140901</span>
<span class="co">#&gt; 5985: MID26648392 141901</span>
<span class="co">#&gt; 5986: MID26648417 140201</span>
<span class="co">#&gt; 5987: MID26648422 141901</span>
<span class="co">#&gt; 5988: MID26648435 141901</span>
<span class="co">#&gt; 5989: MID26648484 140801</span>
<span class="co">#&gt; 5990: MID26648508 140701</span>
<span class="co">#&gt; 5991: MID26648517 140801</span>
<span class="co">#&gt; 5992: MID26648544 141901</span></pre></body></html></div>
<p>To get a sense of the distribution of programs in these data, we can count the number of students in each program.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># tally N students by program CIP</span>
<span class="no">fye_start_summary</span> <span class="kw">&lt;-</span> <span class="no">fye_start</span>[, <span class="fu">.</span>(<span class="kw">N</span> <span class="kw">=</span> <span class="no">.N</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="st">"start"</span>]</pre></body></html></div>
<p>Before viewing the result, we can join the program names from <code>cip</code>. To join by the <code>cip6</code> variable, we first must rename <code>start</code> to <code>cip6</code> in our summary data frame.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># rename start to cip6 for join</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span>(<span class="no">fye_start_summary</span>, <span class="kw">old</span> <span class="kw">=</span> <span class="st">"start"</span>, <span class="kw">new</span> <span class="kw">=</span> <span class="st">"cip6"</span>)

<span class="co"># left-join program names from CIP data</span>
<span class="no">fye_start_summary</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span>(<span class="no">fye_start_summary</span>, <span class="no">cip</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"cip6"</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># order rows and select columns</span>
<span class="no">fye_start_summary</span> <span class="kw">&lt;-</span> <span class="no">fye_start_summary</span>[<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span>(-<span class="no">N</span>), <span class="fu">.</span>(<span class="no">cip6</span>, <span class="no">cip6name</span>, <span class="no">N</span>)]
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span>(<span class="no">fye_start_summary</span>, <span class="kw">old</span> <span class="kw">=</span> <span class="st">"cip6"</span>, <span class="kw">new</span> <span class="kw">=</span> <span class="st">"start"</span>)
<span class="no">fye_start_summary</span></pre></body></html></div>
<table class="table table">
<caption style="font-size: initial !important;">
Summary of starting program predictions
</caption>
<thead><tr>
<th style="text-align:left;">
start
</th>
<th style="text-align:left;">
cip6name
</th>
<th style="text-align:right;">
N
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
141901
</td>
<td style="text-align:left;">
Mechanical Engineering
</td>
<td style="text-align:right;">
1579
</td>
</tr>
<tr>
<td style="text-align:left;">
140801
</td>
<td style="text-align:left;">
Civil Engineering, General
</td>
<td style="text-align:right;">
894
</td>
</tr>
<tr>
<td style="text-align:left;">
141001
</td>
<td style="text-align:left;">
Electrical, Electronics and Communications Engineering
</td>
<td style="text-align:right;">
790
</td>
</tr>
<tr>
<td style="text-align:left;">
140901
</td>
<td style="text-align:left;">
Computer Engineering, General
</td>
<td style="text-align:right;">
611
</td>
</tr>
<tr>
<td style="text-align:left;">
143501
</td>
<td style="text-align:left;">
Industrial Engineering
</td>
<td style="text-align:right;">
565
</td>
</tr>
<tr>
<td style="text-align:left;">
140701
</td>
<td style="text-align:left;">
Chemical Engineering
</td>
<td style="text-align:right;">
486
</td>
</tr>
<tr>
<td style="text-align:left;">
140201
</td>
<td style="text-align:left;">
Aerospace, Aeronautical and Astronautical, Space Engineering
</td>
<td style="text-align:right;">
417
</td>
</tr>
<tr>
<td style="text-align:left;">
140301
</td>
<td style="text-align:left;">
Agricultural, Biological Engineering and Bioengineering
</td>
<td style="text-align:right;">
146
</td>
</tr>
<tr>
<td style="text-align:left;">
142101
</td>
<td style="text-align:left;">
Mining and Mineral Engineering
</td>
<td style="text-align:right;">
105
</td>
</tr>
<tr>
<td style="text-align:left;">
140601
</td>
<td style="text-align:left;">
Ceramic Sciences and Engineering
</td>
<td style="text-align:right;">
103
</td>
</tr>
<tr>
<td style="text-align:left;">
141101
</td>
<td style="text-align:left;">
Engineering Mechanics
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;">
140501
</td>
<td style="text-align:left;">
Biomedical, Medical Engineering
</td>
<td style="text-align:right;">
90
</td>
</tr>
<tr>
<td style="text-align:left;">
141801
</td>
<td style="text-align:left;">
Materials Engineering
</td>
<td style="text-align:right;">
85
</td>
</tr>
<tr>
<td style="text-align:left;">
142801
</td>
<td style="text-align:left;">
Textile Sciences and Engineering
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
142301
</td>
<td style="text-align:left;">
Nuclear Engineering
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
143301
</td>
<td style="text-align:left;">
Construction Engineering
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
149999
</td>
<td style="text-align:left;">
Engineering, Other
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p><br><a href="#top">▲ top of page</a></p>
</div>
<div id="how-to-use-fye_start" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-use-fye_start" class="anchor"></a>How to use <code>fye_start</code>
</h3>
<p>We use the engineering case study to illustrate using the predicted starting majors.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># IDs of students ever enrolled in the case study programs </span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">rep_ever</span>)
<span class="co">#&gt;  chr [1:10135] "MID25783178" "MID25783197" "MID25783388" "MID25783441" ...</span></pre></body></html></div>
<p>From <code>midfieldstudents</code> we obtain the matriculation programs for these students.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># matriculation CIP for representative example </span>
<span class="no">matric_programs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/filter_by_id.html">filter_by_id</a></span>(<span class="no">midfieldstudents</span>,
                                    <span class="kw">keep_id</span> <span class="kw">=</span> <span class="no">rep_ever</span>,
                                    <span class="kw">keep_col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"cip6"</span>))
<span class="co"># examine the result</span>
<span class="no">matric_programs</span>
<span class="co">#&gt;                 id   cip6</span>
<span class="co">#&gt;     1: MID25783178 14XXXX</span>
<span class="co">#&gt;     2: MID25783197 14XXXX</span>
<span class="co">#&gt;     3: MID25783388 14XXXX</span>
<span class="co">#&gt;     4: MID25783441 14XXXX</span>
<span class="co">#&gt;     5: MID25783491 14XXXX</span>
<span class="co">#&gt;     6: MID25783553 14XXXX</span>
<span class="co">#&gt;     7: MID25783606 14XXXX</span>
<span class="co">#&gt;     8: MID25783648 14XXXX</span>
<span class="co">#&gt;     9: MID25783912 14XXXX</span>
<span class="co">#&gt;    10: MID25784022 14XXXX</span>
<span class="co">#&gt;    ---                   </span>
<span class="co">#&gt; 10126: MID26696484 141901</span>
<span class="co">#&gt; 10127: MID26696642 141001</span>
<span class="co">#&gt; 10128: MID26696738 141901</span>
<span class="co">#&gt; 10129: MID26696771 140401</span>
<span class="co">#&gt; 10130: MID26696958 141901</span>
<span class="co">#&gt; 10131: MID26696967 141901</span>
<span class="co">#&gt; 10132: MID26696979 141901</span>
<span class="co">#&gt; 10133: MID26697163 140101</span>
<span class="co">#&gt; 10134: MID26697444 141901</span>
<span class="co">#&gt; 10135: MID26697447 140701</span></pre></body></html></div>
<p>Join the FYE starting programs by ID.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># left-join the predicted CIPs for FYE students</span>
<span class="no">start_programs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span>(<span class="no">matric_programs</span>,
                         <span class="no">fye_start</span>,
                         <span class="kw">by</span> <span class="kw">=</span> <span class="st">"id"</span>,
                         <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># examine the result</span>
<span class="no">start_programs</span>
<span class="co">#&gt;                 id   cip6  start</span>
<span class="co">#&gt;     1: MID25783178 14XXXX 140701</span>
<span class="co">#&gt;     2: MID25783197 14XXXX 140701</span>
<span class="co">#&gt;     3: MID25783388 14XXXX 141901</span>
<span class="co">#&gt;     4: MID25783441 14XXXX 140801</span>
<span class="co">#&gt;     5: MID25783491 14XXXX 141001</span>
<span class="co">#&gt;     6: MID25783553 14XXXX 140801</span>
<span class="co">#&gt;     7: MID25783606 14XXXX 141001</span>
<span class="co">#&gt;     8: MID25783648 14XXXX 140801</span>
<span class="co">#&gt;     9: MID25783912 14XXXX 143501</span>
<span class="co">#&gt;    10: MID25784022 14XXXX 141901</span>
<span class="co">#&gt;    ---                          </span>
<span class="co">#&gt; 10126: MID26696484 141901   &lt;NA&gt;</span>
<span class="co">#&gt; 10127: MID26696642 141001   &lt;NA&gt;</span>
<span class="co">#&gt; 10128: MID26696738 141901   &lt;NA&gt;</span>
<span class="co">#&gt; 10129: MID26696771 140401   &lt;NA&gt;</span>
<span class="co">#&gt; 10130: MID26696958 141901   &lt;NA&gt;</span>
<span class="co">#&gt; 10131: MID26696967 141901   &lt;NA&gt;</span>
<span class="co">#&gt; 10132: MID26696979 141901   &lt;NA&gt;</span>
<span class="co">#&gt; 10133: MID26697163 140101   &lt;NA&gt;</span>
<span class="co">#&gt; 10134: MID26697444 141901   &lt;NA&gt;</span>
<span class="co">#&gt; 10135: MID26697447 140701   &lt;NA&gt;</span></pre></body></html></div>
<p>For non-FYE students, the <code>start</code> value is the <code>cip6</code> value.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># non-FYE, replace NA with matriculation CIP </span>
<span class="no">rows_non_fye</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">start_programs</span>$<span class="no">start</span>)
<span class="no">start_programs</span> <span class="kw">&lt;-</span> <span class="no">start_programs</span>[<span class="no">rows_non_fye</span>, <span class="no">start</span> <span class="kw">:=</span> <span class="no">cip6</span>]</pre></body></html></div>
<p>The <code>cip6</code> column can be removed.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># remove the matriculation CIP codes</span>
<span class="no">start_programs</span>[, <span class="no">cip6</span> <span class="kw">:=</span> <span class="kw">NULL</span>]

<span class="co"># examine the result</span>
<span class="no">start_programs</span>[]
<span class="co">#&gt;                 id  start</span>
<span class="co">#&gt;     1: MID25783178 140701</span>
<span class="co">#&gt;     2: MID25783197 140701</span>
<span class="co">#&gt;     3: MID25783388 141901</span>
<span class="co">#&gt;     4: MID25783441 140801</span>
<span class="co">#&gt;     5: MID25783491 141001</span>
<span class="co">#&gt;     6: MID25783553 140801</span>
<span class="co">#&gt;     7: MID25783606 141001</span>
<span class="co">#&gt;     8: MID25783648 140801</span>
<span class="co">#&gt;     9: MID25783912 143501</span>
<span class="co">#&gt;    10: MID25784022 141901</span>
<span class="co">#&gt;    ---                   </span>
<span class="co">#&gt; 10126: MID26696484 141901</span>
<span class="co">#&gt; 10127: MID26696642 141001</span>
<span class="co">#&gt; 10128: MID26696738 141901</span>
<span class="co">#&gt; 10129: MID26696771 140401</span>
<span class="co">#&gt; 10130: MID26696958 141901</span>
<span class="co">#&gt; 10131: MID26696967 141901</span>
<span class="co">#&gt; 10132: MID26696979 141901</span>
<span class="co">#&gt; 10133: MID26697163 140101</span>
<span class="co">#&gt; 10134: MID26697444 141901</span>
<span class="co">#&gt; 10135: MID26697447 140701</span></pre></body></html></div>
<p>The starting program data derived above is the data set <code>rep_start</code> in midfieldr. View its help page by running</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">? <span class="no">rep_start</span></pre></body></html></div>
<p>To verify that these two data frames are identical,</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># verify result matches expectation</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/all.equal.data.table.html">all.equal</a></span>(<span class="no">rep_start</span>, <span class="no">start_programs</span>)
<span class="co">#&gt; [1] TRUE</span></pre></body></html></div>
<p><br><a href="#top">▲ top of page</a></p>
</div>
</div>
<div id="option-2-perform-the-multiple-imputation" class="section level2">
<h2 class="hasAnchor">
<a href="#option-2-perform-the-multiple-imputation" class="anchor"></a>Option 2: Perform the multiple imputation</h2>
<p>The work described in this option is for those who want to do their own imputation. The example illustrates how the ready-to-use starting program data <code>fye_start</code> is created.</p>
<div id="how-to-use-fye_mi_prep" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-use-fye_mi_prep" class="anchor"></a>How to use <code>fye_mi_prep()</code>
</h3>
<p>The midfieldr function <code><a href="../reference/fye_mi_prep.html">fye_mi_prep()</a></code> accesses MIDFIELD data (or equivalent) and prepares a data frame of all FYE students ready for imputation using the mice package.</p>
<p>The arguments of <code><a href="../reference/fye_mi_prep.html">fye_mi_prep()</a></code> are the student and term data sets.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># prepare data for mice()</span>
<span class="no">mi_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/fye_mi_prep.html">fye_mi_prep</a></span>(<span class="no">midfieldstudents</span>, <span class="no">midfieldterms</span>)

<span class="co"># examine the result</span>
<span class="no">mi_data</span>[]
<span class="co">#&gt;                id   institution          race    sex   cip6</span>
<span class="co">#&gt;    1: MID25783162 Institution M         White   Male   &lt;NA&gt;</span>
<span class="co">#&gt;    2: MID25783166 Institution M         White   Male   &lt;NA&gt;</span>
<span class="co">#&gt;    3: MID25783167 Institution M         White   Male 140901</span>
<span class="co">#&gt;    4: MID25783178 Institution M         Black   Male 140701</span>
<span class="co">#&gt;    5: MID25783197 Institution M         White   Male 140701</span>
<span class="co">#&gt;    6: MID25783199 Institution M         White Female 140301</span>
<span class="co">#&gt;    7: MID25783227 Institution M         White   Male   &lt;NA&gt;</span>
<span class="co">#&gt;    8: MID25783257 Institution M         White   Male 140701</span>
<span class="co">#&gt;    9: MID25783275 Institution M         White   Male 140501</span>
<span class="co">#&gt;   10: MID25783388 Institution M         White   Male 141901</span>
<span class="co">#&gt;   ---                                                      </span>
<span class="co">#&gt; 5983: MID26648334 Institution J International   Male   &lt;NA&gt;</span>
<span class="co">#&gt; 5984: MID26648354 Institution J         Asian   Male   &lt;NA&gt;</span>
<span class="co">#&gt; 5985: MID26648392 Institution J         White Female   &lt;NA&gt;</span>
<span class="co">#&gt; 5986: MID26648417 Institution J         White   Male   &lt;NA&gt;</span>
<span class="co">#&gt; 5987: MID26648422 Institution J         White   Male   &lt;NA&gt;</span>
<span class="co">#&gt; 5988: MID26648435 Institution J      Hispanic   Male   &lt;NA&gt;</span>
<span class="co">#&gt; 5989: MID26648484 Institution J      Hispanic   Male   &lt;NA&gt;</span>
<span class="co">#&gt; 5990: MID26648508 Institution J International Female   &lt;NA&gt;</span>
<span class="co">#&gt; 5991: MID26648517 Institution J      Hispanic   Male   &lt;NA&gt;</span>
<span class="co">#&gt; 5992: MID26648544 Institution J         White   Male   &lt;NA&gt;</span></pre></body></html></div>
<p>The result is a data frame with the predictor variables (institution, race, and sex) as factors. The NA values denote the CIP codes to be imputed.</p>
<p><br><a href="#top">▲ top of page</a></p>
</div>
<div id="how-fye_mi_prep-works" class="section level3">
<h3 class="hasAnchor">
<a href="#how-fye_mi_prep-works" class="anchor"></a>How <code>fye_mi_prep()</code> works</h3>
<p>The function’s first operation extracts all FYE students from <code>midfieldstudents</code>, yielding:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r">#&gt;                id   institution          race    sex
#&gt;    1: MID25783162 Institution M         White   Male
#&gt;    2: MID25783166 Institution M         White   Male
#&gt;    3: MID25783167 Institution M         White   Male
#&gt;    4: MID25783178 Institution M         Black   Male
#&gt;    5: MID25783197 Institution M         White   Male
#&gt;    6: MID25783199 Institution M         White Female
#&gt;    7: MID25783227 Institution M         White   Male
#&gt;    8: MID25783257 Institution M         White   Male
#&gt;    9: MID25783275 Institution M         White   Male
#&gt;   10: MID25783388 Institution M         White   Male
#&gt;   ---                                               
#&gt; 5983: MID26648334 Institution J International   Male
#&gt; 5984: MID26648354 Institution J         Asian   Male
#&gt; 5985: MID26648392 Institution J         White Female
#&gt; 5986: MID26648417 Institution J         White   Male
#&gt; 5987: MID26648422 Institution J         White   Male
#&gt; 5988: MID26648435 Institution J      Hispanic   Male
#&gt; 5989: MID26648484 Institution J      Hispanic   Male
#&gt; 5990: MID26648508 Institution J International Female
#&gt; 5991: MID26648517 Institution J      Hispanic   Male
#&gt; 5992: MID26648544 Institution J         White   Male</pre></body></html></div>
<p>The function’s second operation extracts all term data for these students from <code>midfieldterms</code>. The function filters for students whose first post-FYE program is in engineering, yielding:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r">#&gt;                id   cip6
#&gt;    1: MID25783167 140901
#&gt;    2: MID25783178 140701
#&gt;    3: MID25783197 140701
#&gt;    4: MID25783199 140301
#&gt;    5: MID25783257 140701
#&gt;    6: MID25783275 140501
#&gt;    7: MID25783388 141901
#&gt;    8: MID25783441 140801
#&gt;    9: MID25783491 141001
#&gt;   10: MID25783553 140801
#&gt;   ---                   
#&gt; 3359: MID26640528 141901
#&gt; 3360: MID26640591 141901
#&gt; 3361: MID26640613 142101
#&gt; 3362: MID26640916 141901
#&gt; 3363: MID26640932 141101
#&gt; 3364: MID26641121 140201
#&gt; 3365: MID26642386 140801
#&gt; 3366: MID26642809 140801
#&gt; 3367: MID26642812 141001
#&gt; 3368: MID26643920 141901</pre></body></html></div>
<p>The results from the two operations are joined, creating an NA in the <code>cip6</code> column, representing FYE students whose post-FYE programs are missing or non-engineering.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r">#&gt;                id   institution          race    sex   cip6
#&gt;    1: MID25783162 Institution M         White   Male   &lt;NA&gt;
#&gt;    2: MID25783166 Institution M         White   Male   &lt;NA&gt;
#&gt;    3: MID25783167 Institution M         White   Male 140901
#&gt;    4: MID25783178 Institution M         Black   Male 140701
#&gt;    5: MID25783197 Institution M         White   Male 140701
#&gt;    6: MID25783199 Institution M         White Female 140301
#&gt;    7: MID25783227 Institution M         White   Male   &lt;NA&gt;
#&gt;    8: MID25783257 Institution M         White   Male 140701
#&gt;    9: MID25783275 Institution M         White   Male 140501
#&gt;   10: MID25783388 Institution M         White   Male 141901
#&gt;   ---                                                      
#&gt; 5983: MID26648334 Institution J International   Male   &lt;NA&gt;
#&gt; 5984: MID26648354 Institution J         Asian   Male   &lt;NA&gt;
#&gt; 5985: MID26648392 Institution J         White Female   &lt;NA&gt;
#&gt; 5986: MID26648417 Institution J         White   Male   &lt;NA&gt;
#&gt; 5987: MID26648422 Institution J         White   Male   &lt;NA&gt;
#&gt; 5988: MID26648435 Institution J      Hispanic   Male   &lt;NA&gt;
#&gt; 5989: MID26648484 Institution J      Hispanic   Male   &lt;NA&gt;
#&gt; 5990: MID26648508 Institution J International Female   &lt;NA&gt;
#&gt; 5991: MID26648517 Institution J      Hispanic   Male   &lt;NA&gt;
#&gt; 5992: MID26648544 Institution J         White   Male   &lt;NA&gt;</pre></body></html></div>
<p>The final operation is to convert the three predictor variables—institution, race, and sex—to factors, yielding the form required for input data to <code><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice()</a></code>.</p>
<p><br><a href="#top">▲ top of page</a></p>
</div>
<div id="how-to-use-mice" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-use-mice" class="anchor"></a>How to use <code>mice()</code>
</h3>
<p>The mice package creates multiple imputations (replacement values) for missing data <span class="citation">(van Buuren and Groothuis-Oudshoorn, <a href="#ref-vanBuuren+Oudshoorn:2011" role="doc-biblioref">2011</a>)</span>. The replacement values are CIP codes to replace the NA values in the prepared data frame.</p>
<p>Our predictors (institution, race, and sex) are unordered categorical variables, so the imputation method we select is a “polytomous logistic regression” (argument <code>polyreg</code>). To read more, view the help page by running</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r">? <span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice</a></span>()</pre></body></html></div>
<p>To examine the default arguments that <code><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice()</a></code> applies to our data, we call the function with zero iterations. (A warning may appear in your console. It can be ignored.)</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co"># examine default arguments </span>
<span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice</a></span>(<span class="no">mi_data</span>, <span class="kw">maxit</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="co">#&gt; Class: mids</span>
<span class="co">#&gt; Number of multiple imputations:  5 </span>
<span class="co">#&gt; Imputation methods:</span>
<span class="co">#&gt;          id institution        race         sex        cip6 </span>
<span class="co">#&gt;          ""          ""          ""          ""   "polyreg" </span>
<span class="co">#&gt; PredictorMatrix:</span>
<span class="co">#&gt;             id institution race sex cip6</span>
<span class="co">#&gt; id           0           1    1   1    1</span>
<span class="co">#&gt; institution  0           0    1   1    1</span>
<span class="co">#&gt; race         0           1    0   1    1</span>
<span class="co">#&gt; sex          0           1    1   0    1</span>
<span class="co">#&gt; cip6         0           1    1   1    0</span>
<span class="co">#&gt; Number of logged events:  1 </span>
<span class="co">#&gt;   it im dep     meth out</span>
<span class="co">#&gt; 1  0  0     constant  id</span></pre></body></html></div>
<p>This framework is suited to our data, so no further editing of these data is needed. (If editing were required, a procedure is outlined in Appendix A.)</p>
<ul>
<li>Number of multiple imputations is 5</li>
<li>Imputation method is <code>polyreg</code>, applied to <code>cip6</code> only. This is the appropriate method for multiple, unordered, categorical predictor variables.</li>
<li>
<code>cip6</code> row of the predictor matrix correctly has a <code>1</code> in each of the three predictor columns (the other rows can be ignored)</li>
</ul>
<p>Applying <code><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice()</a></code> to our data returns an object of class <code>mids</code> (multiply imputed data set). The default <code>seed</code> argument is NULL, but by setting the seed as shown the vignette results are reproducible. Setting <code>printFlag = TRUE</code> displays progress in the console.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># impute missing CIP codes </span>
<span class="no">mi_mids</span> <span class="kw">&lt;-</span> <span class="kw pkg">mice</span><span class="kw ns">::</span><span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice</a></span>(<span class="no">mi_data</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">20180624</span>, <span class="kw">printFlag</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt;  iter imp variable</span>
<span class="co">#&gt;   1   1  cip6</span>
<span class="co">#&gt;   1   2  cip6</span>
<span class="co">#&gt;   1   3  cip6</span>
<span class="co">#&gt;   1   4  cip6</span>
<span class="co">#&gt;   1   5  cip6</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;   5   1  cip6</span>
<span class="co">#&gt;   5   2  cip6</span>
<span class="co">#&gt;   5   3  cip6</span>
<span class="co">#&gt;   5   4  cip6</span>
<span class="co">#&gt;   5   5  cip6</span></pre></body></html></div>
<p>To export the <code>mids</code> object to a data frame, we use the <code><a href="http://stefvanbuuren.github.io/mice/reference/complete.mids.html">complete()</a></code> function.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="co"># export result to data frame </span>
<span class="no">mi_start</span> <span class="kw">&lt;-</span> <span class="kw pkg">mice</span><span class="kw ns">::</span><span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/complete.mids.html">complete</a></span>(<span class="no">mi_mids</span>)

<span class="co"># convert to data.table structure</span>
<span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span>(<span class="no">mi_start</span>)

<span class="co"># examine the result</span>
<span class="no">mi_start</span>[]
<span class="co">#&gt;                id   institution          race    sex   cip6</span>
<span class="co">#&gt;    1: MID25783162 Institution M         White   Male 140901</span>
<span class="co">#&gt;    2: MID25783166 Institution M         White   Male 141901</span>
<span class="co">#&gt;    3: MID25783167 Institution M         White   Male 140901</span>
<span class="co">#&gt;    4: MID25783178 Institution M         Black   Male 140701</span>
<span class="co">#&gt;    5: MID25783197 Institution M         White   Male 140701</span>
<span class="co">#&gt;    6: MID25783199 Institution M         White Female 140301</span>
<span class="co">#&gt;    7: MID25783227 Institution M         White   Male 141001</span>
<span class="co">#&gt;    8: MID25783257 Institution M         White   Male 140701</span>
<span class="co">#&gt;    9: MID25783275 Institution M         White   Male 140501</span>
<span class="co">#&gt;   10: MID25783388 Institution M         White   Male 141901</span>
<span class="co">#&gt;   ---                                                      </span>
<span class="co">#&gt; 5983: MID26648334 Institution J International   Male 140801</span>
<span class="co">#&gt; 5984: MID26648354 Institution J         Asian   Male 140901</span>
<span class="co">#&gt; 5985: MID26648392 Institution J         White Female 141901</span>
<span class="co">#&gt; 5986: MID26648417 Institution J         White   Male 140201</span>
<span class="co">#&gt; 5987: MID26648422 Institution J         White   Male 141901</span>
<span class="co">#&gt; 5988: MID26648435 Institution J      Hispanic   Male 141901</span>
<span class="co">#&gt; 5989: MID26648484 Institution J      Hispanic   Male 140801</span>
<span class="co">#&gt; 5990: MID26648508 Institution J International Female 140701</span>
<span class="co">#&gt; 5991: MID26648517 Institution J      Hispanic   Male 140801</span>
<span class="co">#&gt; 5992: MID26648544 Institution J         White   Male 141901</span></pre></body></html></div>
<p>Some final data carpentry yields the data frame we want.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="co"># select columns </span>
<span class="no">columns_we_want</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"cip6"</span>)
<span class="no">mi_start</span> <span class="kw">&lt;-</span> <span class="no">mi_start</span>[, <span class="no">..columns_we_want</span>]

<span class="co"># ensure our columns are characters</span>
<span class="no">mi_start</span>[, <span class="no">id</span> <span class="kw">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">id</span>)]
<span class="no">mi_start</span>[, <span class="no">cip6</span> <span class="kw">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">cip6</span>)]

<span class="co"># order the rows</span>
<span class="no">mi_start</span> <span class="kw">&lt;-</span> <span class="no">mi_start</span>[<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span>(<span class="no">id</span>)]

<span class="co"># rename CIP to start</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span>(<span class="no">mi_start</span>, <span class="kw">old</span> <span class="kw">=</span> <span class="st">"cip6"</span>, <span class="kw">new</span> <span class="kw">=</span> <span class="st">"start"</span>)

<span class="co"># examine the result</span>
<span class="no">mi_start</span>[]
<span class="co">#&gt;                id  start</span>
<span class="co">#&gt;    1: MID25783162 140901</span>
<span class="co">#&gt;    2: MID25783166 141901</span>
<span class="co">#&gt;    3: MID25783167 140901</span>
<span class="co">#&gt;    4: MID25783178 140701</span>
<span class="co">#&gt;    5: MID25783197 140701</span>
<span class="co">#&gt;    6: MID25783199 140301</span>
<span class="co">#&gt;    7: MID25783227 141001</span>
<span class="co">#&gt;    8: MID25783257 140701</span>
<span class="co">#&gt;    9: MID25783275 140501</span>
<span class="co">#&gt;   10: MID25783388 141901</span>
<span class="co">#&gt;   ---                   </span>
<span class="co">#&gt; 5983: MID26648334 140801</span>
<span class="co">#&gt; 5984: MID26648354 140901</span>
<span class="co">#&gt; 5985: MID26648392 141901</span>
<span class="co">#&gt; 5986: MID26648417 140201</span>
<span class="co">#&gt; 5987: MID26648422 141901</span>
<span class="co">#&gt; 5988: MID26648435 141901</span>
<span class="co">#&gt; 5989: MID26648484 140801</span>
<span class="co">#&gt; 5990: MID26648508 140701</span>
<span class="co">#&gt; 5991: MID26648517 140801</span>
<span class="co">#&gt; 5992: MID26648544 141901</span></pre></body></html></div>
<p>This data frame is identical to the <code>fye_start</code> data described earlier. To verify that these two data frames are identical,</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="co"># verify result matches expectation</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/all.equal.data.table.html">all.equal</a></span>(<span class="no">mi_start</span>, <span class="no">fye_start</span>)
<span class="co">#&gt; [1] TRUE</span></pre></body></html></div>
<p>Lastly, because the mice package masks the base R <code><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind()</a></code> and <code><a href="http://stefvanbuuren.github.io/mice/reference/cbind.html">cbind()</a></code> functions, we use the following to unload the package once we’re done with it.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="co"># unload because mice masks rbind</span>
<span class="fu"><a href="https://rdrr.io/r/base/detach.html">detach</a></span>(<span class="st">"package:mice"</span>, <span class="kw">unload</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><br><a href="#top">▲ top of page</a></p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs">
<div id="ref-Katitas:2019">
<p>Katitas A (2019) Getting started with multiple imputation in R. <a href="https://shorturl.at/bEFMZ">https://shorturl.at/bEFMZ</a></p>
</div>
<div id="ref-vanBuuren+Oudshoorn:2011">
<p>van Buuren S and Groothuis-Oudshoorn K (2011) mice: Multivariate Imputation by Chained Equations in R. <em>Journal of Statistical Software</em> <strong>45</strong>(3), 1–67 <a href="https://www.jstatsoft.org/v45/i03/">https://www.jstatsoft.org/v45/i03/</a></p>
</div>
</div>
</div>
<div id="appendix" class="section level2">
<h2 class="hasAnchor">
<a href="#appendix" class="anchor"></a>Appendix</h2>
<div id="a--editing-the-arguments-for-mice" class="section level3">
<h3 class="hasAnchor">
<a href="#a--editing-the-arguments-for-mice" class="anchor"></a>A. Editing the arguments for <code>mice()</code>
</h3>
<p>Had the default framework not been to our liking, we reset the arguments as follows, adapted from <span class="citation">(Katitas, <a href="#ref-Katitas:2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>Obtain the <code>mi_data</code> as before, using <code><a href="../reference/fye_mi_prep.html">fye_mi_prep()</a></code>.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">mi_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/fye_mi_prep.html">fye_mi_prep</a></span>()</pre></body></html></div>
<p>Use this data as the input to <code><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice()</a></code> with zero iterations.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">mi_framework</span> <span class="kw">&lt;-</span> <span class="kw pkg">mice</span><span class="kw ns">::</span><span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice</a></span>(<span class="no">mi_data</span>, <span class="kw">maxit</span> <span class="kw">=</span> <span class="fl">0</span>)</pre></body></html></div>
<p>Extract the method and predictor matrix from the framework.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">mi_method</span> <span class="kw">&lt;-</span> <span class="no">mi_framework</span>$<span class="no">method</span>
<span class="no">mi_predictors</span> <span class="kw">&lt;-</span> <span class="no">mi_framework</span>$<span class="no">predictorMatrix</span></pre></body></html></div>
<p>Assign the <code>polyreg</code> method to <code>cip6</code> and the “empty” method (<code>""</code>) to all others.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="co"># apply an imputation method to CIP only </span>
<span class="no">mi_method</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"cip6"</span>)] <span class="kw">&lt;-</span> <span class="st">"polyreg"</span>
<span class="no">mi_method</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"institution"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span>)] <span class="kw">&lt;-</span> <span class="st">""</span></pre></body></html></div>
<p>Ensure the ID column is not a predictor by setting its column values in the predictor matrix to zero.</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">mi_predictors</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>)] <span class="kw">&lt;-</span> <span class="fl">0</span></pre></body></html></div>
<p>An imputation method is assigned to <code>cip6</code> only, so only the <code>cip6</code> row of the predictor matrix is active. The values of <code>1</code> in the row indicate that institution, sex, and race are used to impute the CIP code.</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"># predictor matrix excerpt 
#&gt;             id cip6 institution race sex
#&gt; cip6         0    0           1    1   1</pre></body></html></div>
<p>Our three main arguments <code>mi_data</code>, <code>mi_method</code>, and <code>mi_predictors</code> are ready to use.</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">mi_mids</span> <span class="kw">&lt;-</span> <span class="kw pkg">mice</span><span class="kw ns">::</span><span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">mi_data</span>,
                      <span class="kw">method</span> <span class="kw">=</span> <span class="no">mi_method</span>,
                      <span class="kw">predictorMatrix</span> <span class="kw">=</span> <span class="no">mi_predictors</span>,
                      <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">20180624</span>,
                      <span class="kw">printFlag</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>The <code>seed</code> and <code>printFlag</code> arguments are optional.</p>
<p><br><a href="#top">▲ top of page</a></p>
</div>
<div id="b--complete-script" class="section level3">
<h3 class="hasAnchor">
<a href="#b--complete-script" class="anchor"></a>B. Complete script</h3>
<p>The vignette code chunks are collected below in a single, condensed script.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="co"># packages used</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">midfieldr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">midfielddata</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">data.table</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mice</span>)

<span class="co"># Option 1: Ready-to-use starting programs</span>
<span class="co"># Summarize fye_start by program CIP</span>
<span class="no">fye_start_summary</span> <span class="kw">&lt;-</span> <span class="no">fye_start</span>[, <span class="fu">.</span>(<span class="kw">N</span> <span class="kw">=</span> <span class="no">.N</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="st">"start"</span>]
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span>(<span class="no">fye_start_summary</span>, <span class="kw">old</span> <span class="kw">=</span> <span class="st">"start"</span>, <span class="kw">new</span> <span class="kw">=</span> <span class="st">"cip6"</span>)
<span class="no">fye_start_summary</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span>(<span class="no">fye_start_summary</span>, <span class="no">cip</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"cip6"</span>, <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">fye_start_summary</span> <span class="kw">&lt;-</span> <span class="no">fye_start_summary</span>[<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span>(-<span class="no">N</span>), <span class="fu">.</span>(<span class="no">cip6</span>, <span class="no">cip6name</span>, <span class="no">N</span>)]
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span>(<span class="no">fye_start_summary</span>, <span class="kw">old</span> <span class="kw">=</span> <span class="st">"cip6"</span>, <span class="kw">new</span> <span class="kw">=</span> <span class="st">"start"</span>)

<span class="co"># How to use fye_start</span>
<span class="no">matric_programs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/filter_by_id.html">filter_by_id</a></span>(<span class="no">midfieldstudents</span>,
                                <span class="kw">keep_id</span> <span class="kw">=</span> <span class="no">rep_ever</span>,
                                <span class="kw">keep_col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"cip6"</span>))
<span class="no">start_programs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span>(<span class="no">matric_programs</span>,
                        <span class="no">fye_start</span>,
                        <span class="kw">by</span> <span class="kw">=</span> <span class="st">"id"</span>,
                        <span class="kw">all.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">rows_non_fye</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">start_programs</span>$<span class="no">start</span>)
<span class="no">start_programs</span> <span class="kw">&lt;-</span> <span class="no">start_programs</span>[<span class="no">rows_non_fye</span>, <span class="no">start</span> <span class="kw">:=</span> <span class="no">cip6</span>]
<span class="no">start_programs</span>[, <span class="no">cip6</span> <span class="kw">:=</span> <span class="kw">NULL</span>]

<span class="co"># Option 2: Perform the multiple imputation</span>
<span class="co"># How to use fye_mi_prep()</span>
<span class="no">mi_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/fye_mi_prep.html">fye_mi_prep</a></span>(<span class="no">midfieldstudents</span>, <span class="no">midfieldterms</span>)

<span class="co"># How to use mice()</span>
<span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice</a></span>(<span class="no">mi_data</span>, <span class="kw">maxit</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="no">mi_mids</span> <span class="kw">&lt;-</span> <span class="kw pkg">mice</span><span class="kw ns">::</span><span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice</a></span>(<span class="no">mi_data</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">20180624</span>, <span class="kw">printFlag</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">mi_start</span> <span class="kw">&lt;-</span> <span class="kw pkg">mice</span><span class="kw ns">::</span><span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/complete.mids.html">complete</a></span>(<span class="no">mi_mids</span>)
<span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span>(<span class="no">mi_start</span>)
<span class="no">columns_we_want</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"cip6"</span>)
<span class="no">mi_start</span> <span class="kw">&lt;-</span> <span class="no">mi_start</span>[, <span class="no">..columns_we_want</span>]
<span class="no">mi_start</span>[, <span class="no">id</span> <span class="kw">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">id</span>)]
<span class="no">mi_start</span>[, <span class="no">cip6</span> <span class="kw">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">cip6</span>)]
<span class="no">mi_start</span> <span class="kw">&lt;-</span> <span class="no">mi_start</span>[<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">order</a></span>(<span class="no">id</span>)]
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span>(<span class="no">mi_start</span>, <span class="kw">old</span> <span class="kw">=</span> <span class="st">"cip6"</span>, <span class="kw">new</span> <span class="kw">=</span> <span class="st">"start"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/detach.html">detach</a></span>(<span class="st">"package:mice"</span>, <span class="kw">unload</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># Appendix: editing the arguments for mice()</span>
<span class="no">mi_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/fye_mi_prep.html">fye_mi_prep</a></span>()
<span class="no">mi_framework</span> <span class="kw">&lt;-</span> <span class="kw pkg">mice</span><span class="kw ns">::</span><span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice</a></span>(<span class="no">mi_data</span>, <span class="kw">maxit</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="no">mi_method</span> <span class="kw">&lt;-</span> <span class="no">mi_framework</span>$<span class="no">method</span>
<span class="no">mi_predictors</span> <span class="kw">&lt;-</span> <span class="no">mi_framework</span>$<span class="no">predictorMatrix</span>
<span class="no">mi_method</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"cip6"</span>)] <span class="kw">&lt;-</span> <span class="st">"polyreg"</span>
<span class="no">mi_method</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"institution"</span>, <span class="st">"race"</span>, <span class="st">"sex"</span>)] <span class="kw">&lt;-</span> <span class="st">""</span>
<span class="no">mi_predictors</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>)] <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">mi_mids</span> <span class="kw">&lt;-</span> <span class="kw pkg">mice</span><span class="kw ns">::</span><span class="fu"><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">mi_data</span>,
                      <span class="kw">method</span> <span class="kw">=</span> <span class="no">mi_method</span>,
                      <span class="kw">predictorMatrix</span> <span class="kw">=</span> <span class="no">mi_predictors</span>,
                      <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">20180624</span>,
                      <span class="kw">printFlag</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><br><a href="#top">▲ top of page </a><br><a href="../index.html">◁ main page </a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Richard Layton, Russell Long, Matthew Ohland, US National Science Foundation.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
