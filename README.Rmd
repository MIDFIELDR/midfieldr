---
output: github_document
bibliography: inst/REFERENCES.bib
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(
  # these options tend to vary from one Rmd to another
  echo = TRUE,
  fig.path = "man/figures/README-",
  # these options tend to remain constant
  collapse = TRUE,
  comment = "#>",
  message = FALSE,
  warning = FALSE,
  fig.width = 6,
  fig.asp = 1 / 1.6,
  out.width = "70%",
  fig.align = "center",
  # http://r-pkgs.had.co.nz/vignettes.html: error = TRUE captures errors in
  # the block and shows them inline. This is useful for demonstrating what
  # happens if code throws an error. If you use error = TRUE, set
  # purl = FALSE. Vignettes are accompanied by files containing all the
  # code from the vignette. purl = FALSE prevents the code from being
  # inserted into that file
  error = TRUE,
  purl = FALSE
)
knitr::knit_hooks$set(inline = function(x) {
  if (!is.numeric(x)) {
    x
  } else if (x >= 10000) {
    prettyNum(round(x, 2), big.mark = ",")
  } else {
    prettyNum(round(x, 2))
  }
})
options(tibble.print_min = 8L, tibble.print_max = 8L)
library(dplyr) # for the pipe %>%
unpack_data <- function(x = data_bits, bit, power10 = 0, decimals = 0) {
  x <- x %>%
    dplyr::filter(name == bit) %>%
    dplyr::select(data) %>%
    unlist() %>%
    unname()
  x <- round(x / 10^power10, decimals)
}
```


# midfieldr <span class="border-wrap"><img src="man/figures/midfieldhex01.png" align="right" height="122" width="106" alt="logo.png"></span>





[![CRAN_Status_Badge](http://www.r-pkg.org/badges/version/midfieldr)](http://cran.r-project.org/package=midfieldr)
[![Build Status](https://travis-ci.org/MIDFIELDR/midfieldr.svg?branch=master)](https://travis-ci.org/MIDFIELDR/midfieldr)
[![Coverage Status](https://img.shields.io/codecov/c/github/MIDFIELDR/midfieldr/master.svg)](https://codecov.io/github/MIDFIELDR/midfieldr?branch=master)
[![](https://cranlogs.r-pkg.org/badges/grand-total/midfieldr)](https://cran.r-project.org/package=midfieldr)
[![License: GPL v3](man/figures/License-GPL-v3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)


```{r databits, echo = FALSE}
library(midfieldr)
data_bits <- midfieldr:::data_bits # ::: for internal variables

obs_cip <- unpack_data(bit = "obs_cip")
var_cip <- unpack_data(bit = "var_cip")
size_cip <- unpack_data(bit = "size_cip", power10 = 3)

obs_students <- unpack_data(bit = "obs_students")
var_students <- unpack_data(bit = "var_students")
size_students <- unpack_data(bit = "size_students", power10 = 6)

year_min <- unpack_data(bit = "year_min")
year_max <- unpack_data(bit = "year_max")

obs_degrees <- unpack_data(bit = "obs_degrees")
var_degrees <- unpack_data(bit = "var_degrees")
size_degrees <- unpack_data(bit = "size_degrees", power10 = 6)

obs_terms <- unpack_data(bit = "obs_terms")
var_terms <- unpack_data(bit = "var_terms")
size_terms <- unpack_data(bit = "size_terms", power10 = 6)

obs_courses <- unpack_data(bit = "obs_courses", power10 = 6, decimals = 1)
var_courses <- unpack_data(bit = "var_courses")
size_courses <- unpack_data(bit = "size_courses", power10 = 6)
```

A package for investigating student record data provided by registrars at US universities participating in the MIDFIELD project. 

Analytical tools for research in student pathways are generally scarce. midfieldr provides an entry to this type of intersectional research for anyone with basic proficiency in R and familiarity with packages from the tidyverse. 

midfieldr provides access to [midfielddata](https://midfieldr.github.io/midfielddata/), a data package containing a stratified sample of the MIDFIELD database. The sample comprises demographic, term, course, and degree information for `r obs_students` undergraduate students from `r year_min` to `r year_max`. The purpose of creating these packages is to share our data, methods, and metrics for intersectional research in student persistence. Potential audiences include:  

- Researchers interested in student persistence metrics, especially if they are R novices 
- Institutional researchers responsible for reporting student persistence metrics 
- Statistics instructors looking for new data for their students explore 



## Installation

midfieldr depends on midfielddata, a data package available from a [drat repository](https://midfieldr.github.io/drat/) on GitHub. Install midfielddata before installing midfieldr. 

```{r eval = FALSE}
install.packages("drat")
drat::addRepo("midfieldr")
install.packages("midfielddata")
```

The development version of midfieldr can be installed from GitHub.   

```{r eval = FALSE}
install.packages("devtools")
devtools::install_github("MIDFIELDR/midfieldr")
```


## Data

The midfieldr package includes: 

- `cip`  A data frame with `r obs_cip` observations and `r var_cip` CIP variables of program codes and names at the 2, 4, and 6-digit levels. Each observation is a unique program. Occupies `r size_cip` kb of memory.  

The midfielddata package contains the four datasets that comprise a stratified sample of the MIDFIELD database. 

- `midfieldstudents` A data frame with `r obs_students` observations and `r var_students` demographic variables. Each observation is a unique student. Occupies `r size_students` Mb of memory.  

- `midfieldcourses` A data frame with `r obs_courses` M observations and `r var_courses` academic course variables. Each observation is one course in one term for one student. Occupies `r size_courses` Mb of memory. 

- `midfieldterms` A data frame with `r obs_terms` observations and `r var_terms` academic term variables. Each observation is one term for one student. Occupies `r size_terms` Mb of memory. 

- `midfielddegrees` A data frame with `r obs_degrees` observations and `r var_degrees` graduation variables. Each observation is a unique student. Occupies `r size_degrees` Mb of memory.


## Usage

It's hard to succinctly describe how midfieldr works because going from raw unit-records to a grouped and summarized persistence metric entails a number of operations. However, in most cases, you start with a metric and a set of academic programs in mind and follow steps something like this, using a combination of functions from the tidyverse and specialized functions from midfieldr: 

- cip_filter() to select programs from the CIP data 
- cip_label() to add custom program labels for grouping 
- ever_filter(), grad_filter(), etc. to identify students 
- race_sex_join() to join student sex and race 
- group_by() and summarize() to count students 
- join() and mutate() to compute a persistence metric  
- multiway_order() to prepare the results for graphing 
- ggplot() to graph the metric 

A short but complete example is provided in the [Getting started](getting_started.html) vignette. 

## Meta

- Data provided by the [MIDFIELD](https://engineering.purdue.edu/MIDFIELD) project 
- Get citation information with `citation("midfieldr")` 
- Please note that this project is released with a [Code of Conduct](https://midfieldr.github.io/midfieldr/CONDUCT.html). If you contribute to this project you agree to abide by its terms. 


