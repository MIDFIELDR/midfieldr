---
output: github_document
bibliography: inst/REFERENCES.bib
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(
  # these options tend to vary from one Rmd to another
  echo = TRUE,
  fig.path = "man/figures/README-",
  # these options tend to remain constant
  collapse = TRUE,
  comment = "#>",
  message = FALSE,
  warning = FALSE,
  fig.width = 6,
  fig.asp = 1 / 1.6,
  out.width = "70%",
  fig.align = "center",
  # http://r-pkgs.had.co.nz/vignettes.html: error = TRUE captures errors in
  # the block and shows them inline. This is useful for demonstrating what
  # happens if code throws an error. If you use error = TRUE, set
  # purl = FALSE. Vignettes are accompanied by files containing all the
  # code from the vignette. purl = FALSE prevents the code from being
  # inserted into that file
  error = TRUE,
  purl = FALSE
)
knitr::knit_hooks$set(inline = function(x) {
  if (!is.numeric(x)) {
    x
  } else if (x >= 10000) {
    prettyNum(round(x, 2), big.mark = ",")
  } else {
    prettyNum(round(x, 2))
  }
})
options(tibble.print_min = 8L, tibble.print_max = 8L)
library(dplyr) # for the pipe %>%
unpack_data <- function(x = data_bits, bit, power10 = 0, decimals = 0) {
  x <- x %>%
    dplyr::filter(name == bit) %>%
    dplyr::select(data) %>%
    unlist() %>%
    unname()
  x <- round(x / 10^power10, decimals)
}
```


# midfieldr <span class="border-wrap"><img src="man/figures/logo.png" align="right" height="122" width="106" alt="logo.png"></span>


[![CRAN_Status_Badge](http://www.r-pkg.org/badges/version/midfieldr)](http://cran.r-project.org/package=midfieldr)
[![Build Status](https://travis-ci.org/MIDFIELDR/midfieldr.svg?branch=master)](https://travis-ci.org/MIDFIELDR/midfieldr)
[![Coverage Status](https://img.shields.io/codecov/c/github/MIDFIELDR/midfieldr/master.svg)](https://codecov.io/github/MIDFIELDR/midfieldr?branch=master)
[![](https://cranlogs.r-pkg.org/badges/grand-total/midfieldr)](https://cran.r-project.org/package=midfieldr)
[![License: GPL v3](man/figures/License-GPL-v3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)


```{r databits, echo = FALSE}
library("midfieldr")
library("midfielddata")

obs_cip  <- nrow(cip) 
var_cip  <- ncol(cip) 
size_cip <- "364 kb"

obs_students  <- nrow(midfieldstudents) 
var_students  <- ncol(midfieldstudents)  
size_students <- "19 Mb"

obs_courses   <- nrow(midfieldcourses)
var_courses   <- ncol(midfieldcourses) 
size_courses  <- "348 Mb"

obs_terms     <- nrow(midfieldterms) 
var_terms     <- ncol(midfieldterms)
size_terms    <- "82 Mb"

obs_degrees   <- nrow(midfielddegrees)  
var_degrees   <- ncol(midfielddegrees)
size_degrees  <- "10 Mb"

obs_institution <- length(unique(midfieldstudents$institution))
year_min  <- floor(min(midfieldterms$term) / 10)
year_max  <- floor(max(midfieldterms$term) / 10)
```


## Tools for student records research
 
MIDFIELD---the  *Multiple-Institution Database for Investigating Engineering Longitudinal Development*---is a partnership of US higher education institutions with engineering programs. As of June, 2019, MIDFIELD contains registrar's population data for 2.2M undergraduates at 20 institutions from 1987--2017. The data are organized in four related tables: students, courses, terms, and degrees. The MIDFIELD population data set is available to partner institutions only  [(link)](https://engineering.purdue.edu/MIDFIELD). 

**midfieldr** is an R package that provides tools specialized for the midfielddata sample data set. 

**midfielddata** is an R package that provides a stratified sample of the MIDFIELD population data set. The sample contains data for `r obs_students` undergraduates at `r obs_institution` institutions from `r year_min`--`r year_max` [(link)](https://midfieldr.github.io/midfielddata/). 

The midfielddata data dictionaries are a subset of the MIDFIELD dictionaries. When creating the midfielddata sample data set, some MIDFIELD variables were omitted and some were re-coded to preserve confidentiality. In general, however, scripts written for the midfielddata sample data set will work for the MIDFIELD population data set. 






## Installation

The data package is too large for CRAN, so it is stored on GitHub in a drat repository. Installation takes time; please be patient and wait for the Console prompt > to reappear. Installation must be in the order shown: install midfielddata before midfieldr. 

```r
install.packages("midfielddata", repos = "https://MIDFIELDR.github.io/drat/", type = "source")
```

Once midfieldr has been released on CRAN, install with:

```r
install.packages("midfieldr")
```

Or install the development version from GitHub using: 

```r
devtools::install_github("MIDFIELDR/midfieldr")
```





## Data

The midfieldr package includes: 

- `cip`  A data frame with `r obs_cip` observations and `r var_cip` CIP variables of program codes and names at the 2, 4, and 6-digit levels. Each observation is a unique program. Occupies `r size_cip` of memory.  Data dictionary [(link)](https://midfieldr.github.io/midfieldr/reference/cip.html). 

The midfielddata package contains the four datasets that comprise a stratified sample of the MIDFIELD database. 

- `midfieldstudents` A data frame with `r obs_students` observations and `r var_students` demographic variables. Each observation is a unique student. Occupies `r size_students` of memory. Data dictionary   [(link)](https://midfieldr.github.io/midfielddata/reference/midfieldstudents.html). 

- `midfieldcourses` A data frame with `r obs_courses` observations and `r var_courses` academic course variables. Each observation is one course in one term for one student. Occupies `r size_courses` of memory. Data dictionary  [(link)](https://midfieldr.github.io/midfielddata/reference/midfieldcourses.html).

- `midfieldterms` A data frame with `r obs_terms` observations and `r var_terms` academic term variables. Each observation is one term for one student. Occupies `r size_terms` of memory. Data dictionary  [(link)](https://midfieldr.github.io/midfielddata/reference/midfieldterms.html).

- `midfielddegrees` A data frame with `r obs_degrees` observations and `r var_degrees` graduation variables. Each observation is a unique student. Occupies `r size_degrees` of memory. Data dictionary  [(link)](https://midfieldr.github.io/midfielddata/reference/midfielddegrees.html).




## Usage

It's hard to succinctly describe how midfieldr works because going from raw unit-records to a grouped and summarized persistence metric entails a number of operations. However, in most cases, you start with a metric and a set of academic programs in mind and follow steps something like this, using a combination of functions from the tidyverse and specialized functions from midfieldr: 

- `cip_filter()` to select programs from the CIP data 
- `cip_label()` to add custom program labels for grouping 
- `ever_filter()`, `grad_filter()`, etc. to identify students 
- `race_sex_join()` to join student sex and race 
- `group_by()` and `summarize()` to count students 
- `join()` and `mutate()` to compute a persistence metric  
- `multiway_order()` to prepare the results for graphing 
- `ggplot()` to graph the metric 

A short but complete example is provided in the "Getting started" vignette  [(link)](articles/getting_started.html).   

## Meta

- Data provided by MIDFIELD [(link)](https://engineering.purdue.edu/MIDFIELD)   
- Get citation information with `citation("midfieldr")` 
- This project is released with a Code of Conduct  [(link)](https://midfieldr.github.io/midfieldr/CONDUCT.html). If you contribute to this project you agree to abide by its terms. 


