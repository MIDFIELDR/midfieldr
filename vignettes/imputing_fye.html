<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Imputing starting majors for FYE</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Imputing starting majors for FYE</h1>



<p>Packages used in this article:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(midfieldr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(midfielddata)</a></code></pre></div>
<p>If you also wish to run the imputation, you will also require:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(mice)</a></code></pre></div>
<div id="the-need-to-predict-a-starting-major" class="section level2">
<h2>The need to predict a starting major</h2>
<p>Some US institutions have first year engineering (FYE) programs—typically a common first year curriculum that is a prerequisite for declaring an engineering major. For these FYE students, some persistence metrics require us to predict their “starting major.”</p>
<p><strong>Starting major</strong>: The degree-granting engineering program—Civil Engineering, Electrical Engineering, Mechanical Engineering, etc.—that we predict the student would have declared had they not been required to enroll in FYE.</p>
<p>Predicting the starting major of FYE students takes one of two forms.</p>
<ol style="list-style-type: decimal">
<li><p>In the first instance, we have students who complete an FYE and declare an engineering major. This is the easy case–at the student’s first opportunity, they enrolled in an engineering major of their choosing. We use that major as our predicted starting major.</p></li>
<li><p>In the second instance, we have students who, after FYE, do not declare an engineering major. This is the more complicated case—the data provide no information regarding what engineering major the student would have declared originally had the institution not required them to enroll in FYE. For these students, we treat the starting major as missing data and impute a predicted value.</p></li>
</ol>
<p>Note that FYE students are neither undecided nor undeclared. Their institutions admitted them as engineering students. We just don’t know their preferred major. We have to predict the starting majors of FYE students to make fair comparisons across programs and institutions.</p>
</div>
<div id="we-provide-an-imputed-data-set" class="section level2">
<h2>We provide an imputed data set</h2>
<p>We impute these missing values using multiple imputation as implemented in the <a href="https://stefvanbuuren.github.io/mice/">mice</a> package (multivariate imputation via chained equations). The variables used to predict the missing values are institution, race, and sex.</p>
<p>The process does take time—about 30 seconds for imputing the missing values in our FYE data with 5992 observations, 5 variables, and 5 imputations.</p>
<p>You can skip doing the imputation yourself if you wish. We’ve done it for you and saved the results. We provide a replacement data set <code>case_fye</code> with the ID and predicted starting major of all FYE students in the midfieldr data sets.</p>
<p>We use these data in the package vignettes whenever an engineering starting major is required. You can do the same. To access the data,</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;case_fye&quot;</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">glimpse</span>(case_fye)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; Observations: 5,992</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; Variables: 2</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; $ id    &lt;chr&gt; &quot;MID25877315&quot;, &quot;MID25896490&quot;, &quot;MID25916711&quot;, &quot;MID2592129...</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; $ start &lt;chr&gt; &quot;140201&quot;, &quot;140201&quot;, &quot;140801&quot;, &quot;140901&quot;, &quot;140901&quot;, &quot;14070...</span></a></code></pre></div>
</div>
<div id="preparing-the-fye-data-for-imputation" class="section level2">
<h2>Preparing the FYE data for imputation</h2>
<p>You may skip the rest of the vignette and simply incorporate the imputed data <code>case_fye</code> in your analysis if the details of imputation are not important to you at this time.</p>
<p>If the details are of interest to you, we start by conditioning the data to prepare it for imputation.</p>
<p><strong>Step 1.</strong> Extract from <code>midfieldstudents</code> the IDs of all students whose matriculation major is FYE.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">fye_id &lt;-<span class="st"> </span>midfieldstudents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(., cip6 <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;14XXXX&quot;</span>, <span class="st">&quot;14YYYY&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(., id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw">unique</span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="kw">glimpse</span>(.)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; Observations: 5,992</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; Variables: 1</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; $ id &lt;chr&gt; &quot;MID25783162&quot;, &quot;MID25783166&quot;, &quot;MID25783167&quot;, &quot;MID25783178&quot;,...</span></a></code></pre></div>
<p>Extract from <code>midfieldterms</code> all the term data for these students. <code>semi_join(x, y)</code> returns all rows from x where there are matching values in y, keeping just columns from x.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">all_fye_terms &lt;-<span class="st"> </span><span class="kw">semi_join</span>(midfieldterms, fye_id, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(., id, cip6, term) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw">glimpse</span>(.)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; Observations: 51,625</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; Variables: 3</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; $ id   &lt;chr&gt; &quot;MID25783162&quot;, &quot;MID25783162&quot;, &quot;MID25783162&quot;, &quot;MID25783162...</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; $ cip6 &lt;chr&gt; &quot;14XXXX&quot;, &quot;14XXXX&quot;, &quot;520301&quot;, &quot;520301&quot;, &quot;520301&quot;, &quot;520301...</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; $ term &lt;dbl&gt; 19921, 19923, 19931, 19933, 19941, 19943, 19951, 19953, 1...</span></a></code></pre></div>
<p><strong>Step 2.</strong> Subset the students who declare an engineering major after FYE.</p>
<p>Keeping those terms in which FYE is the declared major, we arrange the rows by ID and <em>descending</em> term. Then, grouped by ID, each first row is a student’s final FYE term, denoted <code>end_fye</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">last_fye_terms &lt;-<span class="st"> </span>all_fye_terms <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(., cip6 <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;14XXXX&quot;</span>, <span class="st">&quot;14YYYY&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw">arrange</span>(., id, <span class="kw">desc</span>(term)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(., id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(., <span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw">ungroup</span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw">select</span>(., id, <span class="dt">end_fye =</span> term) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="st">  </span><span class="kw">glimpse</span>(.)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; Observations: 5,220</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; Variables: 2</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; $ id      &lt;chr&gt; &quot;MID25783162&quot;, &quot;MID25783166&quot;, &quot;MID25783167&quot;, &quot;MID25783...</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; $ end_fye &lt;dbl&gt; 19923, 20093, 20053, 19961, 19873, 20063, 20053, 20063...</span></a></code></pre></div>
<p>We join the column <code>end_fye</code> to the <code>all_fye_terms</code> data frame. <code>left_join(x, y)</code> returns all rows from x, and all columns from x and y. All multiple matches between x and y are returned.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">fye_to_engr &lt;-<span class="st"> </span><span class="kw">left_join</span>(all_fye_terms, last_fye_terms, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</a></code></pre></div>
<p>Arranging by ID and <em>ascending</em> term and grouped by ID, each first row is a student’s first term after FYE.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">fye_to_engr &lt;-<span class="st"> </span>fye_to_engr <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(., term <span class="op">&gt;</span><span class="st"> </span>end_fye) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw">arrange</span>(., id, term) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(., id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(., <span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="st">  </span><span class="kw">ungroup</span>(.)</a></code></pre></div>
<p>Because this data frame denotes students transitioning to an engineering major, we filter to keep only those whose CIP starts with “14.” For these students, the predicted starting major is their declared engineering major after FYE.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">fye_to_engr &lt;-<span class="st"> </span>fye_to_engr <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(., <span class="kw">str_detect</span>(cip6, <span class="st">&quot;^14&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(., id, <span class="dt">start =</span> cip6) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw">glimpse</span>(.)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; Observations: 3,366</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; Variables: 2</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; $ id    &lt;chr&gt; &quot;MID25783167&quot;, &quot;MID25783178&quot;, &quot;MID25783197&quot;, &quot;MID2578319...</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; $ start &lt;chr&gt; &quot;140901&quot;, &quot;140701&quot;, &quot;140701&quot;, &quot;140301&quot;, &quot;140701&quot;, &quot;14050...</span></a></code></pre></div>
<p><strong>Step 3.</strong> The remaining FYE students have an unknown starting major.</p>
<p>Starting with the IDs of all students in FYE and removing the IDs of students who have declared an engineering major after FYE yields the IDs of students whose starting major will have to be imputed. <code>anti_join(x, y)</code> returns all rows from x where there are not matching values in y, keeping just columns from x.</p>
<p>For these students, the predicted starting major after FYE is assumed missing (NA).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">fye_to_nonengr &lt;-<span class="st"> </span><span class="kw">anti_join</span>(fye_id, fye_to_engr, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">start =</span> <span class="ot">NA_character_</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw">glimpse</span>()</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; Observations: 2,626</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; Variables: 2</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; $ id    &lt;chr&gt; &quot;MID25783162&quot;, &quot;MID25783166&quot;, &quot;MID25783227&quot;, &quot;MID2578342...</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; $ start &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...</span></a></code></pre></div>
<p><strong>Step 4.</strong> Combine the two data frames and finish the data preparation.</p>
<p>Bind the two data frames.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">fye_start &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(fye_to_engr, fye_to_nonengr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">glimpse</span>()</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; Observations: 5,992</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; Variables: 2</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; $ id    &lt;chr&gt; &quot;MID25783167&quot;, &quot;MID25783178&quot;, &quot;MID25783197&quot;, &quot;MID2578319...</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; $ start &lt;chr&gt; &quot;140901&quot;, &quot;140701&quot;, &quot;140701&quot;, &quot;140301&quot;, &quot;140701&quot;, &quot;14050...</span></a></code></pre></div>
<p>Extract from <code>midfieldstudents</code> the institution names by student ID. <code>semi_join(x, y)</code> returns all rows from x where there are matching values in y, keeping just columns from x.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">inst_id &lt;-<span class="st"> </span><span class="kw">semi_join</span>(midfieldstudents, fye_start, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(., id, institution) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="kw">unique</span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span><span class="kw">glimpse</span>(.)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; Observations: 5,992</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; Variables: 2</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; $ id          &lt;chr&gt; &quot;MID25783162&quot;, &quot;MID25783166&quot;, &quot;MID25783167&quot;, &quot;MID2...</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; $ institution &lt;chr&gt; &quot;Institution M&quot;, &quot;Institution M&quot;, &quot;Institution M&quot;,...</span></a></code></pre></div>
<p>Join the institutions to the FYE starters data frame and add race and sex using <code>race_sex_join()</code>. We assume that these variables are appropriate predictors.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">fye_start &lt;-<span class="st"> </span><span class="kw">left_join</span>(fye_start, inst_id, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw">race_sex_join</span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(id, institution, race, sex, start) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">  </span><span class="kw">glimpse</span>(.)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; Observations: 5,992</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; Variables: 5</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; $ id          &lt;chr&gt; &quot;MID25783167&quot;, &quot;MID25783178&quot;, &quot;MID25783197&quot;, &quot;MID2...</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt; $ institution &lt;chr&gt; &quot;Institution M&quot;, &quot;Institution M&quot;, &quot;Institution M&quot;,...</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt; $ race        &lt;chr&gt; &quot;White&quot;, &quot;Black&quot;, &quot;White&quot;, &quot;White&quot;, &quot;White&quot;, &quot;Whit...</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt; $ sex         &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Female&quot;, &quot;Male&quot;, &quot;Male&quot;, ...</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; $ start       &lt;chr&gt; &quot;140901&quot;, &quot;140701&quot;, &quot;140701&quot;, &quot;140301&quot;, &quot;140701&quot;, ...</span></a></code></pre></div>
<p>Convert the character variables to factors to use with mice. The resulting data frame <code>mi_input</code> is ready to be operated on by mice.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">mi_input &lt;-<span class="st"> </span>fye_start <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw">arrange</span>(., institution, race, sex, start) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(.,</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">    <span class="dt">institution =</span> <span class="kw">as.factor</span>(institution),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">    <span class="dt">race =</span> <span class="kw">as.factor</span>(race),</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">    <span class="dt">sex =</span> <span class="kw">as.factor</span>(sex),</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">    <span class="dt">start =</span> <span class="kw">as.factor</span>(start)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="st">  </span><span class="kw">glimpse</span>(.)</a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; Observations: 5,992</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; Variables: 5</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; $ id          &lt;chr&gt; &quot;MID25877315&quot;, &quot;MID25896490&quot;, &quot;MID25916711&quot;, &quot;MID2...</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; $ institution &lt;fct&gt; Institution B, Institution B, Institution B, Insti...</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; $ race        &lt;fct&gt; Asian, Asian, Asian, Asian, Asian, Asian, Asian, A...</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; $ sex         &lt;fct&gt; Female, Female, Female, Female, Female, Female, Ma...</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; $ start       &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...</span></a></code></pre></div>
</div>
<div id="imputing-missing-data" class="section level2">
<h2>Imputing missing data</h2>
<p>The mice package <span class="citation">(van Buuren and Groothuis-Oudshoorn 2011)</span> implements multivariate imputation by chained equations (MICE). MICE is also known as “fully conditional specification” or “sequential regression multiple imputation” and is suitable for categorical variables such as ours <span class="citation">(Azur et al. 2011)</span>. Our computational procedure follows the approach suggested by Dhana <span class="citation">(2017)</span>.</p>
<p>The procedure assumes the missing data are “missing at random” (MAR), that is, independent of the variables used to impute the missing values. This is the rationale for using data only from FYE institutions to impute the missing values—the existence if the missing data does depend on the institution type, FYE or non-FYE. Within the FYE data itself, however, we assume that the imputed starting majors are missing at random.</p>
<p>Use <code>mice::md.pattern()</code> to see the pattern of missing data. As expected, all the missing values are in the <code>start</code> column.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">md.pattern</span>(mi_input, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" width="70%" style="display: block; margin: auto;" /></p>
<pre><code>#&gt;      id institution race sex start     
#&gt; 3366  1           1    1   1     1    0
#&gt; 2626  1           1    1   1     0    1
#&gt;       0           0    0   0  2626 2626</code></pre>
<p>Initialize parameters.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">init &lt;-<span class="st"> </span><span class="kw">mice</span>(mi_input, <span class="dt">maxit =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">meth &lt;-<span class="st"> </span>init<span class="op">$</span>method</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">predM &lt;-<span class="st"> </span>init<span class="op">$</span>predictorMatrix</a></code></pre></div>
<p>Identify variables not used as predictors.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">predM[, <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>)] &lt;-<span class="st"> </span><span class="dv">0</span></a></code></pre></div>
<p>Assign variables not imputed. (In this case, this step could be skipped because a mice default is to not impute variables with zero missing values.)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">meth[<span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;institution&quot;</span>, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;sex&quot;</span>)] &lt;-<span class="st"> &quot;&quot;</span></a></code></pre></div>
<p>Assign the imputation method. For unordered categorical data with more than two levels, the suggested method is “polyreg” (polytomous regression).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">meth[<span class="kw">c</span>(<span class="st">&quot;start&quot;</span>)] &lt;-<span class="st"> &quot;polyreg&quot;</span></a></code></pre></div>
<p>Run the multiple (m = 5) imputations. The seed is set for reproducible results. On my Windows machine, this imputation takes about 30 seconds.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">mi_output &lt;-<span class="st"> </span><span class="kw">mice</span>(</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">  mi_input,</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">  <span class="dt">method =</span> meth,</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">  <span class="dt">predictorMatrix =</span> predM,</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">  <span class="dt">m =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">  <span class="dt">printFlag =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb21-7" data-line-number="7">  <span class="dt">seed =</span> <span class="dv">20180624</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8">)</a></code></pre></div>
</div>
<div id="data-set-case_fye" class="section level2">
<h2>Data set: <code>case_fye</code></h2>
<p>Construct the data set after imputation, keeping ID and starting major only. Reformat the start major as a character. The data frame, <code>case_fye</code>, is the data mentioned previously provided with the midfieldr package if you prefer not to do your own imputation.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">mi_output_complete &lt;-<span class="st"> </span><span class="kw">complete</span>(mi_output)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">case_fye &lt;-<span class="st"> </span>mi_output_complete <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(id, start) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">start =</span> <span class="kw">as.character</span>(start)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="st">  </span><span class="kw">glimpse</span>(.)</a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">#&gt; Observations: 5,992</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">#&gt; Variables: 2</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co">#&gt; $ id    &lt;chr&gt; &quot;MID25877315&quot;, &quot;MID25896490&quot;, &quot;MID25916711&quot;, &quot;MID2592129...</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">#&gt; $ start &lt;chr&gt; &quot;140201&quot;, &quot;140201&quot;, &quot;140801&quot;, &quot;140901&quot;, &quot;140901&quot;, &quot;14070...</span></a></code></pre></div>
</div>
<div id="assessing-the-imputation." class="section level2">
<h2>Assessing the imputation.</h2>
<p>Confirm there are no missing values.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">md.pattern</span>(mi_output_complete, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#&gt;  /\     /\</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt; {  `---'  }</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#&gt; {  O   O  }</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt; ==&gt;  V &lt;==  No need for mice. This data set is completely observed.</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt;  \  \|/  /</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt;   `-----'</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" width="70%" style="display: block; margin: auto;" /></p>
<pre><code>#&gt;      id institution race sex start  
#&gt; 5992  1           1    1   1     1 0
#&gt;       0           0    0   0     0 0</code></pre>
<p>Confirm that the start majors are all in engineering.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">case_fye <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(., start) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="st">  </span><span class="kw">unlist</span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="st">  </span><span class="kw">unique</span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="st">  </span><span class="kw">sort</span>(.)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">#&gt;  [1] &quot;140201&quot; &quot;140301&quot; &quot;140501&quot; &quot;140601&quot; &quot;140701&quot; &quot;140801&quot; &quot;140901&quot;</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co">#&gt;  [8] &quot;141001&quot; &quot;141101&quot; &quot;141801&quot; &quot;141901&quot; &quot;142101&quot; &quot;142301&quot; &quot;142801&quot;</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="co">#&gt; [15] &quot;143301&quot; &quot;143501&quot; &quot;149999&quot;</span></a></code></pre></div>
</div>
<div id="issue-bin" class="section level2">
<h2>Issue bin</h2>
<ul>
<li>To assess the imputation, the FYE starting majors with and without the imputed values.</li>
</ul>
<!-- To assess the imputed start values, we will collect the numbers of all students starting in all institutions, with and without the missing data.  -->
<!-- We extract from `midfieldstudents` the IDs of all students whose matriculation major is engineering.    -->
<!-- ```{r} -->
<!-- engr_id <- midfieldstudents %>%  -->
<!--    filter(., str_detect(cip6, "^14")) %>% -->
<!--    select(., id) %>% -->
<!--    unique(.) %>% -->
<!--    glimpse(.)  -->
<!-- ``` -->
<!-- Keep students from non-FYE institutions.     -->
<!-- ```{r} -->
<!-- non_fye_id <- engr_id %>%  -->
<!--    anti_join(., fye_id, by = "id") %>%  -->
<!--    glimpse() -->
<!-- ``` -->
<!-- From `midfieldstudents`, collect the starting information for these students. -->
<!-- ```{r} -->
<!-- non_fye <- midfieldstudents %>%  -->
<!--    semi_join(., non_fye_id, by = "id") %>% -->
<!--    select(id, start = cip6) %>%  -->
<!--    glimpse() -->
<!-- ``` -->
<!-- Add a column to categorize FYE and non-FYE students and join the data frames.  -->
<!-- ```{r} -->
<!-- non_fye <- non_fye %>%  -->
<!--    mutate(fye_status = "Non_FYE") -->
<!-- fye <- as.tibble(case_fye) %>%  -->
<!--    mutate(fye_status = "FYE")  -->
<!-- engr <- bind_rows(fye, non_fye) %>%  -->
<!--    race_sex_join() %>%  -->
<!--    select(-id) %>%  -->
<!--    glimpse() -->
<!-- ``` -->
<!-- Truncate to the 4-digit CIP -->
<!-- ```{r} -->
<!-- engr <- engr %>%  -->
<!--    mutate(start = str_sub(start, start = 1, end = 4)) %>%  -->
<!--    glimpse() -->
<!-- ``` -->
<!-- Now count by FYE status, race, sex, and major.  -->
<!-- ```{r} -->
<!-- library(seplyr) -->
<!-- engr_count <- engr %>%  -->
<!--    group_summarise(., c("fye_status", "race", "sex", "start"), n = n()) %>%  -->
<!--    spread(fye_status, n)  -->
<!-- engr_count$Total <- rowSums(engr_count[ , c("FYE", "Non_FYE")], na.rm = TRUE) -->
<!-- knitr::kable(engr_count) -->
<!-- ``` -->
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-azur2011">
<p>Azur, Melissa J., Elizabeth A. Stuart, Constantine Frangakis, and Philip J. Leaf. 2011. “Multiple Imputation by Chained Equations: What Is It and How Does It Work?” <em>International Journal of Methods in Psychiatric Research</em> 20 (1): 40–49.</p>
</div>
<div id="ref-dhana2017">
<p>Dhana, Klodian. 2017. “Handling Missing Data with MICE Package: A Simple Approach.” Edited by Data Science Plus. <a href="https://datascienceplus.com/handling-missing-data-with-mice-package-a-simple-approach/" class="uri">https://datascienceplus.com/handling-missing-data-with-mice-package-a-simple-approach/</a>.</p>
</div>
<div id="ref-vanbuuren2011">
<p>van Buuren, Stef, and Karin Groothuis-Oudshoorn. 2011. “mice: Multivariate Imputation by Chained Equations in R.” <em>Journal of Statistical Software</em> 45 (3): 1–67. <a href="https://www.jstatsoft.org/v45/i03/" class="uri">https://www.jstatsoft.org/v45/i03/</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
