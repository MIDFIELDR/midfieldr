<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>FYE proxies</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">FYE proxies</h1>



<p>Before we can treat “starters”, we have to introduce “FYE
proxies”—estimates of the degree-granting engineering programs
First-Year Engineering (FYE) students would have declared had they not
been required to enroll in FYE.</p>
<p>Users of midfielddata practice data are not required to reproduce
this vignette—the results are included with midfieldr in the
<code>fye_proxy</code> data set.</p>
<p>This vignette in the MIDFIELD workflow.</p>
<ol style="list-style-type: decimal">
<li>Planning<br />
</li>
<li>Initial processing<br />
</li>
<li><span style=" font-weight: bold;    color: #b35806 !important;">Blocs</span>
<ul>
<li>Ever-enrolled<br />
</li>
<li><span style=" font-weight: bold;    color: #b35806 !important;">FYE
proxies</span><br />
</li>
<li>Starters<br />
</li>
<li>Graduates<br />
</li>
</ul></li>
<li>Groupings<br />
</li>
<li>Metrics<br />
</li>
<li>Displays</li>
</ol>
<div id="potential-for-starter-miscounts" class="section level2">
<h2>Potential for starter miscounts</h2>
<p>At some US institutions, engineering students are required to
complete a First-Year Engineering (FYE) program as a prerequisite for
declaring an engineering major. Administratively, degree-granting
engineering programs such as Electrical Engineering or Mechanical
Engineering treat their incoming post-FYE students as their “starting”
cohorts. However, when computing a metric such as graduation rate that
requires a count of starters, FYE records must be treated with special
care to avoid a miscount.</p>
<p>To illustrate the potential for miscounting starters, suppose we wish
to calculate a Mechanical Engineering (ME) graduation rate. Students
starting in ME constitute the starting pool and the fraction of that
pool graduating in ME is the graduation rate.</p>
<p>At FYE institutions, an ME program would typically define their
starting pool as the post-FYE cohort entering their program. This may be
the best information available, but it invariably undercounts starters
by failing to account for FYE students who leave the institution or
switch to non-engineering majors. In the absence of the FYE requirement
some of these students would have been ME starters. By neglecting these
students, the count of ME starters is artificially low resulting in an
ME graduation rate that is artificially high. The same is true for every
degree-granting engineering major in an FYE institution.</p>
<p>Because of the special nature of FYE programs, we cannot address
starter miscounts by grouping FYE students with those admitted with
“undecided” or “unknown” CIP codes—FYE students are neither. They were
admitted as Engineering majors (2-digit CIP 14). We simply don’t know to
which degree-granting program (6-digit CIP) they intended to
transition.</p>
<p>Therefore, to avoid miscounting starters at FYE institutions, we
estimate the 6-digit CIP codes of the degree-granting engineering
programs that FYE students would have declared had they not been
required to enroll in FYE.</p>
</div>
<div id="definitions" class="section level2">
<h2>Definitions</h2>
<dl>
<dt>FYE</dt>
<dd>
<p>First-Year Engineering program, a common-first-year curriculum that
is a prerequisite for declaring an engineering major at some US
institutions. Denoted by its own CIP code, FYE is not a degree-granting
program.</p>
</dd>
<dt>FYE proxy</dt>
<dd>
<p>Our estimate of the degree-granting engineering program in which an
FYE student would have enrolled had they not been required to enroll in
FYE. The proxy, a 6-digit CIP code, denotes the program of which the FYE
student can be considered a starter.</p>
</dd>
<dt>bloc</dt>
<dd>
<p>A grouping of student-level data dealt with as a unit, for example,
starters, students ever-enrolled, graduates, transfer students,
traditional and non-traditional students, migrators, etc.</p>
</dd>
<dt>starters</dt>
<dd>
<p>Bloc of degree-seeking students in their initial terms enrolled in
degree-granting programs.</p>
</dd>
<dt>migrators</dt>
<dd>
<p>Bloc of students who leave one program to enroll in another. Also
called <em>switchers.</em></p>
</dd>
<dt>multiple imputation</dt>
<dd>
<p>Method of imputing missing categorical data, in this case, imputing
the FYE proxy 6-digit CIP codes.</p>
</dd>
</dl>
</div>
<div id="method" class="section level2">
<h2>Method</h2>
<p>We apply <code>prep_fye_mice()</code> to the <code>student</code> and
<code>term</code> source files to construct a data frame suitable for
imputation using the mice R package. The procedure has four steps:</p>
<ol style="list-style-type: decimal">
<li><p>Use <code>prep_fye_mice()</code> from the midfieldr package to
estimate some of the FYE proxy CIPs, treat the remainder as missing
values, and structure the data frame for imputation.</p></li>
<li><p>Optional. If the default predictor variables (institution,
race/ethnicity, and sex) do not meet the needs of your study, you can
define your own.</p></li>
<li><p>Use <code>mice()</code> from the mice package to impute the
6-digit CIP missing values.</p></li>
<li><p>Post-processing to convert the results to useful form and to
remove migrators.</p></li>
</ol>
<p>Three outcomes are possible, depending on your goals and available
data:</p>
<ul>
<li><p>Use midfielddata practice data to recreate the
<code>fye_proxy</code> data set included with midfieldr—as we do in this
vignette.</p></li>
<li><p>Use midfielddata practice data to create an alternate set of FYE
proxies based on a different random number seed or different predictor
variables. The result would have the same IDs as <code>fye_proxy</code>
but different ID-proxy pairings.</p></li>
<li><p>Use MIDFIELD research data and construct your own FYE
proxies.</p></li>
</ul>
<p>For a given set of source files, FYE proxies need be created only
once and written to file. The result can be used as needed unless the
source files change.</p>
<p><em>Reminder.</em>   midfielddata datasets are for practice, not
research.</p>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<p><em>Start.</em>   If you are writing your own script to follow along,
we use these packages in this article:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;midfieldr&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;midfielddata&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;data.table&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;mice&quot;</span>)</span></code></pre></div>
<p><em>Load.</em>   Practice datasets. View data dictionaries via
<code>?student</code>, <code>?term</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load practice data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(student, term)</span></code></pre></div>
<p><em>Loads with midfieldr.</em>   Prepared data, derived in <a href="art-040-programs.html#reusable-code">Programs</a>. View data
dictionary via <code>?study_programs</code>.</p>
<ul>
<li><code>study_programs</code></li>
</ul>
</div>
<div id="initial-processing" class="section level2">
<h2>Initial processing</h2>
<p>Unlike the initial processing in previous articles, we do not filter
for data sufficiency and degree seeking.</p>
<p><em>Select (optional).</em>   Reduce the number of columns. Code
reproduced from <a href="art-000-getting-started.html#reusable-code">Getting
started</a>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional. Copy of source files with all variables</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>source_student <span class="ot">&lt;-</span> <span class="fu">copy</span>(student)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>source_term <span class="ot">&lt;-</span> <span class="fu">copy</span>(term)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional. Select variables required by midfieldr functions</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>student <span class="ot">&lt;-</span> <span class="fu">select_required</span>(source_student)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>term <span class="ot">&lt;-</span> <span class="fu">select_required</span>(source_term)</span></code></pre></div>
</div>
<div id="prep_fye_mice" class="section level2">
<h2><code>prep_fye_mice()</code></h2>
<p>The purpose of <code>prep_fye_mice()</code> is preparing a data frame
for the mice R package. Operates on the complete, unfiltered
<code>student</code> and <code>term</code> source data to create a data
frame with three predictor variables and an FYE proxy variable. The
values in <code>proxy</code> are determined by a student’s first
post-FYE program code, as follows:</p>
<ol style="list-style-type: decimal">
<li><p><em>Post-FYE in Engineering.</em>   The student completes FYE and
enrolls in an engineering major. For this outcome, we know that at the
student’s first opportunity, they enrolled in an engineering major of
their choosing. The CIP code of that program is returned as the
student’s FYE proxy.</p></li>
<li><p><em>Post-FYE not in Engineering.</em>   The student migrates to a
non-engineering major or has no post-FYE records in the database. The
data provide no indication of the student’s preferred degree-granting
engineering major. Thus their FYE proxy value is returned as NA, to be
treated as missing data to be imputed.</p></li>
</ol>
<p><em>Arguments.</em></p>
<ul>
<li><p><strong><code>midfield_student</code></strong>   Data frame of
student observations, keyed by student ID. Default is
<code>student</code>. Required variables are <code>mcid</code>,
<code>race</code>, and <code>sex</code>. Use all rows of your source
<code>student</code> data table.</p></li>
<li><p><strong><code>midfield_term</code></strong>   Data frame of term
observations keyed by student ID. Default is <code>term</code>. Required
variables are <code>mcid</code>, <code>institution</code>,
<code>term</code>, and <code>cip6</code>. Use all rows of your source
<code>term</code> data table.</p></li>
<li><p><strong><code>fye_codes</code></strong>   Optional character
vector of 6-digit CIP codes assigned to FYE programs. Default is
“140102”. Argument to be used by name.</p></li>
</ul>
<p><em>Implicit arguments.</em>   The following implementations yield
identical results.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Required arguments in order and explicitly named</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">prep_fye_mice</span>(<span class="at">midfield_student =</span> student, <span class="at">midfield_term =</span> term)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Required arguments in order, but not named</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">prep_fye_mice</span>(student, term)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the implicit defaults</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">prep_fye_mice</span>()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate equivalence</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">same_content</span>(x, y)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">same_content</span>(x, z)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p><em>Output.</em>   The function returns one row per FYE student keyed
by student ID. All variables except ID are returned as factors to meet
the requirements of <code>mice()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Working data frame</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">&lt;-</span> <span class="fu">prep_fye_mice</span>(student, term)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>DT</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 mcid   race    sex   institution  proxy</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               &lt;char&gt; &lt;fctr&gt; &lt;fctr&gt;        &lt;fctr&gt; &lt;fctr&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1: MCID3111190643  Asian Female Institution J   &lt;NA&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2: MCID3111190747  Asian Female Institution J   &lt;NA&gt;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3: MCID3111288144  Asian Female Institution J   &lt;NA&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ---                                                  </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5787: MCID3112328635  White   Male Institution J 143501</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5788: MCID3112328655  White   Male Institution J 143501</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5789: MCID3112382784  White   Male Institution J 143501</span></span></code></pre></div>
</div>
<div id="missing-data" class="section level2">
<h2>Missing data</h2>
<p>The output of <code>prep_fye_mive()</code> should contain missing
values in the proxy column only. Other variables are complete. A
race/ethnicity or sex value of “unknown” is treated as an observed
value, not missing data. And while no values of ID or institution are
unknown or missing in this example, such observations (if they existed)
would have to be removed.</p>
<p>Checking that all variables except <code>proxy</code> are
complete.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of unique IDs</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(DT<span class="sc">$</span>mcid))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of complete cases on four variables</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">complete.cases</span>(DT[, .(mcid, race, sex, institution)]))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate equivalence</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(x, y)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Number of missing observations in <code>proxy</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number NAs in proxy</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(DT<span class="sc">$</span>proxy))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2152</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentage NAs in proxy</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> <span class="fu">round</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(DT<span class="sc">$</span>proxy)) <span class="sc">/</span> <span class="fu">nrow</span>(DT), <span class="dv">3</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 37.2</span></span></code></pre></div>
<p><em>Missing at random (MAR).</em>   These missing <code>proxy</code>
data are caused by a student’s decision to migrate to a non-engineering
major or to leave the database. At the time of making that decision, the
FYE student would not yet have enrolled in a degree-granting engineering
major, thus their decision is unlikely to be related to any specific
engineering major.</p>
<p>That a CIP is missing, therefore, is unlikely to be related to a
specific CIP value—but may be related to other observations such as
institution, race/ethnicity, or sex. Missing data of this type are
classified as “missing at random” (MAR) which are suitable for multiple
imputation and yield unbiased results <span class="citation">(<a href="#ref-GraceMartin:2012" role="doc-biblioref">Grace-Martin
2012</a>)</span>.</p>
<p><em>Multiple imputation.</em>   Lastly, while 5–10 imputations are
generally considered adequate for unbiasedness, Bodner <span class="citation">(<a href="#ref-Bodner:2008" role="doc-biblioref">2008</a>)</span> recommends having as many
imputations as the percentage of missing data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of proxies to be imputed</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>(N_impute <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(DT<span class="sc">$</span>proxy)))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2152</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of observations with complete predictor information</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>(N_complete <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">complete.cases</span>(DT[, .(mcid, race, sex, institution)])))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 5789</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent missing proxies</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>(percent_missing <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> N_impute <span class="sc">/</span> N_complete, <span class="dv">3</span>))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 37.174</span></span></code></pre></div>
<p>As shown here, the overall percentage of missing data is 37.17%,
suggesting we set the number of imputations to 37.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the &quot;m&quot; argument in mice()</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>(m_imputations <span class="ot">&lt;-</span> <span class="fu">round</span>(percent_missing, <span class="dv">0</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 37</span></span></code></pre></div>
<p><em>Chart.</em>   The chart displays the percent missing data by
category. The <code>institution</code> category isn’t used because the
practice data contain FYE students in one institution only. The vertical
dashed line indicates the 37% percent missing data overall.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAEMCAMAAABEAiHuAAABcVBMVEUAAAAAADoAAGYAOpAAZrYZGT8ZGWIZP4EZYp8aGhozMzM6AAA6ADo6AGY6OpA6kNs/GRk/GWI/P4E/gb1NTU1NTW5NTY5Nbo5NbqtNjshZWVliGRliGT9iGWJiP4Fin9lmAABmADpmAGZmOpBmkJBmtrZmtttmtv9uTU1uTW5uTY5ubk1ubo5ubqtujqtujshuq6tuq+SBPxmBPz+BP2KBvdmOTU2OTW6OTY6Obk2Obm6ObquOjk2Ojm6Ojo6OjsiOq6uOyP+QOgCQkDqQkGaQtpCQ27aQ2/+fYhmf2b2f2dmrbk2rbm6rbo6rjk2rjqurq46ryKur5Mir5OSr5P+2ZgC2/7a2/9u2//+9gT+92dnIjk3Ijm7IyI7I5KvI/8jI/+TI///Zn2LZvYHZ2Z/Z2b3Z2dnbkDrb/9vb///kq27kq47k5Kvk/8jk/+Tk///r6+v/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T///+wjq5sAAAACXBIWXMAAA7DAAAOwwHHb6hkAAASuElEQVR4nO2dj1/bxhmHTcvWeSSjGQ7FabO0+xVC46VOF0qarZuzdmlj0iWt2dKS0jq/vHhtPcwcIv31u/fuZEkmwCFLd9Z73++HYLAUP9yHe6Q7Gb1XCRHE41Rc/wAI4jIQAPE6EADxOhAA8ToQAPE6EADxOu4E+O8ROXJjATkx75xl3pTxmff05YEA4PnBgwAGAY8vDwIYBDy+PAhgEPD48iCAQTAJ5suDAAaBAHx5EMAgEIAvDwIYBALw5UEAg4DHl+dKgNFqXXzeXu5G36910ztkbVARAY8vz5kAl/4wCPc/XOMsQKVSscrLHJ95zgRY+3MnHH0kuv1otVZrSQH212vjMwIDASqVrAaUo308eO4E+KYV/ufeWnf/gw71fhJguxn2aWAU/lykKLCVnKNPUgDHPwhyXNwJsHMluLOjBj77GyQAqSC+0jtkNbqIZLsKhDNAGXjuBPjuHz/8RY78t2ti5EMCrNdqtbMdNgJgDlAGnjsBug/uNmW3b+khUHz0ZyKAPd6U8Zknu/vD6oWH1eqSZQGGZzt68D+61NFzgOHKgIMA4JWGR7398VvXnlxdenz+tl0BdO/v12pvXG/pq0DjERAEAM8KTwvw6Mxt8WFRgGOTtUFFBDy+PD0Eqi6Jc4DNIRAEAG8meK4mwbwFwCS4NDwIYBAIwJcnu/uTq9Vq9bWvIUBePAhQGp7q/0tP3r/2VdIACDAVDwKUhievAp2/LQSwexmUtwDglYanzgAXcAYAz0+e7O6Pznx2FXMA8Hzk4SqQQcDjy5NzgF/Rwf/JHzEHyIuHSXBpeGoI9PrPnn76k2s4A+TFgwCl4ekO/7B6AUOg/HgQoDQ82d0fv1n4GYDu/K3VmodvZ3VTPAQoDU+/D1D4HOBABy+xAJnv9MrIKzw+82xdBYo6uKr8EGzeFaeDoTwllK4qRPZ7fbPxio/PPNsCqMoPQbsuS2ONylgVAtUeOMWaADQHqIe68kOw2QnpH30blq0qBM4AnHiWzwC68kNKgNJVhTi+/2MSXBqebQHUET4hAKpC5MCbMj7zHMwBhiuDhAAsq0JAgNLwHFwFOttJngFYVoWAAKXh2RLgxMnaoCICHl8eBDAIeHx5EMAg4PHlQQCDgMeXBwEMgkkwXx4EMAgE4MuDAAaBAHx5EMAgEIAvb2YFQJAZCARAvA4EQLwOBEC8DgRAvA4EQLwOBEC8Dt4HAI83b2bfB8jaoCICHl8eBDAIeHx5EMAg4PHlQQCD4G+B+PIggEEgAF8eBDAIBODLgwAGgQB8eRDAIODx5UEAg4DHl5dZgNFqK0yua6FLnE9G139+6SscuWZG1gYVEfD48qYQgBazSAnwst2GHx2+LNKRydqgIgJe6XipCt7FCLD2TV11e7nEC63usrO20xhQzc94qZdg84sbg9SCMGrb6PJ1sXtUDlQvEtP4nB44CIBJsGNeeg2HggTobrfSS7yM1r7bFF83BuOlXuQ3reSCMHoZGBpAie+CdiscrvygX2E1qg492yvEGOSc6x/A95iv4jONAPs3BnHZf+VAX3TvZmKpF/H9sJ5aDkBtk2eO5Kwhfk4/cZTfM3/EwhnAMc/OGUB0b9lhoyVe6KPxoxwB6aVegnaNtqXWw5DbIgEaajmA6BUgQDbelGHIszEHoMUe79HKRq3xEEh09XuNQbzUi+zg262kAGpb6gwQvwIXAcArDW8qAeSloHiJF3lSoInueKmXPs1ph/Xkehhqm+7sNAcYre3Ei8RAAPDs8qYTIOwvd/USL0F7WXfkcLzUS3BHHuA/+DIhgL7uozu7+i5eJAYCgGeXl1mAopO1QUUEPL48CGAQTIL58iCAQSAAXx4EMAgE4MuDAAaBAHx5EMAg4PHlQQCDgMeXBwEMAh5fHgQwCHh8eRDAIJgE8+VBAINAAL48CGAQCMCXBwEMAgH48iCAQcDjy3MhAN0DL++CnygkQX8xDQHAs8pzIoC8l0bdAQMBwJu4gdECLxFnAojePq6pom+hEU8F7ZUBBPCNl76FvXheMu7OAI1BXFNFlUf5cbOzLctooSyKXzEvYpJ/3M0BVtI1VUI6Kbwbl5HLanQRwVWgYnlengHEQT9RU0WWRwna790YQIAStC9vno9zgHCbBEhURJHTgv74FJC1QUUEAvDlORNAjP6jWkCXOqo8ynebnfhCUNYGFRHw+PLczQHU+wCqIsr4KlD83kDWBhUR8PjyXAhglKwNKiLg8eVBAIOAx5cHAQyCSTBfHgQwCATgy4MABoEAfHkQwCAQgC8PAhgEPL48CGAQ8PjyIIBBwOPLgwAGAY8vDwIYBJNgvjwIYBAIwJcHAQwCAfjybAuQvhE+tVY2BMjMmzI+85wLcNiOWRtURMDTyenOrVlqnysBZDWI/fUara06anwelYZYHguRtUFFBDyVvO7dnaX2ORJAV4PQH6tqYe3tZtiv09bSV4VgGpfVG4qKwyGQqgYR3RepSqSI5/TWrEYXEfBUcAbIUQBVDSIlwHqtplaYL70AXCfBmAPkJUBcDSIhwEZyRpy1QUUEAvDlORJAV4NICUBzgGFUGRECWIzPPOsCyIoQdV0NImjLq0BaAFkaItoxa4OKCATgy7MtgHGyNqiIgMeXBwEMAh5fHgQwCHh8eRDAIODx5UEAg2ASzJcHAQwCAfjyqLc/frNK+eltCJATDwKUhhf3+Ue//BoC5MSDAKXhxX3+8XmcAcDzjoc5gEHA48uT3f2ravXC47euQQDwvOPJwc9b18QEAHMA8Dzk6dG/+oAAOfEwCS4NT3b3T5eefnrh0ZkMAvTlYl+HVHcINu/JJ+NN8Rp4ECBP3pTxmZd4H2Dp5HOA/sog3F9vHiLAqPE9BDDKxJ1WM98+RryprgKpe7hGa9/K6g5/SpR2GF2+vtwd1keRALrwgxAgaK98n6wCIVdIvdQJh+On/RNg8l7bmW8fI95UAqj7t9Sa7+nSDqPVll4KWwugtgoBxPbEruKhL/6D6Pf9ZvS0f1UhOFZbKEuejsdAyb+EMBVAFjFRHT1d2oG+E709FkBtDTbfber7IdU9wLRcdmPw4G5d7xyPlrIaXUSK5uEM4I5Hvf3J1Qvi88PXTnwZVAmgzwCp0g7yu8bggADt924MIgG0JPsb327srH270fVXAMwB3PH0+wDic4arQNEc4GBpB/pO6EHngzAyQZ4BOv3mxBkg3P7rlWDzbj30WADwnPFkd3/0+tLTh9ULGa4CLXeTV4Hi0g7yK5oG1OkMMe7zNAmOxzq6CsSwpmYBjATAZdDS8KaaBItBkHofQFV3SJR2UJ09lPWvavGwn54brSV2pVqg8hrQchcCZOdNGZ95UwpQXLI2qIhAAL68p2oWXK1Wk3NgCDAdDwKUhqf6/9KT9699dfKrQBAAvLLz5FWg87eFAPhjOPA85On3AXAGAM9PnroMeuazq5gDgOcjD1eBDIJJMF8eBDAIBODLgwAGgQB8eRDAIBCALw8CGAQ8vjwIYBDw+PIggEHA48tzIAD9mfSQ/oY0umf4pffUZ21QEQGPL8+BAP2m+PcRfWrG3b78AiTv6sIkuDQ8BwKMGoNg8x596oxUKQlVV6Kr7w8opwCp+3ohQGl4DgTY3+ju3/jxDt0SqQtB6CGQKigRlrMqRKqywzmHPwhyojgQgI78V6iUxJXE7fFxQQm9V1ajiwjOAHx5Lq4C9Vv9VjhsxrfHawFUQYmSCjBZ2aFwXo7xmedCgGH9QSccXXnQmRBgIzkPztqgIgIeX54LAfY/bAzEQOhyNy1AVCUCAoBnj+dCgKBNU12qmBILELTlVaDxCAgCgGeF50IAo2RtUBHBH8Px5UEAg0AAvjwIYBAIwJcHAQwCAfjyIIBBwOPLgwAGAY8vDwIYBDy+PAhgEPD48iCAQTAJ5suDAAaBAHx5EMAgEIAvDwIYBALw5UEAg4DHl+dEALV4pMqBu+EhAHgWeU4EGFJNiGOStUFT5ZC7umbpFwZevjwXAgSbX9wYyBUmo7UhV2VtiMbncslJdwJMrtheNO+wgGeP50KAUWOw3ZL3v/fl8tg0IqLbYlajO8JcVYVIVXaYJufyeBHERlwI0G/Gq8hHcwCqkeJ8neDczgC4ClQangMBgnZNDX5W9ZLacjnt5RkQILc5AAQoDc+BAGIEpAqEhroo1v56KyoPipXiM/GmjM88BwL0qe8P6zTcj6vCjS51GAkAXml49gUI7lAfFzOA7fFVoH6t9sb1FgQAzz7PxSTYKFkbVETA48uDAAYBjy8PAhgEk2C+PAhgEAjAlwcBDAIB+PIggEEgAF8eBDAIeHx5EMAg4PHlQQCDgMeXBwEMAh5fHgQwCCbBfHkQwCAQgC8PAhgEAvDlQQCDQAC+vHwFiP+a+bBqJ3rbYZvx59Dg2eU5EuD4TVkbNA4WrgbPgJe7AKq4yf56TS57Sne8XL6+vKMrnsj6J/T0jujoenNyU44CHHaDe5bM0i8MvHx5+Qugipvoha+p7smq6Nfqyaj+SXJd7AObwnzKouRW4gRhnfwFGK99TX06Ue0kVf+ENm906cbIA5v0S2U1OorTMwAmwaXhFSnAeq1WO9tJCRDVP9E7BpudA5tyEsDpHAAClIZXpAAbXf1c9C+uf3LgDJAojZKTADkGAvDlFShANMiPBYjrnxzYnCiNAgFmvn2MeEUJELTlVSBd+i36p+qfiG2Jq0Brk6VRGAgAXml4+QqQY7I2qIiAx5cHAQwCHl8eBDAIeHx5EMAgmATz5UEAg0AAvjwIYBAIwJcHAQwCAfjyZlaAo2J7ATHwvOVBAPC85kEA8LzmQQDwvObNpgAIYikQAPE6EADxOhAA8ToQAPE6sybAUK4tTPfSrAws8vo19WghQbtlsX2aZ619GmStfZqXvX0zJoC8dawuf2niwRov3G5ZgKn0ay177dM8e+1TIHvt0w3L3r4ZE4Ci76c/qvRc3rxgs2OHFVIZsVZosX2SZ619GmStfZo3RftmUACqtdUYUEEJazxZ4MXKQTLY/FIcHe21T/GstU+DrLVP86Zo38wJMFo926FiErYEkLzRpY6lo2S/ScMDe+1TPGvt0yBr7dO8Kdo3cwKEspaQzTNABLIxThYNC2yeATRPxuI8wOrvb7p5wAwKIFpidQ4w/UTKPHS1olZrWmuf5smvLQpQot/fjAmgz51Bu2nnKoLm0UNwx95lUGvt0zxr7dMgq78/wZuifTMmAB2yxJjc6nVk4ukHG3H1PoCd9pXu9zdrAiCI1UAAxOtAAMTrQADE60AAxOtAAMTrQID88uKmXLes8vubr9wX3+4tzEfPyO8zZe/ULYOnzP5jOi9uXgx3K5VF8eXuvPj0/B2Tl2UXCJBfXtxcVF/sLdAXW68+Gz9jP8cK0JsPn799kXZ7/mvp5+6rz2z8YDMWCJBf4u7eE4f8vYWL4QwLQAf8vdP36TzQUz8kfelfIEB+ibv787fnw635cEKAvVMfVyriMLt3+m9iUETDI7FLb04cgt9epL3poCx3+2RBDE32xKeLsh/TV+LL6FE8pXa5SKDK3Cen74/hwjy516La65YSgVA0CoteiNKTPwgJoE8Anp4CIEB+SXT33blPqPdNCLBA3X6eJge0aV7+I1HEx67ooPoQvLcgOmKPTKHuHPXjhYuJR7XLK/eFOcIBNcOgHi14YlgTpv7jqVsSIzZHLzD+WdUQqBf9jGaTC2aBAPlFT3kX1ZeL8TMV1cVk35PdVzxSj5efxNFcHMKp3+7JQ7neLdpXfKinw/GjfgXxKF+kpwSQ54pTt/73LBz/Ry2A3Is6++l4Li49kZNgcQLYqszdGj/nWSBAfkke72WnOzAEuhUddfV4Q37Vk6MSMfxRI6BwPHKJhjFbcqwURo+Jrt2TL6L6NbHk96JXiw6d3CuyMHqhMNnZe4viBeRP43DG4i4QIL9kFGBLdevT/9KT0AMCyKG+fD35eIgA4hX/fZNGRHO3Js4AvXhsH71QLMDz3zyLRkcQAJkqxwogBy6n7ysBaNRBe+2+8k/qjC9u/jYe4kwKEHdY5U9qcLOr32V4/g6NpaRYu6kzgERF0S80FmDr4nh6gCEQMlWOF0BPgtXhVk2CqdepoXw0PJkUQG5NPCa6dnISrE8l1Nv3FqQAtPXFzTkxCRZSiOejF1A763nJL+TFoPh85FsgQH55mQBq+K0OwfIy6HzU0fRl0C158WZ+fHnmJWeAXf0K+jF5gZMug34cCbArJxNioD/3dzXOosuev3tHXQZNvIDaWY6L1IWnnnq2h8ugSJE5+gibvEZzomS7fH/wLx/wRhhSbI4WoJdhBkrjHXn6yJDe5H/z8n0wCGAxRwkg39o6eegKZ7b+f+CAjz+GQxD/AgEQrwMBEK8DARCvAwEQrwMBEK8DARCv83//oCzMiyiDoQAAAABJRU5ErkJggg==" alt="Figure 1: Percent missing data by category." width="100%" />
<p class="caption">
Figure 1: Percent missing data by category.
</p>
</div>
</div>
<div id="setting-up-mice" class="section level2">
<h2>Setting up <code>mice()</code></h2>
<p>The mice package <span class="citation">(<a href="#ref-vanBuuren+Oudshoorn:2011" role="doc-biblioref">van Buuren and
Groothuis-Oudshoorn 2011</a>)</span> implements multiple imputation by
chained equations (MICE). MICE is also known as “fully conditional
specification” or “sequential regression multiple imputation” and is
suitable for categorical variables such as ours <span class="citation">(<a href="#ref-azur2011" role="doc-biblioref">Azur et
al. 2011</a>)</span>. Our computational procedure follows the approach
suggested by Dhana <span class="citation">(<a href="#ref-dhana2017" role="doc-biblioref">2017</a>)</span>.</p>
<div id="standard-predictors" class="section level3">
<h3>Standard predictors</h3>
<p><em>Framework.</em>   Our first use of <code>mice()</code> is to
examine the imputation framework by calling the function with zero
iterations on the <code>DT</code> data frame. <code>mice()</code>
produces a “multiply-imputed data set”, an R object of class “mids”.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation framework</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>framework <span class="ot">&lt;-</span> <span class="fu">mice</span>(DT, <span class="at">maxit =</span> <span class="dv">0</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Number of logged events: 2</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>framework</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class: mids</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of multiple imputations:  5 </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Imputation methods:</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        mcid        race         sex institution       proxy </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &quot;&quot;          &quot;&quot;          &quot;&quot;          &quot;&quot;   &quot;polyreg&quot; </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PredictorMatrix:</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             mcid race sex institution proxy</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mcid           0    1   1           0     1</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; race           0    0   1           0     1</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sex            0    1   0           0     1</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; institution    0    1   1           0     1</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; proxy          0    1   1           0     0</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of logged events:  2 </span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   it im dep     meth         out</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0  0     constant        mcid</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  0  0     constant institution</span></span></code></pre></div>
<p><em>Logged events warning.</em>   The printout above includes a
warning about two “logged events”—an indication that two variables will
not be used as predictors. We can isolate the warning for a closer
look,</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the warning</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>framework<span class="sc">$</span>loggedEvents</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   it im dep     meth         out</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0  0     constant        mcid</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  0  0     constant institution</span></span></code></pre></div>
<p>The two variables are <code>mcid</code> and
<code>institution</code>.</p>
<ul>
<li><p><code>mcid</code> was never intended to be a predictor variable.
We retain the ID column so that imputed CIP values are assigned to
specific IDs.</p></li>
<li><p><code>institution</code> usually is a predictor. In this case,
however, the FYE students are all at the same institution—a
characteristic of the midfielddata practice data only.</p></li>
</ul>
<p><em>Imputation methods.</em>   We look more closely at two elements
of this framework. The first is the imputation method vector.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation method</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>method_vector <span class="ot">&lt;-</span> framework[[<span class="st">&quot;method&quot;</span>]]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>method_vector</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        mcid        race         sex institution       proxy </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &quot;&quot;          &quot;&quot;          &quot;&quot;          &quot;&quot;   &quot;polyreg&quot;</span></span></code></pre></div>
<p>The “polyreg” imputation method (polytomous logistic regression) is
appropriate for data, like ours, comprising unordered categorical
variables. Variable <code>proxy</code> is imputed using the polyreg
method; the other variables, being predictors, are not imputed, thus
their methods are empty.</p>
<p>Had the method not been correctly assigned, we would assign it as
follows,</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually assign the variable(s) being imputed</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>method_vector[<span class="fu">c</span>(<span class="st">&quot;proxy&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;polyreg&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually assign the variable(s) not being imputed</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>method_vector[<span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>, <span class="st">&quot;institution&quot;</span>, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;sex&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>method_vector</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        mcid        race         sex institution       proxy </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &quot;&quot;          &quot;&quot;          &quot;&quot;          &quot;&quot;   &quot;polyreg&quot;</span></span></code></pre></div>
<p><em>Predictor matrix.</em>   The second element to review is the
predictor matrix. A row label identifies the variable being predicted;
the columns indicate the predictor variables.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation predictor matrix</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>predictor_matrix <span class="ot">&lt;-</span> framework[[<span class="st">&quot;predictorMatrix&quot;</span>]]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>predictor_matrix</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             mcid race sex institution proxy</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mcid           0    1   1           0     1</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; race           0    0   1           0     1</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sex            0    1   0           0     1</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; institution    0    1   1           0     1</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; proxy          0    1   1           0     0</span></span></code></pre></div>
<p>However, only those variables assigned a method are imputed. In our
case, the only variable to be imputed is <code>proxy</code>, so the only
row of this matrix that gets used is the last row.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictor row for this example</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>predictor_matrix[<span class="st">&quot;proxy&quot;</span>, ]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        mcid        race         sex institution       proxy </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           0           1           1           0           0</span></span></code></pre></div>
<p>The zeros and ones tell us that <code>proxy</code> is going to be
predicted by race and sex. Again, the institution variable is not a
predictor because the practice data contain one FYE institution only.
(This would not be the case if one were using the MIDFIELD research
database.)</p>
<p>Had the default setting been incorrect, we can set them manually.
Again, note that the bottom row is the only row we need because only the
<code>proxy</code> variable is being imputed.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually assign zero columns</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>predictor_matrix[, <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>, <span class="st">&quot;proxy&quot;</span>, <span class="st">&quot;institution&quot;</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually assign predictor columns</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>predictor_matrix[, <span class="fu">c</span>(<span class="st">&quot;race&quot;</span>, <span class="st">&quot;sex&quot;</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>predictor_matrix</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             mcid race sex institution proxy</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mcid           0    0   0           0     0</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; race           0    0   0           0     0</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sex            0    0   0           0     0</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; institution    0    0   0           0     0</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; proxy          0    1   1           0     0</span></span></code></pre></div>
<p>If the data included more than one FYE institution, the manual
assignment would be,</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Not run</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>predictor_matrix[, <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>, <span class="st">&quot;proxy&quot;</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>predictor_matrix[, <span class="fu">c</span>(<span class="st">&quot;race&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;institution&quot;</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="optional-predictors" class="section level3">
<h3>Optional predictors</h3>
<p>The default predictors set up by <code>prep_fye_mice()</code> are
institution (required), race/ethnicity, and sex. If these are
acceptable, you can skip to the next section, <a href="#imputing-missing-values">Imputing missing values</a>.</p>
<p>Predictors can be edited or added before invoking
<code>mice()</code>. As before, ensure that the only missing values are
in the proxy column. Other variables are expected to be complete (no NA
values). A value of “unknown” in a predictor column, e.g.,
race/ethnicity or sex, is an acceptable value, not missing data.
Observations with missing or unknown values in the ID or institution
columns should be removed.</p>
<p>For example, suppose we wish to replace race/ethnicity and sex with a
<code>people</code> variable that has four possible values
(<code>Domestic Female</code>, <code>Domestic Male</code>,
<code>International Female</code>, and <code>International Male</code>)
where “domestic” means a US citizen; and we want to add a variable that
encodes the <code>year</code> of a student’s first term in FYE.</p>
<p><em>Creating variables.</em>   Remove any unknown observations of
race/ethnicity and sex to create the desired <code>people</code>
variable.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frame to illustrate optional predictors</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>opt_DT <span class="ot">&lt;-</span> <span class="fu">copy</span>(DT)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor to character</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>cols_to_edit <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;race&quot;</span>, <span class="st">&quot;sex&quot;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>opt_DT[, (cols_to_edit) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, as.character), .SDcols <span class="ot">=</span> cols_to_edit]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter unknown race and sex</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>opt_DT <span class="ot">&lt;-</span> opt_DT[sex <span class="sc">!=</span> <span class="st">&quot;Unknown&quot;</span>]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>opt_DT <span class="ot">&lt;-</span> opt_DT[race <span class="sc">!=</span> <span class="st">&quot;Other/Unknown&quot;</span>]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create origin variable</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>opt_DT[, origin <span class="sc">:</span><span class="er">=</span> <span class="fu">fcase</span>(</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  race <span class="sc">!=</span> <span class="st">&quot;International&quot;</span>, <span class="st">&quot;Domestic&quot;</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  race <span class="sc">==</span> <span class="st">&quot;International&quot;</span>, <span class="st">&quot;International&quot;</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">default =</span> <span class="cn">NA_character_</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>)]</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>opt_DT <span class="ot">&lt;-</span> opt_DT[<span class="sc">!</span><span class="fu">is.na</span>(origin)]</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create people variable</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>opt_DT[, people <span class="sc">:</span><span class="er">=</span> <span class="fu">paste</span>(origin, sex)]</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>opt_DT[, people <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(people)]</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>opt_DT[, <span class="fu">c</span>(<span class="st">&quot;race&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;origin&quot;</span>) <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="fu">setcolorder</span>(opt_DT, <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>, <span class="st">&quot;people&quot;</span>, <span class="st">&quot;institution&quot;</span>, <span class="st">&quot;proxy&quot;</span>))</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>opt_DT</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 mcid          people   institution  proxy</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1: MCID3111190643 Domestic Female Institution J   &lt;NA&gt;</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2: MCID3111190747 Domestic Female Institution J   &lt;NA&gt;</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3: MCID3111288144 Domestic Female Institution J   &lt;NA&gt;</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ---                                                    </span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5569: MCID3112328635   Domestic Male Institution J 143501</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5570: MCID3112328655   Domestic Male Institution J 143501</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5571: MCID3112382784   Domestic Male Institution J 143501</span></span></code></pre></div>
<p>Check the unique values.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display unique people</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(opt_DT<span class="sc">$</span>people))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] Domestic Female      Domestic Male        International Female</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4] International Male  </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Levels: Domestic Female Domestic Male ... International Male</span></span></code></pre></div>
<p><em>Adding a variable.</em>   Obtain the student’s first term in the
data set from the <code>term</code> data table using a left-outer
join.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add all term variables by ID</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cols_to_join <span class="ot">&lt;-</span> term[, .(mcid, term)]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>opt_DT <span class="ot">&lt;-</span> cols_to_join[opt_DT, on <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>)]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for first term</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setkeyv</span>(opt_DT, <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>, <span class="st">&quot;term&quot;</span>))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>opt_DT <span class="ot">&lt;-</span> opt_DT[, .SD[<span class="dv">1</span>], by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>)]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create year variable</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>opt_DT[, year <span class="sc">:</span><span class="er">=</span> <span class="fu">substr</span>(term, <span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>opt_DT[, year <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(year)]</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>opt_DT[, term <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">setcolorder</span>(opt_DT, <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>, <span class="st">&quot;people&quot;</span>, <span class="st">&quot;institution&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;proxy&quot;</span>))</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>opt_DT</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 mcid             people   institution year  proxy</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1: MCID3111142290      Domestic Male Institution J 1988 141001</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2: MCID3111142294      Domestic Male Institution J 1988 141001</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3: MCID3111142961 International Male Institution J 1988 142101</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ---                                                            </span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5569: MCID3112447659      Domestic Male Institution J 2009   &lt;NA&gt;</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5570: MCID3112447663      Domestic Male Institution J 2009   &lt;NA&gt;</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5571: MCID3112447664      Domestic Male Institution J 2009   &lt;NA&gt;</span></span></code></pre></div>
<p><em>Filtering.</em>   Ensure complete cases except in
<code>proxy</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify complete cases in predictor variables</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>rows_we_want <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(opt_DT[, .(mcid, people, institution, year)])</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for complete predictors</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>opt_DT <span class="ot">&lt;-</span> opt_DT[rows_we_want]</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>opt_DT</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 mcid             people   institution year  proxy</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1: MCID3111142290      Domestic Male Institution J 1988 141001</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2: MCID3111142294      Domestic Male Institution J 1988 141001</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3: MCID3111142961 International Male Institution J 1988 142101</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ---                                                            </span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5569: MCID3112447659      Domestic Male Institution J 2009   &lt;NA&gt;</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5570: MCID3112447663      Domestic Male Institution J 2009   &lt;NA&gt;</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5571: MCID3112447664      Domestic Male Institution J 2009   &lt;NA&gt;</span></span></code></pre></div>
<p><em>Framework</em>   for optional predictors.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation framework</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>opt_framework <span class="ot">&lt;-</span> <span class="fu">mice</span>(opt_DT, <span class="at">maxit =</span> <span class="dv">0</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Number of logged events: 2</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>opt_framework</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class: mids</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of multiple imputations:  5 </span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Imputation methods:</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        mcid      people institution        year       proxy </span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &quot;&quot;          &quot;&quot;          &quot;&quot;          &quot;&quot;   &quot;polyreg&quot; </span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PredictorMatrix:</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             mcid people institution year proxy</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mcid           0      1           0    1     1</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; people         0      0           0    1     1</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; institution    0      1           0    1     1</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; year           0      1           0    0     1</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; proxy          0      1           0    1     0</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of logged events:  2 </span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   it im dep     meth         out</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0  0     constant        mcid</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  0  0     constant institution</span></span></code></pre></div>
<p><em>Imputation method</em>   for optional predictors.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation framework</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>opt_method_vector <span class="ot">&lt;-</span> opt_framework[[<span class="st">&quot;method&quot;</span>]]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>opt_method_vector</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        mcid      people institution        year       proxy </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &quot;&quot;          &quot;&quot;          &quot;&quot;          &quot;&quot;   &quot;polyreg&quot;</span></span></code></pre></div>
<p><em>Predictor matrix</em>   for optional predictors.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation predictor matrix</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>opt_predictor_matrix <span class="ot">&lt;-</span> opt_framework[[<span class="st">&quot;predictorMatrix&quot;</span>]]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>opt_predictor_matrix</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             mcid people institution year proxy</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mcid           0      1           0    1     1</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; people         0      0           0    1     1</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; institution    0      1           0    1     1</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; year           0      1           0    0     1</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; proxy          0      1           0    1     0</span></span></code></pre></div>
<p><em>Percent missing data</em>   for setting the number of multiple
imputations.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>N_impute <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(opt_DT<span class="sc">$</span>proxy))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>N_fye <span class="ot">&lt;-</span> <span class="fu">nrow</span>(opt_DT)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent missing data</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> N_impute <span class="sc">/</span> N_fye, <span class="dv">0</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 37</span></span></code></pre></div>
</div>
</div>
<div id="imputing-missing-values" class="section level2">
<h2>Imputing missing values</h2>
<p>The three essential arguments for <code>mice()</code> are the
<code>DT</code> data frame, the <code>method_vector</code>, and the
<code>predictor_matrix</code>. The number of multiple imputations
<code>m</code> is set to 37 as discussed in <a href="#missing-data">Missing data</a>. The default <code>seed</code>
argument is NULL, but by setting the seed as shown the vignette results
are reproducible. Setting <code>printFlag = TRUE</code> displays
progress in the console.</p>
<p>For the practice data, 5 iterations of 37 imputations takes about 3
minutes (depending on your machine). For MIDFIELD research data,
however, imputation runs significantly longer.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute missing proxy data</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>DT_mids <span class="ot">&lt;-</span> <span class="fu">mice</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> DT,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> m_imputations,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxit =</span> <span class="dv">5</span>, <span class="co"># default</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> method_vector,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictorMatrix =</span> predictor_matrix,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">20180624</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">printFlag =</span> <span class="cn">TRUE</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># output in console with printFlag = TRUE</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;  iter imp variable</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   1   1  proxy</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   1   2  proxy</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   1   3  proxy</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   1   4  proxy</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   1   5  proxy</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   ---</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   5  33  proxy</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   5  34  proxy</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   5  35  proxy</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   5  36  proxy</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;   5  37  proxy</span></span></code></pre></div>
</div>
<div id="post-processing" class="section level2">
<h2>Post-processing</h2>
<p><em>Extracting the result.</em>   We apply
<code>mice::complete()</code> to extract the data from the
<code>mids</code> object. The missing data have been replaced by imputed
values.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Revert to default random number generation</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="cn">NULL</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract data from the mids object</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">complete</span>(DT_mids)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data.table structure</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(DT)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">&lt;-</span> DT[<span class="fu">order</span>(mcid)]</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>DT</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 mcid          race  sex   institution  proxy</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1: MCID3111142290         Asian Male Institution J 141001</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2: MCID3111142294         Asian Male Institution J 141001</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3: MCID3111142961 International Male Institution J 142101</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ---                                                       </span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5787: MCID3112447659         White Male Institution J 141901</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5788: MCID3112447663         White Male Institution J 140201</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5789: MCID3112447664         White Male Institution J 141001</span></span></code></pre></div>
<p><em>Selecting columns.</em>   To use the result, we need only two
columns: IDs and the the predicted starting programs.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the data</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">&lt;-</span> DT[, .(mcid, proxy)]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>DT</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 mcid  proxy</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1: MCID3111142290 141001</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2: MCID3111142294 141001</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3: MCID3111142961 142101</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ---                      </span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5787: MCID3112447659 141901</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5788: MCID3112447663 140201</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5789: MCID3112447664 141001</span></span></code></pre></div>
<p><em>Recoding.</em>   We convert the CIP codes from factor to
character.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert factors</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>DT[, proxy <span class="sc">:</span><span class="er">=</span> <span class="fu">as.character</span>(proxy)]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>DT</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 mcid  proxy</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1: MCID3111142290 141001</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2: MCID3111142294 141001</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3: MCID3111142961 142101</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ---                      </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5787: MCID3112447659 141901</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5788: MCID3112447663 140201</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5789: MCID3112447664 141001</span></span></code></pre></div>
<p><em>Filtering.</em>   Proxies are substitutes for students
<em>starting</em> in FYE. Thus we filter to remove migrators, retaining
the proxies of first-term FYE students only.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order term data by ID and term</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ordered_term <span class="ot">&lt;-</span> term[, .(mcid, term, cip6)]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setorderv</span>(ordered_term, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>, <span class="st">&quot;term&quot;</span>))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain first term of all students</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>first_term <span class="ot">&lt;-</span> ordered_term[, .SD[<span class="dv">1</span>], by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>)]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduce to first term in FYE</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>first_term_fye_mcid <span class="ot">&lt;-</span> first_term[cip6 <span class="sc">==</span> <span class="st">&quot;140102&quot;</span>, .(mcid)]</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Inner join to remove migrators from working data frame</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">&lt;-</span> first_term_fye_mcid[DT, on <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>), nomatch <span class="ot">=</span> <span class="cn">NULL</span>]</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(DT, <span class="cn">NULL</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>DT</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 mcid  proxy</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1: MCID3111142290 141001</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2: MCID3111142294 141001</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3: MCID3111142961 142101</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ---                      </span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4621: MCID3112447659 141901</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4622: MCID3112447663 140201</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4623: MCID3112447664 141001</span></span></code></pre></div>
<p><em>Verify prepared data.</em>   To avoid deriving this data frame
each time it is needed in other vignettes, the same information is
provided in the <code>fye_proxy</code> data frame included with
midfieldr. Here we verify that the two data frames have the same
content.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate equivalence</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">same_content</span>(DT, fye_proxy)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div id="assessing-fye-proxies" class="section level2">
<h2>Assessing FYE proxies</h2>
<div id="credibility" class="section level3">
<h3>Credibility</h3>
<p>Here we summarize the FYE proxy data set to see how many students our
algorithm assigned to which engineering majors. Start by extracting the
unique set of CIP codes from the proxy data set.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify unique CIP codes in the proxy data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>proxy_cips <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(fye_proxy<span class="sc">$</span>proxy))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>proxy_cips</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;140201&quot; &quot;140301&quot; &quot;140701&quot; &quot;140801&quot; &quot;140901&quot; &quot;141001&quot; &quot;141101&quot; &quot;141401&quot;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;141801&quot; &quot;141901&quot; &quot;142101&quot; &quot;143301&quot; &quot;143501&quot;</span></span></code></pre></div>
<p>Obtain the program names from the <code>cip</code> data set (provided
with midfieldr). We use the 4-digit names that in engineering generally
represent department-level programs.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the 4-digit program names corresponding to these codes</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>proxy_program_names <span class="ot">&lt;-</span> <span class="fu">filter_cip</span>(<span class="at">keep_text =</span> proxy_cips)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>proxy_program_names <span class="ot">&lt;-</span> proxy_program_names[, .(cip6, <span class="at">program =</span> cip4name)]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>proxy_program_names</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       cip6                                                 program</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1: 140201   Aerospace, Aeronautical and Astronautical Engineering</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2: 140301 Agricultural, Biological Engineering and Bioengineering</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3: 140701                                    Chemical Engineering</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4: 140801                                       Civil Engineering</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5: 140901                           Computer Engineering, General</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6: 141001  Electrical, Electronics and Communications Engineering</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7: 141101                                   Engineering Mechanics</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8: 141401         Environmental, Environmental Health Engineering</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9: 141801                                   Materials Engineering</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10: 141901                                  Mechanical Engineering</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11: 142101                          Mining and Mineral Engineering</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12: 143301                                Construction Engineering</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13: 143501                                  Industrial Engineering</span></span></code></pre></div>
<p>Join these names to the proxy data set, summarize by program, and
order the rows by descending N.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join these program names to the proxy data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>proxy_programs <span class="ot">&lt;-</span> proxy_program_names[fye_proxy[, .(<span class="at">cip6 =</span> proxy)], .(program), on <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;cip6&quot;</span>)]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count by program and order rows in descending magnitude</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>proxy_programs <span class="ot">&lt;-</span> proxy_programs[, .N, by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;program&quot;</span>)]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setorderv</span>(proxy_programs, <span class="at">order =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;N&quot;</span>))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>proxy_programs</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                     program    N</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1:                                  Mechanical Engineering 1053</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2:  Electrical, Electronics and Communications Engineering  668</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3:                                       Civil Engineering  598</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4:                           Computer Engineering, General  566</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5:   Aerospace, Aeronautical and Astronautical Engineering  516</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6:                                  Industrial Engineering  393</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7:                                    Chemical Engineering  358</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8:                          Mining and Mineral Engineering  134</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9:                                   Engineering Mechanics  133</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10:                                   Materials Engineering  104</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11: Agricultural, Biological Engineering and Bioengineering   82</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12:                                Construction Engineering   17</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13:         Environmental, Environmental Health Engineering    1</span></span></code></pre></div>
<p>For comparison, the National Science Foundation (NSF) reports that in
2012, the top seven US engineering majors ranked by enrollment were
<span class="citation">(<a href="#ref-NSF:2014:online" role="doc-biblioref">SEI dashboard 2014</a>)</span>:</p>
<ul>
<li>Mechanical</li>
<li>Electrical</li>
<li>Civil</li>
<li>Chemical</li>
<li>Industrial</li>
<li>Aerospace</li>
<li>Materials</li>
</ul>
<p>In Table 1, we show the FYE proxy programs and indicate the
equivalent NSF ranking cited above. The assignment of proxies is fairly
consistent with the NSF results, though the practice data have a higher
frequency of aerospace proxies than expected. Recall that the practice
data contain only three institutions while the NSF information is based
on nearly 3000 US undergraduate institutions <span class="citation">(<a href="#ref-NSF:2014:ch2" role="doc-biblioref">SEI report
2014</a>)</span>.</p>
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
Table 1: Frequency of FYE proxies using the practice data
</caption>
<thead>
<tr>
<th style="text-align:left;background-color: #c7eae5 !important;">
Program
</th>
<th style="text-align:right;background-color: #c7eae5 !important;">
NSF ranking
</th>
<th style="text-align:right;background-color: #c7eae5 !important;">
N
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Mechanical Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
1
</td>
<td style="text-align:right;">
1053
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Electrical, Electronics and Communications Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
2
</td>
<td style="text-align:right;">
668
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Civil Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
3
</td>
<td style="text-align:right;">
598
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Computer Engineering, General
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
</td>
<td style="text-align:right;">
566
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Aerospace, Aeronautical and Astronautical Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
6
</td>
<td style="text-align:right;">
516
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Industrial Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
5
</td>
<td style="text-align:right;">
393
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Chemical Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
4
</td>
<td style="text-align:right;">
358
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Mining and Mineral Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
</td>
<td style="text-align:right;">
134
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Engineering Mechanics
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
</td>
<td style="text-align:right;">
133
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Materials Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
7
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Agricultural, Biological Engineering and Bioengineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
</td>
<td style="text-align:right;">
82
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Construction Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
</td>
<td style="text-align:right;">
17
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: white !important;">
Environmental, Environmental Health Engineering
</td>
<td style="text-align:right;color: black !important;background-color: white !important;">
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>We conclude that the imputation is credible at least to the extent
that the ranking of the majors is generally consistent with
expectations.</p>
</div>
<div id="quantifying-potential-miscounts" class="section level3">
<h3>Quantifying potential miscounts</h3>
<p>The main goal of estimating FYE proxies is to prevent starter
miscounts. Here, we assess the potential for miscounts if FYE records
are not treated as recommended.</p>
<p>We start with the <code>first_term</code> data frame created earlier
(in <a href="#post-processing">Post-processing</a>) containing the
initial term information of all students in the practice data.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First term of all students</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>first_term</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  mcid  term   cip6</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     1: MCID3111142225 19881 140901</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     2: MCID3111142283 19881 240102</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     3: MCID3111142290 19881 140102</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    ---                            </span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 97553: MCID3112898894 20181 451001</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 97554: MCID3112898895 20181 302001</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 97555: MCID3112898940 20181 050103</span></span></code></pre></div>
<p>Identify starters, including FYE proxies, in the four case study
programs. (This procedure is more fully developed in the <a href="art-070-starters.html">Starters</a> vignette.)</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join proxies by ID (left join) to first-term data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> fye_proxy[first_term, .(mcid, cip6, proxy), on <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;mcid&quot;</span>)]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Distinguish FYE from direct matriculants</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>start[, matric <span class="sc">:</span><span class="er">=</span> <span class="fu">fcase</span>(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">is.na</span>(proxy), <span class="st">&quot;direct&quot;</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span><span class="fu">is.na</span>(proxy), <span class="st">&quot;fye&quot;</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)]</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create start variable</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>start[, start <span class="sc">:</span><span class="er">=</span> <span class="fu">fcase</span>(</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  matric <span class="sc">==</span> <span class="st">&quot;fye&quot;</span>, proxy,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  matric <span class="sc">==</span> <span class="st">&quot;direct&quot;</span>, cip6</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>)]</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to retain case study program starters</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>join_labels <span class="ot">&lt;-</span> <span class="fu">copy</span>(study_programs)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(join_labels, <span class="at">old =</span> <span class="st">&quot;cip6&quot;</span>, <span class="at">new =</span> <span class="st">&quot;start&quot;</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> join_labels[start, on <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;start&quot;</span>)]</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> start[<span class="sc">!</span><span class="fu">is.na</span>(program)]</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>start[<span class="fu">order</span>(matric, start)]</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        start program           mcid   cip6  proxy matric</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1: 140801      CE MCID3111170903 140801   &lt;NA&gt; direct</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2: 140801      CE MCID3111170949 140801   &lt;NA&gt; direct</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3: 140801      CE MCID3111174233 140801   &lt;NA&gt; direct</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ---                                                   </span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5386: 143501     ISE MCID3112441692 140102 143501    fye</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5387: 143501     ISE MCID3112447596 140102 143501    fye</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5388: 143501     ISE MCID3112447600 140102 143501    fye</span></span></code></pre></div>
<p>This data frame contains all direct-matriculation starters in the
case study programs plus the FYE students with one of these programs as
their estimated proxy.</p>
<p>Grouping by program and type of matriculation, we can determine the
FYE percentage of all starters.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> start[, .N, by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;matric&quot;</span>, <span class="st">&quot;program&quot;</span>)]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to row-record form</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">dcast</span>(start, program <span class="sc">~</span> matric, <span class="at">value.var =</span> <span class="st">&quot;N&quot;</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute FYE as fraction of total</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>start[, N_starters <span class="sc">:</span><span class="er">=</span> direct <span class="sc">+</span> fye]</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>start[, fye_pct <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> fye <span class="sc">/</span> N_starters, <span class="dv">1</span>)]</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>start</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    program direct  fye N_starters fye_pct</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      CE    714  598       1312    45.6</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      EE    669  668       1337    50.0</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:     ISE     12  393        405    97.0</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4:      ME   1281 1053       2334    45.1</span></span></code></pre></div>
<p>The results indicate (for the case study data) a potential
under-count of 45% to 97% if FYE proxies are excluded when counting
starters.</p>
</div>
</div>
<div id="reusable-code" class="section level2">
<h2>Reusable code</h2>
<p>Given the number of lines of code and the number of case-specific
parameters involved, a reusable code section is not provided.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-azur2011" class="csl-entry">
Azur, Melissa J., Elizabeth A. Stuart, Constantine Frangakis, and Philip
J. Leaf. 2011. <span>“Multiple Imputation by Chained Equations:
<span>W</span>hat Is It and How Does It Work?”</span> <em>International
Journal of Methods in Psychiatric Research</em> 20 (1): 40–49. <a href="https://doi.org/doi:10.1002/mpr.329">https://doi.org/doi:10.1002/mpr.329</a>.
</div>
<div id="ref-Bodner:2008" class="csl-entry">
Bodner, Todd E. 2008. <span>“<span class="nocase">What improves with
increased missing data imputations?</span>”</span> <em><span>Structural
Equation Modeling: A Multidisciplinary Journal</span></em> 15 (4):
651–75. <a href="https://doi.org/10.1080/10705510802339072">https://doi.org/10.1080/10705510802339072</a>.
</div>
<div id="ref-dhana2017" class="csl-entry">
Dhana, Klodian. 2017. <span>“Handling Missing Data with
<span>MICE</span> Package: A Simple Approach.”</span> Edited by Data
Science Plus. [Online; accessed 2018-06-24]; <a href="https://datascienceplus.com/handling-missing-data-with-mice-package-a-simple-approach/" class="uri">https://datascienceplus.com/handling-missing-data-with-mice-package-a-simple-approach/</a>.
</div>
<div id="ref-GraceMartin:2012" class="csl-entry">
Grace-Martin, Karen. 2012. <span>“<span class="nocase">Two recommended
solutions for missing data: Multiple imputation and maximum
likelihood</span>.”</span> Blog post. <a href="https://www.theanalysisfactor.com/missing-data-two-recommended-solutions/">https://www.theanalysisfactor.com/missing-data-two-recommended-solutions/</a>.
</div>
<div id="ref-NSF:2014:online" class="csl-entry">
SEI dashboard. 2014. <em><span class="nocase">Science and Engineering
Indicators: How many degrees are earned in engineering, and what
subfields are most popular?</span></em> National Science Foundation;
[Online; accessed 2022–12–15]. <a href="https://www.nsf.gov/nsb/sei/edTool/data/engineering-01.html">https://www.nsf.gov/nsb/sei/edTool/data/engineering-01.html</a>.
</div>
<div id="ref-NSF:2014:ch2" class="csl-entry">
SEI report. 2014. <em><span class="nocase">Science and Engineering
Indicators: Ch. 2</span></em>. National Science Foundation; [Online;
accessed 2022–12–15]. <a href="https://www.nsf.gov/statistics/seind14/content/chapter-2/chapter-2.pdf">https://www.nsf.gov/statistics/seind14/content/chapter-2/chapter-2.pdf</a>.
</div>
<div id="ref-vanBuuren+Oudshoorn:2011" class="csl-entry">
van Buuren, Stef, and Karin Groothuis-Oudshoorn. 2011. <span>“<span class="nocase">mice: Multivariate Imputation by Chained Equations in
R</span>.”</span> <em>Journal of Statistical Software</em> 45 (3): 1–67.
<a href="https://www.jstatsoft.org/v45/i03/">https://www.jstatsoft.org/v45/i03/</a>.
</div>
</div>
<style type="text/css">
blockquote {
padding: 10px 20px;
margin: 0 0 20px;
border-left: 0px
}
caption {
color: #525252;
text-align: left;
font-weight: normal;
font-size: medium;
line-height: 1.5;
}
</style>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
